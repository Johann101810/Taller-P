var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,i=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,o=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),s=e=>{let n={};for(var r in e)t(n,r,{get:e[r],enumerable:!0});return n},c=(e,i,o,s)=>{if(i&&typeof i==`object`||typeof i==`function`)for(var c=r(i),l=0,u=c.length,d;l<u;l++)d=c[l],!a.call(e,d)&&d!==o&&t(e,d,{get:(e=>i[e]).bind(null,d),enumerable:!(s=n(i,d))||s.enumerable});return e},l=(n,r,a)=>(a=n==null?{}:e(i(n)),c(r||!n||!n.__esModule?t(a,`default`,{value:n,enumerable:!0}):a,n));(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var u=`bottom`,d=`right`,f=`left`,p=`auto`,m=[`top`,u,d,f],h=`start`,g=`clippingParents`,_=`viewport`,v=`popper`,y=`reference`,b=m.reduce(function(e,t){return e.concat([t+`-`+h,t+`-end`])},[]),x=[].concat(m,[p]).reduce(function(e,t){return e.concat([t,t+`-`+h,t+`-end`])},[]),S=`beforeRead`,C=`read`,w=`afterRead`,T=`beforeMain`,E=`main`,D=`afterMain`,O=`beforeWrite`,k=`write`,ee=`afterWrite`,te=[S,C,w,T,E,D,O,k,ee];function ne(e){return e?(e.nodeName||``).toLowerCase():null}function A(e){if(e==null)return window;if(e.toString()!==`[object Window]`){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function j(e){var t=A(e).Element;return e instanceof t||e instanceof Element}function re(e){var t=A(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function ie(e){if(typeof ShadowRoot>`u`)return!1;var t=A(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}function ae(e){var t=e.state;Object.keys(t.elements).forEach(function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},i=t.elements[e];!re(i)||!ne(i)||(Object.assign(i.style,n),Object.keys(r).forEach(function(e){var t=r[e];t===!1?i.removeAttribute(e):i.setAttribute(e,t===!0?``:t)}))})}function oe(e){var t=e.state,n={popper:{position:t.options.strategy,left:`0`,top:`0`,margin:`0`},arrow:{position:`absolute`},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(e){var r=t.elements[e],i=t.attributes[e]||{},a=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce(function(e,t){return e[t]=``,e},{});!re(r)||!ne(r)||(Object.assign(r.style,a),Object.keys(i).forEach(function(e){r.removeAttribute(e)}))})}}var se={name:`applyStyles`,enabled:!0,phase:`write`,fn:ae,effect:oe,requires:[`computeStyles`]};function ce(e){return e.split(`-`)[0]}var le=Math.max,ue=Math.min,de=Math.round;function fe(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(e){return e.brand+`/`+e.version}).join(` `):navigator.userAgent}function pe(){return!/^((?!chrome|android).)*safari/i.test(fe())}function me(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!1);var r=e.getBoundingClientRect(),i=1,a=1;t&&re(e)&&(i=e.offsetWidth>0&&de(r.width)/e.offsetWidth||1,a=e.offsetHeight>0&&de(r.height)/e.offsetHeight||1);var o=(j(e)?A(e):window).visualViewport,s=!pe()&&n,c=(r.left+(s&&o?o.offsetLeft:0))/i,l=(r.top+(s&&o?o.offsetTop:0))/a,u=r.width/i,d=r.height/a;return{width:u,height:d,top:l,right:c+u,bottom:l+d,left:c,x:c,y:l}}function he(e){var t=me(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function ge(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&ie(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function _e(e){return A(e).getComputedStyle(e)}function ve(e){return[`table`,`td`,`th`].indexOf(ne(e))>=0}function ye(e){return((j(e)?e.ownerDocument:e.document)||window.document).documentElement}function be(e){return ne(e)===`html`?e:e.assignedSlot||e.parentNode||(ie(e)?e.host:null)||ye(e)}function xe(e){return!re(e)||_e(e).position===`fixed`?null:e.offsetParent}function Se(e){var t=/firefox/i.test(fe());if(/Trident/i.test(fe())&&re(e)&&_e(e).position===`fixed`)return null;var n=be(e);for(ie(n)&&(n=n.host);re(n)&&[`html`,`body`].indexOf(ne(n))<0;){var r=_e(n);if(r.transform!==`none`||r.perspective!==`none`||r.contain===`paint`||[`transform`,`perspective`].indexOf(r.willChange)!==-1||t&&r.willChange===`filter`||t&&r.filter&&r.filter!==`none`)return n;n=n.parentNode}return null}function Ce(e){for(var t=A(e),n=xe(e);n&&ve(n)&&_e(n).position===`static`;)n=xe(n);return n&&(ne(n)===`html`||ne(n)===`body`&&_e(n).position===`static`)?t:n||Se(e)||t}function we(e){return[`top`,`bottom`].indexOf(e)>=0?`x`:`y`}function Te(e,t,n){return le(e,ue(t,n))}function Ee(e,t,n){var r=Te(e,t,n);return r>n?n:r}function De(){return{top:0,right:0,bottom:0,left:0}}function Oe(e){return Object.assign({},De(),e)}function ke(e,t){return t.reduce(function(t,n){return t[n]=e,t},{})}var Ae=function(e,t){return e=typeof e==`function`?e(Object.assign({},t.rects,{placement:t.placement})):e,Oe(typeof e==`number`?ke(e,m):e)};function je(e){var t,n=e.state,r=e.name,i=e.options,a=n.elements.arrow,o=n.modifiersData.popperOffsets,s=ce(n.placement),c=we(s),l=[`left`,`right`].indexOf(s)>=0?`height`:`width`;if(!(!a||!o)){var p=Ae(i.padding,n),m=he(a),h=c===`y`?`top`:f,g=c===`y`?u:d,_=n.rects.reference[l]+n.rects.reference[c]-o[c]-n.rects.popper[l],v=o[c]-n.rects.reference[c],y=Ce(a),b=y?c===`y`?y.clientHeight||0:y.clientWidth||0:0,x=_/2-v/2,S=p[h],C=b-m[l]-p[g],w=b/2-m[l]/2+x,T=Te(S,w,C),E=c;n.modifiersData[r]=(t={},t[E]=T,t.centerOffset=T-w,t)}}function Me(e){var t=e.state,n=e.options.element,r=n===void 0?`[data-popper-arrow]`:n;r!=null&&(typeof r==`string`&&(r=t.elements.popper.querySelector(r),!r)||ge(t.elements.popper,r)&&(t.elements.arrow=r))}var Ne={name:`arrow`,enabled:!0,phase:`main`,fn:je,effect:Me,requires:[`popperOffsets`],requiresIfExists:[`preventOverflow`]};function Pe(e){return e.split(`-`)[1]}var Fe={top:`auto`,right:`auto`,bottom:`auto`,left:`auto`};function Ie(e,t){var n=e.x,r=e.y,i=t.devicePixelRatio||1;return{x:de(n*i)/i||0,y:de(r*i)/i||0}}function Le(e){var t,n=e.popper,r=e.popperRect,i=e.placement,a=e.variation,o=e.offsets,s=e.position,c=e.gpuAcceleration,l=e.adaptive,p=e.roundOffsets,m=e.isFixed,h=o.x,g=h===void 0?0:h,_=o.y,v=_===void 0?0:_,y=typeof p==`function`?p({x:g,y:v}):{x:g,y:v};g=y.x,v=y.y;var b=o.hasOwnProperty(`x`),x=o.hasOwnProperty(`y`),S=f,C=`top`,w=window;if(l){var T=Ce(n),E=`clientHeight`,D=`clientWidth`;if(T===A(n)&&(T=ye(n),_e(T).position!==`static`&&s===`absolute`&&(E=`scrollHeight`,D=`scrollWidth`)),T=T,i===`top`||(i===`left`||i===`right`)&&a===`end`){C=u;var O=m&&T===w&&w.visualViewport?w.visualViewport.height:T[E];v-=O-r.height,v*=c?1:-1}if(i===`left`||(i===`top`||i===`bottom`)&&a===`end`){S=d;var k=m&&T===w&&w.visualViewport?w.visualViewport.width:T[D];g-=k-r.width,g*=c?1:-1}}var ee=Object.assign({position:s},l&&Fe),te=p===!0?Ie({x:g,y:v},A(n)):{x:g,y:v};if(g=te.x,v=te.y,c){var ne;return Object.assign({},ee,(ne={},ne[C]=x?`0`:``,ne[S]=b?`0`:``,ne.transform=(w.devicePixelRatio||1)<=1?`translate(`+g+`px, `+v+`px)`:`translate3d(`+g+`px, `+v+`px, 0)`,ne))}return Object.assign({},ee,(t={},t[C]=x?v+`px`:``,t[S]=b?g+`px`:``,t.transform=``,t))}function Re(e){var t=e.state,n=e.options,r=n.gpuAcceleration,i=r===void 0?!0:r,a=n.adaptive,o=a===void 0?!0:a,s=n.roundOffsets,c=s===void 0?!0:s,l={placement:ce(t.placement),variation:Pe(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:t.options.strategy===`fixed`};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,Le(Object.assign({},l,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:c})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,Le(Object.assign({},l,{offsets:t.modifiersData.arrow,position:`absolute`,adaptive:!1,roundOffsets:c})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}var ze={name:`computeStyles`,enabled:!0,phase:`beforeWrite`,fn:Re,data:{}},Be={passive:!0};function Ve(e){var t=e.state,n=e.instance,r=e.options,i=r.scroll,a=i===void 0?!0:i,o=r.resize,s=o===void 0?!0:o,c=A(t.elements.popper),l=[].concat(t.scrollParents.reference,t.scrollParents.popper);return a&&l.forEach(function(e){e.addEventListener(`scroll`,n.update,Be)}),s&&c.addEventListener(`resize`,n.update,Be),function(){a&&l.forEach(function(e){e.removeEventListener(`scroll`,n.update,Be)}),s&&c.removeEventListener(`resize`,n.update,Be)}}var He={name:`eventListeners`,enabled:!0,phase:`write`,fn:function(){},effect:Ve,data:{}},Ue={left:`right`,right:`left`,bottom:`top`,top:`bottom`};function We(e){return e.replace(/left|right|bottom|top/g,function(e){return Ue[e]})}var Ge={start:`end`,end:`start`};function Ke(e){return e.replace(/start|end/g,function(e){return Ge[e]})}function qe(e){var t=A(e),n=t.pageXOffset,r=t.pageYOffset;return{scrollLeft:n,scrollTop:r}}function Je(e){return me(ye(e)).left+qe(e).scrollLeft}function Ye(e,t){var n=A(e),r=ye(e),i=n.visualViewport,a=r.clientWidth,o=r.clientHeight,s=0,c=0;if(i){a=i.width,o=i.height;var l=pe();(l||!l&&t===`fixed`)&&(s=i.offsetLeft,c=i.offsetTop)}return{width:a,height:o,x:s+Je(e),y:c}}function Xe(e){var t=ye(e),n=qe(e),r=e.ownerDocument?.body,i=le(t.scrollWidth,t.clientWidth,r?r.scrollWidth:0,r?r.clientWidth:0),a=le(t.scrollHeight,t.clientHeight,r?r.scrollHeight:0,r?r.clientHeight:0),o=-n.scrollLeft+Je(e),s=-n.scrollTop;return _e(r||t).direction===`rtl`&&(o+=le(t.clientWidth,r?r.clientWidth:0)-i),{width:i,height:a,x:o,y:s}}function Ze(e){var t=_e(e),n=t.overflow,r=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function Qe(e){return[`html`,`body`,`#document`].indexOf(ne(e))>=0?e.ownerDocument.body:re(e)&&Ze(e)?e:Qe(be(e))}function $e(e,t){t===void 0&&(t=[]);var n=Qe(e),r=n===e.ownerDocument?.body,i=A(n),a=r?[i].concat(i.visualViewport||[],Ze(n)?n:[]):n,o=t.concat(a);return r?o:o.concat($e(be(a)))}function et(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function tt(e,t){var n=me(e,!1,t===`fixed`);return n.top+=e.clientTop,n.left+=e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}function nt(e,t,n){return t===`viewport`?et(Ye(e,n)):j(t)?tt(t,n):et(Xe(ye(e)))}function rt(e){var t=$e(be(e)),n=[`absolute`,`fixed`].indexOf(_e(e).position)>=0&&re(e)?Ce(e):e;return j(n)?t.filter(function(e){return j(e)&&ge(e,n)&&ne(e)!==`body`}):[]}function it(e,t,n,r){var i=t===`clippingParents`?rt(e):[].concat(t),a=[].concat(i,[n]),o=a[0],s=a.reduce(function(t,n){var i=nt(e,n,r);return t.top=le(i.top,t.top),t.right=ue(i.right,t.right),t.bottom=ue(i.bottom,t.bottom),t.left=le(i.left,t.left),t},nt(e,o,r));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function at(e){var t=e.reference,n=e.element,r=e.placement,i=r?ce(r):null,a=r?Pe(r):null,o=t.x+t.width/2-n.width/2,s=t.y+t.height/2-n.height/2,c;switch(i){case`top`:c={x:o,y:t.y-n.height};break;case u:c={x:o,y:t.y+t.height};break;case d:c={x:t.x+t.width,y:s};break;case f:c={x:t.x-n.width,y:s};break;default:c={x:t.x,y:t.y}}var l=i?we(i):null;if(l!=null){var p=l===`y`?`height`:`width`;switch(a){case h:c[l]=c[l]-(t[p]/2-n[p]/2);break;case`end`:c[l]=c[l]+(t[p]/2-n[p]/2);break;default:}}return c}function ot(e,t){t===void 0&&(t={});var n=t,r=n.placement,i=r===void 0?e.placement:r,a=n.strategy,o=a===void 0?e.strategy:a,s=n.boundary,c=s===void 0?g:s,l=n.rootBoundary,u=l===void 0?_:l,d=n.elementContext,f=d===void 0?v:d,p=n.altBoundary,h=p===void 0?!1:p,b=n.padding,x=b===void 0?0:b,S=Oe(typeof x==`number`?ke(x,m):x),C=f===`popper`?y:v,w=e.rects.popper,T=e.elements[h?C:f],E=it(j(T)?T:T.contextElement||ye(e.elements.popper),c,u,o),D=me(e.elements.reference),O=at({reference:D,element:w,strategy:`absolute`,placement:i}),k=et(Object.assign({},w,O)),ee=f===`popper`?k:D,te={top:E.top-ee.top+S.top,bottom:ee.bottom-E.bottom+S.bottom,left:E.left-ee.left+S.left,right:ee.right-E.right+S.right},ne=e.modifiersData.offset;if(f===`popper`&&ne){var A=ne[i];Object.keys(te).forEach(function(e){var t=[`right`,`bottom`].indexOf(e)>=0?1:-1,n=[`top`,`bottom`].indexOf(e)>=0?`y`:`x`;te[e]+=A[n]*t})}return te}function st(e,t){t===void 0&&(t={});var n=t,r=n.placement,i=n.boundary,a=n.rootBoundary,o=n.padding,s=n.flipVariations,c=n.allowedAutoPlacements,l=c===void 0?x:c,u=Pe(r),d=u?s?b:b.filter(function(e){return Pe(e)===u}):m,f=d.filter(function(e){return l.indexOf(e)>=0});f.length===0&&(f=d);var p=f.reduce(function(t,n){return t[n]=ot(e,{placement:n,boundary:i,rootBoundary:a,padding:o})[ce(n)],t},{});return Object.keys(p).sort(function(e,t){return p[e]-p[t]})}function ct(e){if(ce(e)===`auto`)return[];var t=We(e);return[Ke(e),t,Ke(t)]}function lt(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var i=n.mainAxis,a=i===void 0?!0:i,o=n.altAxis,s=o===void 0?!0:o,c=n.fallbackPlacements,l=n.padding,p=n.boundary,m=n.rootBoundary,g=n.altBoundary,_=n.flipVariations,v=_===void 0?!0:_,y=n.allowedAutoPlacements,b=t.options.placement,x=ce(b)===b,S=c||(x||!v?[We(b)]:ct(b)),C=[b].concat(S).reduce(function(e,n){return e.concat(ce(n)===`auto`?st(t,{placement:n,boundary:p,rootBoundary:m,padding:l,flipVariations:v,allowedAutoPlacements:y}):n)},[]),w=t.rects.reference,T=t.rects.popper,E=new Map,D=!0,O=C[0],k=0;k<C.length;k++){var ee=C[k],te=ce(ee),ne=Pe(ee)===h,A=[`top`,u].indexOf(te)>=0,j=A?`width`:`height`,re=ot(t,{placement:ee,boundary:p,rootBoundary:m,altBoundary:g,padding:l}),ie=A?ne?d:f:ne?u:`top`;w[j]>T[j]&&(ie=We(ie));var ae=We(ie),oe=[];if(a&&oe.push(re[te]<=0),s&&oe.push(re[ie]<=0,re[ae]<=0),oe.every(function(e){return e})){O=ee,D=!1;break}E.set(ee,oe)}if(D)for(var se=v?3:1,le=function(e){var t=C.find(function(t){var n=E.get(t);if(n)return n.slice(0,e).every(function(e){return e})});if(t)return O=t,`break`},ue=se;ue>0&&le(ue)!==`break`;ue--);t.placement!==O&&(t.modifiersData[r]._skip=!0,t.placement=O,t.reset=!0)}}var ut={name:`flip`,enabled:!0,phase:`main`,fn:lt,requiresIfExists:[`offset`],data:{_skip:!1}};function dt(e,t,n){return n===void 0&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function ft(e){return[`top`,d,u,f].some(function(t){return e[t]>=0})}function pt(e){var t=e.state,n=e.name,r=t.rects.reference,i=t.rects.popper,a=t.modifiersData.preventOverflow,o=ot(t,{elementContext:`reference`}),s=ot(t,{altBoundary:!0}),c=dt(o,r),l=dt(s,i,a),u=ft(c),d=ft(l);t.modifiersData[n]={referenceClippingOffsets:c,popperEscapeOffsets:l,isReferenceHidden:u,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":d})}var mt={name:`hide`,enabled:!0,phase:`main`,requiresIfExists:[`preventOverflow`],fn:pt};function ht(e,t,n){var r=ce(e),i=[`left`,`top`].indexOf(r)>=0?-1:1,a=typeof n==`function`?n(Object.assign({},t,{placement:e})):n,o=a[0],s=a[1];return o||=0,s=(s||0)*i,[`left`,`right`].indexOf(r)>=0?{x:s,y:o}:{x:o,y:s}}function gt(e){var t=e.state,n=e.options,r=e.name,i=n.offset,a=i===void 0?[0,0]:i,o=x.reduce(function(e,n){return e[n]=ht(n,t.rects,a),e},{}),s=o[t.placement],c=s.x,l=s.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=c,t.modifiersData.popperOffsets.y+=l),t.modifiersData[r]=o}var _t={name:`offset`,enabled:!0,phase:`main`,requires:[`popperOffsets`],fn:gt};function vt(e){var t=e.state,n=e.name;t.modifiersData[n]=at({reference:t.rects.reference,element:t.rects.popper,strategy:`absolute`,placement:t.placement})}var yt={name:`popperOffsets`,enabled:!0,phase:`read`,fn:vt,data:{}};function bt(e){return e===`x`?`y`:`x`}function xt(e){var t=e.state,n=e.options,r=e.name,i=n.mainAxis,a=i===void 0?!0:i,o=n.altAxis,s=o===void 0?!1:o,c=n.boundary,l=n.rootBoundary,p=n.altBoundary,m=n.padding,h=n.tether,g=h===void 0?!0:h,_=n.tetherOffset,v=_===void 0?0:_,y=ot(t,{boundary:c,rootBoundary:l,padding:m,altBoundary:p}),b=ce(t.placement),x=Pe(t.placement),S=!x,C=we(b),w=bt(C),T=t.modifiersData.popperOffsets,E=t.rects.reference,D=t.rects.popper,O=typeof v==`function`?v(Object.assign({},t.rects,{placement:t.placement})):v,k=typeof O==`number`?{mainAxis:O,altAxis:O}:Object.assign({mainAxis:0,altAxis:0},O),ee=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,te={x:0,y:0};if(T){if(a){var ne=C===`y`?`top`:f,A=C===`y`?u:d,j=C===`y`?`height`:`width`,re=T[C],ie=re+y[ne],ae=re-y[A],oe=g?-D[j]/2:0,se=x===`start`?E[j]:D[j],de=x===`start`?-D[j]:-E[j],fe=t.elements.arrow,pe=g&&fe?he(fe):{width:0,height:0},me=t.modifiersData[`arrow#persistent`]?t.modifiersData[`arrow#persistent`].padding:De(),ge=me[ne],_e=me[A],ve=Te(0,E[j],pe[j]),ye=S?E[j]/2-oe-ve-ge-k.mainAxis:se-ve-ge-k.mainAxis,be=S?-E[j]/2+oe+ve+_e+k.mainAxis:de+ve+_e+k.mainAxis,xe=t.elements.arrow&&Ce(t.elements.arrow),Se=xe?C===`y`?xe.clientTop||0:xe.clientLeft||0:0,Oe=ee?.[C]??0,ke=re+ye-Oe-Se,Ae=re+be-Oe,je=Te(g?ue(ie,ke):ie,re,g?le(ae,Ae):ae);T[C]=je,te[C]=je-re}if(s){var Me=C===`x`?`top`:f,Ne=C===`x`?u:d,Fe=T[w],Ie=w===`y`?`height`:`width`,Le=Fe+y[Me],Re=Fe-y[Ne],ze=[`top`,f].indexOf(b)!==-1,Be=ee?.[w]??0,Ve=ze?Le:Fe-E[Ie]-D[Ie]-Be+k.altAxis,He=ze?Fe+E[Ie]+D[Ie]-Be-k.altAxis:Re,Ue=g&&ze?Ee(Ve,Fe,He):Te(g?Ve:Le,Fe,g?He:Re);T[w]=Ue,te[w]=Ue-Fe}t.modifiersData[r]=te}}var St={name:`preventOverflow`,enabled:!0,phase:`main`,fn:xt,requiresIfExists:[`offset`]};function Ct(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function wt(e){return e===A(e)||!re(e)?qe(e):Ct(e)}function Tt(e){var t=e.getBoundingClientRect(),n=de(t.width)/e.offsetWidth||1,r=de(t.height)/e.offsetHeight||1;return n!==1||r!==1}function Et(e,t,n){n===void 0&&(n=!1);var r=re(t),i=re(t)&&Tt(t),a=ye(t),o=me(e,i,n),s={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(r||!r&&!n)&&((ne(t)!==`body`||Ze(a))&&(s=wt(t)),re(t)?(c=me(t,!0),c.x+=t.clientLeft,c.y+=t.clientTop):a&&(c.x=Je(a))),{x:o.left+s.scrollLeft-c.x,y:o.top+s.scrollTop-c.y,width:o.width,height:o.height}}function Dt(e){var t=new Map,n=new Set,r=[];e.forEach(function(e){t.set(e.name,e)});function i(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach(function(e){if(!n.has(e)){var r=t.get(e);r&&i(r)}}),r.push(e)}return e.forEach(function(e){n.has(e.name)||i(e)}),r}function Ot(e){var t=Dt(e);return te.reduce(function(e,n){return e.concat(t.filter(function(e){return e.phase===n}))},[])}function kt(e){var t;return function(){return t||=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})}),t}}function At(e){var t=e.reduce(function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e},{});return Object.keys(t).map(function(e){return t[e]})}var jt={placement:`bottom`,modifiers:[],strategy:`absolute`};function Mt(){return![...arguments].some(function(e){return!(e&&typeof e.getBoundingClientRect==`function`)})}function Nt(e){e===void 0&&(e={});var t=e,n=t.defaultModifiers,r=n===void 0?[]:n,i=t.defaultOptions,a=i===void 0?jt:i;return function(e,t,n){n===void 0&&(n=a);var i={placement:`bottom`,orderedModifiers:[],options:Object.assign({},jt,a),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},o=[],s=!1,c={state:i,setOptions:function(n){var o=typeof n==`function`?n(i.options):n;return u(),i.options=Object.assign({},a,i.options,o),i.scrollParents={reference:j(e)?$e(e):e.contextElement?$e(e.contextElement):[],popper:$e(t)},i.orderedModifiers=Ot(At([].concat(r,i.options.modifiers))).filter(function(e){return e.enabled}),l(),c.update()},forceUpdate:function(){if(!s){var e=i.elements,t=e.reference,n=e.popper;if(Mt(t,n)){i.rects={reference:Et(t,Ce(n),i.options.strategy===`fixed`),popper:he(n)},i.reset=!1,i.placement=i.options.placement,i.orderedModifiers.forEach(function(e){return i.modifiersData[e.name]=Object.assign({},e.data)});for(var r=0;r<i.orderedModifiers.length;r++){if(i.reset===!0){i.reset=!1,r=-1;continue}var a=i.orderedModifiers[r],o=a.fn,l=a.options,u=l===void 0?{}:l,d=a.name;typeof o==`function`&&(i=o({state:i,options:u,name:d,instance:c})||i)}}}},update:kt(function(){return new Promise(function(e){c.forceUpdate(),e(i)})}),destroy:function(){u(),s=!0}};if(!Mt(e,t))return c;c.setOptions(n).then(function(e){!s&&n.onFirstUpdate&&n.onFirstUpdate(e)});function l(){i.orderedModifiers.forEach(function(e){var t=e.name,n=e.options,r=n===void 0?{}:n,a=e.effect;if(typeof a==`function`){var s=a({state:i,name:t,instance:c,options:r});o.push(s||function(){})}})}function u(){o.forEach(function(e){return e()}),o=[]}return c}}var Pt=Nt(),Ft=Nt({defaultModifiers:[He,yt,ze,se]}),It=Nt({defaultModifiers:[He,yt,ze,se,_t,ut,St,Ne,mt]}),Lt=s({afterMain:()=>D,afterRead:()=>w,afterWrite:()=>ee,applyStyles:()=>se,arrow:()=>Ne,auto:()=>p,basePlacements:()=>m,beforeMain:()=>T,beforeRead:()=>S,beforeWrite:()=>O,bottom:()=>u,clippingParents:()=>g,computeStyles:()=>ze,createPopper:()=>It,createPopperBase:()=>Pt,createPopperLite:()=>Ft,detectOverflow:()=>ot,end:()=>`end`,eventListeners:()=>He,flip:()=>ut,hide:()=>mt,left:()=>f,main:()=>E,modifierPhases:()=>te,offset:()=>_t,placements:()=>x,popper:()=>v,popperGenerator:()=>Nt,popperOffsets:()=>yt,preventOverflow:()=>St,read:()=>C,reference:()=>y,right:()=>d,start:()=>h,top:()=>`top`,variationPlacements:()=>b,viewport:()=>_,write:()=>k}),Rt=new Map,zt={set(e,t,n){Rt.has(e)||Rt.set(e,new Map);let r=Rt.get(e);if(!r.has(t)&&r.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(r.keys())[0]}.`);return}r.set(t,n)},get(e,t){return Rt.has(e)&&Rt.get(e).get(t)||null},remove(e,t){if(!Rt.has(e))return;let n=Rt.get(e);n.delete(t),n.size===0&&Rt.delete(e)}},Bt=1e6,Vt=1e3,Ht=`transitionend`,Ut=e=>(e&&window.CSS&&window.CSS.escape&&(e=e.replace(/#([^\s"#']+)/g,(e,t)=>`#${CSS.escape(t)}`)),e),Wt=e=>e==null?`${e}`:Object.prototype.toString.call(e).match(/\s([a-z]+)/i)[1].toLowerCase(),Gt=e=>{do e+=Math.floor(Math.random()*Bt);while(document.getElementById(e));return e},Kt=e=>{if(!e)return 0;let{transitionDuration:t,transitionDelay:n}=window.getComputedStyle(e);return!Number.parseFloat(t)&&!Number.parseFloat(n)?0:(t=t.split(`,`)[0],n=n.split(`,`)[0],(Number.parseFloat(t)+Number.parseFloat(n))*Vt)},qt=e=>{e.dispatchEvent(new Event(Ht))},Jt=e=>!e||typeof e!=`object`?!1:(e.jquery!==void 0&&(e=e[0]),e.nodeType!==void 0),Yt=e=>Jt(e)?e.jquery?e[0]:e:typeof e==`string`&&e.length>0?document.querySelector(Ut(e)):null,Xt=e=>{if(!Jt(e)||e.getClientRects().length===0)return!1;let t=getComputedStyle(e).getPropertyValue(`visibility`)===`visible`,n=e.closest(`details:not([open])`);if(!n)return t;if(n!==e){let t=e.closest(`summary`);if(t&&t.parentNode!==n||t===null)return!1}return t},Zt=e=>!e||e.nodeType!==Node.ELEMENT_NODE||e.classList.contains(`disabled`)?!0:e.disabled===void 0?e.hasAttribute(`disabled`)&&e.getAttribute(`disabled`)!==`false`:e.disabled,Qt=e=>{if(!document.documentElement.attachShadow)return null;if(typeof e.getRootNode==`function`){let t=e.getRootNode();return t instanceof ShadowRoot?t:null}return e instanceof ShadowRoot?e:e.parentNode?Qt(e.parentNode):null},$t=()=>{},en=e=>{e.offsetHeight},tn=()=>window.jQuery&&!document.body.hasAttribute(`data-bs-no-jquery`)?window.jQuery:null,nn=[],rn=e=>{document.readyState===`loading`?(nn.length||document.addEventListener(`DOMContentLoaded`,()=>{for(let e of nn)e()}),nn.push(e)):e()},an=()=>document.documentElement.dir===`rtl`,on=e=>{rn(()=>{let t=tn();if(t){let n=e.NAME,r=t.fn[n];t.fn[n]=e.jQueryInterface,t.fn[n].Constructor=e,t.fn[n].noConflict=()=>(t.fn[n]=r,e.jQueryInterface)}})},sn=(e,t=[],n=e)=>typeof e==`function`?e.call(...t):n,cn=(e,t,n=!0)=>{if(!n){sn(e);return}let r=Kt(t)+5,i=!1,a=({target:n})=>{n===t&&(i=!0,t.removeEventListener(Ht,a),sn(e))};t.addEventListener(Ht,a),setTimeout(()=>{i||qt(t)},r)},ln=(e,t,n,r)=>{let i=e.length,a=e.indexOf(t);return a===-1?!n&&r?e[i-1]:e[0]:(a+=n?1:-1,r&&(a=(a+i)%i),e[Math.max(0,Math.min(a,i-1))])},un=/[^.]*(?=\..*)\.|.*/,dn=/\..*/,fn=/::\d+$/,pn={},mn=1,hn={mouseenter:`mouseover`,mouseleave:`mouseout`},gn=new Set(`click.dblclick.mouseup.mousedown.contextmenu.mousewheel.DOMMouseScroll.mouseover.mouseout.mousemove.selectstart.selectend.keydown.keypress.keyup.orientationchange.touchstart.touchmove.touchend.touchcancel.pointerdown.pointermove.pointerup.pointerleave.pointercancel.gesturestart.gesturechange.gestureend.focus.blur.change.reset.select.submit.focusin.focusout.load.unload.beforeunload.resize.move.DOMContentLoaded.readystatechange.error.abort.scroll`.split(`.`));function _n(e,t){return t&&`${t}::${mn++}`||e.uidEvent||mn++}function vn(e){let t=_n(e);return e.uidEvent=t,pn[t]=pn[t]||{},pn[t]}function yn(e,t){return function n(r){return Dn(r,{delegateTarget:e}),n.oneOff&&M.off(e,r.type,t),t.apply(e,[r])}}function bn(e,t,n){return function r(i){let a=e.querySelectorAll(t);for(let{target:o}=i;o&&o!==this;o=o.parentNode)for(let s of a)if(s===o)return Dn(i,{delegateTarget:o}),r.oneOff&&M.off(e,i.type,t,n),n.apply(o,[i])}}function xn(e,t,n=null){return Object.values(e).find(e=>e.callable===t&&e.delegationSelector===n)}function Sn(e,t,n){let r=typeof t==`string`,i=r?n:t||n,a=En(e);return gn.has(a)||(a=e),[r,i,a]}function Cn(e,t,n,r,i){if(typeof t!=`string`||!e)return;let[a,o,s]=Sn(t,n,r);t in hn&&(o=(e=>function(t){if(!t.relatedTarget||t.relatedTarget!==t.delegateTarget&&!t.delegateTarget.contains(t.relatedTarget))return e.call(this,t)})(o));let c=vn(e),l=c[s]||(c[s]={}),u=xn(l,o,a?n:null);if(u){u.oneOff=u.oneOff&&i;return}let d=_n(o,t.replace(un,``)),f=a?bn(e,n,o):yn(e,o);f.delegationSelector=a?n:null,f.callable=o,f.oneOff=i,f.uidEvent=d,l[d]=f,e.addEventListener(s,f,a)}function wn(e,t,n,r,i){let a=xn(t[n],r,i);a&&(e.removeEventListener(n,a,!!i),delete t[n][a.uidEvent])}function Tn(e,t,n,r){let i=t[n]||{};for(let[a,o]of Object.entries(i))a.includes(r)&&wn(e,t,n,o.callable,o.delegationSelector)}function En(e){return e=e.replace(dn,``),hn[e]||e}var M={on(e,t,n,r){Cn(e,t,n,r,!1)},one(e,t,n,r){Cn(e,t,n,r,!0)},off(e,t,n,r){if(typeof t!=`string`||!e)return;let[i,a,o]=Sn(t,n,r),s=o!==t,c=vn(e),l=c[o]||{},u=t.startsWith(`.`);if(a!==void 0){if(!Object.keys(l).length)return;wn(e,c,o,a,i?n:null);return}if(u)for(let n of Object.keys(c))Tn(e,c,n,t.slice(1));for(let[n,r]of Object.entries(l)){let i=n.replace(fn,``);(!s||t.includes(i))&&wn(e,c,o,r.callable,r.delegationSelector)}},trigger(e,t,n){if(typeof t!=`string`||!e)return null;let r=tn(),i=En(t),a=t!==i,o=null,s=!0,c=!0,l=!1;a&&r&&(o=r.Event(t,n),r(e).trigger(o),s=!o.isPropagationStopped(),c=!o.isImmediatePropagationStopped(),l=o.isDefaultPrevented());let u=Dn(new Event(t,{bubbles:s,cancelable:!0}),n);return l&&u.preventDefault(),c&&e.dispatchEvent(u),u.defaultPrevented&&o&&o.preventDefault(),u}};function Dn(e,t={}){for(let[n,r]of Object.entries(t))try{e[n]=r}catch{Object.defineProperty(e,n,{configurable:!0,get(){return r}})}return e}function On(e){if(e===`true`)return!0;if(e===`false`)return!1;if(e===Number(e).toString())return Number(e);if(e===``||e===`null`)return null;if(typeof e!=`string`)return e;try{return JSON.parse(decodeURIComponent(e))}catch{return e}}function kn(e){return e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}var An={setDataAttribute(e,t,n){e.setAttribute(`data-bs-${kn(t)}`,n)},removeDataAttribute(e,t){e.removeAttribute(`data-bs-${kn(t)}`)},getDataAttributes(e){if(!e)return{};let t={},n=Object.keys(e.dataset).filter(e=>e.startsWith(`bs`)&&!e.startsWith(`bsConfig`));for(let r of n){let n=r.replace(/^bs/,``);n=n.charAt(0).toLowerCase()+n.slice(1),t[n]=On(e.dataset[r])}return t},getDataAttribute(e,t){return On(e.getAttribute(`data-bs-${kn(t)}`))}},jn=class{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw Error(`You have to implement the static method "NAME", for each component!`)}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,t){let n=Jt(t)?An.getDataAttribute(t,`config`):{};return{...this.constructor.Default,...typeof n==`object`?n:{},...Jt(t)?An.getDataAttributes(t):{},...typeof e==`object`?e:{}}}_typeCheckConfig(e,t=this.constructor.DefaultType){for(let[n,r]of Object.entries(t)){let t=e[n],i=Jt(t)?`element`:Wt(t);if(!new RegExp(r).test(i))throw TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${n}" provided type "${i}" but expected type "${r}".`)}}},Mn=`5.3.8`,Nn=class extends jn{constructor(e,t){super(),e=Yt(e),e&&(this._element=e,this._config=this._getConfig(t),zt.set(this._element,this.constructor.DATA_KEY,this))}dispose(){zt.remove(this._element,this.constructor.DATA_KEY),M.off(this._element,this.constructor.EVENT_KEY);for(let e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,t,n=!0){cn(e,t,n)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return zt.get(Yt(e),this.DATA_KEY)}static getOrCreateInstance(e,t={}){return this.getInstance(e)||new this(e,typeof t==`object`?t:null)}static get VERSION(){return Mn}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}},Pn=e=>{let t=e.getAttribute(`data-bs-target`);if(!t||t===`#`){let n=e.getAttribute(`href`);if(!n||!n.includes(`#`)&&!n.startsWith(`.`))return null;n.includes(`#`)&&!n.startsWith(`#`)&&(n=`#${n.split(`#`)[1]}`),t=n&&n!==`#`?n.trim():null}return t?t.split(`,`).map(e=>Ut(e)).join(`,`):null},Fn={find(e,t=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(t,e))},findOne(e,t=document.documentElement){return Element.prototype.querySelector.call(t,e)},children(e,t){return[].concat(...e.children).filter(e=>e.matches(t))},parents(e,t){let n=[],r=e.parentNode.closest(t);for(;r;)n.push(r),r=r.parentNode.closest(t);return n},prev(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return[n];n=n.previousElementSibling}return[]},next(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return[n];n=n.nextElementSibling}return[]},focusableChildren(e){let t=[`a`,`button`,`input`,`textarea`,`select`,`details`,`[tabindex]`,`[contenteditable="true"]`].map(e=>`${e}:not([tabindex^="-"])`).join(`,`);return this.find(t,e).filter(e=>!Zt(e)&&Xt(e))},getSelectorFromElement(e){let t=Pn(e);return t&&Fn.findOne(t)?t:null},getElementFromSelector(e){let t=Pn(e);return t?Fn.findOne(t):null},getMultipleElementsFromSelector(e){let t=Pn(e);return t?Fn.find(t):[]}},In=(e,t=`hide`)=>{let n=`click.dismiss${e.EVENT_KEY}`,r=e.NAME;M.on(document,n,`[data-bs-dismiss="${r}"]`,function(n){if([`A`,`AREA`].includes(this.tagName)&&n.preventDefault(),Zt(this))return;let i=Fn.getElementFromSelector(this)||this.closest(`.${r}`);e.getOrCreateInstance(i)[t]()})},Ln=`alert`,Rn=`.bs.alert`,zn=`close${Rn}`,Bn=`closed${Rn}`,Vn=`fade`,Hn=`show`,Un=class e extends Nn{static get NAME(){return Ln}close(){if(M.trigger(this._element,zn).defaultPrevented)return;this._element.classList.remove(Hn);let e=this._element.classList.contains(Vn);this._queueCallback(()=>this._destroyElement(),this._element,e)}_destroyElement(){this._element.remove(),M.trigger(this._element,Bn),this.dispose()}static jQueryInterface(t){return this.each(function(){let n=e.getOrCreateInstance(this);if(typeof t==`string`){if(n[t]===void 0||t.startsWith(`_`)||t===`constructor`)throw TypeError(`No method named "${t}"`);n[t](this)}})}};In(Un,`close`),on(Un);var Wn=`button`,Gn=`.bs.button`,Kn=`.data-api`,qn=`active`,Jn=`[data-bs-toggle="button"]`,Yn=`click${Gn}${Kn}`,Xn=class e extends Nn{static get NAME(){return Wn}toggle(){this._element.setAttribute(`aria-pressed`,this._element.classList.toggle(qn))}static jQueryInterface(t){return this.each(function(){let n=e.getOrCreateInstance(this);t===`toggle`&&n[t]()})}};M.on(document,Yn,Jn,e=>{e.preventDefault();let t=e.target.closest(Jn);Xn.getOrCreateInstance(t).toggle()}),on(Xn);var Zn=`swipe`,Qn=`.bs.swipe`,$n=`touchstart${Qn}`,er=`touchmove${Qn}`,tr=`touchend${Qn}`,nr=`pointerdown${Qn}`,rr=`pointerup${Qn}`,ir=`touch`,ar=`pen`,or=`pointer-event`,sr=40,cr={endCallback:null,leftCallback:null,rightCallback:null},lr={endCallback:`(function|null)`,leftCallback:`(function|null)`,rightCallback:`(function|null)`},ur=class e extends jn{constructor(t,n){super(),this._element=t,!(!t||!e.isSupported())&&(this._config=this._getConfig(n),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return cr}static get DefaultType(){return lr}static get NAME(){return Zn}dispose(){M.off(this._element,Qn)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),sn(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){let e=Math.abs(this._deltaX);if(e<=sr)return;let t=e/this._deltaX;this._deltaX=0,t&&sn(t>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(M.on(this._element,nr,e=>this._start(e)),M.on(this._element,rr,e=>this._end(e)),this._element.classList.add(or)):(M.on(this._element,$n,e=>this._start(e)),M.on(this._element,er,e=>this._move(e)),M.on(this._element,tr,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===ar||e.pointerType===ir)}static isSupported(){return`ontouchstart`in document.documentElement||navigator.maxTouchPoints>0}},dr=`carousel`,fr=`.bs.carousel`,pr=`.data-api`,mr=`ArrowLeft`,hr=`ArrowRight`,gr=500,_r=`next`,vr=`prev`,yr=`left`,br=`right`,xr=`slide${fr}`,Sr=`slid${fr}`,Cr=`keydown${fr}`,wr=`mouseenter${fr}`,Tr=`mouseleave${fr}`,Er=`dragstart${fr}`,Dr=`load${fr}${pr}`,Or=`click${fr}${pr}`,kr=`carousel`,Ar=`active`,jr=`slide`,Mr=`carousel-item-end`,Nr=`carousel-item-start`,Pr=`carousel-item-next`,Fr=`carousel-item-prev`,Ir=`.active`,Lr=`.carousel-item`,Rr=Ir+Lr,zr=`.carousel-item img`,Br=`.carousel-indicators`,Vr=`[data-bs-slide], [data-bs-slide-to]`,Hr=`[data-bs-ride="carousel"]`,Ur={[mr]:br,[hr]:yr},Wr={interval:5e3,keyboard:!0,pause:`hover`,ride:!1,touch:!0,wrap:!0},Gr={interval:`(number|boolean)`,keyboard:`boolean`,pause:`(string|boolean)`,ride:`(boolean|string)`,touch:`boolean`,wrap:`boolean`},Kr=class e extends Nn{constructor(e,t){super(e,t),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Fn.findOne(Br,this._element),this._addEventListeners(),this._config.ride===kr&&this.cycle()}static get Default(){return Wr}static get DefaultType(){return Gr}static get NAME(){return dr}next(){this._slide(_r)}nextWhenVisible(){!document.hidden&&Xt(this._element)&&this.next()}prev(){this._slide(vr)}pause(){this._isSliding&&qt(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){M.one(this._element,Sr,()=>this.cycle());return}this.cycle()}}to(e){let t=this._getItems();if(e>t.length-1||e<0)return;if(this._isSliding){M.one(this._element,Sr,()=>this.to(e));return}let n=this._getItemIndex(this._getActive());if(n===e)return;let r=e>n?_r:vr;this._slide(r,t[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&M.on(this._element,Cr,e=>this._keydown(e)),this._config.pause===`hover`&&(M.on(this._element,wr,()=>this.pause()),M.on(this._element,Tr,()=>this._maybeEnableCycle())),this._config.touch&&ur.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(let e of Fn.find(zr,this._element))M.on(e,Er,e=>e.preventDefault());this._swipeHelper=new ur(this._element,{leftCallback:()=>this._slide(this._directionToOrder(yr)),rightCallback:()=>this._slide(this._directionToOrder(br)),endCallback:()=>{this._config.pause===`hover`&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),gr+this._config.interval))}})}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;let t=Ur[e.key];t&&(e.preventDefault(),this._slide(this._directionToOrder(t)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;let t=Fn.findOne(Ir,this._indicatorsElement);t.classList.remove(Ar),t.removeAttribute(`aria-current`);let n=Fn.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);n&&(n.classList.add(Ar),n.setAttribute(`aria-current`,`true`))}_updateInterval(){let e=this._activeElement||this._getActive();if(!e)return;let t=Number.parseInt(e.getAttribute(`data-bs-interval`),10);this._config.interval=t||this._config.defaultInterval}_slide(e,t=null){if(this._isSliding)return;let n=this._getActive(),r=e===_r,i=t||ln(this._getItems(),n,r,this._config.wrap);if(i===n)return;let a=this._getItemIndex(i),o=t=>M.trigger(this._element,t,{relatedTarget:i,direction:this._orderToDirection(e),from:this._getItemIndex(n),to:a});if(o(xr).defaultPrevented||!n||!i)return;let s=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(a),this._activeElement=i;let c=r?Nr:Mr,l=r?Pr:Fr;i.classList.add(l),en(i),n.classList.add(c),i.classList.add(c),this._queueCallback(()=>{i.classList.remove(c,l),i.classList.add(Ar),n.classList.remove(Ar,l,c),this._isSliding=!1,o(Sr)},n,this._isAnimated()),s&&this.cycle()}_isAnimated(){return this._element.classList.contains(jr)}_getActive(){return Fn.findOne(Rr,this._element)}_getItems(){return Fn.find(Lr,this._element)}_clearInterval(){this._interval&&=(clearInterval(this._interval),null)}_directionToOrder(e){return an()?e===yr?vr:_r:e===yr?_r:vr}_orderToDirection(e){return an()?e===vr?yr:br:e===vr?br:yr}static jQueryInterface(t){return this.each(function(){let n=e.getOrCreateInstance(this,t);if(typeof t==`number`){n.to(t);return}if(typeof t==`string`){if(n[t]===void 0||t.startsWith(`_`)||t===`constructor`)throw TypeError(`No method named "${t}"`);n[t]()}})}};M.on(document,Or,Vr,function(e){let t=Fn.getElementFromSelector(this);if(!t||!t.classList.contains(kr))return;e.preventDefault();let n=Kr.getOrCreateInstance(t),r=this.getAttribute(`data-bs-slide-to`);if(r){n.to(r),n._maybeEnableCycle();return}if(An.getDataAttribute(this,`slide`)===`next`){n.next(),n._maybeEnableCycle();return}n.prev(),n._maybeEnableCycle()}),M.on(window,Dr,()=>{let e=Fn.find(Hr);for(let t of e)Kr.getOrCreateInstance(t)}),on(Kr);var qr=`collapse`,Jr=`.bs.collapse`,Yr=`.data-api`,Xr=`show${Jr}`,Zr=`shown${Jr}`,Qr=`hide${Jr}`,$r=`hidden${Jr}`,ei=`click${Jr}${Yr}`,ti=`show`,ni=`collapse`,ri=`collapsing`,ii=`collapsed`,ai=`:scope .${ni} .${ni}`,oi=`collapse-horizontal`,si=`width`,ci=`height`,li=`.collapse.show, .collapse.collapsing`,ui=`[data-bs-toggle="collapse"]`,di={parent:null,toggle:!0},fi={parent:`(null|element)`,toggle:`boolean`},pi=class e extends Nn{constructor(e,t){super(e,t),this._isTransitioning=!1,this._triggerArray=[];let n=Fn.find(ui);for(let e of n){let t=Fn.getSelectorFromElement(e),n=Fn.find(t).filter(e=>e===this._element);t!==null&&n.length&&this._triggerArray.push(e)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return di}static get DefaultType(){return fi}static get NAME(){return qr}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let t=[];if(this._config.parent&&(t=this._getFirstLevelChildren(li).filter(e=>e!==this._element).map(t=>e.getOrCreateInstance(t,{toggle:!1}))),t.length&&t[0]._isTransitioning||M.trigger(this._element,Xr).defaultPrevented)return;for(let e of t)e.hide();let n=this._getDimension();this._element.classList.remove(ni),this._element.classList.add(ri),this._element.style[n]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;let r=()=>{this._isTransitioning=!1,this._element.classList.remove(ri),this._element.classList.add(ni,ti),this._element.style[n]=``,M.trigger(this._element,Zr)},i=`scroll${n[0].toUpperCase()+n.slice(1)}`;this._queueCallback(r,this._element,!0),this._element.style[n]=`${this._element[i]}px`}hide(){if(this._isTransitioning||!this._isShown()||M.trigger(this._element,Qr).defaultPrevented)return;let e=this._getDimension();this._element.style[e]=`${this._element.getBoundingClientRect()[e]}px`,en(this._element),this._element.classList.add(ri),this._element.classList.remove(ni,ti);for(let e of this._triggerArray){let t=Fn.getElementFromSelector(e);t&&!this._isShown(t)&&this._addAriaAndCollapsedClass([e],!1)}this._isTransitioning=!0;let t=()=>{this._isTransitioning=!1,this._element.classList.remove(ri),this._element.classList.add(ni),M.trigger(this._element,$r)};this._element.style[e]=``,this._queueCallback(t,this._element,!0)}_isShown(e=this._element){return e.classList.contains(ti)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Yt(e.parent),e}_getDimension(){return this._element.classList.contains(oi)?si:ci}_initializeChildren(){if(!this._config.parent)return;let e=this._getFirstLevelChildren(ui);for(let t of e){let e=Fn.getElementFromSelector(t);e&&this._addAriaAndCollapsedClass([t],this._isShown(e))}}_getFirstLevelChildren(e){let t=Fn.find(ai,this._config.parent);return Fn.find(e,this._config.parent).filter(e=>!t.includes(e))}_addAriaAndCollapsedClass(e,t){if(e.length)for(let n of e)n.classList.toggle(ii,!t),n.setAttribute(`aria-expanded`,t)}static jQueryInterface(t){let n={};return typeof t==`string`&&/show|hide/.test(t)&&(n.toggle=!1),this.each(function(){let r=e.getOrCreateInstance(this,n);if(typeof t==`string`){if(r[t]===void 0)throw TypeError(`No method named "${t}"`);r[t]()}})}};M.on(document,ei,ui,function(e){(e.target.tagName===`A`||e.delegateTarget&&e.delegateTarget.tagName===`A`)&&e.preventDefault();for(let e of Fn.getMultipleElementsFromSelector(this))pi.getOrCreateInstance(e,{toggle:!1}).toggle()}),on(pi);var mi=`dropdown`,hi=`.bs.dropdown`,gi=`.data-api`,_i=`Escape`,vi=`Tab`,yi=`ArrowUp`,bi=`ArrowDown`,xi=2,Si=`hide${hi}`,Ci=`hidden${hi}`,wi=`show${hi}`,Ti=`shown${hi}`,Ei=`click${hi}${gi}`,Di=`keydown${hi}${gi}`,Oi=`keyup${hi}${gi}`,ki=`show`,Ai=`dropup`,ji=`dropend`,Mi=`dropstart`,Ni=`dropup-center`,Pi=`dropdown-center`,Fi=`[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)`,Ii=`${Fi}.${ki}`,Li=`.dropdown-menu`,Ri=`.navbar`,zi=`.navbar-nav`,Bi=`.dropdown-menu .dropdown-item:not(.disabled):not(:disabled)`,Vi=an()?`top-end`:`top-start`,Hi=an()?`top-start`:`top-end`,Ui=an()?`bottom-end`:`bottom-start`,Wi=an()?`bottom-start`:`bottom-end`,Gi=an()?`left-start`:`right-start`,Ki=an()?`right-start`:`left-start`,qi=`top`,Ji=`bottom`,Yi={autoClose:!0,boundary:`clippingParents`,display:`dynamic`,offset:[0,2],popperConfig:null,reference:`toggle`},Xi={autoClose:`(boolean|string)`,boundary:`(string|element)`,display:`string`,offset:`(array|string|function)`,popperConfig:`(null|object|function)`,reference:`(string|element|object)`},Zi=class e extends Nn{constructor(e,t){super(e,t),this._popper=null,this._parent=this._element.parentNode,this._menu=Fn.next(this._element,Li)[0]||Fn.prev(this._element,Li)[0]||Fn.findOne(Li,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Yi}static get DefaultType(){return Xi}static get NAME(){return mi}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Zt(this._element)||this._isShown())return;let e={relatedTarget:this._element};if(!M.trigger(this._element,wi,e).defaultPrevented){if(this._createPopper(),`ontouchstart`in document.documentElement&&!this._parent.closest(zi))for(let e of[].concat(...document.body.children))M.on(e,`mouseover`,$t);this._element.focus(),this._element.setAttribute(`aria-expanded`,!0),this._menu.classList.add(ki),this._element.classList.add(ki),M.trigger(this._element,Ti,e)}}hide(){if(Zt(this._element)||!this._isShown())return;let e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!M.trigger(this._element,Si,e).defaultPrevented){if(`ontouchstart`in document.documentElement)for(let e of[].concat(...document.body.children))M.off(e,`mouseover`,$t);this._popper&&this._popper.destroy(),this._menu.classList.remove(ki),this._element.classList.remove(ki),this._element.setAttribute(`aria-expanded`,`false`),An.removeDataAttribute(this._menu,`popper`),M.trigger(this._element,Ci,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference==`object`&&!Jt(e.reference)&&typeof e.reference.getBoundingClientRect!=`function`)throw TypeError(`${mi.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(Lt===void 0)throw TypeError(`Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)`);let e=this._element;this._config.reference===`parent`?e=this._parent:Jt(this._config.reference)?e=Yt(this._config.reference):typeof this._config.reference==`object`&&(e=this._config.reference);let t=this._getPopperConfig();this._popper=It(e,this._menu,t)}_isShown(){return this._menu.classList.contains(ki)}_getPlacement(){let e=this._parent;if(e.classList.contains(ji))return Gi;if(e.classList.contains(Mi))return Ki;if(e.classList.contains(Ni))return qi;if(e.classList.contains(Pi))return Ji;let t=getComputedStyle(this._menu).getPropertyValue(`--bs-position`).trim()===`end`;return e.classList.contains(Ai)?t?Hi:Vi:t?Wi:Ui}_detectNavbar(){return this._element.closest(Ri)!==null}_getOffset(){let{offset:e}=this._config;return typeof e==`string`?e.split(`,`).map(e=>Number.parseInt(e,10)):typeof e==`function`?t=>e(t,this._element):e}_getPopperConfig(){let e={placement:this._getPlacement(),modifiers:[{name:`preventOverflow`,options:{boundary:this._config.boundary}},{name:`offset`,options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display===`static`)&&(An.setDataAttribute(this._menu,`popper`,`static`),e.modifiers=[{name:`applyStyles`,enabled:!1}]),{...e,...sn(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:t}){let n=Fn.find(Bi,this._menu).filter(e=>Xt(e));n.length&&ln(n,t,e===bi,!n.includes(t)).focus()}static jQueryInterface(t){return this.each(function(){let n=e.getOrCreateInstance(this,t);if(typeof t==`string`){if(n[t]===void 0)throw TypeError(`No method named "${t}"`);n[t]()}})}static clearMenus(t){if(t.button===xi||t.type===`keyup`&&t.key!==vi)return;let n=Fn.find(Ii);for(let r of n){let n=e.getInstance(r);if(!n||n._config.autoClose===!1)continue;let i=t.composedPath(),a=i.includes(n._menu);if(i.includes(n._element)||n._config.autoClose===`inside`&&!a||n._config.autoClose===`outside`&&a||n._menu.contains(t.target)&&(t.type===`keyup`&&t.key===vi||/input|select|option|textarea|form/i.test(t.target.tagName)))continue;let o={relatedTarget:n._element};t.type===`click`&&(o.clickEvent=t),n._completeHide(o)}}static dataApiKeydownHandler(t){let n=/input|textarea/i.test(t.target.tagName),r=t.key===_i,i=[yi,bi].includes(t.key);if(!i&&!r||n&&!r)return;t.preventDefault();let a=this.matches(Fi)?this:Fn.prev(this,Fi)[0]||Fn.next(this,Fi)[0]||Fn.findOne(Fi,t.delegateTarget.parentNode),o=e.getOrCreateInstance(a);if(i){t.stopPropagation(),o.show(),o._selectMenuItem(t);return}o._isShown()&&(t.stopPropagation(),o.hide(),a.focus())}};M.on(document,Di,Fi,Zi.dataApiKeydownHandler),M.on(document,Di,Li,Zi.dataApiKeydownHandler),M.on(document,Ei,Zi.clearMenus),M.on(document,Oi,Zi.clearMenus),M.on(document,Ei,Fi,function(e){e.preventDefault(),Zi.getOrCreateInstance(this).toggle()}),on(Zi);var Qi=`backdrop`,$i=`fade`,ea=`show`,ta=`mousedown.bs.${Qi}`,na={className:`modal-backdrop`,clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:`body`},ra={className:`string`,clickCallback:`(function|null)`,isAnimated:`boolean`,isVisible:`boolean`,rootElement:`(element|string)`},ia=class extends jn{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return na}static get DefaultType(){return ra}static get NAME(){return Qi}show(e){if(!this._config.isVisible){sn(e);return}this._append();let t=this._getElement();this._config.isAnimated&&en(t),t.classList.add(ea),this._emulateAnimation(()=>{sn(e)})}hide(e){if(!this._config.isVisible){sn(e);return}this._getElement().classList.remove(ea),this._emulateAnimation(()=>{this.dispose(),sn(e)})}dispose(){this._isAppended&&=(M.off(this._element,ta),this._element.remove(),!1)}_getElement(){if(!this._element){let e=document.createElement(`div`);e.className=this._config.className,this._config.isAnimated&&e.classList.add($i),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Yt(e.rootElement),e}_append(){if(this._isAppended)return;let e=this._getElement();this._config.rootElement.append(e),M.on(e,ta,()=>{sn(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){cn(e,this._getElement(),this._config.isAnimated)}},aa=`focustrap`,oa=`.bs.focustrap`,sa=`focusin${oa}`,ca=`keydown.tab${oa}`,la=`Tab`,ua=`forward`,da=`backward`,fa={autofocus:!0,trapElement:null},pa={autofocus:`boolean`,trapElement:`element`},ma=class extends jn{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return fa}static get DefaultType(){return pa}static get NAME(){return aa}activate(){this._isActive||=(this._config.autofocus&&this._config.trapElement.focus(),M.off(document,oa),M.on(document,sa,e=>this._handleFocusin(e)),M.on(document,ca,e=>this._handleKeydown(e)),!0)}deactivate(){this._isActive&&(this._isActive=!1,M.off(document,oa))}_handleFocusin(e){let{trapElement:t}=this._config;if(e.target===document||e.target===t||t.contains(e.target))return;let n=Fn.focusableChildren(t);n.length===0?t.focus():this._lastTabNavDirection===da?n[n.length-1].focus():n[0].focus()}_handleKeydown(e){e.key===la&&(this._lastTabNavDirection=e.shiftKey?da:ua)}},ha=`.fixed-top, .fixed-bottom, .is-fixed, .sticky-top`,ga=`.sticky-top`,_a=`padding-right`,va=`margin-right`,ya=class{constructor(){this._element=document.body}getWidth(){let e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){let e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,_a,t=>t+e),this._setElementAttributes(ha,_a,t=>t+e),this._setElementAttributes(ga,va,t=>t-e)}reset(){this._resetElementAttributes(this._element,`overflow`),this._resetElementAttributes(this._element,_a),this._resetElementAttributes(ha,_a),this._resetElementAttributes(ga,va)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,`overflow`),this._element.style.overflow=`hidden`}_setElementAttributes(e,t,n){let r=this.getWidth();this._applyManipulationCallback(e,e=>{if(e!==this._element&&window.innerWidth>e.clientWidth+r)return;this._saveInitialAttribute(e,t);let i=window.getComputedStyle(e).getPropertyValue(t);e.style.setProperty(t,`${n(Number.parseFloat(i))}px`)})}_saveInitialAttribute(e,t){let n=e.style.getPropertyValue(t);n&&An.setDataAttribute(e,t,n)}_resetElementAttributes(e,t){this._applyManipulationCallback(e,e=>{let n=An.getDataAttribute(e,t);if(n===null){e.style.removeProperty(t);return}An.removeDataAttribute(e,t),e.style.setProperty(t,n)})}_applyManipulationCallback(e,t){if(Jt(e)){t(e);return}for(let n of Fn.find(e,this._element))t(n)}},ba=`modal`,xa=`.bs.modal`,Sa=`.data-api`,Ca=`Escape`,wa=`hide${xa}`,Ta=`hidePrevented${xa}`,Ea=`hidden${xa}`,Da=`show${xa}`,Oa=`shown${xa}`,ka=`resize${xa}`,Aa=`click.dismiss${xa}`,ja=`mousedown.dismiss${xa}`,Ma=`keydown.dismiss${xa}`,Na=`click${xa}${Sa}`,Pa=`modal-open`,Fa=`fade`,Ia=`show`,La=`modal-static`,Ra=`.modal.show`,za=`.modal-dialog`,Ba=`.modal-body`,Va=`[data-bs-toggle="modal"]`,Ha={backdrop:!0,focus:!0,keyboard:!0},Ua={backdrop:`(boolean|string)`,focus:`boolean`,keyboard:`boolean`},Wa=class e extends Nn{constructor(e,t){super(e,t),this._dialog=Fn.findOne(za,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new ya,this._addEventListeners()}static get Default(){return Ha}static get DefaultType(){return Ua}static get NAME(){return ba}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||M.trigger(this._element,Da,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Pa),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||M.trigger(this._element,wa).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(Ia),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){M.off(window,xa),M.off(this._dialog,xa),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new ia({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new ma({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display=`block`,this._element.removeAttribute(`aria-hidden`),this._element.setAttribute(`aria-modal`,!0),this._element.setAttribute(`role`,`dialog`),this._element.scrollTop=0;let t=Fn.findOne(Ba,this._dialog);t&&(t.scrollTop=0),en(this._element),this._element.classList.add(Ia),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,M.trigger(this._element,Oa,{relatedTarget:e})},this._dialog,this._isAnimated())}_addEventListeners(){M.on(this._element,Ma,e=>{if(e.key===Ca){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),M.on(window,ka,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),M.on(this._element,ja,e=>{M.one(this._element,Aa,t=>{if(!(this._element!==e.target||this._element!==t.target)){if(this._config.backdrop===`static`){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display=`none`,this._element.setAttribute(`aria-hidden`,!0),this._element.removeAttribute(`aria-modal`),this._element.removeAttribute(`role`),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Pa),this._resetAdjustments(),this._scrollBar.reset(),M.trigger(this._element,Ea)})}_isAnimated(){return this._element.classList.contains(Fa)}_triggerBackdropTransition(){if(M.trigger(this._element,Ta).defaultPrevented)return;let e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._element.style.overflowY;t===`hidden`||this._element.classList.contains(La)||(e||(this._element.style.overflowY=`hidden`),this._element.classList.add(La),this._queueCallback(()=>{this._element.classList.remove(La),this._queueCallback(()=>{this._element.style.overflowY=t},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){let e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),n=t>0;if(n&&!e){let e=an()?`paddingLeft`:`paddingRight`;this._element.style[e]=`${t}px`}if(!n&&e){let e=an()?`paddingRight`:`paddingLeft`;this._element.style[e]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft=``,this._element.style.paddingRight=``}static jQueryInterface(t,n){return this.each(function(){let r=e.getOrCreateInstance(this,t);if(typeof t==`string`){if(r[t]===void 0)throw TypeError(`No method named "${t}"`);r[t](n)}})}};M.on(document,Na,Va,function(e){let t=Fn.getElementFromSelector(this);[`A`,`AREA`].includes(this.tagName)&&e.preventDefault(),M.one(t,Da,e=>{e.defaultPrevented||M.one(t,Ea,()=>{Xt(this)&&this.focus()})});let n=Fn.findOne(Ra);n&&Wa.getInstance(n).hide(),Wa.getOrCreateInstance(t).toggle(this)}),In(Wa),on(Wa);var Ga=`offcanvas`,Ka=`.bs.offcanvas`,qa=`.data-api`,Ja=`load${Ka}${qa}`,Ya=`Escape`,Xa=`show`,Za=`showing`,Qa=`hiding`,$a=`offcanvas-backdrop`,eo=`.offcanvas.show`,to=`show${Ka}`,no=`shown${Ka}`,ro=`hide${Ka}`,io=`hidePrevented${Ka}`,ao=`hidden${Ka}`,oo=`resize${Ka}`,so=`click${Ka}${qa}`,co=`keydown.dismiss${Ka}`,lo=`[data-bs-toggle="offcanvas"]`,uo={backdrop:!0,keyboard:!0,scroll:!1},fo={backdrop:`(boolean|string)`,keyboard:`boolean`,scroll:`boolean`},po=class e extends Nn{constructor(e,t){super(e,t),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return uo}static get DefaultType(){return fo}static get NAME(){return Ga}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||M.trigger(this._element,to,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||new ya().hide(),this._element.setAttribute(`aria-modal`,!0),this._element.setAttribute(`role`,`dialog`),this._element.classList.add(Za),this._queueCallback(()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(Xa),this._element.classList.remove(Za),M.trigger(this._element,no,{relatedTarget:e})},this._element,!0))}hide(){!this._isShown||M.trigger(this._element,ro).defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(Qa),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(Xa,Qa),this._element.removeAttribute(`aria-modal`),this._element.removeAttribute(`role`),this._config.scroll||new ya().reset(),M.trigger(this._element,ao)},this._element,!0))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){let e=()=>{if(this._config.backdrop===`static`){M.trigger(this._element,io);return}this.hide()},t=!!this._config.backdrop;return new ia({className:$a,isVisible:t,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:t?e:null})}_initializeFocusTrap(){return new ma({trapElement:this._element})}_addEventListeners(){M.on(this._element,co,e=>{if(e.key===Ya){if(this._config.keyboard){this.hide();return}M.trigger(this._element,io)}})}static jQueryInterface(t){return this.each(function(){let n=e.getOrCreateInstance(this,t);if(typeof t==`string`){if(n[t]===void 0||t.startsWith(`_`)||t===`constructor`)throw TypeError(`No method named "${t}"`);n[t](this)}})}};M.on(document,so,lo,function(e){let t=Fn.getElementFromSelector(this);if([`A`,`AREA`].includes(this.tagName)&&e.preventDefault(),Zt(this))return;M.one(t,ao,()=>{Xt(this)&&this.focus()});let n=Fn.findOne(eo);n&&n!==t&&po.getInstance(n).hide(),po.getOrCreateInstance(t).toggle(this)}),M.on(window,Ja,()=>{for(let e of Fn.find(eo))po.getOrCreateInstance(e).show()}),M.on(window,oo,()=>{for(let e of Fn.find(`[aria-modal][class*=show][class*=offcanvas-]`))getComputedStyle(e).position!==`fixed`&&po.getOrCreateInstance(e).hide()}),In(po),on(po);var mo=/^aria-[\w-]*$/i,ho={"*":[`class`,`dir`,`id`,`lang`,`role`,mo],a:[`target`,`href`,`title`,`rel`],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:[`src`,`srcset`,`alt`,`title`,`width`,`height`],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},go=new Set([`background`,`cite`,`href`,`itemtype`,`longdesc`,`poster`,`src`,`xlink:href`]),_o=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,vo=(e,t)=>{let n=e.nodeName.toLowerCase();return t.includes(n)?go.has(n)?!!_o.test(e.nodeValue):!0:t.filter(e=>e instanceof RegExp).some(e=>e.test(n))};function yo(e,t,n){if(!e.length)return e;if(n&&typeof n==`function`)return n(e);let r=new window.DOMParser().parseFromString(e,`text/html`),i=[].concat(...r.body.querySelectorAll(`*`));for(let e of i){let n=e.nodeName.toLowerCase();if(!Object.keys(t).includes(n)){e.remove();continue}let r=[].concat(...e.attributes),i=[].concat(t[`*`]||[],t[n]||[]);for(let t of r)vo(t,i)||e.removeAttribute(t.nodeName)}return r.body.innerHTML}var bo=`TemplateFactory`,xo={allowList:ho,content:{},extraClass:``,html:!1,sanitize:!0,sanitizeFn:null,template:`<div></div>`},So={allowList:`object`,content:`object`,extraClass:`(string|function)`,html:`boolean`,sanitize:`boolean`,sanitizeFn:`(null|function)`,template:`string`},Co={entry:`(string|element|function|null)`,selector:`(string|element)`},wo=class extends jn{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return xo}static get DefaultType(){return So}static get NAME(){return bo}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){let e=document.createElement(`div`);e.innerHTML=this._maybeSanitize(this._config.template);for(let[t,n]of Object.entries(this._config.content))this._setContent(e,n,t);let t=e.children[0],n=this._resolvePossibleFunction(this._config.extraClass);return n&&t.classList.add(...n.split(` `)),t}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(let[t,n]of Object.entries(e))super._typeCheckConfig({selector:t,entry:n},Co)}_setContent(e,t,n){let r=Fn.findOne(n,e);if(r){if(t=this._resolvePossibleFunction(t),!t){r.remove();return}if(Jt(t)){this._putElementInTemplate(Yt(t),r);return}if(this._config.html){r.innerHTML=this._maybeSanitize(t);return}r.textContent=t}}_maybeSanitize(e){return this._config.sanitize?yo(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return sn(e,[void 0,this])}_putElementInTemplate(e,t){if(this._config.html){t.innerHTML=``,t.append(e);return}t.textContent=e.textContent}},To=`tooltip`,Eo=new Set([`sanitize`,`allowList`,`sanitizeFn`]),Do=`fade`,Oo=`modal`,ko=`show`,Ao=`.tooltip-inner`,jo=`.${Oo}`,Mo=`hide.bs.modal`,No=`hover`,Po=`focus`,Fo=`click`,Io=`manual`,Lo=`hide`,Ro=`hidden`,zo=`show`,Bo=`shown`,Vo=`inserted`,Ho=`click`,Uo=`focusin`,Wo=`focusout`,Go=`mouseenter`,Ko=`mouseleave`,qo={AUTO:`auto`,TOP:`top`,RIGHT:an()?`left`:`right`,BOTTOM:`bottom`,LEFT:an()?`right`:`left`},Jo={allowList:ho,animation:!0,boundary:`clippingParents`,container:!1,customClass:``,delay:0,fallbackPlacements:[`top`,`right`,`bottom`,`left`],html:!1,offset:[0,6],placement:`top`,popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:`<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>`,title:``,trigger:`hover focus`},Yo={allowList:`object`,animation:`boolean`,boundary:`(string|element)`,container:`(string|element|boolean)`,customClass:`(string|function)`,delay:`(number|object)`,fallbackPlacements:`array`,html:`boolean`,offset:`(array|string|function)`,placement:`(string|function)`,popperConfig:`(null|object|function)`,sanitize:`boolean`,sanitizeFn:`(null|function)`,selector:`(string|boolean)`,template:`string`,title:`(string|element|function)`,trigger:`string`},Xo=class e extends Nn{constructor(e,t){if(Lt===void 0)throw TypeError(`Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)`);super(e,t),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Jo}static get DefaultType(){return Yo}static get NAME(){return To}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),M.off(this._element.closest(jo),Mo,this._hideModalHandler),this._element.getAttribute(`data-bs-original-title`)&&this._element.setAttribute(`title`,this._element.getAttribute(`data-bs-original-title`)),this._disposePopper(),super.dispose()}show(){if(this._element.style.display===`none`)throw Error(`Please use show on visible elements`);if(!(this._isWithContent()&&this._isEnabled))return;let e=M.trigger(this._element,this.constructor.eventName(zo)),t=(Qt(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!t)return;this._disposePopper();let n=this._getTipElement();this._element.setAttribute(`aria-describedby`,n.getAttribute(`id`));let{container:r}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(r.append(n),M.trigger(this._element,this.constructor.eventName(Vo))),this._popper=this._createPopper(n),n.classList.add(ko),`ontouchstart`in document.documentElement)for(let e of[].concat(...document.body.children))M.on(e,`mouseover`,$t);this._queueCallback(()=>{M.trigger(this._element,this.constructor.eventName(Bo)),this._isHovered===!1&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(!(!this._isShown()||M.trigger(this._element,this.constructor.eventName(Lo)).defaultPrevented)){if(this._getTipElement().classList.remove(ko),`ontouchstart`in document.documentElement)for(let e of[].concat(...document.body.children))M.off(e,`mouseover`,$t);this._activeTrigger[Fo]=!1,this._activeTrigger[Po]=!1,this._activeTrigger[No]=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute(`aria-describedby`),M.trigger(this._element,this.constructor.eventName(Ro)))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||=this._createTipElement(this._newContent||this._getContentForTemplate()),this.tip}_createTipElement(e){let t=this._getTemplateFactory(e).toHtml();if(!t)return null;t.classList.remove(Do,ko),t.classList.add(`bs-${this.constructor.NAME}-auto`);let n=Gt(this.constructor.NAME).toString();return t.setAttribute(`id`,n),this._isAnimated()&&t.classList.add(Do),t}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new wo({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[Ao]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute(`data-bs-original-title`)}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(Do)}_isShown(){return this.tip&&this.tip.classList.contains(ko)}_createPopper(e){let t=sn(this._config.placement,[this,e,this._element]),n=qo[t.toUpperCase()];return It(this._element,e,this._getPopperConfig(n))}_getOffset(){let{offset:e}=this._config;return typeof e==`string`?e.split(`,`).map(e=>Number.parseInt(e,10)):typeof e==`function`?t=>e(t,this._element):e}_resolvePossibleFunction(e){return sn(e,[this._element,this._element])}_getPopperConfig(e){let t={placement:e,modifiers:[{name:`flip`,options:{fallbackPlacements:this._config.fallbackPlacements}},{name:`offset`,options:{offset:this._getOffset()}},{name:`preventOverflow`,options:{boundary:this._config.boundary}},{name:`arrow`,options:{element:`.${this.constructor.NAME}-arrow`}},{name:`preSetPlacement`,enabled:!0,phase:`beforeMain`,fn:e=>{this._getTipElement().setAttribute(`data-popper-placement`,e.state.placement)}}]};return{...t,...sn(this._config.popperConfig,[void 0,t])}}_setListeners(){let e=this._config.trigger.split(` `);for(let t of e)if(t===`click`)M.on(this._element,this.constructor.eventName(Ho),this._config.selector,e=>{let t=this._initializeOnDelegatedTarget(e);t._activeTrigger[Fo]=!(t._isShown()&&t._activeTrigger[Fo]),t.toggle()});else if(t!==Io){let e=t===No?this.constructor.eventName(Go):this.constructor.eventName(Uo),n=t===No?this.constructor.eventName(Ko):this.constructor.eventName(Wo);M.on(this._element,e,this._config.selector,e=>{let t=this._initializeOnDelegatedTarget(e);t._activeTrigger[e.type===`focusin`?Po:No]=!0,t._enter()}),M.on(this._element,n,this._config.selector,e=>{let t=this._initializeOnDelegatedTarget(e);t._activeTrigger[e.type===`focusout`?Po:No]=t._element.contains(e.relatedTarget),t._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},M.on(this._element.closest(jo),Mo,this._hideModalHandler)}_fixTitle(){let e=this._element.getAttribute(`title`);e&&(!this._element.getAttribute(`aria-label`)&&!this._element.textContent.trim()&&this._element.setAttribute(`aria-label`,e),this._element.setAttribute(`data-bs-original-title`,e),this._element.removeAttribute(`title`))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,t){clearTimeout(this._timeout),this._timeout=setTimeout(e,t)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){let t=An.getDataAttributes(this._element);for(let e of Object.keys(t))Eo.has(e)&&delete t[e];return e={...t,...typeof e==`object`&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Yt(e.container),typeof e.delay==`number`&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title==`number`&&(e.title=e.title.toString()),typeof e.content==`number`&&(e.content=e.content.toString()),e}_getDelegateConfig(){let e={};for(let[t,n]of Object.entries(this._config))this.constructor.Default[t]!==n&&(e[t]=n);return e.selector=!1,e.trigger=`manual`,e}_disposePopper(){this._popper&&=(this._popper.destroy(),null),this.tip&&=(this.tip.remove(),null)}static jQueryInterface(t){return this.each(function(){let n=e.getOrCreateInstance(this,t);if(typeof t==`string`){if(n[t]===void 0)throw TypeError(`No method named "${t}"`);n[t]()}})}};on(Xo);var Zo=`popover`,Qo=`.popover-header`,$o=`.popover-body`,es={...Xo.Default,content:``,offset:[0,8],placement:`right`,template:`<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>`,trigger:`click`},ts={...Xo.DefaultType,content:`(null|string|element|function)`};on(class e extends Xo{static get Default(){return es}static get DefaultType(){return ts}static get NAME(){return Zo}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Qo]:this._getTitle(),[$o]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(t){return this.each(function(){let n=e.getOrCreateInstance(this,t);if(typeof t==`string`){if(n[t]===void 0)throw TypeError(`No method named "${t}"`);n[t]()}})}});var ns=`scrollspy`,rs=`.bs.scrollspy`,os=`.data-api`,ss=`activate${rs}`,cs=`click${rs}`,ls=`load${rs}${os}`,us=`dropdown-item`,ds=`active`,fs=`[data-bs-spy="scroll"]`,ps=`[href]`,ms=`.nav, .list-group`,hs=`.nav-link`,gs=`${hs}, .nav-item > ${hs}, .list-group-item`,_s=`.dropdown`,vs=`.dropdown-toggle`,ys={offset:null,rootMargin:`0px 0px -25%`,smoothScroll:!1,target:null,threshold:[.1,.5,1]},bs={offset:`(number|null)`,rootMargin:`string`,smoothScroll:`boolean`,target:`element`,threshold:`array`},xs=class e extends Nn{constructor(e,t){super(e,t),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY===`visible`?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return ys}static get DefaultType(){return bs}static get NAME(){return ns}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(let e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Yt(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold==`string`&&(e.threshold=e.threshold.split(`,`).map(e=>Number.parseFloat(e))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(M.off(this._config.target,cs),M.on(this._config.target,cs,ps,e=>{let t=this._observableSections.get(e.target.hash);if(t){e.preventDefault();let n=this._rootElement||window,r=t.offsetTop-this._element.offsetTop;if(n.scrollTo){n.scrollTo({top:r,behavior:`smooth`});return}n.scrollTop=r}}))}_getNewObserver(){let e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(e=>this._observerCallback(e),e)}_observerCallback(e){let t=e=>this._targetLinks.get(`#${e.target.id}`),n=e=>{this._previousScrollData.visibleEntryTop=e.target.offsetTop,this._process(t(e))},r=(this._rootElement||document.documentElement).scrollTop,i=r>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=r;for(let a of e){if(!a.isIntersecting){this._activeTarget=null,this._clearActiveClass(t(a));continue}let e=a.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(i&&e){if(n(a),!r)return;continue}!i&&!e&&n(a)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;let e=Fn.find(ps,this._config.target);for(let t of e){if(!t.hash||Zt(t))continue;let e=Fn.findOne(decodeURI(t.hash),this._element);Xt(e)&&(this._targetLinks.set(decodeURI(t.hash),t),this._observableSections.set(t.hash,e))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(ds),this._activateParents(e),M.trigger(this._element,ss,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(us)){Fn.findOne(vs,e.closest(_s)).classList.add(ds);return}for(let t of Fn.parents(e,ms))for(let e of Fn.prev(t,gs))e.classList.add(ds)}_clearActiveClass(e){e.classList.remove(ds);let t=Fn.find(`${ps}.${ds}`,e);for(let e of t)e.classList.remove(ds)}static jQueryInterface(t){return this.each(function(){let n=e.getOrCreateInstance(this,t);if(typeof t==`string`){if(n[t]===void 0||t.startsWith(`_`)||t===`constructor`)throw TypeError(`No method named "${t}"`);n[t]()}})}};M.on(window,ls,()=>{for(let e of Fn.find(fs))xs.getOrCreateInstance(e)}),on(xs);var Ss=`tab`,Cs=`.bs.tab`,ws=`hide${Cs}`,Ts=`hidden${Cs}`,Es=`show${Cs}`,Ds=`shown${Cs}`,Os=`click${Cs}`,ks=`keydown${Cs}`,As=`load${Cs}`,js=`ArrowLeft`,Ms=`ArrowRight`,Ns=`ArrowUp`,Ps=`ArrowDown`,Fs=`Home`,Is=`End`,Ls=`active`,Rs=`fade`,zs=`show`,Bs=`dropdown`,Vs=`.dropdown-toggle`,Hs=`.dropdown-menu`,Us=`:not(${Vs})`,Ws=`.list-group, .nav, [role="tablist"]`,Gs=`.nav-item, .list-group-item`,Ks=`.nav-link${Us}, .list-group-item${Us}, [role="tab"]${Us}`,qs=`[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]`,Js=`${Ks}, ${qs}`,Ys=`.${Ls}[data-bs-toggle="tab"], .${Ls}[data-bs-toggle="pill"], .${Ls}[data-bs-toggle="list"]`,Xs=class e extends Nn{constructor(e){super(e),this._parent=this._element.closest(Ws),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),M.on(this._element,ks,e=>this._keydown(e)))}static get NAME(){return Ss}show(){let e=this._element;if(this._elemIsActive(e))return;let t=this._getActiveElem(),n=t?M.trigger(t,ws,{relatedTarget:e}):null;M.trigger(e,Es,{relatedTarget:t}).defaultPrevented||n&&n.defaultPrevented||(this._deactivate(t,e),this._activate(e,t))}_activate(e,t){e&&(e.classList.add(Ls),this._activate(Fn.getElementFromSelector(e)),this._queueCallback(()=>{if(e.getAttribute(`role`)!==`tab`){e.classList.add(zs);return}e.removeAttribute(`tabindex`),e.setAttribute(`aria-selected`,!0),this._toggleDropDown(e,!0),M.trigger(e,Ds,{relatedTarget:t})},e,e.classList.contains(Rs)))}_deactivate(e,t){e&&(e.classList.remove(Ls),e.blur(),this._deactivate(Fn.getElementFromSelector(e)),this._queueCallback(()=>{if(e.getAttribute(`role`)!==`tab`){e.classList.remove(zs);return}e.setAttribute(`aria-selected`,!1),e.setAttribute(`tabindex`,`-1`),this._toggleDropDown(e,!1),M.trigger(e,Ts,{relatedTarget:t})},e,e.classList.contains(Rs)))}_keydown(t){if(![js,Ms,Ns,Ps,Fs,Is].includes(t.key))return;t.stopPropagation(),t.preventDefault();let n=this._getChildren().filter(e=>!Zt(e)),r;if([Fs,Is].includes(t.key))r=n[t.key===Fs?0:n.length-1];else{let e=[Ms,Ps].includes(t.key);r=ln(n,t.target,e,!0)}r&&(r.focus({preventScroll:!0}),e.getOrCreateInstance(r).show())}_getChildren(){return Fn.find(Js,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,t){this._setAttributeIfNotExists(e,`role`,`tablist`);for(let e of t)this._setInitialAttributesOnChild(e)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);let t=this._elemIsActive(e),n=this._getOuterElement(e);e.setAttribute(`aria-selected`,t),n!==e&&this._setAttributeIfNotExists(n,`role`,`presentation`),t||e.setAttribute(`tabindex`,`-1`),this._setAttributeIfNotExists(e,`role`,`tab`),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){let t=Fn.getElementFromSelector(e);t&&(this._setAttributeIfNotExists(t,`role`,`tabpanel`),e.id&&this._setAttributeIfNotExists(t,`aria-labelledby`,`${e.id}`))}_toggleDropDown(e,t){let n=this._getOuterElement(e);if(!n.classList.contains(Bs))return;let r=(e,r)=>{let i=Fn.findOne(e,n);i&&i.classList.toggle(r,t)};r(Vs,Ls),r(Hs,zs),n.setAttribute(`aria-expanded`,t)}_setAttributeIfNotExists(e,t,n){e.hasAttribute(t)||e.setAttribute(t,n)}_elemIsActive(e){return e.classList.contains(Ls)}_getInnerElement(e){return e.matches(Js)?e:Fn.findOne(Js,e)}_getOuterElement(e){return e.closest(Gs)||e}static jQueryInterface(t){return this.each(function(){let n=e.getOrCreateInstance(this);if(typeof t==`string`){if(n[t]===void 0||t.startsWith(`_`)||t===`constructor`)throw TypeError(`No method named "${t}"`);n[t]()}})}};M.on(document,Os,qs,function(e){[`A`,`AREA`].includes(this.tagName)&&e.preventDefault(),!Zt(this)&&Xs.getOrCreateInstance(this).show()}),M.on(window,As,()=>{for(let e of Fn.find(Ys))Xs.getOrCreateInstance(e)}),on(Xs);var Zs=`toast`,Qs=`.bs.toast`,$s=`mouseover${Qs}`,ec=`mouseout${Qs}`,tc=`focusin${Qs}`,nc=`focusout${Qs}`,rc=`hide${Qs}`,ic=`hidden${Qs}`,ac=`show${Qs}`,oc=`shown${Qs}`,sc=`fade`,cc=`hide`,lc=`show`,uc=`showing`,dc={animation:`boolean`,autohide:`boolean`,delay:`number`},fc={animation:!0,autohide:!0,delay:5e3},pc=class e extends Nn{constructor(e,t){super(e,t),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return fc}static get DefaultType(){return dc}static get NAME(){return Zs}show(){M.trigger(this._element,ac).defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add(sc),this._element.classList.remove(cc),en(this._element),this._element.classList.add(lc,uc),this._queueCallback(()=>{this._element.classList.remove(uc),M.trigger(this._element,oc),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){!this.isShown()||M.trigger(this._element,rc).defaultPrevented||(this._element.classList.add(uc),this._queueCallback(()=>{this._element.classList.add(cc),this._element.classList.remove(uc,lc),M.trigger(this._element,ic)},this._element,this._config.animation))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(lc),super.dispose()}isShown(){return this._element.classList.contains(lc)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,t){switch(e.type){case`mouseover`:case`mouseout`:this._hasMouseInteraction=t;break;case`focusin`:case`focusout`:this._hasKeyboardInteraction=t;break}if(t){this._clearTimeout();return}let n=e.relatedTarget;this._element===n||this._element.contains(n)||this._maybeScheduleHide()}_setListeners(){M.on(this._element,$s,e=>this._onInteraction(e,!0)),M.on(this._element,ec,e=>this._onInteraction(e,!1)),M.on(this._element,tc,e=>this._onInteraction(e,!0)),M.on(this._element,nc,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(t){return this.each(function(){let n=e.getOrCreateInstance(this,t);if(typeof t==`string`){if(n[t]===void 0)throw TypeError(`No method named "${t}"`);n[t](this)}})}};In(pc),on(pc);var mc=()=>void 0,hc=function(e){let t=[],n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=i&63|128):(i&64512)==55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)==56320?(i=65536+((i&1023)<<10)+(e.charCodeAt(++r)&1023),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=i&63|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=i&63|128)}return t},gc=function(e){let t=[],n=0,r=0;for(;n<e.length;){let i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){let a=e[n++];t[r++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){let a=e[n++],o=e[n++],s=e[n++],c=((i&7)<<18|(a&63)<<12|(o&63)<<6|s&63)-65536;t[r++]=String.fromCharCode(55296+(c>>10)),t[r++]=String.fromCharCode(56320+(c&1023))}else{let a=e[n++],o=e[n++];t[r++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return t.join(``)},_c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789`,get ENCODED_VALS(){return this.ENCODED_VALS_BASE+`+/=`},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+`-_.`},HAS_NATIVE_SUPPORT:typeof atob==`function`,encodeByteArray(e,t){if(!Array.isArray(e))throw Error(`encodeByteArray takes an array as a parameter`);this.init_();let n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){let i=e[t],a=t+1<e.length,o=a?e[t+1]:0,s=t+2<e.length,c=s?e[t+2]:0,l=i>>2,u=(i&3)<<4|o>>4,d=(o&15)<<2|c>>6,f=c&63;s||(f=64,a||(d=64)),r.push(n[l],n[u],n[d],n[f])}return r.join(``)},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(hc(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):gc(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){let i=n[e.charAt(t++)],a=t<e.length?n[e.charAt(t)]:0;++t;let o=t<e.length?n[e.charAt(t)]:64;++t;let s=t<e.length?n[e.charAt(t)]:64;if(++t,i==null||a==null||o==null||s==null)throw new vc;let c=i<<2|a>>4;if(r.push(c),o!==64){let e=a<<4&240|o>>2;if(r.push(e),s!==64){let e=o<<6&192|s;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},vc=class extends Error{constructor(){super(...arguments),this.name=`DecodeBase64StringError`}},yc=function(e){let t=hc(e);return _c.encodeByteArray(t,!0)},bc=function(e){return yc(e).replace(/\./g,``)},xc=function(e){try{return _c.decodeString(e,!0)}catch(e){console.error(`base64Decode failed: `,e)}return null};
/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function Sc(){if(typeof self<`u`)return self;if(typeof window<`u`)return window;if(typeof global<`u`)return global;throw Error(`Unable to locate global object.`)}
/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Cc=()=>Sc().__FIREBASE_DEFAULTS__,wc=()=>{if(typeof process>`u`)return;let e={}.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},Tc=()=>{if(typeof document>`u`)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let t=e&&xc(e[1]);return t&&JSON.parse(t)},Ec=()=>{try{return mc()||Cc()||wc()||Tc()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},Dc=e=>Ec()?.emulatorHosts?.[e],Oc=e=>{let t=Dc(e);if(!t)return;let n=t.lastIndexOf(`:`);if(n<=0||n+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let r=parseInt(t.substring(n+1),10);return t[0]===`[`?[t.substring(1,n-1),r]:[t.substring(0,n),r]},kc=()=>Ec()?.config,Ac=e=>Ec()?.[`_${e}`],jc=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e==`function`&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}};
/**
* @license
* Copyright 2025 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function Mc(e){try{return(e.startsWith(`http://`)||e.startsWith(`https://`)?new URL(e).hostname:e).endsWith(`.cloudworkstations.dev`)}catch{return!1}}async function Nc(e){return(await fetch(e,{credentials:`include`})).ok}
/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function Pc(e,t){if(e.uid)throw Error(`The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.`);let n={alg:`none`,type:`JWT`},r=t||`demo-project`,i=e.iat||0,a=e.sub||e.user_id;if(!a)throw Error(`mockUserToken must contain 'sub' or 'user_id' field!`);let o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:`custom`,identities:{}},...e};return[bc(JSON.stringify(n)),bc(JSON.stringify(o)),``].join(`.`)}var Fc={};function Ic(){let e={prod:[],emulator:[]};for(let t of Object.keys(Fc))Fc[t]?e.emulator.push(t):e.prod.push(t);return e}function Lc(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement(`div`),t.setAttribute(`id`,e),n=!0),{created:n,element:t}}var Rc=!1;function zc(e,t){if(typeof window>`u`||typeof document>`u`||!Mc(window.location.host)||Fc[e]===t||Fc[e]||Rc)return;Fc[e]=t;function n(e){return`__firebase__banner__${e}`}let r=`__firebase__banner`,i=Ic().prod.length>0;function a(){let e=document.getElementById(r);e&&e.remove()}function o(e){e.style.display=`flex`,e.style.background=`#7faaf0`,e.style.position=`fixed`,e.style.bottom=`5px`,e.style.left=`5px`,e.style.padding=`.5em`,e.style.borderRadius=`5px`,e.style.alignItems=`center`}function s(e,t){e.setAttribute(`width`,`24`),e.setAttribute(`id`,t),e.setAttribute(`height`,`24`),e.setAttribute(`viewBox`,`0 0 24 24`),e.setAttribute(`fill`,`none`),e.style.marginLeft=`-6px`}function c(){let e=document.createElement(`span`);return e.style.cursor=`pointer`,e.style.marginLeft=`16px`,e.style.fontSize=`24px`,e.innerHTML=` &times;`,e.onclick=()=>{Rc=!0,a()},e}function l(e,t){e.setAttribute(`id`,t),e.innerText=`Learn more`,e.href=`https://firebase.google.com/docs/studio/preview-apps#preview-backend`,e.setAttribute(`target`,`__blank`),e.style.paddingLeft=`5px`,e.style.textDecoration=`underline`}function u(){let e=Lc(r),t=n(`text`),a=document.getElementById(t)||document.createElement(`span`),u=n(`learnmore`),d=document.getElementById(u)||document.createElement(`a`),f=n(`preprendIcon`),p=document.getElementById(f)||document.createElementNS(`http://www.w3.org/2000/svg`,`svg`);if(e.created){let t=e.element;o(t),l(d,u);let n=c();s(p,f),t.append(p,a,d,n),document.body.appendChild(t)}i?(a.innerText=`Preview backend disconnected.`,p.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(p.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,a.innerText=`Preview backend running in this workspace.`),a.setAttribute(`id`,t)}document.readyState===`loading`?window.addEventListener(`DOMContentLoaded`,u):u()}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function Bc(){return typeof navigator<`u`&&typeof navigator.userAgent==`string`?navigator.userAgent:``}function Vc(){return typeof window<`u`&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Bc())}function Hc(){let e=Ec()?.forceEnvironment;if(e===`node`)return!0;if(e===`browser`)return!1;try{return Object.prototype.toString.call(global.process)===`[object process]`}catch{return!1}}function Uc(){return typeof navigator<`u`&&navigator.userAgent===`Cloudflare-Workers`}function Wc(){let e=typeof chrome==`object`?chrome.runtime:typeof browser==`object`?browser.runtime:void 0;return typeof e==`object`&&e.id!==void 0}function Gc(){return typeof navigator==`object`&&navigator.product===`ReactNative`}function Kc(){let e=Bc();return e.indexOf(`MSIE `)>=0||e.indexOf(`Trident/`)>=0}function qc(){return!Hc()&&!!navigator.userAgent&&navigator.userAgent.includes(`Safari`)&&!navigator.userAgent.includes(`Chrome`)}function Jc(){try{return typeof indexedDB==`object`}catch{return!1}}function Yc(){return new Promise((e,t)=>{try{let n=!0,r=`validate-browser-context-for-indexeddb-analytics-module`,i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{t(i.error?.message||``)}}catch(e){t(e)}})}function Xc(){return!(typeof navigator>`u`||!navigator.cookieEnabled)}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Zc=`FirebaseError`,Qc=class e extends Error{constructor(t,n,r){super(n),this.code=t,this.customData=r,this.name=Zc,Object.setPrototypeOf(this,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$c.prototype.create)}},$c=class{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){let n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],a=i?el(i,n):`Error`,o=`${this.serviceName}: ${a} (${r}).`;return new Qc(r,o,n)}};function el(e,t){return e.replace(tl,(e,n)=>{let r=t[n];return r==null?`<${n}?>`:String(r)})}var tl=/\{\$([^}]+)}/g;function nl(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function rl(e,t){if(e===t)return!0;let n=Object.keys(e),r=Object.keys(t);for(let i of n){if(!r.includes(i))return!1;let n=e[i],a=t[i];if(il(n)&&il(a)){if(!rl(n,a))return!1}else if(n!==a)return!1}for(let e of r)if(!n.includes(e))return!1;return!0}function il(e){return typeof e==`object`&&!!e}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function al(e){let t=[];for(let[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+`=`+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+`=`+encodeURIComponent(r));return t.length?`&`+t.join(`&`):``}function ol(e){let t={};return e.replace(/^\?/,``).split(`&`).forEach(e=>{if(e){let[n,r]=e.split(`=`);t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function sl(e){let t=e.indexOf(`?`);if(!t)return``;let n=e.indexOf(`#`,t);return e.substring(t,n>0?n:void 0)}function cl(e,t){let n=new ll(e,t);return n.subscribe.bind(n)}var ll=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(e===void 0&&t===void 0&&n===void 0)throw Error(`Missing Observer.`);r=ul(e,[`next`,`error`,`complete`])?e:{next:e,error:t,complete:n},r.next===void 0&&(r.next=dl),r.error===void 0&&(r.error=dl),r.complete===void 0&&(r.complete=dl);let i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],--this.observerCount,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(e){typeof console<`u`&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function ul(e,t){if(typeof e!=`object`||!e)return!1;for(let n of t)if(n in e&&typeof e[n]==`function`)return!0;return!1}function dl(){}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var fl=1e3,pl=2,ml=14400*1e3,hl=.5;function gl(e,t=fl,n=pl){let r=t*n**+e,i=Math.round(hl*r*(Math.random()-.5)*2);return Math.min(ml,r+i)}
/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function _l(e){return e&&e._delegate?e._delegate:e}var vl=class{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode=`LAZY`,this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}},yl=`[DEFAULT]`,bl=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new jc;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(e){if(n)return null;throw e}else if(n)return null;else throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(Sl(e))try{this.getOrInitializeService({instanceIdentifier:yl})}catch{}for(let[e,t]of this.instancesDeferred.entries()){let n=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch{}}}}clearInstance(e=yl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>`INTERNAL`in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>`_delete`in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=yl){return this.instances.has(e)}getOptions(e=yl){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(let[e,t]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(e);n===i&&t.resolve(r)}return r}onInit(e,t){let n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);let i=this.instances.get(n);return i&&e(i,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){let n=this.onInitCallbacks.get(t);if(n)for(let r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:xl(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=yl){return this.component?this.component.multipleInstances?e:yl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!==`EXPLICIT`}};function xl(e){return e===yl?void 0:e}function Sl(e){return e.instantiationMode===`EAGER`}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Cl=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new bl(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}},wl=[],Tl;(function(e){e[e.DEBUG=0]=`DEBUG`,e[e.VERBOSE=1]=`VERBOSE`,e[e.INFO=2]=`INFO`,e[e.WARN=3]=`WARN`,e[e.ERROR=4]=`ERROR`,e[e.SILENT=5]=`SILENT`})(Tl||={});var El={debug:Tl.DEBUG,verbose:Tl.VERBOSE,info:Tl.INFO,warn:Tl.WARN,error:Tl.ERROR,silent:Tl.SILENT},Dl=Tl.INFO,Ol={[Tl.DEBUG]:`log`,[Tl.VERBOSE]:`log`,[Tl.INFO]:`info`,[Tl.WARN]:`warn`,[Tl.ERROR]:`error`},kl=(e,t,...n)=>{if(t<e.logLevel)return;let r=new Date().toISOString(),i=Ol[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)},Al=class{constructor(e){this.name=e,this._logLevel=Dl,this._logHandler=kl,this._userLogHandler=null,wl.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Tl))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e==`string`?El[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!=`function`)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Tl.DEBUG,...e),this._logHandler(this,Tl.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Tl.VERBOSE,...e),this._logHandler(this,Tl.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Tl.INFO,...e),this._logHandler(this,Tl.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Tl.WARN,...e),this._logHandler(this,Tl.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Tl.ERROR,...e),this._logHandler(this,Tl.ERROR,...e)}},jl=(e,t)=>t.some(t=>e instanceof t),Ml,Nl;function Pl(){return Ml||=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]}function Fl(){return Nl||=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey]}var Il=new WeakMap,Ll=new WeakMap,Rl=new WeakMap,zl=new WeakMap,Bl=new WeakMap;function Vl(e){let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener(`success`,i),e.removeEventListener(`error`,a)},i=()=>{t(ql(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener(`success`,i),e.addEventListener(`error`,a)});return t.then(t=>{t instanceof IDBCursor&&Il.set(t,e)}).catch(()=>{}),Bl.set(t,e),t}function Hl(e){if(Ll.has(e))return;let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener(`complete`,i),e.removeEventListener(`error`,a),e.removeEventListener(`abort`,a)},i=()=>{t(),r()},a=()=>{n(e.error||new DOMException(`AbortError`,`AbortError`)),r()};e.addEventListener(`complete`,i),e.addEventListener(`error`,a),e.addEventListener(`abort`,a)});Ll.set(e,t)}var Ul={get(e,t,n){if(e instanceof IDBTransaction){if(t===`done`)return Ll.get(e);if(t===`objectStoreNames`)return e.objectStoreNames||Rl.get(e);if(t===`store`)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ql(e[t])},set(e,t,n){return e[t]=n,!0},has(e,t){return e instanceof IDBTransaction&&(t===`done`||t===`store`)?!0:t in e}};function Wl(e){Ul=e(Ul)}function Gl(e){return e===IDBDatabase.prototype.transaction&&!(`objectStoreNames`in IDBTransaction.prototype)?function(t,...n){let r=e.call(Jl(this),t,...n);return Rl.set(r,t.sort?t.sort():[t]),ql(r)}:Fl().includes(e)?function(...t){return e.apply(Jl(this),t),ql(Il.get(this))}:function(...t){return ql(e.apply(Jl(this),t))}}function Kl(e){return typeof e==`function`?Gl(e):(e instanceof IDBTransaction&&Hl(e),jl(e,Pl())?new Proxy(e,Ul):e)}function ql(e){if(e instanceof IDBRequest)return Vl(e);if(zl.has(e))return zl.get(e);let t=Kl(e);return t!==e&&(zl.set(e,t),Bl.set(t,e)),t}var Jl=e=>Bl.get(e);function Yl(e,t,{blocked:n,upgrade:r,blocking:i,terminated:a}={}){let o=indexedDB.open(e,t),s=ql(o);return r&&o.addEventListener(`upgradeneeded`,e=>{r(ql(o.result),e.oldVersion,e.newVersion,ql(o.transaction),e)}),n&&o.addEventListener(`blocked`,e=>n(e.oldVersion,e.newVersion,e)),s.then(e=>{a&&e.addEventListener(`close`,()=>a()),i&&e.addEventListener(`versionchange`,e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),s}var Xl=[`get`,`getKey`,`getAll`,`getAllKeys`,`count`],Zl=[`put`,`add`,`delete`,`clear`],Ql=new Map;function $l(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&typeof t==`string`))return;if(Ql.get(t))return Ql.get(t);let n=t.replace(/FromIndex$/,``),r=t!==n,i=Zl.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Xl.includes(n)))return;let a=async function(e,...t){let a=this.transaction(e,i?`readwrite`:`readonly`),o=a.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&a.done]))[0]};return Ql.set(t,a),a}Wl(e=>({...e,get:(t,n,r)=>$l(t,n)||e.get(t,n,r),has:(t,n)=>!!$l(t,n)||e.has(t,n)}));
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var eu=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(tu(e)){let t=e.getImmediate();return`${t.library}/${t.version}`}else return null}).filter(e=>e).join(` `)}};function tu(e){return e.getComponent()?.type===`VERSION`}var nu=`@firebase/app`,ru=`0.14.4`,iu=new Al(`@firebase/app`),au=`@firebase/app-compat`,ou=`@firebase/analytics-compat`,su=`@firebase/analytics`,cu=`@firebase/app-check-compat`,lu=`@firebase/app-check`,uu=`@firebase/auth`,du=`@firebase/auth-compat`,fu=`@firebase/database`,pu=`@firebase/data-connect`,mu=`@firebase/database-compat`,hu=`@firebase/functions`,gu=`@firebase/functions-compat`,_u=`@firebase/installations`,vu=`@firebase/installations-compat`,yu=`@firebase/messaging`,bu=`@firebase/messaging-compat`,xu=`@firebase/performance`,Su=`@firebase/performance-compat`,Cu=`@firebase/remote-config`,wu=`@firebase/remote-config-compat`,Tu=`@firebase/storage`,Eu=`@firebase/storage-compat`,Du=`@firebase/firestore`,Ou=`@firebase/ai`,ku=`@firebase/firestore-compat`,Au=`firebase`,ju=`12.4.0`,Mu=`[DEFAULT]`,Nu={[nu]:`fire-core`,[au]:`fire-core-compat`,[su]:`fire-analytics`,[ou]:`fire-analytics-compat`,[lu]:`fire-app-check`,[cu]:`fire-app-check-compat`,[uu]:`fire-auth`,[du]:`fire-auth-compat`,[fu]:`fire-rtdb`,[pu]:`fire-data-connect`,[mu]:`fire-rtdb-compat`,[hu]:`fire-fn`,[gu]:`fire-fn-compat`,[_u]:`fire-iid`,[vu]:`fire-iid-compat`,[yu]:`fire-fcm`,[bu]:`fire-fcm-compat`,[xu]:`fire-perf`,[Su]:`fire-perf-compat`,[Cu]:`fire-rc`,[wu]:`fire-rc-compat`,[Tu]:`fire-gcs`,[Eu]:`fire-gcs-compat`,[Du]:`fire-fst`,[ku]:`fire-fst-compat`,[Ou]:`fire-vertex`,"fire-js":`fire-js`,[Au]:`fire-js-all`},Pu=new Map,Fu=new Map,Iu=new Map;function Lu(e,t){try{e.container.addComponent(t)}catch(n){iu.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function Ru(e){let t=e.name;if(Iu.has(t))return iu.debug(`There were multiple attempts to register component ${t}.`),!1;Iu.set(t,e);for(let t of Pu.values())Lu(t,e);for(let t of Fu.values())Lu(t,e);return!0}function zu(e,t){let n=e.container.getProvider(`heartbeat`).getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Bu(e){return e==null?!1:e.settings!==void 0}var Vu=new $c(`app`,`Firebase`,{"no-app":`No Firebase App '{$appName}' has been created - call initializeApp() first`,"bad-app-name":`Illegal App name: '{$appName}'`,"duplicate-app":`Firebase App named '{$appName}' already exists with different options or config`,"app-deleted":`Firebase App named '{$appName}' already deleted`,"server-app-deleted":`Firebase Server App has been deleted`,"no-options":`Need to provide options, when not being deployed to hosting via source.`,"invalid-app-argument":`firebase.{$appName}() takes either no argument or a Firebase App instance.`,"invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":`Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.`,"idb-get":`Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.`,"idb-set":`Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.`,"idb-delete":`Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.`,"finalization-registry-not-supported":`FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.`,"invalid-server-app-environment":`FirebaseServerApp is not for use in browser environments.`}),Hu=class{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new vl(`app`,()=>this,`PUBLIC`))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Vu.create(`app-deleted`,{appName:this._name})}},Uu=ju;function Wu(e,t={}){let n=e;typeof t!=`object`&&(t={name:t});let r={name:Mu,automaticDataCollectionEnabled:!0,...t},i=r.name;if(typeof i!=`string`||!i)throw Vu.create(`bad-app-name`,{appName:String(i)});if(n||=kc(),!n)throw Vu.create(`no-options`);let a=Pu.get(i);if(a){if(rl(n,a.options)&&rl(r,a.config))return a;throw Vu.create(`duplicate-app`,{appName:i})}let o=new Cl(i);for(let e of Iu.values())o.addComponent(e);let s=new Hu(n,r,o);return Pu.set(i,s),s}function Gu(e=Mu){let t=Pu.get(e);if(!t&&e===`[DEFAULT]`&&kc())return Wu();if(!t)throw Vu.create(`no-app`,{appName:e});return t}function Ku(e,t,n){let r=Nu[e]??e;n&&(r+=`-${n}`);let i=r.match(/\s|\//),a=t.match(/\s|\//);if(i||a){let e=[`Unable to register library "${r}" with version "${t}":`];i&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&a&&e.push(`and`),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),iu.warn(e.join(` `));return}Ru(new vl(`${r}-version`,()=>({library:r,version:t}),`VERSION`))}
/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var qu=`firebase-heartbeat-database`,Ju=1,Yu=`firebase-heartbeat-store`,Xu=null;function Zu(){return Xu||=Yl(qu,Ju,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(Yu)}catch(e){console.warn(e)}}}}).catch(e=>{throw Vu.create(`idb-open`,{originalErrorMessage:e.message})}),Xu}async function Qu(e){try{let t=(await Zu()).transaction(Yu),n=await t.objectStore(Yu).get(ed(e));return await t.done,n}catch(e){if(e instanceof Qc)iu.warn(e.message);else{let t=Vu.create(`idb-get`,{originalErrorMessage:e?.message});iu.warn(t.message)}}}async function $u(e,t){try{let n=(await Zu()).transaction(Yu,`readwrite`);await n.objectStore(Yu).put(t,ed(e)),await n.done}catch(e){if(e instanceof Qc)iu.warn(e.message);else{let t=Vu.create(`idb-set`,{originalErrorMessage:e?.message});iu.warn(t.message)}}}function ed(e){return`${e.name}!${e.options.appId}`}
/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var td=1024,nd=30,rd=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider(`app`).getImmediate();this._storage=new od(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{let e=this.container.getProvider(`platform-logger`).getImmediate().getPlatformInfoString(),t=id();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>nd){let e=cd(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){iu.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return``;let e=id(),{heartbeatsToSend:t,unsentEntries:n}=ad(this._heartbeatsCache.heartbeats),r=bc(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return iu.warn(e),``}}};function id(){return new Date().toISOString().substring(0,10)}function ad(e,t=td){let n=[],r=e.slice();for(let i of e){let e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),sd(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),sd(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}var od=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Jc()?Yc().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let e=await Qu(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return $u(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return $u(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}else return}};function sd(e){return bc(JSON.stringify({version:2,heartbeats:e})).length}function cd(e){if(e.length===0)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function ld(e){Ru(new vl(`platform-logger`,e=>new eu(e),`PRIVATE`)),Ru(new vl(`heartbeat`,e=>new rd(e),`PRIVATE`)),Ku(nu,ru,e),Ku(nu,ru,`esm2020`),Ku(`fire-js`,``)}ld(``);function ud(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var dd=ud,fd=new $c(`auth`,`Firebase`,ud()),pd=new Al(`@firebase/auth`);function md(e,...t){pd.logLevel<=Tl.WARN&&pd.warn(`Auth (${Uu}): ${e}`,...t)}function hd(e,...t){pd.logLevel<=Tl.ERROR&&pd.error(`Auth (${Uu}): ${e}`,...t)}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function gd(e,...t){throw xd(e,...t)}function _d(e,...t){return xd(e,...t)}function vd(e,t,n){let r={...dd(),[t]:n};return new $c(`auth`,`Firebase`,r).create(t,{appName:e.name})}function yd(e){return vd(e,`operation-not-supported-in-this-environment`,`Operations that alter the current user are not supported in conjunction with FirebaseServerApp`)}function bd(e,t,n){let r=n;if(!(t instanceof r))throw r.name!==t.constructor.name&&gd(e,`argument-error`),vd(e,`argument-error`,`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function xd(e,...t){if(typeof e!=`string`){let n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return fd.create(e,...t)}function Sd(e,t,...n){if(!e)throw xd(t,...n)}function Cd(e){let t=`INTERNAL ASSERTION FAILED: `+e;throw hd(t),Error(t)}function wd(e,t){e||Cd(t)}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function Td(){return typeof self<`u`&&self.location?.href||``}function Ed(){return Dd()===`http:`||Dd()===`https:`}function Dd(){return typeof self<`u`&&self.location?.protocol||null}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function Od(){return typeof navigator<`u`&&navigator&&`onLine`in navigator&&typeof navigator.onLine==`boolean`&&(Ed()||Wc()||`connection`in navigator)?navigator.onLine:!0}function kd(){if(typeof navigator>`u`)return null;let e=navigator;return e.languages&&e.languages[0]||e.language||null}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Ad=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,wd(t>e,`Short delay should be less than long delay!`),this.isMobile=Vc()||Gc()}get(){return Od()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function jd(e,t){wd(e.emulator,`Emulator should always be set here`);let{url:n}=e.emulator;return t?`${n}${t.startsWith(`/`)?t.slice(1):t}`:n}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Md=class{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<`u`&&`fetch`in self)return self.fetch;if(typeof globalThis<`u`&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<`u`)return fetch;Cd(`Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill`)}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<`u`&&`Headers`in self)return self.Headers;if(typeof globalThis<`u`&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<`u`)return Headers;Cd(`Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill`)}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<`u`&&`Response`in self)return self.Response;if(typeof globalThis<`u`&&globalThis.Response)return globalThis.Response;if(typeof Response<`u`)return Response;Cd(`Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill`)}},Nd={CREDENTIAL_MISMATCH:`custom-token-mismatch`,MISSING_CUSTOM_TOKEN:`internal-error`,INVALID_IDENTIFIER:`invalid-email`,MISSING_CONTINUE_URI:`internal-error`,INVALID_PASSWORD:`wrong-password`,MISSING_PASSWORD:`missing-password`,INVALID_LOGIN_CREDENTIALS:`invalid-credential`,EMAIL_EXISTS:`email-already-in-use`,PASSWORD_LOGIN_DISABLED:`operation-not-allowed`,INVALID_IDP_RESPONSE:`invalid-credential`,INVALID_PENDING_TOKEN:`invalid-credential`,FEDERATED_USER_ID_ALREADY_LINKED:`credential-already-in-use`,MISSING_REQ_TYPE:`internal-error`,EMAIL_NOT_FOUND:`user-not-found`,RESET_PASSWORD_EXCEED_LIMIT:`too-many-requests`,EXPIRED_OOB_CODE:`expired-action-code`,INVALID_OOB_CODE:`invalid-action-code`,MISSING_OOB_CODE:`internal-error`,CREDENTIAL_TOO_OLD_LOGIN_AGAIN:`requires-recent-login`,INVALID_ID_TOKEN:`invalid-user-token`,TOKEN_EXPIRED:`user-token-expired`,USER_NOT_FOUND:`user-token-expired`,TOO_MANY_ATTEMPTS_TRY_LATER:`too-many-requests`,PASSWORD_DOES_NOT_MEET_REQUIREMENTS:`password-does-not-meet-requirements`,INVALID_CODE:`invalid-verification-code`,INVALID_SESSION_INFO:`invalid-verification-id`,INVALID_TEMPORARY_PROOF:`invalid-credential`,MISSING_SESSION_INFO:`missing-verification-id`,SESSION_EXPIRED:`code-expired`,MISSING_ANDROID_PACKAGE_NAME:`missing-android-pkg-name`,UNAUTHORIZED_DOMAIN:`unauthorized-continue-uri`,INVALID_OAUTH_CLIENT_ID:`invalid-oauth-client-id`,ADMIN_ONLY_OPERATION:`admin-restricted-operation`,INVALID_MFA_PENDING_CREDENTIAL:`invalid-multi-factor-session`,MFA_ENROLLMENT_NOT_FOUND:`multi-factor-info-not-found`,MISSING_MFA_ENROLLMENT_ID:`missing-multi-factor-info`,MISSING_MFA_PENDING_CREDENTIAL:`missing-multi-factor-session`,SECOND_FACTOR_EXISTS:`second-factor-already-in-use`,SECOND_FACTOR_LIMIT_EXCEEDED:`maximum-second-factor-count-exceeded`,BLOCKING_FUNCTION_ERROR_RESPONSE:`internal-error`,RECAPTCHA_NOT_ENABLED:`recaptcha-not-enabled`,MISSING_RECAPTCHA_TOKEN:`missing-recaptcha-token`,INVALID_RECAPTCHA_TOKEN:`invalid-recaptcha-token`,INVALID_RECAPTCHA_ACTION:`invalid-recaptcha-action`,MISSING_CLIENT_TYPE:`missing-client-type`,MISSING_RECAPTCHA_VERSION:`missing-recaptcha-version`,INVALID_RECAPTCHA_VERSION:`invalid-recaptcha-version`,INVALID_REQ_TYPE:`invalid-req-type`},Pd=[`/v1/accounts:signInWithCustomToken`,`/v1/accounts:signInWithEmailLink`,`/v1/accounts:signInWithIdp`,`/v1/accounts:signInWithPassword`,`/v1/accounts:signInWithPhoneNumber`,`/v1/token`],Fd=new Ad(3e4,6e4);function Id(e,t){return e.tenantId&&!t.tenantId?{...t,tenantId:e.tenantId}:t}async function Ld(e,t,n,r,i={}){return Rd(e,i,async()=>{let i={},a={};r&&(t===`GET`?a=r:i={body:JSON.stringify(r)});let o=al({key:e.config.apiKey,...a}).slice(1),s=await e._getAdditionalHeaders();s[`Content-Type`]=`application/json`,e.languageCode&&(s[`X-Firebase-Locale`]=e.languageCode);let c={method:t,headers:s,...i};return Uc()||(c.referrerPolicy=`no-referrer`),e.emulatorConfig&&Mc(e.emulatorConfig.host)&&(c.credentials=`include`),Md.fetch()(await Bd(e,e.config.apiHost,n,o),c)})}async function Rd(e,t,n){e._canInitEmulator=!1;let r={...Nd,...t};try{let t=new Hd(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();let a=await i.json();if(`needConfirmation`in a)throw Ud(e,`account-exists-with-different-credential`,a);if(i.ok&&!(`errorMessage`in a))return a;{let[t,n]=(i.ok?a.errorMessage:a.error.message).split(` : `);if(t===`FEDERATED_USER_ID_ALREADY_LINKED`)throw Ud(e,`credential-already-in-use`,a);if(t===`EMAIL_EXISTS`)throw Ud(e,`email-already-in-use`,a);if(t===`USER_DISABLED`)throw Ud(e,`user-disabled`,a);let o=r[t]||t.toLowerCase().replace(/[_\s]+/g,`-`);if(n)throw vd(e,o,n);gd(e,o)}}catch(t){if(t instanceof Qc)throw t;gd(e,`network-request-failed`,{message:String(t)})}}async function zd(e,t,n,r,i={}){let a=await Ld(e,t,n,r,i);return`mfaPendingCredential`in a&&gd(e,`multi-factor-auth-required`,{_serverResponse:a}),a}async function Bd(e,t,n,r){let i=`${t}${n}?${r}`,a=e,o=a.config.emulator?jd(e.config,i):`${e.config.apiScheme}://${i}`;return Pd.includes(n)&&(await a._persistenceManagerAvailable,a._getPersistenceType()===`COOKIE`)?a._getPersistence()._getFinalTarget(o).toString():o}function Vd(e){switch(e){case`ENFORCE`:return`ENFORCE`;case`AUDIT`:return`AUDIT`;case`OFF`:return`OFF`;default:return`ENFORCEMENT_STATE_UNSPECIFIED`}}var Hd=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(_d(this.auth,`network-request-failed`)),Fd.get())})}};function Ud(e,t,n){let r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);let i=_d(e,t,r);return i.customData._tokenResponse=n,i}function Wd(e){return e!==void 0&&e.enterprise!==void 0}var Gd=class{constructor(e){if(this.siteKey=``,this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw Error(`recaptchaKey undefined`);this.siteKey=e.recaptchaKey.split(`/`)[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Vd(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)===`ENFORCE`||this.getProviderEnforcementState(e)===`AUDIT`}isAnyProviderEnabled(){return this.isProviderEnabled(`EMAIL_PASSWORD_PROVIDER`)||this.isProviderEnabled(`PHONE_PROVIDER`)}};async function Kd(e,t){return Ld(e,`GET`,`/v2/recaptchaConfig`,Id(e,t))}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function qd(e,t){return Ld(e,`POST`,`/v1/accounts:delete`,t)}async function Jd(e,t){return Ld(e,`POST`,`/v1/accounts:lookup`,t)}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function Yd(e){if(e)try{let t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function Xd(e,t=!1){let n=_l(e),r=await n.getIdToken(t),i=Qd(r);Sd(i&&i.exp&&i.auth_time&&i.iat,n.auth,`internal-error`);let a=typeof i.firebase==`object`?i.firebase:void 0,o=a?.sign_in_provider;return{claims:i,token:r,authTime:Yd(Zd(i.auth_time)),issuedAtTime:Yd(Zd(i.iat)),expirationTime:Yd(Zd(i.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function Zd(e){return Number(e)*1e3}function Qd(e){let[t,n,r]=e.split(`.`);if(t===void 0||n===void 0||r===void 0)return hd(`JWT malformed, contained fewer than 3 sections`),null;try{let e=xc(n);return e?JSON.parse(e):(hd(`Failed to decode base64 JWT payload`),null)}catch(e){return hd(`Caught error parsing JWT payload as JSON`,e?.toString()),null}}function $d(e){let t=Qd(e);return Sd(t,`internal-error`),Sd(t.exp!==void 0,`internal-error`),Sd(t.iat!==void 0,`internal-error`),Number(t.exp)-Number(t.iat)}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function ef(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof Qc&&tf(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}function tf({code:e}){return e===`auth/user-disabled`||e===`auth/user-token-expired`}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var nf=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let e=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),e}else{this.errorBackoff=3e4;let e=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code===`auth/network-request-failed`&&this.schedule(!0);return}this.schedule()}},rf=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Yd(this.lastLoginAt),this.creationTime=Yd(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function af(e){let t=e.auth,n=await e.getIdToken(),r=await ef(e,Jd(t,{idToken:n}));Sd(r?.users.length,t,`internal-error`);let i=r.users[0];e._notifyReloadListener(i);let a=i.providerUserInfo?.length?lf(i.providerUserInfo):[],o=cf(e.providerData,a),s=e.isAnonymous,c=!(e.email&&i.passwordHash)&&!o?.length,l=s?c:!1,u={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new rf(i.createdAt,i.lastLoginAt),isAnonymous:l};Object.assign(e,u)}async function sf(e){let t=_l(e);await af(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function cf(e,t){return[...e.filter(e=>!t.some(t=>t.providerId===e.providerId)),...t]}function lf(e){return e.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||``,displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function uf(e,t){let n=await Rd(e,{},async()=>{let n=al({grant_type:`refresh_token`,refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,a=await Bd(e,r,`/v1/token`,`key=${i}`),o=await e._getAdditionalHeaders();o[`Content-Type`]=`application/x-www-form-urlencoded`;let s={method:`POST`,headers:o,body:n};return e.emulatorConfig&&Mc(e.emulatorConfig.host)&&(s.credentials=`include`),Md.fetch()(a,s)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function df(e,t){return Ld(e,`POST`,`/v2/accounts:revokeToken`,Id(e,t))}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var ff=class e{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Sd(e.idToken,`internal-error`),Sd(e.idToken!==void 0,`internal-error`),Sd(e.refreshToken!==void 0,`internal-error`);let t=`expiresIn`in e&&e.expiresIn!==void 0?Number(e.expiresIn):$d(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Sd(e.length!==0,`internal-error`);let t=$d(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Sd(this.refreshToken,e,`user-token-expired`),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:n,refreshToken:r,expiresIn:i}=await uf(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(t,n){let{refreshToken:r,accessToken:i,expirationTime:a}=n,o=new e;return r&&(Sd(typeof r==`string`,`internal-error`,{appName:t}),o.refreshToken=r),i&&(Sd(typeof i==`string`,`internal-error`,{appName:t}),o.accessToken=i),a&&(Sd(typeof a==`number`,`internal-error`,{appName:t}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new e,this.toJSON())}_performRefresh(){return Cd(`not implemented`)}};
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function pf(e,t){Sd(typeof e==`string`||e===void 0,`internal-error`,{appName:t})}var mf=class e{constructor({uid:e,auth:t,stsTokenManager:n,...r}){this.providerId=`firebase`,this.proactiveRefresh=new nf(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new rf(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){let t=await ef(this,this.stsTokenManager.getToken(this.auth,e));return Sd(t,this.auth,`internal-error`),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Xd(this,e)}reload(){return sf(this)}_assign(e){this!==e&&(Sd(this.uid===e.uid,this.auth,`internal-error`),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>({...e})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(t){let n=new e({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Sd(!this.reloadListener,this.auth,`internal-error`),this.reloadListener=e,this.reloadUserInfo&&=(this._notifyReloadListener(this.reloadUserInfo),null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await af(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Bu(this.auth.app))return Promise.reject(yd(this.auth));let e=await this.getIdToken();return await ef(this,qd(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||``}static _fromJSON(t,n){let r=n.displayName??void 0,i=n.email??void 0,a=n.phoneNumber??void 0,o=n.photoURL??void 0,s=n.tenantId??void 0,c=n._redirectEventId??void 0,l=n.createdAt??void 0,u=n.lastLoginAt??void 0,{uid:d,emailVerified:f,isAnonymous:p,providerData:m,stsTokenManager:h}=n;Sd(d&&h,t,`internal-error`);let g=ff.fromJSON(this.name,h);Sd(typeof d==`string`,t,`internal-error`),pf(r,t.name),pf(i,t.name),Sd(typeof f==`boolean`,t,`internal-error`),Sd(typeof p==`boolean`,t,`internal-error`),pf(a,t.name),pf(o,t.name),pf(s,t.name),pf(c,t.name),pf(l,t.name),pf(u,t.name);let _=new e({uid:d,auth:t,email:i,emailVerified:f,displayName:r,isAnonymous:p,photoURL:o,phoneNumber:a,tenantId:s,stsTokenManager:g,createdAt:l,lastLoginAt:u});return m&&Array.isArray(m)&&(_.providerData=m.map(e=>({...e}))),c&&(_._redirectEventId=c),_}static async _fromIdTokenResponse(t,n,r=!1){let i=new ff;i.updateFromServerResponse(n);let a=new e({uid:n.localId,auth:t,stsTokenManager:i,isAnonymous:r});return await af(a),a}static async _fromGetAccountInfoResponse(t,n,r){let i=n.users[0];Sd(i.localId!==void 0,`internal-error`);let a=i.providerUserInfo===void 0?[]:lf(i.providerUserInfo),o=!(i.email&&i.passwordHash)&&!a?.length,s=new ff;s.updateFromIdToken(r);let c=new e({uid:i.localId,auth:t,stsTokenManager:s,isAnonymous:o}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new rf(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(c,l),c}},hf=new Map;function gf(e){wd(e instanceof Function,`Expected a class definition`);let t=hf.get(e);return t?(wd(t instanceof e,`Instance stored in cache mismatched with class`),t):(t=new e,hf.set(e,t),t)}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var _f=class{constructor(){this.type=`NONE`,this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){let t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}};_f.type=`NONE`;var vf=_f;
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function yf(e,t,n){return`firebase:${e}:${t}:${n}`}var bf=class e{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;let{config:r,name:i}=this.auth;this.fullUserKey=yf(this.userKey,r.apiKey,i),this.fullPersistenceKey=yf(`persistence`,r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e==`string`){let t=await Jd(this.auth,{idToken:e}).catch(()=>void 0);return t?mf._fromGetAccountInfoResponse(this.auth,t,e):null}return mf._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,n,r=`authUser`){if(!n.length)return new e(gf(vf),t,r);let i=(await Promise.all(n.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e),a=i[0]||gf(vf),o=yf(r,t.config.apiKey,t.name),s=null;for(let e of n)try{let n=await e._get(o);if(n){let r;if(typeof n==`string`){let e=await Jd(t,{idToken:n}).catch(()=>void 0);if(!e)break;r=await mf._fromGetAccountInfoResponse(t,e,n)}else r=mf._fromJSON(t,n);e!==a&&(s=r),a=e;break}}catch{}let c=i.filter(e=>e._shouldAllowMigration);return!a._shouldAllowMigration||!c.length?new e(a,t,r):(a=c[0],s&&await a._set(o,s.toJSON()),await Promise.all(n.map(async e=>{if(e!==a)try{await e._remove(o)}catch{}})),new e(a,t,r))}};
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function xf(e){let t=e.toLowerCase();if(t.includes(`opera/`)||t.includes(`opr/`)||t.includes(`opios/`))return`Opera`;if(Tf(t))return`IEMobile`;if(t.includes(`msie`)||t.includes(`trident/`))return`IE`;if(t.includes(`edge/`))return`Edge`;if(Sf(t))return`Firefox`;if(t.includes(`silk/`))return`Silk`;if(Df(t))return`Blackberry`;if(Of(t))return`Webos`;if(Cf(t))return`Safari`;if((t.includes(`chrome/`)||wf(t))&&!t.includes(`edge/`))return`Chrome`;if(Ef(t))return`Android`;{let t=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(t?.length===2)return t[1]}return`Other`}function Sf(e=Bc()){return/firefox\//i.test(e)}function Cf(e=Bc()){let t=e.toLowerCase();return t.includes(`safari/`)&&!t.includes(`chrome/`)&&!t.includes(`crios/`)&&!t.includes(`android`)}function wf(e=Bc()){return/crios\//i.test(e)}function Tf(e=Bc()){return/iemobile/i.test(e)}function Ef(e=Bc()){return/android/i.test(e)}function Df(e=Bc()){return/blackberry/i.test(e)}function Of(e=Bc()){return/webos/i.test(e)}function kf(e=Bc()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Af(e=Bc()){return kf(e)&&!!window.navigator?.standalone}function jf(){return Kc()&&document.documentMode===10}function Mf(e=Bc()){return kf(e)||Ef(e)||Of(e)||Df(e)||/windows phone/i.test(e)||Tf(e)}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function Nf(e,t=[]){let n;switch(e){case`Browser`:n=xf(Bc());break;case`Worker`:n=`${xf(Bc())}-${e}`;break;default:n=e}let r=t.length?t.join(`,`):`FirebaseCore-web`;return`${n}/JsCore/${Uu}/${r}`}
/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Pf=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let n=t=>new Promise((n,r)=>{try{let r=e(t);n(r)}catch(e){r(e)}});n.onAbort=t,this.queue.push(n);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){t.reverse();for(let e of t)try{e()}catch{}throw this.auth._errorFactory.create(`login-blocked`,{originalMessage:e?.message})}}};
/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function Ff(e,t={}){return Ld(e,`GET`,`/v2/passwordPolicy`,Id(e,t))}
/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var If=6,Lf=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??If,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState===`ENFORCEMENT_STATE_UNSPECIFIED`&&(this.enforcementState=`OFF`),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join(``)??``,this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&=t.meetsMinPasswordLength??!0,t.isValid&&=t.meetsMaxPasswordLength??!0,t.isValid&&=t.containsLowercaseLetter??!0,t.isValid&&=t.containsUppercaseLetter??!0,t.isValid&&=t.containsNumericCharacter??!0,t.isValid&&=t.containsNonAlphanumericCharacter??!0,t}validatePasswordLengthOptions(e,t){let n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>=`a`&&n<=`z`,n>=`A`&&n<=`Z`,n>=`0`&&n<=`9`,this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||=t),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||=n),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||=r),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||=i)}},Rf=class{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Bf(this),this.idTokenSubscription=new Bf(this),this.beforeStateQueue=new Pf(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=fd,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=gf(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await bf.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await Jd(this,{idToken:e}),n=await mf._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(e){console.warn(`FirebaseServerApp could not login user with provided authIdToken: `,e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Bu(this.app)){let e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),n=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let t=this.redirectUser?._redirectEventId,i=n?._redirectEventId,a=await this.tryRedirectSignIn(e);(!t||t===i)&&a?.user&&(n=a.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(e){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Sd(this._popupRedirectResolver,this,`argument-error`),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await af(e)}catch(e){if(e?.code!==`auth/network-request-failed`)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=kd()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Bu(this.app))return Promise.reject(yd(this));let t=e?_l(e):null;return t&&Sd(t.auth.config.apiKey===this.config.apiKey,this,`invalid-user-token`),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Sd(this.tenantId===e.tenantId,this,`tenant-id-mismatch`),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Bu(this.app)?Promise.reject(yd(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Bu(this.app)?Promise.reject(yd(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(gf(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion===this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?t.validatePassword(e):Promise.reject(this._errorFactory.create(`unsupported-password-policy-schema-version`,{}))}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await Ff(this),t=new Lf(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new $c(`auth`,`Firebase`,e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),n={providerId:`apple.com`,tokenType:`ACCESS_TOKEN`,token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await df(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&gf(e)||this._popupRedirectResolver;Sd(t,this,`argument-error`),this.redirectPersistenceManager=await bf.create(this,[gf(t._redirectPersistence)],`redirectUser`),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};let i=typeof t==`function`?t:t.next.bind(t),a=!1,o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Sd(o,this,`internal-error`),o.then(()=>{a||i(this.currentUser)}),typeof t==`function`){let i=e.addObserver(t,n,r);return()=>{a=!0,i()}}else{let n=e.addObserver(t);return()=>{a=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Sd(this.persistenceManager,this,`internal-error`),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Nf(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e[`X-Firebase-gmpid`]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e[`X-Firebase-Client`]=t);let n=await this._getAppCheckToken();return n&&(e[`X-Firebase-AppCheck`]=n),e}async _getAppCheckToken(){if(Bu(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&md(`Error while retrieving App Check token: ${e.error}`),e?.token}};function zf(e){return _l(e)}var Bf=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=cl(e=>this.observer=e)}get next(){return Sd(this.observer,this.auth,`internal-error`),this.observer.next.bind(this.observer)}},Vf={async loadJS(){throw Error(`Unable to load external scripts`)},recaptchaV2Script:``,recaptchaEnterpriseScript:``,gapiScript:``};function Hf(e){Vf=e}function Uf(e){return Vf.loadJS(e)}function Wf(){return Vf.recaptchaEnterpriseScript}function Gf(){return Vf.gapiScript}function Kf(e){return`__${e}${Math.floor(Math.random()*1e6)}`}var qf=class{constructor(){this.enterprise=new Jf}ready(e){e()}execute(e,t){return Promise.resolve(`token`)}render(e,t){return``}},Jf=class{ready(e){e()}execute(e,t){return Promise.resolve(`token`)}render(e,t){return``}},Yf=`recaptcha-enterprise`,Xf=`NO_RECAPTCHA`,Zf=class{constructor(e){this.type=Yf,this.auth=zf(e)}async verify(e=`verify`,t=!1){async function n(e){if(!t){if(e.tenantId==null&&e._agentRecaptchaConfig!=null)return e._agentRecaptchaConfig.siteKey;if(e.tenantId!=null&&e._tenantRecaptchaConfigs[e.tenantId]!==void 0)return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{Kd(e,{clientType:`CLIENT_TYPE_WEB`,version:`RECAPTCHA_ENTERPRISE`}).then(r=>{if(r.recaptchaKey===void 0)n(Error(`recaptcha Enterprise site key undefined`));else{let n=new Gd(r);return e.tenantId==null?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}}).catch(e=>{n(e)})})}function r(t,n,r){let i=window.grecaptcha;Wd(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(Xf)})}):r(Error(`No reCAPTCHA enterprise script loaded.`))}return this.auth.settings.appVerificationDisabledForTesting?new qf().execute(`siteKey`,{action:`verify`}):new Promise((e,i)=>{n(this.auth).then(n=>{if(!t&&Wd(window.grecaptcha))r(n,e,i);else{if(typeof window>`u`){i(Error(`RecaptchaVerifier is only supported in browser`));return}let t=Wf();t.length!==0&&(t+=n),Uf(t).then(()=>{r(n,e,i)}).catch(e=>{i(e)})}}).catch(e=>{i(e)})})}};async function Qf(e,t,n,r=!1,i=!1){let a=new Zf(e),o;if(i)o=Xf;else try{o=await a.verify(n)}catch{o=await a.verify(n,!0)}let s={...t};if(n===`mfaSmsEnrollment`||n===`mfaSmsSignIn`){if(`phoneEnrollmentInfo`in s){let e=s.phoneEnrollmentInfo.phoneNumber,t=s.phoneEnrollmentInfo.recaptchaToken;Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:o,clientType:`CLIENT_TYPE_WEB`,recaptchaVersion:`RECAPTCHA_ENTERPRISE`}})}else if(`phoneSignInInfo`in s){let e=s.phoneSignInInfo.recaptchaToken;Object.assign(s,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:o,clientType:`CLIENT_TYPE_WEB`,recaptchaVersion:`RECAPTCHA_ENTERPRISE`}})}return s}return r?Object.assign(s,{captchaResp:o}):Object.assign(s,{captchaResponse:o}),Object.assign(s,{clientType:`CLIENT_TYPE_WEB`}),Object.assign(s,{recaptchaVersion:`RECAPTCHA_ENTERPRISE`}),s}async function $f(e,t,n,r,i){if(i===`EMAIL_PASSWORD_PROVIDER`)if(e._getRecaptchaConfig()?.isProviderEnabled(`EMAIL_PASSWORD_PROVIDER`)){let i=await Qf(e,t,n,n===`getOobCode`);return r(e,i)}else return r(e,t).catch(async i=>{if(i.code===`auth/missing-recaptcha-token`){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let i=await Qf(e,t,n,n===`getOobCode`);return r(e,i)}else return Promise.reject(i)});else if(i===`PHONE_PROVIDER`)if(e._getRecaptchaConfig()?.isProviderEnabled(`PHONE_PROVIDER`)){let i=await Qf(e,t,n);return r(e,i).catch(async i=>{if(e._getRecaptchaConfig()?.getProviderEnforcementState(`PHONE_PROVIDER`)===`AUDIT`&&(i.code===`auth/missing-recaptcha-token`||i.code===`auth/invalid-app-credential`)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);let i=await Qf(e,t,n,!1,!0);return r(e,i)}return Promise.reject(i)})}else{let i=await Qf(e,t,n,!1,!0);return r(e,i)}else return Promise.reject(i+` provider is not supported.`)}async function ep(e){let t=zf(e),n=await Kd(t,{clientType:`CLIENT_TYPE_WEB`,version:`RECAPTCHA_ENTERPRISE`}),r=new Gd(n);t.tenantId==null?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()&&new Zf(t).verify()}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function tp(e,t){let n=zu(e,`auth`);if(n.isInitialized()){let e=n.getImmediate(),r=n.getOptions();if(rl(r,t??{}))return e;gd(e,`already-initialized`)}return n.initialize({options:t})}function np(e,t){let n=t?.persistence||[],r=(Array.isArray(n)?n:[n]).map(gf);t?.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,t?.popupRedirectResolver)}function rp(e,t,n){let r=zf(e);Sd(/^https?:\/\//.test(t),r,`invalid-emulator-scheme`);let i=!!n?.disableWarnings,a=ip(t),{host:o,port:s}=ap(t),c=s===null?``:`:${s}`,l={url:`${a}//${o}${c}/`},u=Object.freeze({host:o,port:s,protocol:a.replace(`:`,``),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){Sd(r.config.emulator&&r.emulatorConfig,r,`emulator-config-failed`),Sd(rl(l,r.config.emulator)&&rl(u,r.emulatorConfig),r,`emulator-config-failed`);return}r.config.emulator=l,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,Mc(o)?(Nc(`${a}//${o}${c}`),zc(`Auth`,!0)):i||sp()}function ip(e){let t=e.indexOf(`:`);return t<0?``:e.substr(0,t+1)}function ap(e){let t=ip(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:``,port:null};let r=n[2].split(`@`).pop()||``,i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let e=i[1];return{host:e,port:op(r.substr(e.length+1))}}else{let[e,t]=r.split(`:`);return{host:e,port:op(t)}}}function op(e){if(!e)return null;let t=Number(e);return isNaN(t)?null:t}function sp(){function e(){let e=document.createElement(`p`),t=e.style;e.innerText=`Running in emulator mode. Do not use with production credentials.`,t.position=`fixed`,t.width=`100%`,t.backgroundColor=`#ffffff`,t.border=`.1em solid #000000`,t.color=`#b50000`,t.bottom=`0px`,t.left=`0px`,t.margin=`0px`,t.zIndex=`10000`,t.textAlign=`center`,e.classList.add(`firebase-emulator-warning`),document.body.appendChild(e)}typeof console<`u`&&typeof console.info==`function`&&console.info(`WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.`),typeof window<`u`&&typeof document<`u`&&(document.readyState===`loading`?window.addEventListener(`DOMContentLoaded`,e):e())}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var cp=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Cd(`not implemented`)}_getIdTokenResponse(e){return Cd(`not implemented`)}_linkToIdToken(e,t){return Cd(`not implemented`)}_getReauthenticationResolver(e){return Cd(`not implemented`)}};async function lp(e,t){return Ld(e,`POST`,`/v1/accounts:signUp`,t)}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function up(e,t){return zd(e,`POST`,`/v1/accounts:signInWithPassword`,Id(e,t))}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function dp(e,t){return zd(e,`POST`,`/v1/accounts:signInWithEmailLink`,Id(e,t))}async function fp(e,t){return zd(e,`POST`,`/v1/accounts:signInWithEmailLink`,Id(e,t))}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var pp=class e extends cp{constructor(e,t,n,r=null){super(`password`,n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(t,n){return new e(t,n,`password`)}static _fromEmailAndCode(t,n,r=null){return new e(t,n,`emailLink`,r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e==`string`?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod===`password`)return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod===`emailLink`)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case`password`:let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:`CLIENT_TYPE_WEB`};return $f(e,t,`signInWithPassword`,up,`EMAIL_PASSWORD_PROVIDER`);case`emailLink`:return dp(e,{email:this._email,oobCode:this._password});default:gd(e,`internal-error`)}}async _linkToIdToken(e,t){switch(this.signInMethod){case`password`:let n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:`CLIENT_TYPE_WEB`};return $f(e,n,`signUpPassword`,lp,`EMAIL_PASSWORD_PROVIDER`);case`emailLink`:return fp(e,{idToken:t,email:this._email,oobCode:this._password});default:gd(e,`internal-error`)}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function mp(e,t){return zd(e,`POST`,`/v1/accounts:signInWithIdp`,Id(e,t))}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var hp=`http://localhost`,gp=class e extends cp{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){let n=new e(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(n.idToken=t.idToken),t.accessToken&&(n.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(n.nonce=t.nonce),t.pendingToken&&(n.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(n.accessToken=t.oauthToken,n.secret=t.oauthTokenSecret):gd(`argument-error`),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){let{providerId:n,signInMethod:r,...i}=typeof t==`string`?JSON.parse(t):t;if(!n||!r)return null;let a=new e(n,r);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){let t=this.buildRequest();return mp(e,t)}_linkToIdToken(e,t){let n=this.buildRequest();return n.idToken=t,mp(e,n)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,mp(e,t)}buildRequest(){let e={requestUri:hp,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=al(t)}return e}};
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function _p(e,t){return Ld(e,`POST`,`/v1/accounts:sendVerificationCode`,Id(e,t))}async function vp(e,t){return zd(e,`POST`,`/v1/accounts:signInWithPhoneNumber`,Id(e,t))}async function yp(e,t){let n=await zd(e,`POST`,`/v1/accounts:signInWithPhoneNumber`,Id(e,t));if(n.temporaryProof)throw Ud(e,`account-exists-with-different-credential`,n);return n}var bp={USER_NOT_FOUND:`user-not-found`};async function xp(e,t){let n={...t,operation:`REAUTH`};return zd(e,`POST`,`/v1/accounts:signInWithPhoneNumber`,Id(e,n),bp)}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Sp=class e extends cp{constructor(e){super(`phone`,`phone`),this.params=e}static _fromVerification(t,n){return new e({verificationId:t,verificationCode:n})}static _fromTokenResponse(t,n){return new e({phoneNumber:t,temporaryProof:n})}_getIdTokenResponse(e){return vp(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return yp(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return xp(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(t){typeof t==`string`&&(t=JSON.parse(t));let{verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:a}=t;return!r&&!n&&!i&&!a?null:new e({verificationId:n,verificationCode:r,phoneNumber:i,temporaryProof:a})}};
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function Cp(e){switch(e){case`recoverEmail`:return`RECOVER_EMAIL`;case`resetPassword`:return`PASSWORD_RESET`;case`signIn`:return`EMAIL_SIGNIN`;case`verifyEmail`:return`VERIFY_EMAIL`;case`verifyAndChangeEmail`:return`VERIFY_AND_CHANGE_EMAIL`;case`revertSecondFactorAddition`:return`REVERT_SECOND_FACTOR_ADDITION`;default:return null}}function wp(e){let t=ol(sl(e)).link,n=t?ol(sl(t)).deep_link_id:null,r=ol(sl(e)).deep_link_id;return(r?ol(sl(r)).link:null)||r||n||t||e}var Tp=class e{constructor(e){let t=ol(sl(e)),n=t.apiKey??null,r=t.oobCode??null,i=Cp(t.mode??null);Sd(n&&r&&i,`argument-error`),this.apiKey=n,this.operation=i,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(t){let n=wp(t);try{return new e(n)}catch{return null}}},Ep=class e{constructor(){this.providerId=e.PROVIDER_ID}static credential(e,t){return pp._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){let n=Tp.parseLink(t);return Sd(n,`argument-error`),pp._fromEmailAndCode(e,n.code,n.tenantId)}};Ep.PROVIDER_ID=`password`,Ep.EMAIL_PASSWORD_SIGN_IN_METHOD=`password`,Ep.EMAIL_LINK_SIGN_IN_METHOD=`emailLink`;
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Dp=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}},Op=class extends Dp{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}},kp=class e extends Op{constructor(){super(`facebook.com`)}static credential(t){return gp._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return e.credentialFromTaggedObject(t)}static credentialFromError(t){return e.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!(`oauthAccessToken`in t)||!t.oauthAccessToken)return null;try{return e.credential(t.oauthAccessToken)}catch{return null}}};kp.FACEBOOK_SIGN_IN_METHOD=`facebook.com`,kp.PROVIDER_ID=`facebook.com`;
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Ap=class e extends Op{constructor(){super(`google.com`),this.addScope(`profile`)}static credential(t,n){return gp._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:n})}static credentialFromResult(t){return e.credentialFromTaggedObject(t)}static credentialFromError(t){return e.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return e.credential(n,r)}catch{return null}}};Ap.GOOGLE_SIGN_IN_METHOD=`google.com`,Ap.PROVIDER_ID=`google.com`;
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var jp=class e extends Op{constructor(){super(`github.com`)}static credential(t){return gp._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return e.credentialFromTaggedObject(t)}static credentialFromError(t){return e.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!(`oauthAccessToken`in t)||!t.oauthAccessToken)return null;try{return e.credential(t.oauthAccessToken)}catch{return null}}};jp.GITHUB_SIGN_IN_METHOD=`github.com`,jp.PROVIDER_ID=`github.com`;
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Mp=class e extends Op{constructor(){super(`twitter.com`)}static credential(t,n){return gp._fromParams({providerId:e.PROVIDER_ID,signInMethod:e.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:n})}static credentialFromResult(t){return e.credentialFromTaggedObject(t)}static credentialFromError(t){return e.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;let{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return e.credential(n,r)}catch{return null}}};Mp.TWITTER_SIGN_IN_METHOD=`twitter.com`,Mp.PROVIDER_ID=`twitter.com`;
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function Np(e,t){return zd(e,`POST`,`/v1/accounts:signUp`,Id(e,t))}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Pp=class e{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(t,n,r,i=!1){let a=await mf._fromIdTokenResponse(t,r,i),o=Fp(r);return new e({user:a,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(t,n,r){await t._updateTokensIfNecessary(r,!0);let i=Fp(r);return new e({user:t,providerId:i,_tokenResponse:r,operationType:n})}};function Fp(e){return e.providerId?e.providerId:`phoneNumber`in e?`phone`:null}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Ip=class e extends Qc{constructor(t,n,r,i){super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,e.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(t,n,r,i){return new e(t,n,r,i)}};function Lp(e,t,n,r){return(t===`reauthenticate`?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{throw n.code===`auth/multi-factor-auth-required`?Ip._fromErrorAndOperation(e,n,t,r):n})}async function Rp(e,t,n=!1){let r=await ef(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Pp._forOperation(e,`link`,r)}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function zp(e,t,n=!1){let{auth:r}=e;if(Bu(r.app))return Promise.reject(yd(r));let i=`reauthenticate`;try{let a=await ef(e,Lp(r,i,t,e),n);Sd(a.idToken,r,`internal-error`);let o=Qd(a.idToken);Sd(o,r,`internal-error`);let{sub:s}=o;return Sd(e.uid===s,r,`user-mismatch`),Pp._forOperation(e,i,a)}catch(e){throw e?.code===`auth/user-not-found`&&gd(r,`user-mismatch`),e}}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function Bp(e,t,n=!1){if(Bu(e.app))return Promise.reject(yd(e));let r=`signIn`,i=await Lp(e,r,t),a=await Pp._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(a.user),a}async function Vp(e,t){return Bp(zf(e),t)}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function Hp(e){let t=zf(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function Up(e,t,n){if(Bu(e.app))return Promise.reject(yd(e));let r=zf(e),i=await $f(r,{returnSecureToken:!0,email:t,password:n,clientType:`CLIENT_TYPE_WEB`},`signUpPassword`,Np,`EMAIL_PASSWORD_PROVIDER`).catch(t=>{throw t.code===`auth/password-does-not-meet-requirements`&&Hp(e),t}),a=await Pp._fromIdTokenResponse(r,`signIn`,i);return await r._updateCurrentUser(a.user),a}function Wp(e,t,n){return Bu(e.app)?Promise.reject(yd(e)):Vp(_l(e),Ep.credential(t,n)).catch(async t=>{throw t.code===`auth/password-does-not-meet-requirements`&&Hp(e),t})}function Gp(e,t,n,r){return _l(e).onIdTokenChanged(t,n,r)}function Kp(e,t,n){return _l(e).beforeAuthStateChanged(t,n)}function qp(e,t,n,r){return _l(e).onAuthStateChanged(t,n,r)}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function Jp(e,t){return Ld(e,`POST`,`/v2/accounts/mfaEnrollment:start`,Id(e,t))}function Yp(e,t){return Ld(e,`POST`,`/v2/accounts/mfaEnrollment:finalize`,Id(e,t))}function Xp(e,t){return Ld(e,`POST`,`/v2/accounts/mfaEnrollment:start`,Id(e,t))}function Zp(e,t){return Ld(e,`POST`,`/v2/accounts/mfaEnrollment:finalize`,Id(e,t))}var Qp=`__sak`,$p=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Qp,`1`),this.storage.removeItem(Qp),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}},em=1e3,tm=10,nm=class extends $p{constructor(){super(()=>window.localStorage,`LOCAL`),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Mf(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let t of Object.keys(this.listeners)){let n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});return}let n=e.key;t?this.detachListener():this.stopPolling();let r=()=>{let e=this.storage.getItem(n);!t&&this.localCache[n]===e||this.notifyListeners(n,e)},i=this.storage.getItem(n);jf()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,tm):r()}notifyListeners(e,t){this.localCache[e]=t;let n=this.listeners[e];if(n)for(let e of Array.from(n))e(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent(`storage`,{key:e,oldValue:t,newValue:n}),!0)})},em)}stopPolling(){this.pollTimer&&=(clearInterval(this.pollTimer),null)}attachListener(){window.addEventListener(`storage`,this.boundEventHandler)}detachListener(){window.removeEventListener(`storage`,this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){let t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}};nm.type=`LOCAL`;var rm=nm,im=1e3;function am(e){let t=e.replace(/[\\^$.*+?()[\]{}|]/g,`\\$&`),n=RegExp(`${t}=([^;]+)`);return document.cookie.match(n)?.[1]??null}function om(e){return`${window.location.protocol===`http:`?`__dev_`:`__HOST-`}FIREBASE_${e.split(`:`)[3]}`}var sm=class{constructor(){this.type=`COOKIE`,this.listenerUnsubscribes=new Map}_getFinalTarget(e){let t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set(`finalTarget`,e),t}async _isAvailable(){return typeof isSecureContext==`boolean`&&!isSecureContext||typeof navigator>`u`||typeof document>`u`?!1:navigator.cookieEnabled??!0}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;let t=om(e);return window.cookieStore?(await window.cookieStore.get(t))?.value:am(t)}async _remove(e){if(!this._isAvailable()||!await this._get(e))return;let t=om(e);document.cookie=`${t}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch(`/__cookies__`,{method:`DELETE`}).catch(()=>void 0)}_addListener(e,t){if(!this._isAvailable())return;let n=om(e);if(window.cookieStore){let e=(e=>{let r=e.changed.find(e=>e.name===n);r&&t(r.value),e.deleted.find(e=>e.name===n)&&t(null)});return this.listenerUnsubscribes.set(t,()=>window.cookieStore.removeEventListener(`change`,e)),window.cookieStore.addEventListener(`change`,e)}let r=am(n),i=setInterval(()=>{let e=am(n);e!==r&&(t(e),r=e)},im);this.listenerUnsubscribes.set(t,()=>clearInterval(i))}_removeListener(e,t){let n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}};sm.type=`COOKIE`;
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var cm=class extends $p{constructor(){super(()=>window.sessionStorage,`SESSION`)}_addListener(e,t){}_removeListener(e,t){}};cm.type=`SESSION`;var lm=cm;
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function um(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}}))}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var dm=class e{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let n=this.receivers.find(e=>e.isListeningto(t));if(n)return n;let r=new e(t);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let t=e,{eventId:n,eventType:r,data:i}=t.data,a=this.handlersMap[r];if(!a?.size)return;t.ports[0].postMessage({status:`ack`,eventId:n,eventType:r});let o=Array.from(a).map(async e=>e(t.origin,i)),s=await um(o);t.ports[0].postMessage({status:`done`,eventId:n,eventType:r,response:s})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener(`message`,this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener(`message`,this.boundEventHandler)}};dm.receivers=[];
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function fm(e=``,t=10){let n=``;for(let e=0;e<t;e++)n+=Math.floor(Math.random()*10);return e+n}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var pm=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener(`message`,e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){let r=typeof MessageChannel<`u`?new MessageChannel:null;if(!r)throw Error(`connection_unavailable`);let i,a;return new Promise((o,s)=>{let c=fm(``,20);r.port1.start();let l=setTimeout(()=>{s(Error(`unsupported_event`))},n);a={messageChannel:r,onMessage(e){let t=e;if(t.data.eventId===c)switch(t.data.status){case`ack`:clearTimeout(l),i=setTimeout(()=>{s(Error(`timeout`))},3e3);break;case`done`:clearTimeout(i),o(t.data.response);break;default:clearTimeout(l),clearTimeout(i),s(Error(`invalid_response`));break}}},this.handlers.add(a),r.port1.addEventListener(`message`,a.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}};
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function mm(){return window}function hm(e){mm().location.href=e}
/**
* @license
* Copyright 2020 Google LLC.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function gm(){return mm().WorkerGlobalScope!==void 0&&typeof mm().importScripts==`function`}async function _m(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function vm(){return navigator?.serviceWorker?.controller||null}function ym(){return gm()?self:null}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var bm=`firebaseLocalStorageDb`,eee=1,xm=`firebaseLocalStorage`,Sm=`fbase_key`,Cm=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener(`success`,()=>{e(this.request.result)}),this.request.addEventListener(`error`,()=>{t(this.request.error)})})}};function wm(e,t){return e.transaction([xm],t?`readwrite`:`readonly`).objectStore(xm)}function tee(){let e=indexedDB.deleteDatabase(bm);return new Cm(e).toPromise()}function Tm(){let e=indexedDB.open(bm,eee);return new Promise((t,n)=>{e.addEventListener(`error`,()=>{n(e.error)}),e.addEventListener(`upgradeneeded`,()=>{let t=e.result;try{t.createObjectStore(xm,{keyPath:Sm})}catch(e){n(e)}}),e.addEventListener(`success`,async()=>{let n=e.result;n.objectStoreNames.contains(xm)?t(n):(n.close(),await tee(),t(await Tm()))})})}async function Em(e,t,n){let r=wm(e,!0).put({[Sm]:t,value:n});return new Cm(r).toPromise()}async function nee(e,t){let n=wm(e,!1).get(t),r=await new Cm(n).toPromise();return r===void 0?null:r.value}function Dm(e,t){let n=wm(e,!0).delete(t);return new Cm(n).toPromise()}var ree=800,iee=3,Om=class{constructor(){this.type=`LOCAL`,this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||=await Tm(),this.db}async _withRetries(e){let t=0;for(;;)try{let t=await this._openDb();return await e(t)}catch(e){if(t++>iee)throw e;this.db&&=(this.db.close(),void 0)}}async initializeServiceWorkerMessaging(){return gm()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=dm._getInstance(ym()),this.receiver._subscribe(`keyChanged`,async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe(`ping`,async(e,t)=>[`keyChanged`])}async initializeSender(){if(this.activeServiceWorker=await _m(),!this.activeServiceWorker)return;this.sender=new pm(this.activeServiceWorker);let e=await this.sender._send(`ping`,{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes(`keyChanged`)&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||vm()!==this.activeServiceWorker))try{await this.sender._send(`keyChanged`,{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await Tm();return await Em(e,Qp,`1`),await Dm(e,Qp),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Em(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){let t=await this._withRetries(t=>nee(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Dm(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(e=>{let t=wm(e,!1).getAll();return new Cm(t).toPromise()});if(!e||this.pendingWrites!==0)return[];let t=[],n=new Set;if(e.length!==0)for(let{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(let e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;let n=this.listeners[e];if(n)for(let e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),ree)}stopPolling(){this.pollTimer&&=(clearInterval(this.pollTimer),null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}};Om.type=`LOCAL`;var aee=Om;
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function km(e,t){return Ld(e,`POST`,`/v2/accounts/mfaSignIn:start`,Id(e,t))}function oee(e,t){return Ld(e,`POST`,`/v2/accounts/mfaSignIn:finalize`,Id(e,t))}function see(e,t){return Ld(e,`POST`,`/v2/accounts/mfaSignIn:finalize`,Id(e,t))}Kf(`rcb`),new Ad(3e4,6e4);
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Am=`recaptcha`;async function cee(e,t,n){if(!e._getRecaptchaConfig())try{await ep(e)}catch{console.log(`Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.`)}try{let r;if(r=typeof t==`string`?{phoneNumber:t}:t,`session`in r){let t=r.session;if(`phoneNumber`in r){Sd(t.type===`enroll`,e,`internal-error`);let i={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:`CLIENT_TYPE_WEB`}};return(await $f(e,i,`mfaSmsEnrollment`,async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Xf){Sd(n?.type===Am,e,`argument-error`);let r=await jm(e,t,n);return Jp(e,r)}return Jp(e,t)},`PHONE_PROVIDER`).catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}else{Sd(t.type===`signin`,e,`internal-error`);let i=r.multiFactorHint?.uid||r.multiFactorUid;Sd(i,e,`missing-multi-factor-info`);let a={mfaPendingCredential:t.credential,mfaEnrollmentId:i,phoneSignInInfo:{clientType:`CLIENT_TYPE_WEB`}};return(await $f(e,a,`mfaSmsSignIn`,async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Xf){Sd(n?.type===Am,e,`argument-error`);let r=await jm(e,t,n);return km(e,r)}return km(e,t)},`PHONE_PROVIDER`).catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}else{let t={phoneNumber:r.phoneNumber,clientType:`CLIENT_TYPE_WEB`};return(await $f(e,t,`sendVerificationCode`,async(e,t)=>{if(t.captchaResponse===Xf){Sd(n?.type===Am,e,`argument-error`);let r=await jm(e,t,n);return _p(e,r)}return _p(e,t)},`PHONE_PROVIDER`).catch(e=>Promise.reject(e))).sessionInfo}}finally{n?._reset()}}async function jm(e,t,n){Sd(n.type===Am,e,`argument-error`);let r=await n.verify();Sd(typeof r==`string`,e,`argument-error`);let i={...t};if(`phoneEnrollmentInfo`in i){let e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,a=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:a}}),i}else if(`phoneSignInInfo`in i){let e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}else return Object.assign(i,{recaptchaToken:r}),i}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Mm=class e{constructor(t){this.providerId=e.PROVIDER_ID,this.auth=zf(t)}verifyPhoneNumber(e,t){return cee(this.auth,e,_l(t))}static credential(e,t){return Sp._fromVerification(e,t)}static credentialFromResult(t){let n=t;return e.credentialFromTaggedObject(n)}static credentialFromError(t){return e.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:t,temporaryProof:n}=e;return t&&n?Sp._fromTokenResponse(t,n):null}};Mm.PROVIDER_ID=`phone`,Mm.PHONE_SIGN_IN_METHOD=`phone`;
/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function Nm(e,t){return t?gf(t):(Sd(e._popupRedirectResolver,e,`argument-error`),e._popupRedirectResolver)}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Pm=class extends cp{constructor(e){super(`custom`,`custom`),this.params=e}_getIdTokenResponse(e){return mp(e,this._buildIdpRequest())}_linkToIdToken(e,t){return mp(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return mp(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function lee(e){return Bp(e.auth,new Pm(e),e.bypassAuthState)}function uee(e){let{auth:t,user:n}=e;return Sd(n,t,`internal-error`),zp(n,new Pm(e),e.bypassAuthState)}async function dee(e){let{auth:t,user:n}=e;return Sd(n,t,`internal-error`),Rp(n,new Pm(e),e.bypassAuthState)}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Fm=class{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}let s={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(s))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case`signInViaPopup`:case`signInViaRedirect`:return lee;case`linkViaPopup`:case`linkViaRedirect`:return dee;case`reauthViaPopup`:case`reauthViaRedirect`:return uee;default:gd(this.auth,`internal-error`)}}resolve(e){wd(this.pendingPromise,`Pending promise was never set`),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){wd(this.pendingPromise,`Pending promise was never set`),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}},fee=new Ad(2e3,1e4);async function pee(e,t,n){if(Bu(e.app))return Promise.reject(_d(e,`operation-not-supported-in-this-environment`));let r=zf(e);bd(e,t,Dp);let i=Nm(r,n);return new Im(r,`signInViaPopup`,t,i).executeNotNull()}var Im=class e extends Fm{constructor(t,n,r,i,a){super(t,n,i,a),this.provider=r,this.authWindow=null,this.pollId=null,e.currentPopupAction&&e.currentPopupAction.cancel(),e.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return Sd(e,this.auth,`internal-error`),e}async onExecution(){wd(this.filter.length===1,`Popup operations only handle one event`);let e=fm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(_d(this.auth,`web-storage-unsupported`))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(_d(this.auth,`cancelled-popup-request`))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,e.currentPopupAction=null}pollUserCancellation(){let e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_d(this.auth,`popup-closed-by-user`))},8e3);return}this.pollId=window.setTimeout(e,fee.get())};e()}};Im.currentPopupAction=null;
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var mee=`pendingRedirect`,Lm=new Map,hee=class extends Fm{constructor(e,t,n=!1){super(e,[`signInViaRedirect`,`linkViaRedirect`,`reauthViaRedirect`,`unknown`],t,void 0,n),this.eventId=null}async execute(){let e=Lm.get(this.auth._key());if(!e){try{let t=await gee(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Lm.set(this.auth._key(),e)}return this.bypassAuthState||Lm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type===`signInViaRedirect`)return super.onAuthEvent(e);if(e.type===`unknown`){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function gee(e,t){let n=yee(t),r=vee(e);if(!await r._isAvailable())return!1;let i=await r._get(n)===`true`;return await r._remove(n),i}function _ee(e,t){Lm.set(e._key(),t)}function vee(e){return gf(e._redirectPersistence)}function yee(e){return yf(mee,e.config.apiKey,e.name)}async function bee(e,t,n=!1){if(Bu(e.app))return Promise.reject(yd(e));let r=zf(e),i=Nm(r,t),a=await new hee(r,i,n).execute();return a&&!n&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,t)),a}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var xee=600*1e3,See=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Cee(e)?t:(this.hasHandledPotentialRedirect=!0,t||=(this.queuedRedirectEvent=e,!0),t)}sendToConsumer(e,t){if(e.error&&!zm(e)){let n=e.error.code?.split(`auth/`)[1]||`internal-error`;t.onError(_d(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=xee&&this.cachedEventUids.clear(),this.cachedEventUids.has(Rm(e))}saveEventToCache(e){this.cachedEventUids.add(Rm(e)),this.lastProcessedEventTime=Date.now()}};function Rm(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join(`-`)}function zm({type:e,error:t}){return e===`unknown`&&t?.code===`auth/no-auth-event`}function Cee(e){switch(e.type){case`signInViaRedirect`:case`linkViaRedirect`:case`reauthViaRedirect`:return!0;case`unknown`:return zm(e);default:return!1}}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function wee(e,t={}){return Ld(e,`GET`,`/v1/projects`,t)}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Tee=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Eee=/^https?/;async function Dee(e){if(e.config.emulator)return;let{authorizedDomains:t}=await wee(e);for(let e of t)try{if(Oee(e))return}catch{}gd(e,`unauthorized-domain`)}function Oee(e){let t=Td(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith(`chrome-extension://`)){let i=new URL(e);return i.hostname===``&&r===``?n===`chrome-extension:`&&e.replace(`chrome-extension://`,``)===t.replace(`chrome-extension://`,``):n===`chrome-extension:`&&i.hostname===r}if(!Eee.test(n))return!1;if(Tee.test(e))return r===e;let i=e.replace(/\./g,`\\.`);return RegExp(`^(.+\\.`+i+`|`+i+`)$`,`i`).test(r)}
/**
* @license
* Copyright 2020 Google LLC.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var kee=new Ad(3e4,6e4);function Bm(){let e=mm().___jsl;if(e?.H){for(let t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}}function Aee(e){return new Promise((t,n)=>{function r(){Bm(),gapi.load(`gapi.iframes`,{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Bm(),n(_d(e,`network-request-failed`))},timeout:kee.get()})}if(mm().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(mm().gapi?.load)r();else{let t=Kf(`iframefcb`);return mm()[t]=()=>{gapi.load?r():n(_d(e,`network-request-failed`))},Uf(`${Gf()}?onload=${t}`).catch(e=>n(e))}}).catch(e=>{throw Vm=null,e})}var Vm=null;function jee(e){return Vm||=Aee(e),Vm}
/**
* @license
* Copyright 2020 Google LLC.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Mee=new Ad(5e3,15e3),Nee=`__/auth/iframe`,Pee=`emulator/auth/iframe`,Fee={style:{position:`absolute`,top:`-100px`,width:`1px`,height:`1px`},"aria-hidden":`true`,tabindex:`-1`},Iee=new Map([[`identitytoolkit.googleapis.com`,`p`],[`staging-identitytoolkit.sandbox.googleapis.com`,`s`],[`test-identitytoolkit.sandbox.googleapis.com`,`t`]]);function Lee(e){let t=e.config;Sd(t.authDomain,e,`auth-domain-config-required`);let n=t.emulator?jd(t,Pee):`https://${e.config.authDomain}/${Nee}`,r={apiKey:t.apiKey,appName:e.name,v:Uu},i=Iee.get(e.config.apiHost);i&&(r.eid=i);let a=e._getFrameworks();return a.length&&(r.fw=a.join(`,`)),`${n}?${al(r).slice(1)}`}async function Ree(e){let t=await jee(e),n=mm().gapi;return Sd(n,e,`internal-error`),t.open({where:document.body,url:Lee(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Fee,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});let i=_d(e,`network-request-failed`),a=mm().setTimeout(()=>{r(i)},Mee.get());function o(){mm().clearTimeout(a),n(t)}t.ping(o).then(o,()=>{r(i)})}))}
/**
* @license
* Copyright 2020 Google LLC.
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var zee={location:`yes`,resizable:`yes`,statusbar:`yes`,toolbar:`no`},Bee=500,Vee=600,Hee=`_blank`,Uee=`http://localhost`,Hm=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function Wee(e,t,n,r=Bee,i=Vee){let a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),s=``,c={...zee,width:r.toString(),height:i.toString(),top:a,left:o},l=Bc().toLowerCase();n&&(s=wf(l)?Hee:n),Sf(l)&&(t||=Uee,c.scrollbars=`yes`);let u=Object.entries(c).reduce((e,[t,n])=>`${e}${t}=${n},`,``);if(Af(l)&&s!==`_self`)return Gee(t||``,s),new Hm(null);let d=window.open(t||``,s,u);Sd(d,e,`popup-blocked`);try{d.focus()}catch{}return new Hm(d)}function Gee(e,t){let n=document.createElement(`a`);n.href=e,n.target=t;let r=document.createEvent(`MouseEvent`);r.initMouseEvent(`click`,!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}
/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Kee=`__/auth/handler`,qee=`emulator/auth/handler`,Jee=`fac`;async function Um(e,t,n,r,i,a){Sd(e.config.authDomain,e,`auth-domain-config-required`),Sd(e.config.apiKey,e,`invalid-api-key`);let o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Uu,eventId:i};if(t instanceof Dp){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||``,nl(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(let[e,t]of Object.entries(a||{}))o[e]=t}if(t instanceof Op){let e=t.getScopes().filter(e=>e!==``);e.length>0&&(o.scopes=e.join(`,`))}e.tenantId&&(o.tid=e.tenantId);let s=o;for(let e of Object.keys(s))s[e]===void 0&&delete s[e];let c=await e._getAppCheckToken(),l=c?`#${Jee}=${encodeURIComponent(c)}`:``;return`${Yee(e)}?${al(s).slice(1)}${l}`}function Yee({config:e}){return e.emulator?jd(e,qee):`https://${e.authDomain}/${Kee}`}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Wm=`webStorageSupport`,Xee=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=lm,this._completeRedirectFn=bee,this._overrideRedirectResult=_ee}async _openPopup(e,t,n,r){wd(this.eventManagers[e._key()]?.manager,`_initialize() not called before _openPopup()`);let i=await Um(e,t,n,Td(),r);return Wee(e,i,fm())}async _openRedirect(e,t,n,r){await this._originValidation(e);let i=await Um(e,t,n,Td(),r);return hm(i),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(wd(n,`If manager is not set, promise should be`),n)}let n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){let t=await Ree(e),n=new See(e);return t.register(`authEvent`,t=>(Sd(t?.authEvent,e,`invalid-auth-event`),{status:n.onEvent(t.authEvent)?`ACK`:`ERROR`}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Wm,{type:Wm},n=>{let r=n?.[0]?.[Wm];r!==void 0&&t(!!r),gd(e,`internal-error`)},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Dee(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Mf()||Cf()||kf()}},Gm=class{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case`enroll`:return this._finalizeEnroll(e,t.credential,n);case`signin`:return this._finalizeSignIn(e,t.credential);default:return Cd(`unexpected MultiFactorSessionType`)}}},Zee=class e extends Gm{constructor(e){super(`phone`),this.credential=e}static _fromCredential(t){return new e(t)}_finalizeEnroll(e,t,n){return Yp(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return oee(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},Qee=class{constructor(){}static assertion(e){return Zee._fromCredential(e)}};Qee.FACTOR_ID=`phone`;var $ee=class{static assertionForEnrollment(e,t){return Km._fromSecret(e,t)}static assertionForSignIn(e,t){return Km._fromEnrollmentId(e,t)}static async generateSecret(e){let t=e;Sd(t.user?.auth!==void 0,`internal-error`);let n=await Xp(t.user.auth,{idToken:t.credential,totpEnrollmentInfo:{}});return ete._fromStartTotpMfaEnrollmentResponse(n,t.user.auth)}};$ee.FACTOR_ID=`totp`;var Km=class e extends Gm{constructor(e,t,n){super(`totp`),this.otp=e,this.enrollmentId=t,this.secret=n}static _fromSecret(t,n){return new e(n,void 0,t)}static _fromEnrollmentId(t,n){return new e(n,t)}async _finalizeEnroll(e,t,n){return Sd(this.secret!==void 0,e,`argument-error`),Zp(e,{idToken:t,displayName:n,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){Sd(this.enrollmentId!==void 0&&this.otp!==void 0,e,`argument-error`);let n={verificationCode:this.otp};return see(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:n})}},ete=class e{constructor(e,t,n,r,i,a,o){this.sessionInfo=a,this.auth=o,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=n,this.codeIntervalSeconds=r,this.enrollmentCompletionDeadline=i}static _fromStartTotpMfaEnrollmentResponse(t,n){return new e(t.totpSessionInfo.sharedSecretKey,t.totpSessionInfo.hashingAlgorithm,t.totpSessionInfo.verificationCodeLength,t.totpSessionInfo.periodSec,new Date(t.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),t.totpSessionInfo.sessionInfo,n)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){let n=!1;return(qm(e)||qm(t))&&(n=!0),n&&(qm(e)&&(e=this.auth.currentUser?.email||`unknownuser`),qm(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}};function qm(e){return e===void 0||e?.length===0}var Jm=`@firebase/auth`,Ym=`1.11.0`,tte=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(t=>{e(t?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Sd(this.auth._initializationPromise,`dependent-sdk-initialized-before-auth`)}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function nte(e){switch(e){case`Node`:return`node`;case`ReactNative`:return`rn`;case`Worker`:return`webworker`;case`Cordova`:return`cordova`;case`WebExtension`:return`web-extension`;default:return}}function rte(e){Ru(new vl(`auth`,(t,{options:n})=>{let r=t.getProvider(`app`).getImmediate(),i=t.getProvider(`heartbeat`),a=t.getProvider(`app-check-internal`),{apiKey:o,authDomain:s}=r.options;Sd(o&&!o.includes(`:`),`invalid-api-key`,{appName:r.name});let c={apiKey:o,authDomain:s,clientPlatform:e,apiHost:`identitytoolkit.googleapis.com`,tokenApiHost:`securetoken.googleapis.com`,apiScheme:`https`,sdkClientVersion:Nf(e)},l=new Rf(r,i,a,c);return np(l,n),l},`PUBLIC`).setInstantiationMode(`EXPLICIT`).setInstanceCreatedCallback((e,t,n)=>{e.getProvider(`auth-internal`).initialize()})),Ru(new vl(`auth-internal`,e=>(e=>new tte(e))(zf(e.getProvider(`auth`).getImmediate())),`PRIVATE`).setInstantiationMode(`EXPLICIT`)),Ku(Jm,Ym,nte(e)),Ku(Jm,Ym,`esm2020`)}var ite=Ac(`authIdTokenMaxAge`)||300,Xm=null,ate=e=>async t=>{let n=t&&await t.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>ite)return;let i=n?.token;Xm!==i&&(Xm=i,await fetch(e,{method:i?`POST`:`DELETE`,headers:i?{Authorization:`Bearer ${i}`}:{}}))};function ote(e=Gu()){let t=zu(e,`auth`);if(t.isInitialized())return t.getImmediate();let n=tp(e,{popupRedirectResolver:Xee,persistence:[aee,rm,lm]}),r=Ac(`authTokenSyncURL`);if(r&&typeof isSecureContext==`boolean`&&isSecureContext){let e=new URL(r,location.origin);if(location.origin===e.origin){let t=ate(e.toString());Kp(n,t,()=>t(n.currentUser)),Gp(n,e=>t(e))}}let i=Dc(`auth`);return i&&rp(n,`http://${i}`),n}function ste(){return document.getElementsByTagName(`head`)?.[0]??document}Hf({loadJS(e){return new Promise((t,n)=>{let r=document.createElement(`script`);r.setAttribute(`src`,e),r.onload=t,r.onerror=e=>{let t=_d(`internal-error`);t.customData=e,n(t)},r.type=`text/javascript`,r.charset=`UTF-8`,ste().appendChild(r)})},gapiScript:`https://apis.google.com/js/api.js`,recaptchaV2Script:`https://www.google.com/recaptcha/api.js`,recaptchaEnterpriseScript:`https://www.google.com/recaptcha/enterprise.js?render=`}),rte(`Browser`);var cte=o((e=>{var t=Symbol.for(`react.transitional.element`),n=Symbol.for(`react.portal`),r=Symbol.for(`react.fragment`),i=Symbol.for(`react.strict_mode`),a=Symbol.for(`react.profiler`),o=Symbol.for(`react.consumer`),s=Symbol.for(`react.context`),c=Symbol.for(`react.forward_ref`),l=Symbol.for(`react.suspense`),u=Symbol.for(`react.memo`),d=Symbol.for(`react.lazy`),f=Symbol.for(`react.activity`),p=Symbol.iterator;function m(e){return typeof e!=`object`||!e?null:(e=p&&e[p]||e[`@@iterator`],typeof e==`function`?e:null)}var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,_={};function v(e,t,n){this.props=e,this.context=t,this.refs=_,this.updater=n||h}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if(typeof e!=`object`&&typeof e!=`function`&&e!=null)throw Error(`takes an object of state variables to update or a function which returns an object of state variables.`);this.updater.enqueueSetState(this,e,t,`setState`)},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,`forceUpdate`)};function y(){}y.prototype=v.prototype;function b(e,t,n){this.props=e,this.context=t,this.refs=_,this.updater=n||h}var x=b.prototype=new y;x.constructor=b,g(x,v.prototype),x.isPureReactComponent=!0;var S=Array.isArray;function C(){}var w={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function E(e,n,r){var i=r.ref;return{$$typeof:t,type:e,key:n,ref:i===void 0?null:i,props:r}}function D(e,t){return E(e.type,t,e.props)}function O(e){return typeof e==`object`&&!!e&&e.$$typeof===t}function k(e){var t={"=":`=0`,":":`=2`};return`$`+e.replace(/[=:]/g,function(e){return t[e]})}var ee=/\/+/g;function te(e,t){return typeof e==`object`&&e&&e.key!=null?k(``+e.key):t.toString(36)}function ne(e){switch(e.status){case`fulfilled`:return e.value;case`rejected`:throw e.reason;default:switch(typeof e.status==`string`?e.then(C,C):(e.status=`pending`,e.then(function(t){e.status===`pending`&&(e.status=`fulfilled`,e.value=t)},function(t){e.status===`pending`&&(e.status=`rejected`,e.reason=t)})),e.status){case`fulfilled`:return e.value;case`rejected`:throw e.reason}}throw e}function A(e,r,i,a,o){var s=typeof e;(s===`undefined`||s===`boolean`)&&(e=null);var c=!1;if(e===null)c=!0;else switch(s){case`bigint`:case`string`:case`number`:c=!0;break;case`object`:switch(e.$$typeof){case t:case n:c=!0;break;case d:return c=e._init,A(c(e._payload),r,i,a,o)}}if(c)return o=o(e),c=a===``?`.`+te(e,0):a,S(o)?(i=``,c!=null&&(i=c.replace(ee,`$&/`)+`/`),A(o,r,i,``,function(e){return e})):o!=null&&(O(o)&&(o=D(o,i+(o.key==null||e&&e.key===o.key?``:(``+o.key).replace(ee,`$&/`)+`/`)+c)),r.push(o)),1;c=0;var l=a===``?`.`:a+`:`;if(S(e))for(var u=0;u<e.length;u++)a=e[u],s=l+te(a,u),c+=A(a,r,i,s,o);else if(u=m(e),typeof u==`function`)for(e=u.call(e),u=0;!(a=e.next()).done;)a=a.value,s=l+te(a,u++),c+=A(a,r,i,s,o);else if(s===`object`){if(typeof e.then==`function`)return A(ne(e),r,i,a,o);throw r=String(e),Error(`Objects are not valid as a React child (found: `+(r===`[object Object]`?`object with keys {`+Object.keys(e).join(`, `)+`}`:r)+`). If you meant to render a collection of children, use an array instead.`)}return c}function j(e,t,n){if(e==null)return e;var r=[],i=0;return A(e,r,``,``,function(e){return t.call(n,e,i++)}),r}function re(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(t){(e._status===0||e._status===-1)&&(e._status=1,e._result=t)},function(t){(e._status===0||e._status===-1)&&(e._status=2,e._result=t)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ie=typeof reportError==`function`?reportError:function(e){if(typeof window==`object`&&typeof window.ErrorEvent==`function`){var t=new window.ErrorEvent(`error`,{bubbles:!0,cancelable:!0,message:typeof e==`object`&&e&&typeof e.message==`string`?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process==`object`&&typeof process.emit==`function`){process.emit(`uncaughtException`,e);return}console.error(e)},ae={map:j,forEach:function(e,t,n){j(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return j(e,function(){t++}),t},toArray:function(e){return j(e,function(e){return e})||[]},only:function(e){if(!O(e))throw Error(`React.Children.only expected to receive a single React element child.`);return e}};e.Activity=f,e.Children=ae,e.Component=v,e.Fragment=r,e.Profiler=a,e.PureComponent=b,e.StrictMode=i,e.Suspense=l,e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=w,e.__COMPILER_RUNTIME={__proto__:null,c:function(e){return w.H.useMemoCache(e)}},e.cache=function(e){return function(){return e.apply(null,arguments)}},e.cacheSignal=function(){return null},e.cloneElement=function(e,t,n){if(e==null)throw Error(`The argument must be a React element, but you passed `+e+`.`);var r=g({},e.props),i=e.key;if(t!=null)for(a in t.key!==void 0&&(i=``+t.key),t)!T.call(t,a)||a===`key`||a===`__self`||a===`__source`||a===`ref`&&t.ref===void 0||(r[a]=t[a]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var o=Array(a),s=0;s<a;s++)o[s]=arguments[s+2];r.children=o}return E(e.type,i,r)},e.createContext=function(e){return e={$$typeof:s,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider=e,e.Consumer={$$typeof:o,_context:e},e},e.createElement=function(e,t,n){var r,i={},a=null;if(t!=null)for(r in t.key!==void 0&&(a=``+t.key),t)T.call(t,r)&&r!==`key`&&r!==`__self`&&r!==`__source`&&(i[r]=t[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var s=Array(o),c=0;c<o;c++)s[c]=arguments[c+2];i.children=s}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return E(e,a,i)},e.createRef=function(){return{current:null}},e.forwardRef=function(e){return{$$typeof:c,render:e}},e.isValidElement=O,e.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:re}},e.memo=function(e,t){return{$$typeof:u,type:e,compare:t===void 0?null:t}},e.startTransition=function(e){var t=w.T,n={};w.T=n;try{var r=e(),i=w.S;i!==null&&i(n,r),typeof r==`object`&&r&&typeof r.then==`function`&&r.then(C,ie)}catch(e){ie(e)}finally{t!==null&&n.types!==null&&(t.types=n.types),w.T=t}},e.unstable_useCacheRefresh=function(){return w.H.useCacheRefresh()},e.use=function(e){return w.H.use(e)},e.useActionState=function(e,t,n){return w.H.useActionState(e,t,n)},e.useCallback=function(e,t){return w.H.useCallback(e,t)},e.useContext=function(e){return w.H.useContext(e)},e.useDebugValue=function(){},e.useDeferredValue=function(e,t){return w.H.useDeferredValue(e,t)},e.useEffect=function(e,t){return w.H.useEffect(e,t)},e.useEffectEvent=function(e){return w.H.useEffectEvent(e)},e.useId=function(){return w.H.useId()},e.useImperativeHandle=function(e,t,n){return w.H.useImperativeHandle(e,t,n)},e.useInsertionEffect=function(e,t){return w.H.useInsertionEffect(e,t)},e.useLayoutEffect=function(e,t){return w.H.useLayoutEffect(e,t)},e.useMemo=function(e,t){return w.H.useMemo(e,t)},e.useOptimistic=function(e,t){return w.H.useOptimistic(e,t)},e.useReducer=function(e,t,n){return w.H.useReducer(e,t,n)},e.useRef=function(e){return w.H.useRef(e)},e.useState=function(e){return w.H.useState(e)},e.useSyncExternalStore=function(e,t,n){return w.H.useSyncExternalStore(e,t,n)},e.useTransition=function(){return w.H.useTransition()},e.version=`19.2.0`})),Zm=o(((e,t)=>{t.exports=cte()})),N=l(Zm());
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
Ku(`firebase`,`12.4.0`,`app`);var Qm=typeof globalThis<`u`?globalThis:typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:{},$m={},eh,th;(function(){var e;function t(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(r,n),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(e,t,n){n||=0;let r=Array(16);if(typeof t==`string`)for(var i=0;i<16;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;i<16;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];let a=e.g[3],o;o=t+(a^n&(i^a))+r[0]+3614090360&4294967295,t=n+(o<<7&4294967295|o>>>25),o=a+(i^t&(n^i))+r[1]+3905402710&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[2]+606105819&4294967295,i=a+(o<<17&4294967295|o>>>15),o=n+(t^i&(a^t))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(a^n&(i^a))+r[4]+4118548399&4294967295,t=n+(o<<7&4294967295|o>>>25),o=a+(i^t&(n^i))+r[5]+1200080426&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[6]+2821735955&4294967295,i=a+(o<<17&4294967295|o>>>15),o=n+(t^i&(a^t))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(a^n&(i^a))+r[8]+1770035416&4294967295,t=n+(o<<7&4294967295|o>>>25),o=a+(i^t&(n^i))+r[9]+2336552879&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[10]+4294925233&4294967295,i=a+(o<<17&4294967295|o>>>15),o=n+(t^i&(a^t))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(a^n&(i^a))+r[12]+1804603682&4294967295,t=n+(o<<7&4294967295|o>>>25),o=a+(i^t&(n^i))+r[13]+4254626195&4294967295,a=t+(o<<12&4294967295|o>>>20),o=i+(n^a&(t^n))+r[14]+2792965006&4294967295,i=a+(o<<17&4294967295|o>>>15),o=n+(t^i&(a^t))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(i^a&(n^i))+r[1]+4129170786&4294967295,t=n+(o<<5&4294967295|o>>>27),o=a+(n^i&(t^n))+r[6]+3225465664&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[11]+643717713&4294967295,i=a+(o<<14&4294967295|o>>>18),o=n+(a^t&(i^a))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^a&(n^i))+r[5]+3593408605&4294967295,t=n+(o<<5&4294967295|o>>>27),o=a+(n^i&(t^n))+r[10]+38016083&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[15]+3634488961&4294967295,i=a+(o<<14&4294967295|o>>>18),o=n+(a^t&(i^a))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^a&(n^i))+r[9]+568446438&4294967295,t=n+(o<<5&4294967295|o>>>27),o=a+(n^i&(t^n))+r[14]+3275163606&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[3]+4107603335&4294967295,i=a+(o<<14&4294967295|o>>>18),o=n+(a^t&(i^a))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^a&(n^i))+r[13]+2850285829&4294967295,t=n+(o<<5&4294967295|o>>>27),o=a+(n^i&(t^n))+r[2]+4243563512&4294967295,a=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(a^t))+r[7]+1735328473&4294967295,i=a+(o<<14&4294967295|o>>>18),o=n+(a^t&(i^a))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(n^i^a)+r[5]+4294588738&4294967295,t=n+(o<<4&4294967295|o>>>28),o=a+(t^n^i)+r[8]+2272392833&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[11]+1839030562&4294967295,i=a+(o<<16&4294967295|o>>>16),o=n+(i^a^t)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(n^i^a)+r[1]+2763975236&4294967295,t=n+(o<<4&4294967295|o>>>28),o=a+(t^n^i)+r[4]+1272893353&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[7]+4139469664&4294967295,i=a+(o<<16&4294967295|o>>>16),o=n+(i^a^t)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(n^i^a)+r[13]+681279174&4294967295,t=n+(o<<4&4294967295|o>>>28),o=a+(t^n^i)+r[0]+3936430074&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[3]+3572445317&4294967295,i=a+(o<<16&4294967295|o>>>16),o=n+(i^a^t)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(n^i^a)+r[9]+3654602809&4294967295,t=n+(o<<4&4294967295|o>>>28),o=a+(t^n^i)+r[12]+3873151461&4294967295,a=t+(o<<11&4294967295|o>>>21),o=i+(a^t^n)+r[15]+530742520&4294967295,i=a+(o<<16&4294967295|o>>>16),o=n+(i^a^t)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(i^(n|~a))+r[0]+4096336452&4294967295,t=n+(o<<6&4294967295|o>>>26),o=a+(n^(t|~i))+r[7]+1126891415&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[14]+2878612391&4294967295,i=a+(o<<15&4294967295|o>>>17),o=n+(a^(i|~t))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~a))+r[12]+1700485571&4294967295,t=n+(o<<6&4294967295|o>>>26),o=a+(n^(t|~i))+r[3]+2399980690&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[10]+4293915773&4294967295,i=a+(o<<15&4294967295|o>>>17),o=n+(a^(i|~t))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~a))+r[8]+1873313359&4294967295,t=n+(o<<6&4294967295|o>>>26),o=a+(n^(t|~i))+r[15]+4264355552&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[6]+2734768916&4294967295,i=a+(o<<15&4294967295|o>>>17),o=n+(a^(i|~t))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~a))+r[4]+4149444226&4294967295,t=n+(o<<6&4294967295|o>>>26),o=a+(n^(t|~i))+r[11]+3174756917&4294967295,a=t+(o<<10&4294967295|o>>>22),o=i+(t^(a|~n))+r[2]+718787259&4294967295,i=a+(o<<15&4294967295|o>>>17),o=n+(a^(i|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+a&4294967295}r.prototype.v=function(e,t){t===void 0&&(t=e.length);let n=t-this.blockSize,r=this.C,a=this.h,o=0;for(;o<t;){if(a==0)for(;o<=n;)i(this,e,o),o+=this.blockSize;if(typeof e==`string`){for(;o<t;)if(r[a++]=e.charCodeAt(o++),a==this.blockSize){i(this,r),a=0;break}}else for(;o<t;)if(r[a++]=e[o++],a==this.blockSize){i(this,r),a=0;break}}this.h=a,this.o+=t},r.prototype.A=function(){var e=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=this.o*8;for(var n=e.length-8;n<e.length;++n)e[n]=t&255,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};function a(e,t){var n=s;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}function o(e,t){this.h=t;let n=[],r=!0;for(let i=e.length-1;i>=0;i--){let a=e[i]|0;r&&a==t||(n[i]=a,r=!1)}this.g=n}var s={};function c(e){return-128<=e&&e<128?a(e,function(e){return new o([e|0],e<0?-1:0)}):new o([e|0],e<0?-1:0)}function l(e){if(isNaN(e)||!isFinite(e))return d;if(e<0)return g(l(-e));let t=[],n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new o(t,0)}function u(e,t){if(e.length==0)throw Error(`number format error: empty string`);if(t||=10,t<2||36<t)throw Error(`radix out of range: `+t);if(e.charAt(0)==`-`)return g(u(e.substring(1),t));if(e.indexOf(`-`)>=0)throw Error(`number format error: interior "-" character`);let n=l(t**8),r=d;for(let a=0;a<e.length;a+=8){var i=Math.min(8,e.length-a);let o=parseInt(e.substring(a,a+i),t);i<8?(i=l(t**+i),r=r.j(i).add(l(o))):(r=r.j(n),r=r.add(l(o)))}return r}var d=c(0),f=c(1),p=c(16777216);e=o.prototype,e.m=function(){if(h(this))return-g(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){let r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(e||=10,e<2||36<e)throw Error(`radix out of range: `+e);if(m(this))return`0`;if(h(this))return`-`+g(this).toString(e);let t=l(e**6);var n=this;let r=``;for(;;){let i=b(n,t).g;n=_(n,i.j(t));let a=((n.g.length>0?n.g[0]:n.h)>>>0).toString(e);if(n=i,m(n))return a+r;for(;a.length<6;)a=`0`+a;r=a+r}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h};function m(e){if(e.h!=0)return!1;for(let t=0;t<e.g.length;t++)if(e.g[t]!=0)return!1;return!0}function h(e){return e.h==-1}e.l=function(e){return e=_(this,e),h(e)?-1:m(e)?0:1};function g(e){let t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new o(n,~e.h).add(f)}e.abs=function(){return h(this)?g(this):this},e.add=function(e){let t=Math.max(this.g.length,e.g.length),n=[],r=0;for(let i=0;i<=t;i++){let t=r+(this.i(i)&65535)+(e.i(i)&65535),a=(t>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);r=a>>>16,t&=65535,a&=65535,n[i]=a<<16|t}return new o(n,n[n.length-1]&-2147483648?-1:0)};function _(e,t){return e.add(g(t))}e.j=function(e){if(m(this)||m(e))return d;if(h(this))return h(e)?g(this).j(g(e)):g(g(this).j(e));if(h(e))return g(this.j(g(e)));if(this.l(p)<0&&e.l(p)<0)return l(this.m()*e.m());let t=this.g.length+e.g.length,n=[];for(var r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(let t=0;t<e.g.length;t++){let i=this.i(r)>>>16,a=this.i(r)&65535,o=e.i(t)>>>16,s=e.i(t)&65535;n[2*r+2*t]+=a*s,v(n,2*r+2*t),n[2*r+2*t+1]+=i*s,v(n,2*r+2*t+1),n[2*r+2*t+1]+=a*o,v(n,2*r+2*t+1),n[2*r+2*t+2]+=i*o,v(n,2*r+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new o(n,0)};function v(e,t){for(;(e[t]&65535)!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function y(e,t){this.g=e,this.h=t}function b(e,t){if(m(t))throw Error(`division by zero`);if(m(e))return new y(d,d);if(h(e))return t=b(g(e),t),new y(g(t.g),g(t.h));if(h(t))return t=b(e,g(t)),new y(g(t.g),t.h);if(e.g.length>30){if(h(e)||h(t))throw Error(`slowDivide_ only works with positive integers.`);for(var n=f,r=t;r.l(e)<=0;)n=x(n),r=x(r);var i=S(n,1),a=S(r,1);for(r=S(r,2),n=S(n,2);!m(r);){var o=a.add(r);o.l(e)<=0&&(i=i.add(n),a=o),r=S(r,1),n=S(n,1)}return t=_(e,i.j(t)),new y(i,t)}for(i=d;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=Math.ceil(Math.log(n)/Math.LN2),r=r<=48?1:2**(r-48),a=l(n),o=a.j(t);h(o)||o.l(e)>0;)n-=r,a=l(n),o=a.j(t);m(a)&&(a=f),i=i.add(a),e=_(e,o)}return new y(i,e)}e.B=function(e){return b(this,e).h},e.and=function(e){let t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new o(n,this.h&e.h)},e.or=function(e){let t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new o(n,this.h|e.h)},e.xor=function(e){let t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new o(n,this.h^e.h)};function x(e){let t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new o(n,e.h)}function S(e,t){let n=t>>5;t%=32;let r=e.g.length-n,i=[];for(let a=0;a<r;a++)i[a]=t>0?e.i(a+n)>>>t|e.i(a+n+1)<<32-t:e.i(a+n);return new o(i,e.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,th=$m.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=u,eh=$m.Integer=o}).apply(Qm===void 0?typeof self<`u`?self:typeof window<`u`?window:{}:Qm);var nh=typeof globalThis<`u`?globalThis:typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:{},rh={},ih,ah,oh,sh,ch,lh,uh,dh;(function(){var e,t=Object.defineProperty;function n(e){e=[typeof globalThis==`object`&&globalThis,e,typeof window==`object`&&window,typeof self==`object`&&self,typeof nh==`object`&&nh];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error(`Cannot find global object`)}var r=n(this);function i(e,n){if(n)a:{var i=r;e=e.split(`.`);for(var a=0;a<e.length-1;a++){var o=e[a];if(!(o in i))break a;i=i[o]}e=e[e.length-1],a=i[e],n=n(a),n!=a&&n!=null&&t(i,e,{configurable:!0,writable:!0,value:n})}}i(`Symbol.dispose`,function(e){return e||Symbol(`Symbol.dispose`)}),i(`Array.prototype.values`,function(e){return e||function(){return this[Symbol.iterator]()}}),i(`Object.entries`,function(e){return e||function(e){var t=[],n;for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push([n,e[n]]);return t}});var a=a||{},o=this||self;function s(e){var t=typeof e;return t==`object`&&e!=null||t==`function`}function c(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){return l=c,l.apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function d(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var i=Array(arguments.length-2),a=2;a<arguments.length;a++)i[a-2]=arguments[a];return t.prototype[n].apply(e,i)}}var f=typeof AsyncContext<`u`&&typeof AsyncContext.Snapshot==`function`?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function p(e){let t=e.length;if(t>0){let n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function m(e,t){for(let t=1;t<arguments.length;t++){let r=arguments[t];var n=typeof r;if(n=n==`object`?r?Array.isArray(r)?`array`:n:`null`:n,n==`array`||n==`object`&&typeof r.length==`number`){n=e.length||0;let t=r.length||0;e.length=n+t;for(let i=0;i<t;i++)e[n+i]=r[i]}else e.push(r)}}class h{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function g(e){o.setTimeout(()=>{throw e},0)}function _(){var e=C;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}class v{constructor(){this.h=this.g=null}add(e,t){let n=y.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}var y=new h(()=>new b,e=>e.reset());class b{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let x,S=!1,C=new v,w=()=>{let e=Promise.resolve(void 0);x=()=>{e.then(T)}};function T(){for(var e;e=_();){try{e.h.call(e.g)}catch(e){g(e)}var t=y;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}S=!1}function E(){this.u=this.u,this.C=this.C}E.prototype.u=!1,E.prototype.dispose=function(){this.u||(this.u=!0,this.N())},E.prototype[Symbol.dispose]=function(){this.dispose()},E.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function D(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}D.prototype.h=function(){this.defaultPrevented=!0};var O=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},`passive`,{get:function(){e=!0}});try{let e=()=>{};o.addEventListener(`test`,e,t),o.removeEventListener(`test`,e,t)}catch{}return e}();function k(e){return/^[\s\xa0]*$/.test(e)}function ee(e,t){D.call(this,e?e.type:``),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key=``,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType=``,this.i=null,e&&this.init(e,t)}d(ee,D),ee.prototype.init=function(e,t){let n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget,t||(n==`mouseover`?t=e.fromElement:n==`mouseout`&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=r.clientX===void 0?r.pageX:r.clientX,this.clientY=r.clientY===void 0?r.pageY:r.clientY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=e.clientX===void 0?e.pageX:e.clientX,this.clientY=e.clientY===void 0?e.pageY:e.clientY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||``,this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&ee.Z.h.call(this)},ee.prototype.h=function(){ee.Z.h.call(this);let e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var te=`closure_listenable_`+(Math.random()*1e6|0),ne=0;function A(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++ne,this.da=this.fa=!1}function j(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function re(e,t,n){for(let r in e)t.call(n,e[r],r,e)}function ie(e,t){for(let n in e)t.call(void 0,e[n],n,e)}function ae(e){let t={};for(let n in e)t[n]=e[n];return t}let oe=`constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf`.split(` `);function se(e,t){let n,r;for(let t=1;t<arguments.length;t++){for(n in r=arguments[t],r)e[n]=r[n];for(let t=0;t<oe.length;t++)n=oe[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function ce(e){this.src=e,this.g={},this.h=0}ce.prototype.add=function(e,t,n,r,i){let a=e.toString();e=this.g[a],e||(e=this.g[a]=[],this.h++);let o=ue(e,t,r,i);return o>-1?(t=e[o],n||(t.fa=!1)):(t=new A(t,this.src,a,!!r,i),t.fa=n,e.push(t)),t};function le(e,t){let n=t.type;if(n in e.g){var r=e.g[n],i=Array.prototype.indexOf.call(r,t,void 0),a;(a=i>=0)&&Array.prototype.splice.call(r,i,1),a&&(j(t),e.g[n].length==0&&(delete e.g[n],e.h--))}}function ue(e,t,n,r){for(let i=0;i<e.length;++i){let a=e[i];if(!a.da&&a.listener==t&&a.capture==!!n&&a.ha==r)return i}return-1}var de=`closure_lm_`+(Math.random()*1e6|0),fe={};function pe(e,t,n,r,i){if(r&&r.once)return ge(e,t,n,r,i);if(Array.isArray(t)){for(let a=0;a<t.length;a++)pe(e,t[a],n,r,i);return null}return n=Ce(n),e&&e[te]?e.J(t,n,s(r)?!!r.capture:!!r,i):me(e,t,n,!1,r,i)}function me(e,t,n,r,i,a){if(!t)throw Error(`Invalid event type`);let o=s(i)?!!i.capture:!!i,c=xe(e);if(c||(e[de]=c=new ce(e)),n=c.add(t,n,r,o,a),n.proxy)return n;if(r=he(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)O||(i=o),i===void 0&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(ye(t.toString()),r);else if(e.addListener&&e.removeListener)e.addListener(r);else throw Error(`addEventListener and attachEvent are unavailable.`);return n}function he(){function e(n){return t.call(e.src,e.listener,n)}let t=be;return e}function ge(e,t,n,r,i){if(Array.isArray(t)){for(let a=0;a<t.length;a++)ge(e,t[a],n,r,i);return null}return n=Ce(n),e&&e[te]?e.K(t,n,s(r)?!!r.capture:!!r,i):me(e,t,n,!0,r,i)}function _e(e,t,n,r,i){if(Array.isArray(t))for(var a=0;a<t.length;a++)_e(e,t[a],n,r,i);else r=s(r)?!!r.capture:!!r,n=Ce(n),e&&e[te]?(e=e.i,a=String(t).toString(),a in e.g&&(t=e.g[a],n=ue(t,n,r,i),n>-1&&(j(t[n]),Array.prototype.splice.call(t,n,1),t.length==0&&(delete e.g[a],e.h--)))):(e&&=xe(e))&&(t=e.g[t.toString()],e=-1,t&&(e=ue(t,n,r,i)),(n=e>-1?t[e]:null)&&ve(n))}function ve(e){if(typeof e!=`number`&&e&&!e.da){var t=e.src;if(t&&t[te])le(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(ye(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=xe(t))?(le(n,e),n.h==0&&(n.src=null,t[de]=null)):j(e)}}}function ye(e){return e in fe?fe[e]:fe[e]=`on`+e}function be(e,t){if(e.da)e=!0;else{t=new ee(t,this);let n=e.listener,r=e.ha||e.src;e.fa&&ve(e),e=n.call(r,t)}return e}function xe(e){return e=e[de],e instanceof ce?e:null}var Se=`__closure_events_fn_`+(Math.random()*1e9>>>0);function Ce(e){return typeof e==`function`?e:(e[Se]||(e[Se]=function(t){return e.handleEvent(t)}),e[Se])}function we(){E.call(this),this.i=new ce(this),this.M=this,this.G=null}d(we,E),we.prototype[te]=!0,we.prototype.removeEventListener=function(e,t,n,r){_e(this,e,t,n,r)};function Te(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,typeof t==`string`)t=new D(t,e);else if(t instanceof D)t.target=t.target||e;else{var i=t;t=new D(r,e),se(t,i)}i=!0;let a,o;if(n)for(o=n.length-1;o>=0;o--)a=t.g=n[o],i=Ee(a,r,!0,t)&&i;if(a=t.g=e,i=Ee(a,r,!0,t)&&i,i=Ee(a,r,!1,t)&&i,n)for(o=0;o<n.length;o++)a=t.g=n[o],i=Ee(a,r,!1,t)&&i}we.prototype.N=function(){if(we.Z.N.call(this),this.i){var e=this.i;for(let t in e.g){let n=e.g[t];for(let e=0;e<n.length;e++)j(n[e]);delete e.g[t],e.h--}}this.G=null},we.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},we.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};function Ee(e,t,n,r){if(t=e.i.g[String(t)],!t)return!0;t=t.concat();let i=!0;for(let a=0;a<t.length;++a){let o=t[a];if(o&&!o.da&&o.capture==n){let t=o.listener,n=o.ha||o.src;o.fa&&le(e.i,o),i=t.call(n,r)!==!1&&i}}return i&&!r.defaultPrevented}function De(e,t){if(typeof e!=`function`)if(e&&typeof e.handleEvent==`function`)e=l(e.handleEvent,e);else throw Error(`Invalid listener argument`);return Number(t)>2147483647?-1:o.setTimeout(e,t||0)}function Oe(e){e.g=De(()=>{e.g=null,e.i&&(e.i=!1,Oe(e))},e.l);let t=e.h;e.h=null,e.m.apply(null,t)}class ke extends E{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:Oe(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ae(e){E.call(this),this.h=e,this.g={}}d(Ae,E);var je=[];function Me(e){re(e.g,function(e,t){this.g.hasOwnProperty(t)&&ve(e)},e),e.g={}}Ae.prototype.N=function(){Ae.Z.N.call(this),Me(this)},Ae.prototype.handleEvent=function(){throw Error(`EventHandler.handleEvent not implemented`)};var Ne=o.JSON.stringify,Pe=o.JSON.parse,Fe=class{stringify(e){return o.JSON.stringify(e,void 0)}parse(e){return o.JSON.parse(e,void 0)}};function Ie(){}function Le(){}var Re={OPEN:`a`,hb:`b`,ERROR:`c`,tb:`d`};function ze(){D.call(this,`d`)}d(ze,D);function Be(){D.call(this,`c`)}d(Be,D);var Ve={},He=null;function Ue(){return He||=new we}Ve.Ia=`serverreachability`;function We(e){D.call(this,Ve.Ia,e)}d(We,D);function Ge(e){let t=Ue();Te(t,new We(t))}Ve.STAT_EVENT=`statevent`;function Ke(e,t){D.call(this,Ve.STAT_EVENT,e),this.stat=t}d(Ke,D);function qe(e){let t=Ue();Te(t,new Ke(t,e))}Ve.Ja=`timingevent`;function Je(e,t){D.call(this,Ve.Ja,e),this.size=t}d(Je,D);function Ye(e,t){if(typeof e!=`function`)throw Error(`Fn must not be null and must be a function`);return o.setTimeout(function(){e()},t)}function Xe(){this.g=!0}Xe.prototype.ua=function(){this.g=!1};function Ze(e,t,n,r,i,a){e.info(function(){if(e.g)if(a){var o=``,s=a.split(`&`);for(let e=0;e<s.length;e++){var c=s[e].split(`=`);if(c.length>1){let e=c[0];c=c[1];let t=e.split(`_`);o=t.length>=2&&t[1]==`type`?o+(e+`=`+c+`&`):o+(e+`=redacted&`)}}}else o=null;else o=a;return`XMLHTTP REQ (`+r+`) [attempt `+i+`]: `+t+`
`+n+`
`+o})}function Qe(e,t,n,r,i,a,o){e.info(function(){return`XMLHTTP RESP (`+r+`) [ attempt `+i+`]: `+t+`
`+n+`
`+a+` `+o})}function $e(e,t,n,r){e.info(function(){return`XMLHTTP TEXT (`+t+`): `+tt(e,n)+(r?` `+r:``)})}function et(e,t){e.info(function(){return`TIMEOUT: `+t})}Xe.prototype.info=function(){};function tt(e,t){if(!e.g)return t;if(!t)return null;try{let a=JSON.parse(t);if(a){for(e=0;e<a.length;e++)if(Array.isArray(a[e])){var n=a[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var i=r[0];if(i!=`noop`&&i!=`stop`&&i!=`close`)for(let e=1;e<r.length;e++)r[e]=``}}}}return Ne(a)}catch{return t}}var nt={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},rt={ib:`complete`,Fb:`success`,ERROR:`error`,Ga:`abort`,xb:`ready`,yb:`readystatechange`,TIMEOUT:`timeout`,sb:`incrementaldata`,wb:`progress`,lb:`downloadprogress`,Nb:`uploadprogress`},it;function at(){}d(at,Ie),at.prototype.g=function(){return new XMLHttpRequest},it=new at;function ot(e){return encodeURIComponent(String(e))}function st(e){var t=1;e=e.split(`:`);let n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(`:`)),n}function ct(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new Ae(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new lt}function lt(){this.i=null,this.g=``,this.h=!1}var ut={},dt={};function ft(e,t,n){e.M=1,e.A=zt(Pt(t)),e.u=n,e.R=!0,pt(e,null)}function pt(e,t){e.F=Date.now(),_t(e),e.B=Pt(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),$t(n.i,`t`,r),e.C=0,n=e.j.L,e.h=new lt,e.g=Wn(e.j,n?t:null,!e.u),e.P>0&&(e.O=new ke(l(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var i=`readystatechange`;Array.isArray(i)||(i&&(je[0]=i.toString()),i=je);for(let e=0;e<i.length;e++){let a=pe(n,i[e],r||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}t=e.J?ae(e.J):{},e.u?(e.v||=`POST`,t[`Content-Type`]=`application/x-www-form-urlencoded`,e.g.ea(e.B,e.v,e.u,t)):(e.v=`GET`,e.g.ea(e.B,e.v,null,t)),Ge(),Ze(e.i,e.v,e.B,e.l,e.S,e.u)}ct.prototype.ba=function(e){e=e.target;let t=this.O;t&&Sn(e)==3?t.j():this.Y(e)},ct.prototype.Y=function(e){try{if(e==this.g)a:{let s=Sn(this.g),c=this.g.ya(),l=this.g.ca();if(!(s<3)&&(s!=3||this.g&&(this.h.h||this.g.la()||Cn(this.g)))){this.K||s!=4||c==7||Ge(c==8||l<=0?3:2),yt(this);var t=this.g.ca();this.X=t;var n=mt(this);if(this.o=t==200,Qe(this.i,this.v,this.B,this.l,this.S,s,t),this.o){if(this.U&&!this.L){b:{if(this.g){var r,i=this.g;if((r=i.g?i.g.getResponseHeader(`X-HTTP-Initial-Response`):null)&&!k(r)){var a=r;break b}}a=null}if(e=a)$e(this.i,this.l,e,`Initial handshake response via X-HTTP-Initial-Response`),this.L=!0,St(this,e);else{this.o=!1,this.m=3,qe(12),xt(this),bt(this);break a}}if(this.R){e=!0;let t;for(;!this.K&&this.C<n.length;)if(t=gt(this,n),t==dt){s==4&&(this.m=4,qe(14),e=!1),$e(this.i,this.l,null,`[Incomplete Response]`);break}else if(t==ut){this.m=4,qe(15),$e(this.i,this.l,n,`[Invalid Chunk]`),e=!1;break}else $e(this.i,this.l,t,null),St(this,t);if(ht(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),s!=4||n.length!=0||this.h.h||(this.m=1,qe(16),e=!1),this.o=this.o&&e,!e)$e(this.i,this.l,n,`[Invalid Chunked Response]`),xt(this),bt(this);else if(n.length>0&&!this.W){this.W=!0;var o=this.j;o.g==this&&o.aa&&!o.P&&(o.j.info(`Great, no buffering proxy detected. Bytes received: `+n.length),In(o),o.P=!0,qe(11))}}else $e(this.i,this.l,n,null),St(this,n);s==4&&xt(this),this.o&&!this.K&&(s==4?zn(this.j,this):(this.o=!1,_t(this)))}else wn(this.g),t==400&&n.indexOf(`Unknown SID`)>0?(this.m=3,qe(12)):(this.m=0,qe(13)),xt(this),bt(this)}}}catch{}};function mt(e){if(!ht(e))return e.g.la();let t=Cn(e.g);if(t===``)return``;let n=``,r=t.length,i=Sn(e.g)==4;if(!e.h.i){if(typeof TextDecoder>`u`)return xt(e),bt(e),``;e.h.i=new o.TextDecoder}for(let a=0;a<r;a++)e.h.h=!0,n+=e.h.i.decode(t[a],{stream:!(i&&a==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}function ht(e){return e.g?e.v==`GET`&&e.M!=2&&e.j.Aa:!1}function gt(e,t){var n=e.C,r=t.indexOf(`
`,n);return r==-1?dt:(n=Number(t.substring(n,r)),isNaN(n)?ut:(r+=1,r+n>t.length?dt:(t=t.slice(r,r+n),e.C=r+n,t)))}ct.prototype.cancel=function(){this.K=!0,xt(this)};function _t(e){e.T=Date.now()+e.H,vt(e,e.H)}function vt(e,t){if(e.D!=null)throw Error(`WatchDog timer not null`);e.D=Ye(l(e.aa,e),t)}function yt(e){e.D&&=(o.clearTimeout(e.D),null)}ct.prototype.aa=function(){this.D=null;let e=Date.now();e-this.T>=0?(et(this.i,this.B),this.M!=2&&(Ge(),qe(17)),xt(this),this.m=2,bt(this)):vt(this,this.T-e)};function bt(e){e.j.I==0||e.K||zn(e.j,e)}function xt(e){yt(e);var t=e.O;t&&typeof t.dispose==`function`&&t.dispose(),e.O=null,Me(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function St(e,t){try{var n=e.j;if(n.I!=0&&(n.g==e||Dt(n.h,e))){if(!e.L&&Dt(n.h,e)&&n.I==3){try{var r=n.Ba.g.parse(t)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){a:if(!n.v){if(n.g)if(n.g.F+3e3<e.F)Rn(n),Dn(n);else break a;Fn(n),qe(18)}}else n.xa=i[1],0<n.xa-n.K&&i[2]<37500&&n.F&&n.A==0&&!n.C&&(n.C=Ye(l(n.Va,n),6e3));Et(n.h)<=1&&n.ta&&(n.ta=void 0)}else Vn(n,11)}else if((e.L||n.g==e)&&Rn(n),!k(t))for(i=n.Ba.g.parse(t),t=0;t<i.length;t++){let l=i[t],u=l[0];if(!(u<=n.K))if(n.K=u,l=l[1],n.I==2)if(l[0]==`c`){n.M=l[1],n.ba=l[2];let t=l[3];t!=null&&(n.ka=t,n.j.info(`VER=`+n.ka));let i=l[4];i!=null&&(n.za=i,n.j.info(`SVER=`+n.za));let u=l[5];u!=null&&typeof u==`number`&&u>0&&(r=1.5*u,n.O=r,n.j.info(`backChannelRequestTimeoutMs_=`+r)),r=n;let d=e.g;if(d){let e=d.g?d.g.getResponseHeader(`X-Client-Wire-Protocol`):null;if(e){var a=r.h;a.g||e.indexOf(`spdy`)==-1&&e.indexOf(`quic`)==-1&&e.indexOf(`h2`)==-1||(a.j=a.l,a.g=new Set,a.h&&=(Ot(a,a.h),null))}if(r.G){let e=d.g?d.g.getResponseHeader(`X-HTTP-Session-Id`):null;e&&(r.wa=e,Rt(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info(`Handshake RTT: `+n.T+`ms`)),r=n;var o=e;if(r.na=Un(r,r.L?r.ba:null,r.W),o.L){kt(r.h,o);var s=o,c=r.O;c&&(s.H=c),s.D&&(yt(s),_t(s)),r.g=o}else Pn(r);n.i.length>0&&kn(n)}else l[0]!=`stop`&&l[0]!=`close`||Vn(n,7);else n.I==3&&(l[0]==`stop`||l[0]==`close`?l[0]==`stop`?Vn(n,7):M(n):l[0]!=`noop`&&n.l&&n.l.qa(l),n.A=0)}}Ge(4)}catch{}}var Ct=class{constructor(e,t){this.g=e,this.map=t}};function wt(e){this.l=e||10,o.PerformanceNavigationTiming?(e=o.performance.getEntriesByType(`navigation`),e=e.length>0&&(e[0].nextHopProtocol==`hq`||e[0].nextHopProtocol==`h2`)):e=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Tt(e){return e.h?!0:e.g?e.g.size>=e.j:!1}function Et(e){return e.h?1:e.g?e.g.size:0}function Dt(e,t){return e.h?e.h==t:e.g?e.g.has(t):!1}function Ot(e,t){e.g?e.g.add(t):e.h=t}function kt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}wt.prototype.cancel=function(){if(this.i=At(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let e of this.g.values())e.cancel();this.g.clear()}};function At(e){if(e.h!=null)return e.i.concat(e.h.G);if(e.g!=null&&e.g.size!==0){let t=e.i;for(let n of e.g.values())t=t.concat(n.G);return t}return p(e.i)}var jt=RegExp(`^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$`);function Mt(e,t){if(e){e=e.split(`&`);for(let n=0;n<e.length;n++){let r=e[n].indexOf(`=`),i,a=null;r>=0?(i=e[n].substring(0,r),a=e[n].substring(r+1)):i=e[n],t(i,a?decodeURIComponent(a.replace(/\+/g,` `)):``)}}}function Nt(e){this.g=this.o=this.j=``,this.u=null,this.m=this.h=``,this.l=!1;let t;e instanceof Nt?(this.l=e.l,Ft(this,e.j),this.o=e.o,this.g=e.g,It(this,e.u),this.h=e.h,Lt(this,en(e.i)),this.m=e.m):e&&(t=String(e).match(jt))?(this.l=!1,Ft(this,t[1]||``,!0),this.o=Bt(t[2]||``),this.g=Bt(t[3]||``,!0),It(this,t[4]),this.h=Bt(t[5]||``,!0),Lt(this,t[6]||``,!0),this.m=Bt(t[7]||``)):(this.l=!1,this.i=new Jt(null,this.l))}Nt.prototype.toString=function(){let e=[];var t=this.j;t&&e.push(Vt(t,Ut,!0),`:`);var n=this.g;return(n||t==`file`)&&(e.push(`//`),(t=this.o)&&e.push(Vt(t,Ut,!0),`@`),e.push(ot(n).replace(/%25([0-9a-fA-F]{2})/g,`%$1`)),n=this.u,n!=null&&e.push(`:`,String(n))),(n=this.h)&&(this.g&&n.charAt(0)!=`/`&&e.push(`/`),e.push(Vt(n,n.charAt(0)==`/`?Gt:Wt,!0))),(n=this.i.toString())&&e.push(`?`,n),(n=this.m)&&e.push(`#`,Vt(n,qt)),e.join(``)},Nt.prototype.resolve=function(e){let t=Pt(this),n=!!e.j;n?Ft(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=e.u!=null;var r=e.h;if(n)It(t,e.u);else if(n=!!e.h){if(r.charAt(0)!=`/`)if(this.g&&!this.h)r=`/`+r;else{var i=t.h.lastIndexOf(`/`);i!=-1&&(r=t.h.slice(0,i+1)+r)}if(i=r,i==`..`||i==`.`)r=``;else if(i.indexOf(`./`)!=-1||i.indexOf(`/.`)!=-1){r=i.lastIndexOf(`/`,0)==0,i=i.split(`/`);let e=[];for(let t=0;t<i.length;){let n=i[t++];n==`.`?r&&t==i.length&&e.push(``):n==`..`?((e.length>1||e.length==1&&e[0]!=``)&&e.pop(),r&&t==i.length&&e.push(``)):(e.push(n),r=!0)}r=e.join(`/`)}else r=i}return n?t.h=r:n=e.i.toString()!==``,n?Lt(t,en(e.i)):n=!!e.m,n&&(t.m=e.m),t};function Pt(e){return new Nt(e)}function Ft(e,t,n){e.j=n?Bt(t,!0):t,e.j&&=e.j.replace(/:$/,``)}function It(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error(`Bad port number `+t);e.u=t}else e.u=null}function Lt(e,t,n){t instanceof Jt?(e.i=t,nn(e.i,e.l)):(n||(t=Vt(t,Kt)),e.i=new Jt(t,e.l))}function Rt(e,t,n){e.i.set(t,n)}function zt(e){return Rt(e,`zx`,Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),e}function Bt(e,t){return e?t?decodeURI(e.replace(/%25/g,`%2525`)):decodeURIComponent(e):``}function Vt(e,t,n){return typeof e==`string`?(e=encodeURI(e).replace(t,Ht),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,`%$1`)),e):null}function Ht(e){return e=e.charCodeAt(0),`%`+(e>>4&15).toString(16)+(e&15).toString(16)}var Ut=/[#\/\?@]/g,Wt=/[#\?:]/g,Gt=/[#\?]/g,Kt=/[#\?@]/g,qt=/#/g;function Jt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Yt(e){e.g||(e.g=new Map,e.h=0,e.i&&Mt(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g,` `)),n)}))}e=Jt.prototype,e.add=function(e,t){Yt(this),this.i=null,e=tn(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this};function Xt(e,t){Yt(e),t=tn(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Zt(e,t){return Yt(e),t=tn(e,t),e.g.has(t)}e.forEach=function(e,t){Yt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)};function Qt(e,t){Yt(e);let n=[];if(typeof t==`string`)Zt(e,t)&&(n=n.concat(e.g.get(tn(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}e.set=function(e,t){return Yt(this),this.i=null,e=tn(this,e),Zt(this,e)&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e?(e=Qt(this,e),e.length>0?String(e[0]):t):t};function $t(e,t,n){Xt(e,t),n.length>0&&(e.i=null,e.g.set(tn(e,t),p(n)),e.h+=n.length)}e.toString=function(){if(this.i)return this.i;if(!this.g)return``;let e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];let i=ot(n);n=Qt(this,n);for(let t=0;t<n.length;t++){let r=i;n[t]!==``&&(r+=`=`+ot(n[t])),e.push(r)}}return this.i=e.join(`&`)};function en(e){let t=new Jt;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function tn(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function nn(e,t){t&&!e.j&&(Yt(e),e.i=null,e.g.forEach(function(e,t){let n=t.toLowerCase();t!=n&&(Xt(this,t),$t(this,n,e))},e)),e.j=t}function rn(e,t){let n=new Xe;if(o.Image){let r=new Image;r.onload=u(on,n,`TestLoadImage: loaded`,!0,t,r),r.onerror=u(on,n,`TestLoadImage: error`,!1,t,r),r.onabort=u(on,n,`TestLoadImage: abort`,!1,t,r),r.ontimeout=u(on,n,`TestLoadImage: timeout`,!1,t,r),o.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}function an(e,t){let n=new Xe,r=new AbortController,i=setTimeout(()=>{r.abort(),on(n,`TestPingServer: timeout`,!1,t)},1e4);fetch(e,{signal:r.signal}).then(e=>{clearTimeout(i),e.ok?on(n,`TestPingServer: ok`,!0,t):on(n,`TestPingServer: server error`,!1,t)}).catch(()=>{clearTimeout(i),on(n,`TestPingServer: error`,!1,t)})}function on(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch{}}function sn(){this.g=new Fe}function cn(e){this.i=e.Sb||null,this.h=e.ab||!1}d(cn,Ie),cn.prototype.g=function(){return new ln(this.i,this.h)};function ln(e,t){we.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText=``,this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F=`GET`,this.D=``,this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(ln,we),e=ln.prototype,e.open=function(e,t){if(this.readyState!=0)throw this.abort(),Error(`Error reopening a connection`);this.F=e,this.D=t,this.readyState=1,fn(this)},e.send=function(e){if(this.readyState!=1)throw this.abort(),Error(`need to call open() first. `);if(this.v.signal.aborted)throw this.abort(),Error(`Request was aborted.`);this.g=!0;let t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||o).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText=``,this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel(`Request was aborted.`).catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,dn(this)),this.readyState=0},e.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,fn(this)),this.g&&(this.readyState=3,fn(this),this.g)))if(this.responseType===`arraybuffer`)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(o.ReadableStream!==void 0&&`body`in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error(`responseType must be empty for "streamBinaryChunks" mode responses.`);this.response=[]}else this.response=this.responseText=``,this.B=new TextDecoder;un(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))};function un(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}e.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array;(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?dn(this):fn(this),this.readyState==3&&un(this)}},e.Oa=function(e){this.g&&(this.response=this.responseText=e,dn(this))},e.Na=function(e){this.g&&(this.response=e,dn(this))},e.ga=function(){this.g&&dn(this)};function dn(e){e.readyState=4,e.l=null,e.j=null,e.B=null,fn(e)}e.setRequestHeader=function(e,t){this.A.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||``},e.getAllResponseHeaders=function(){if(!this.h)return``;let e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+`: `+n[1]),n=t.next();return e.join(`\r
`)};function fn(e){e.onreadystatechange&&e.onreadystatechange.call(e)}Object.defineProperty(ln.prototype,`withCredentials`,{get:function(){return this.m===`include`},set:function(e){this.m=e?`include`:`same-origin`}});function pn(e){let t=``;return re(e,function(e,n){t+=n,t+=`:`,t+=e,t+=`\r
`}),t}function mn(e,t,n){a:{for(r in n){var r=!1;break a}r=!0}r||(n=pn(n),typeof e==`string`||Rt(e,t,n))}function hn(e){we.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D=``,this.o=0,this.l=``,this.j=this.B=this.v=this.A=!1,this.m=null,this.F=``,this.H=!1}d(hn,we);var gn=/^https?$/i,_n=[`POST`,`PUT`];e=hn.prototype,e.Fa=function(e){this.H=e},e.ea=function(e,t,n,r){if(this.g)throw Error(`[goog.net.XhrIo] Object is active with another request=`+this.D+`; newUri=`+e);t=t?t.toUpperCase():`GET`,this.D=e,this.l=``,this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():it.g(),this.g.onreadystatechange=f(l(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(e){vn(this,e);return}if(e=n||``,n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys==`function`&&typeof r.get==`function`)for(let e of r.keys())n.set(e,r.get(e));else throw Error(`Unknown input type for opt_headers: `+String(r));r=Array.from(n.keys()).find(e=>e.toLowerCase()==`content-type`),i=o.FormData&&e instanceof o.FormData,!(Array.prototype.indexOf.call(_n,t,void 0)>=0)||r||i||n.set(`Content-Type`,`application/x-www-form-urlencoded;charset=utf-8`);for(let[e,t]of n)this.g.setRequestHeader(e,t);this.F&&(this.g.responseType=this.F),`withCredentials`in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&=(clearTimeout(this.m),null),this.v=!0,this.g.send(e),this.v=!1}catch(e){vn(this,e)}};function vn(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,yn(e),xn(e)}function yn(e){e.A||(e.A=!0,Te(e,`complete`),Te(e,`error`))}e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,Te(this,`complete`),Te(this,`abort`),xn(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),xn(this,!0)),hn.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?bn(this):this.Xa())},e.Xa=function(){bn(this)};function bn(e){if(e.h&&a!==void 0){if(e.v&&Sn(e)==4)setTimeout(e.Ca.bind(e),0);else if(Te(e,`readystatechange`),Sn(e)==4){e.h=!1;try{let a=e.ca();a:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break a;default:t=!1}var n;if(!(n=t)){var r;if(r=a===0){let t=String(e.D).match(jt)[1]||null;!t&&o.self&&o.self.location&&(t=o.self.location.protocol.slice(0,-1)),r=!gn.test(t?t.toLowerCase():``)}n=r}if(n)Te(e,`complete`),Te(e,`success`);else{e.o=6;try{var i=Sn(e)>2?e.g.statusText:``}catch{i=``}e.l=i+` [`+e.ca()+`]`,yn(e)}}finally{xn(e)}}}}function xn(e,t){if(e.g){e.m&&=(clearTimeout(e.m),null);let n=e.g;e.g=null,t||Te(e,`ready`);try{n.onreadystatechange=null}catch{}}}e.isActive=function(){return!!this.g};function Sn(e){return e.g?e.g.readyState:0}e.ca=function(){try{return Sn(this)>2?this.g.status:-1}catch{return-1}},e.la=function(){try{return this.g?this.g.responseText:``}catch{return``}},e.La=function(e){if(this.g){var t=this.g.responseText;return e&&t.indexOf(e)==0&&(t=t.substring(e.length)),Pe(t)}};function Cn(e){try{if(!e.g)return null;if(`response`in e.g)return e.g.response;switch(e.F){case``:case`text`:return e.g.responseText;case`arraybuffer`:if(`mozResponseArrayBuffer`in e.g)return e.g.mozResponseArrayBuffer}return null}catch{return null}}function wn(e){let t={};e=(e.g&&Sn(e)>=2&&e.g.getAllResponseHeaders()||``).split(`\r
`);for(let r=0;r<e.length;r++){if(k(e[r]))continue;var n=st(e[r]);let i=n[0];if(n=n[1],typeof n!=`string`)continue;n=n.trim();let a=t[i]||[];t[i]=a,a.push(n)}ie(t,function(e){return e.join(`, `)})}e.ya=function(){return this.o},e.Ha=function(){return typeof this.l==`string`?this.l:String(this.l)};function Tn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function En(e){this.za=0,this.i=[],this.j=new Xe,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Tn(`failFast`,!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Tn(`baseRetryDelayMs`,5e3,e),this.Za=Tn(`retryDelaySeedMs`,1e4,e),this.Ta=Tn(`forwardChannelMaxRetries`,2,e),this.va=Tn(`forwardChannelRequestTimeoutMs`,2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M=``,this.h=new wt(e&&e.concurrentRequestLimit),this.Ba=new sn,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}e=En.prototype,e.ka=8,e.I=1,e.connect=function(e,t,n,r){qe(0),this.W=e,this.H=t||{},n&&r!==void 0&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=Un(this,null,this.W),kn(this)};function M(e){if(On(e),e.I==3){var t=e.V++,n=Pt(e.J);if(Rt(n,`SID`,e.M),Rt(n,`RID`,t),Rt(n,`TYPE`,`terminate`),Mn(e,n),t=new ct(e,e.j,t),t.M=2,t.A=zt(Pt(n)),n=!1,o.navigator&&o.navigator.sendBeacon)try{n=o.navigator.sendBeacon(t.A.toString(),``)}catch{}!n&&o.Image&&(new Image().src=t.A,n=!0),n||(t.g=Wn(t.j,null),t.g.ea(t.A)),t.F=Date.now(),_t(t)}Hn(e)}function Dn(e){e.g&&=(In(e),e.g.cancel(),null)}function On(e){Dn(e),e.v&&=(o.clearTimeout(e.v),null),Rn(e),e.h.cancel(),e.m&&=(typeof e.m==`number`&&o.clearTimeout(e.m),null)}function kn(e){if(!Tt(e.h)&&!e.m){e.m=!0;var t=e.Ea;x||w(),S||=(x(),!0),C.add(t,e),e.D=0}}function An(e,t){return Et(e.h)>=e.h.j-(e.m?1:0)?!1:e.m?(e.i=t.G.concat(e.i),!0):e.I==1||e.I==2||e.D>=(e.Sa?0:e.Ta)?!1:(e.m=Ye(l(e.Ea,e,t),Bn(e,e.D)),e.D++,!0)}e.Ea=function(e){if(this.m)if(this.m=null,this.I==1){if(!e){this.V=Math.floor(Math.random()*1e5),e=this.V++;let i=new ct(this,this.j,e),a=this.o;if(this.U&&(a?(a=ae(a),se(a,this.U)):a=this.U),this.u!==null||this.R||(i.J=a,a=null),this.S)a:{for(var t=0,n=0;n<this.i.length;n++){b:{var r=this.i[n];if(`__data__`in r.map&&(r=r.map.__data__,typeof r==`string`)){r=r.length;break b}r=void 0}if(r===void 0)break;if(t+=r,t>4096){t=n;break a}if(t===4096||n===this.i.length-1){t=n+1;break a}}t=1e3}else t=1e3;t=Nn(this,i,t),n=Pt(this.J),Rt(n,`RID`,e),Rt(n,`CVER`,22),this.G&&Rt(n,`X-HTTP-Session-Id`,this.G),Mn(this,n),a&&(this.R?t=`headers=`+ot(pn(a))+`&`+t:this.u&&mn(n,this.u,a)),Ot(this.h,i),this.Ra&&Rt(n,`TYPE`,`init`),this.S?(Rt(n,`$req`,t),Rt(n,`SID`,`null`),i.U=!0,ft(i,n,null)):ft(i,n,t),this.I=2}}else this.I==3&&(e?jn(this,e):this.i.length==0||Tt(this.h)||jn(this))};function jn(e,t){var n=t?t.l:e.V++;let r=Pt(e.J);Rt(r,`SID`,e.M),Rt(r,`RID`,n),Rt(r,`AID`,e.K),Mn(e,r),e.u&&e.o&&mn(r,e.u,e.o),n=new ct(e,e.j,n,e.D+1),e.u===null&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=Nn(e,n,1e3),n.H=Math.round(e.va*.5)+Math.round(e.va*.5*Math.random()),Ot(e.h,n),ft(n,r,t)}function Mn(e,t){e.H&&re(e.H,function(e,n){Rt(t,n,e)}),e.l&&re({},function(e,n){Rt(t,n,e)})}function Nn(e,t,n){n=Math.min(e.i.length,n);let r=e.l?l(e.l.Ka,e.l,e):null;a:{var i=e.i;let t=-1;for(;;){let e=[`count=`+n];t==-1?n>0?(t=i[0].g,e.push(`ofs=`+t)):t=0:e.push(`ofs=`+t);let c=!0;for(let l=0;l<n;l++){var a=i[l].g;let n=i[l].map;if(a-=t,a<0)t=Math.max(0,i[l].g-100),c=!1;else try{a=`req`+a+`_`||``;try{var o=n instanceof Map?n:Object.entries(n);for(let[t,n]of o){let r=n;s(n)&&(r=Ne(n)),e.push(a+t+`=`+encodeURIComponent(r))}}catch(t){throw e.push(a+`type=_badmap`),t}}catch{r&&r(n)}}if(c){o=e.join(`&`);break a}}o=void 0}return e=e.i.splice(0,n),t.G=e,o}function Pn(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;x||w(),S||=(x(),!0),C.add(t,e),e.A=0}}function Fn(e){return e.g||e.v||e.A>=3?!1:(e.Y++,e.v=Ye(l(e.Da,e),Bn(e,e.A)),e.A++,!0)}e.Da=function(){if(this.v=null,Ln(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var e=4*this.T;this.j.info(`BP detection timer enabled: `+e),this.B=Ye(l(this.Wa,this),e)}},e.Wa=function(){this.B&&(this.B=null,this.j.info(`BP detection timeout reached.`),this.j.info(`Buffering proxy detected and switch to long-polling!`),this.F=!1,this.P=!0,qe(10),Dn(this),Ln(this))};function In(e){e.B!=null&&(o.clearTimeout(e.B),e.B=null)}function Ln(e){e.g=new ct(e,e.j,`rpc`,e.Y),e.u===null&&(e.g.J=e.o),e.g.P=0;var t=Pt(e.na);Rt(t,`RID`,`rpc`),Rt(t,`SID`,e.M),Rt(t,`AID`,e.K),Rt(t,`CI`,e.F?`0`:`1`),!e.F&&e.ia&&Rt(t,`TO`,e.ia),Rt(t,`TYPE`,`xmlhttp`),Mn(e,t),e.u&&e.o&&mn(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=zt(Pt(t)),n.u=null,n.R=!0,pt(n,e)}e.Va=function(){this.C!=null&&(this.C=null,Dn(this),Fn(this),qe(19))};function Rn(e){e.C!=null&&(o.clearTimeout(e.C),e.C=null)}function zn(e,t){var n=null;if(e.g==t){Rn(e),In(e),e.g=null;var r=2}else if(Dt(e.h,t))n=t.G,kt(e.h,t),r=1;else return;if(e.I!=0){if(t.o)if(r==1){n=t.u?t.u.length:0,t=Date.now()-t.F;var i=e.D;r=Ue(),Te(r,new Je(r,n)),kn(e)}else Pn(e);else if(i=t.m,i==3||i==0&&t.X>0||!(r==1&&An(e,t)||r==2&&Fn(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),i){case 1:Vn(e,5);break;case 4:Vn(e,10);break;case 3:Vn(e,6);break;default:Vn(e,2)}}}function Bn(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function Vn(e,t){if(e.j.info(`Error code `+t),t==2){var n=l(e.bb,e),r=e.Ua;let t=!r;r=new Nt(r||`//www.google.com/images/cleardot.gif`),o.location&&o.location.protocol==`http`||Ft(r,`https`),zt(r),t?rn(r.toString(),n):an(r.toString(),n)}else qe(2);e.I=0,e.l&&e.l.pa(t),Hn(e),On(e)}e.bb=function(e){e?(this.j.info(`Successfully pinged google.com`),qe(2)):(this.j.info(`Failed to ping google.com`),qe(1))};function Hn(e){if(e.I=0,e.ja=[],e.l){let t=At(e.h);(t.length!=0||e.i.length!=0)&&(m(e.ja,t),m(e.ja,e.i),e.h.i.length=0,p(e.i),e.i.length=0),e.l.oa()}}function Un(e,t,n){var r=n instanceof Nt?Pt(n):new Nt(n);if(r.g!=``)t&&(r.g=t+`.`+r.g),It(r,r.u);else{var i=o.location;r=i.protocol,t=t?t+`.`+i.hostname:i.hostname,i=+i.port;let e=new Nt(null);r&&Ft(e,r),t&&(e.g=t),i&&It(e,i),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&Rt(r,n,t),Rt(r,`VER`,e.ka),Mn(e,r),r}function Wn(e,t,n){if(t&&!e.L)throw Error(`Can't create secondary domain capable XhrIo object.`);return t=e.Aa&&!e.ma?new hn(new cn({ab:n})):new hn(e.ma),t.Fa(e.L),t}e.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gn(){}e=Gn.prototype,e.ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){};function Kn(){}Kn.prototype.g=function(e,t){return new qn(e,t)};function qn(e,t){we.call(this),this.g=new En(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e[`X-Client-Protocol`]=`webchannel`:e={"X-Client-Protocol":`webchannel`}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e[`X-WebChannel-Content-Type`]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e[`X-WebChannel-Client-Profile`]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!k(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t&&=t.httpSessionIdParam)&&!k(t)&&(this.g.G=t,e=this.h,e!==null&&t in e&&(e=this.h,t in e&&delete e[t])),this.j=new Xn(this)}d(qn,we),qn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},qn.prototype.close=function(){M(this.g)},qn.prototype.o=function(e){var t=this.g;if(typeof e==`string`){var n={};n.__data__=e,e=n}else this.v&&(n={},n.__data__=Ne(e),e=n);t.i.push(new Ct(t.Ya++,e)),t.I==3&&kn(t)},qn.prototype.N=function(){this.g.l=null,delete this.j,M(this.g),delete this.g,qn.Z.N.call(this)};function Jn(e){ze.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){a:{for(let n in t){e=n;break a}e=void 0}(this.i=e)&&(e=this.i,t=t!==null&&e in t?t[e]:void 0),this.data=t}else this.data=e}d(Jn,ze);function Yn(){Be.call(this),this.status=1}d(Yn,Be);function Xn(e){this.g=e}d(Xn,Gn),Xn.prototype.ra=function(){Te(this.g,`a`)},Xn.prototype.qa=function(e){Te(this.g,new Jn(e))},Xn.prototype.pa=function(e){Te(this.g,new Yn)},Xn.prototype.oa=function(){Te(this.g,`b`)},Kn.prototype.createWebChannel=Kn.prototype.g,qn.prototype.send=qn.prototype.o,qn.prototype.open=qn.prototype.m,qn.prototype.close=qn.prototype.close,dh=rh.createWebChannelTransport=function(){return new Kn},uh=rh.getStatEventTarget=function(){return Ue()},lh=rh.Event=Ve,ch=rh.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},nt.NO_ERROR=0,nt.TIMEOUT=8,nt.HTTP_ERROR=6,sh=rh.ErrorCode=nt,rt.COMPLETE=`complete`,oh=rh.EventType=rt,Le.EventType=Re,Re.OPEN=`a`,Re.CLOSE=`b`,Re.ERROR=`c`,Re.MESSAGE=`d`,we.prototype.listen=we.prototype.J,ah=rh.WebChannel=Le,rh.FetchXmlHttpFactory=cn,hn.prototype.listenOnce=hn.prototype.K,hn.prototype.getLastError=hn.prototype.Ha,hn.prototype.getLastErrorCode=hn.prototype.ya,hn.prototype.getStatus=hn.prototype.ca,hn.prototype.getResponseJson=hn.prototype.La,hn.prototype.getResponseText=hn.prototype.la,hn.prototype.send=hn.prototype.ea,hn.prototype.setWithCredentials=hn.prototype.Fa,ih=rh.XhrIo=hn}).apply(nh===void 0?typeof self<`u`?self:typeof window<`u`?window:{}:nh);var fh=`@firebase/firestore`,ph=`4.9.2`,mh=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?`uid:`+this.uid:`anonymous-user`}isEqual(e){return e.uid===this.uid}};mh.UNAUTHENTICATED=new mh(null),mh.GOOGLE_CREDENTIALS=new mh(`google-credentials-uid`),mh.FIRST_PARTY=new mh(`first-party-uid`),mh.MOCK_USER=new mh(`mock-user`);
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var hh=`12.3.0`,gh=new Al(`@firebase/firestore`);function _h(){return gh.logLevel}function vh(e,...t){if(gh.logLevel<=Tl.DEBUG){let n=t.map(xh);gh.debug(`Firestore (${hh}): ${e}`,...n)}}function yh(e,...t){if(gh.logLevel<=Tl.ERROR){let n=t.map(xh);gh.error(`Firestore (${hh}): ${e}`,...n)}}function bh(e,...t){if(gh.logLevel<=Tl.WARN){let n=t.map(xh);gh.warn(`Firestore (${hh}): ${e}`,...n)}}function xh(e){if(typeof e==`string`)return e;try{
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
return function(e){return JSON.stringify(e)}(e)}catch{return e}}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Sh(e,t,n){let r=`Unexpected state`;typeof t==`string`?r=t:n=t,Ch(e,r,n)}function Ch(e,t,n){let r=`FIRESTORE (${hh}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(n!==void 0)try{r+=` CONTEXT: `+JSON.stringify(n)}catch{r+=` CONTEXT: `+n}throw yh(r),Error(r)}function wh(e,t,n,r){let i=`Unexpected state`;typeof n==`string`?i=n:r=n,e||Ch(t,i,r)}function Th(e,t){return e}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var P={OK:`ok`,CANCELLED:`cancelled`,UNKNOWN:`unknown`,INVALID_ARGUMENT:`invalid-argument`,DEADLINE_EXCEEDED:`deadline-exceeded`,NOT_FOUND:`not-found`,ALREADY_EXISTS:`already-exists`,PERMISSION_DENIED:`permission-denied`,UNAUTHENTICATED:`unauthenticated`,RESOURCE_EXHAUSTED:`resource-exhausted`,FAILED_PRECONDITION:`failed-precondition`,ABORTED:`aborted`,OUT_OF_RANGE:`out-of-range`,UNIMPLEMENTED:`unimplemented`,INTERNAL:`internal`,UNAVAILABLE:`unavailable`,DATA_LOSS:`data-loss`},Eh=class extends Qc{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}},Dh=class{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}},Oh=class{constructor(e,t){this.user=t,this.type=`OAuth`,this.headers=new Map,this.headers.set(`Authorization`,`Bearer ${e}`)}},lte=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(mh.UNAUTHENTICATED)))}shutdown(){}},ute=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}},dte=class{constructor(e){this.t=e,this.currentUser=mh.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){wh(this.o===void 0,42304);let n=this.i,r=e=>this.i===n?Promise.resolve():(n=this.i,t(e)),i=new Dh;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Dh,e.enqueueRetryable((()=>r(this.currentUser)))};let a=()=>{let t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{vh(`FirebaseAuthCredentialsProvider`,`Auth detected`),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){let e=this.t.getImmediate({optional:!0});e?o(e):(vh(`FirebaseAuthCredentialsProvider`,`Auth not yet detected`),i.resolve(),i=new Dh)}}),0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i===e?t?(wh(typeof t.accessToken==`string`,31837,{l:t}),new Oh(t.accessToken,this.currentUser)):null:(vh(`FirebaseAuthCredentialsProvider`,`getToken aborted due to token change.`),this.getToken()))):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return wh(e===null||typeof e==`string`,2055,{h:e}),new mh(e)}},fte=class{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type=`FirstParty`,this.user=mh.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set(`X-Goog-AuthUser`,this.P);let e=this.R();return e&&this.A.set(`Authorization`,e),this.T&&this.A.set(`X-Goog-Iam-Authorization-Token`,this.T),this.A}},pte=class{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new fte(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(mh.FIRST_PARTY)))}shutdown(){}invalidateToken(){}},kh=class{constructor(e){this.value=e,this.type=`AppCheck`,this.headers=new Map,e&&e.length>0&&this.headers.set(`x-firebase-appcheck`,this.value)}},mte=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Bu(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){wh(this.o===void 0,3512);let n=e=>{e.error!=null&&vh(`FirebaseAppCheckTokenProvider`,`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let n=e.token!==this.m;return this.m=e.token,vh(`FirebaseAppCheckTokenProvider`,`Received ${n?`new`:`existing`} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};let r=e=>{vh(`FirebaseAppCheckTokenProvider`,`AppCheck detected`),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){let e=this.V.getImmediate({optional:!0});e?r(e):vh(`FirebaseAppCheckTokenProvider`,`AppCheck not yet detected`)}}),0)}getToken(){if(this.p)return Promise.resolve(new kh(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(wh(typeof e.token==`string`,44558,{tokenResult:e}),this.m=e.token,new kh(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function hte(e){let t=typeof self<`u`&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&typeof t.getRandomValues==`function`)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Ah=class{static newId(){let e=``;for(;e.length<20;){let t=hte(40);for(let n=0;n<t.length;++n)e.length<20&&t[n]<248&&(e+=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789`.charAt(t[n]%62))}return e}};function jh(e,t){return e<t?-1:e>t?1:0}function Mh(e,t){let n=Math.min(e.length,t.length);for(let r=0;r<n;r++){let n=e.charAt(r),i=t.charAt(r);if(n!==i)return Nh(n)===Nh(i)?jh(n,i):Nh(n)?1:-1}return jh(e.length,t.length)}var gte=55296,_te=57343;function Nh(e){let t=e.charCodeAt(0);return t>=gte&&t<=_te}function Ph(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var Fh=`__name__`,Ih=class e{constructor(e,t,n){t===void 0?t=0:t>e.length&&Sh(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Sh(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(t){return e.comparator(this,t)===0}child(t){let n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((e=>{n.push(e)})):n.push(t),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,n){let r=Math.min(t.length,n.length);for(let i=0;i<r;i++){let r=e.compareSegments(t.get(i),n.get(i));if(r!==0)return r}return jh(t.length,n.length)}static compareSegments(t,n){let r=e.isNumericId(t),i=e.isNumericId(n);return r&&!i?-1:!r&&i?1:r&&i?e.extractNumericId(t).compare(e.extractNumericId(n)):Mh(t,n)}static isNumericId(e){return e.startsWith(`__id`)&&e.endsWith(`__`)}static extractNumericId(e){return eh.fromString(e.substring(4,e.length-2))}},Lh=class e extends Ih{construct(t,n,r){return new e(t,n,r)}canonicalString(){return this.toArray().join(`/`)}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join(`/`)}static fromString(...t){let n=[];for(let e of t){if(e.indexOf(`//`)>=0)throw new Eh(P.INVALID_ARGUMENT,`Invalid segment (${e}). Paths must not contain // in them.`);n.push(...e.split(`/`).filter((e=>e.length>0)))}return new e(n)}static emptyPath(){return new e([])}},vte=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Rh=class e extends Ih{construct(t,n,r){return new e(t,n,r)}static isValidIdentifier(e){return vte.test(e)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,`\\\\`).replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(`.`)}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Fh}static keyField(){return new e([Fh])}static fromServerFormat(t){let n=[],r=``,i=0,a=()=>{if(r.length===0)throw new Eh(P.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=``},o=!1;for(;i<t.length;){let e=t[i];if(e===`\\`){if(i+1===t.length)throw new Eh(P.INVALID_ARGUMENT,`Path has trailing escape character: `+t);let e=t[i+1];if(e!==`\\`&&e!==`.`&&e!=="`")throw new Eh(P.INVALID_ARGUMENT,`Path has invalid escape sequence: `+t);r+=e,i+=2}else e==="`"?(o=!o,i++):e!==`.`||o?(r+=e,i++):(a(),i++)}if(a(),o)throw new Eh(P.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)}static emptyPath(){return new e([])}},zh=class e{constructor(e){this.path=e}static fromPath(t){return new e(Lh.fromString(t))}static fromName(t){return new e(Lh.fromString(t).popFirst(5))}static empty(){return new e(Lh.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Lh.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Lh.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(t){return new e(new Lh(t.slice()))}};
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Bh(e,t,n){if(!n)throw new Eh(P.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function yte(e,t,n,r){if(!0===t&&!0===r)throw new Eh(P.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Vh(e){if(!zh.isDocumentKey(e))throw new Eh(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Hh(e){if(zh.isDocumentKey(e))throw new Eh(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Uh(e){return typeof e==`object`&&!!e&&(Object.getPrototypeOf(e)===Object.prototype||Object.getPrototypeOf(e)===null)}function Wh(e){if(e===void 0)return`undefined`;if(e===null)return`null`;if(typeof e==`string`)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if(typeof e==`number`||typeof e==`boolean`)return``+e;if(typeof e==`object`){if(e instanceof Array)return`an array`;{let t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:`an object`}}return typeof e==`function`?`a function`:Sh(12329,{type:typeof e})}function Gh(e,t){if(`_delegate`in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Eh(P.INVALID_ARGUMENT,`Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?`);{let n=Wh(e);throw new Eh(P.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function bte(e,t){if(t<=0)throw new Eh(P.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}
/**
* @license
* Copyright 2025 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function Kh(e,t){let n={typeString:e};return t&&(n.value=t),n}function qh(e,t){if(!Uh(e))throw new Eh(P.INVALID_ARGUMENT,`JSON must be an object`);let n;for(let r in t)if(t[r]){let i=t[r].typeString,a=`value`in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}let o=e[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){n=`Expected '${r}' field to equal '${a.value}'`;break}}if(n)throw new Eh(P.INVALID_ARGUMENT,n);return!0}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Jh=-62135596800,Yh=1e6,Xh=class e{static now(){return e.fromMillis(Date.now())}static fromDate(t){return e.fromMillis(t.getTime())}static fromMillis(t){let n=Math.floor(t/1e3),r=Math.floor((t-1e3*n)*Yh);return new e(n,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0||t>=1e9)throw new Eh(P.INVALID_ARGUMENT,`Timestamp nanoseconds out of range: `+t);if(e<Jh||e>=253402300800)throw new Eh(P.INVALID_ARGUMENT,`Timestamp seconds out of range: `+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Yh}_compareTo(e){return this.seconds===e.seconds?jh(this.nanoseconds,e.nanoseconds):jh(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return`Timestamp(seconds=`+this.seconds+`, nanoseconds=`+this.nanoseconds+`)`}toJSON(){return{type:e._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(qh(t,e._jsonSchema))return new e(t.seconds,t.nanoseconds)}valueOf(){let e=this.seconds-Jh;return String(e).padStart(12,`0`)+`.`+String(this.nanoseconds).padStart(9,`0`)}};Xh._jsonSchemaVersion=`firestore/timestamp/1.0`,Xh._jsonSchema={type:Kh(`string`,Xh._jsonSchemaVersion),seconds:Kh(`number`),nanoseconds:Kh(`number`)};
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Zh=class e{static fromTimestamp(t){return new e(t)}static min(){return new e(new Xh(0,0))}static max(){return new e(new Xh(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return`SnapshotVersion(`+this.timestamp.toString()+`)`}toTimestamp(){return this.timestamp}},Qh=-1,xte=class{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}};xte.UNKNOWN_ID=-1;function Ste(e,t){let n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Zh.fromTimestamp(r===1e9?new Xh(n+1,0):new Xh(n,r));return new $h(i,zh.empty(),t)}function Cte(e){return new $h(e.readTime,e.key,Qh)}var $h=class e{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new e(Zh.min(),zh.empty(),Qh)}static max(){return new e(Zh.max(),zh.empty(),Qh)}};function wte(e,t){let n=e.readTime.compareTo(t.readTime);return n===0?(n=zh.comparator(e.documentKey,t.documentKey),n===0?jh(e.largestBatchId,t.largestBatchId):n):n}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var Tte=`The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.`,Ete=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}};
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function eg(e){if(e.code!==P.FAILED_PRECONDITION||e.message!==Tte)throw e;vh(`LocalStore`,`Unexpectedly lost primary lease`)}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var F=class e{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(t,n){return this.callbackAttached&&Sh(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e(((e,r)=>{this.nextCallback=n=>{this.wrapSuccess(t,n).next(e,r)},this.catchCallback=t=>{this.wrapFailure(n,t).next(e,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(t){try{let n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}wrapSuccess(t,n){return t?this.wrapUserFunction((()=>t(n))):e.resolve(n)}wrapFailure(t,n){return t?this.wrapUserFunction((()=>t(n))):e.reject(n)}static resolve(t){return new e(((e,n)=>{e(t)}))}static reject(t){return new e(((e,n)=>{n(t)}))}static waitFor(t){return new e(((e,n)=>{let r=0,i=0,a=!1;t.forEach((t=>{++r,t.next((()=>{++i,a&&i===r&&e()}),(e=>n(e)))})),a=!0,i===r&&e()}))}static or(t){let n=e.resolve(!1);for(let r of t)n=n.next((t=>t?e.resolve(t):r()));return n}static forEach(e,t){let n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(t,n){return new e(((e,r)=>{let i=t.length,a=Array(i),o=0;for(let s=0;s<i;s++){let c=s;n(t[c]).next((t=>{a[c]=t,++o,o===i&&e(a)}),(e=>r(e)))}}))}static doWhile(t,n){return new e(((e,r)=>{let i=()=>{!0===t()?n().next((()=>{i()}),r):e()};i()}))}};function Dte(e){let t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(`.`).slice(0,2).join(`.`):`-1`;return Number(n)}function tg(e){return e.name===`IndexedDbTransactionError`}
/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var ng=class{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ue&&this.ue(e),e}};ng.ce=-1;
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var rg=-1;function ig(e){return e==null}function ag(e){return e===0&&1/e==-1/0}function Ote(e){return typeof e==`number`&&Number.isInteger(e)&&!ag(e)&&e<=2**53-1&&e>=-(2**53-1)}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var og=``;function kte(e){let t=``;for(let n=0;n<e.length;n++)t.length>0&&(t=sg(t)),t=Ate(e.get(n),t);return sg(t)}function Ate(e,t){let n=t,r=e.length;for(let t=0;t<r;t++){let r=e.charAt(t);switch(r){case`\0`:n+=``;break;case og:n+=``;break;default:n+=r}}return n}function sg(e){return e+og+``}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function cg(e){let t=0;for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function lg(e,t){for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function ug(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var dg=class e{constructor(e,t){this.comparator=e,this.root=t||pg.EMPTY}insert(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,pg.BLACK,null,null))}remove(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,pg.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){let e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(`, `)}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fg(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fg(this.root,e,this.comparator,!1)}getReverseIterator(){return new fg(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fg(this.root,e,this.comparator,!0)}},fg=class{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},pg=class e{constructor(t,n,r,i,a){this.key=t,this.value=n,this.color=r??e.RED,this.left=i??e.EMPTY,this.right=a??e.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,n,r,i,a){return new e(t??this.key,n??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this,i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):i===0?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return e.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,n){let r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(t,i.key)===0){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){let t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){return 2**this.check()<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Sh(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Sh(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw Sh(27949);return e+(this.isRed()?0:1)}};pg.EMPTY=null,pg.RED=!0,pg.BLACK=!1,pg.EMPTY=new class{constructor(){this.size=0}get key(){throw Sh(57766)}get value(){throw Sh(16141)}get color(){throw Sh(16727)}get left(){throw Sh(29726)}get right(){throw Sh(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new pg(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var mg=class e{constructor(e){this.comparator=e,this.data=new dg(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=t===void 0?this.data.getIterator():this.data.getIteratorFrom(t);n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new hg(this.data.getIterator())}getIteratorFrom(e){return new hg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(t){if(!(t instanceof e)||this.size!==t.size)return!1;let n=this.data.getIterator(),r=t.data.getIterator();for(;n.hasNext();){let e=n.getNext().key,t=r.getNext().key;if(this.comparator(e,t)!==0)return!1}return!0}toArray(){let e=[];return this.forEach((t=>{e.push(t)})),e}toString(){let e=[];return this.forEach((t=>e.push(t))),`SortedSet(`+e.toString()+`)`}copy(t){let n=new e(this.comparator);return n.data=t,n}},hg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}},gg=class e{constructor(e){this.fields=e,e.sort(Rh.comparator)}static empty(){return new e([])}unionWith(t){let n=new mg(Rh.comparator);for(let e of this.fields)n=n.add(e);for(let e of t)n=n.add(e);return new e(n.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ph(this.fields,e.fields,((e,t)=>e.isEqual(t)))}},_g=class extends Error{constructor(){super(...arguments),this.name=`Base64DecodeError`}},vg=class e{constructor(e){this.binaryString=e}static fromBase64String(t){let n=function(e){try{return atob(e)}catch(e){throw typeof DOMException<`u`&&e instanceof DOMException?new _g(`Invalid base64 string: `+e):e}}(t);return new e(n)}static fromUint8Array(t){let n=function(e){let t=``;for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(t);return new e(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){let t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return jh(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};vg.EMPTY_BYTE_STRING=new vg(``);var jte=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yg(e){if(wh(!!e,39018),typeof e==`string`){let t=0,n=jte.exec(e);if(wh(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+`000000000`).substr(0,9),t=Number(e)}let r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:bg(e.seconds),nanos:bg(e.nanos)}}function bg(e){return typeof e==`number`?e:typeof e==`string`?Number(e):0}function xg(e){return typeof e==`string`?vg.fromBase64String(e):vg.fromUint8Array(e)}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Sg=`server_timestamp`,Cg=`__type__`,wg=`__previous_value__`,Tg=`__local_write_time__`;function Eg(e){return(e?.mapValue?.fields||{})[Cg]?.stringValue===Sg}function Dg(e){let t=e.mapValue.fields[wg];return Eg(t)?Dg(t):t}function Og(e){let t=yg(e.mapValue.fields[Tg].timestampValue);return new Xh(t.seconds,t.nanos)}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var Mte=class{constructor(e,t,n,r,i,a,o,s,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=s,this.useFetchStreams=c,this.isUsingEmulator=l}},kg=`(default)`,Ag=class e{constructor(e,t){this.projectId=e,this.database=t||kg}static empty(){return new e(``,``)}get isDefaultDatabase(){return this.database===kg}isEqual(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}},jg=`__type__`,Mg=`__max__`,Ng={mapValue:{fields:{__type__:{stringValue:Mg}}}},Pg=`__vector__`,Fg=`value`;function Ig(e){return`nullValue`in e?0:`booleanValue`in e?1:`integerValue`in e||`doubleValue`in e?2:`timestampValue`in e?3:`stringValue`in e?5:`bytesValue`in e?6:`referenceValue`in e?7:`geoPointValue`in e?8:`arrayValue`in e?9:`mapValue`in e?Eg(e)?4:$g(e)?9007199254740991:Zg(e)?10:11:Sh(28295,{value:e})}function Lg(e,t){if(e===t)return!0;let n=Ig(e);if(n!==Ig(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Og(e).isEqual(Og(t));case 3:return function(e,t){if(typeof e.timestampValue==`string`&&typeof t.timestampValue==`string`&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;let n=yg(e.timestampValue),r=yg(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return xg(e.bytesValue).isEqual(xg(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return bg(e.geoPointValue.latitude)===bg(t.geoPointValue.latitude)&&bg(e.geoPointValue.longitude)===bg(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if(`integerValue`in e&&`integerValue`in t)return bg(e.integerValue)===bg(t.integerValue);if(`doubleValue`in e&&`doubleValue`in t){let n=bg(e.doubleValue),r=bg(t.doubleValue);return n===r?ag(n)===ag(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Ph(e.arrayValue.values||[],t.arrayValue.values||[],Lg);case 10:case 11:return function(e,t){let n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(cg(n)!==cg(r))return!1;for(let e in n)if(n.hasOwnProperty(e)&&(r[e]===void 0||!Lg(n[e],r[e])))return!1;return!0}(e,t);default:return Sh(52216,{left:e})}}function Rg(e,t){return(e.values||[]).find((e=>Lg(e,t)))!==void 0}function zg(e,t){if(e===t)return 0;let n=Ig(e),r=Ig(t);if(n!==r)return jh(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return jh(e.booleanValue,t.booleanValue);case 2:return function(e,t){let n=bg(e.integerValue||e.doubleValue),r=bg(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Bg(e.timestampValue,t.timestampValue);case 4:return Bg(Og(e),Og(t));case 5:return Mh(e.stringValue,t.stringValue);case 6:return function(e,t){let n=xg(e),r=xg(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){let n=e.split(`/`),r=t.split(`/`);for(let e=0;e<n.length&&e<r.length;e++){let t=jh(n[e],r[e]);if(t!==0)return t}return jh(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){let n=jh(bg(e.latitude),bg(t.latitude));return n===0?jh(bg(e.longitude),bg(t.longitude)):n}(e.geoPointValue,t.geoPointValue);case 9:return Vg(e.arrayValue,t.arrayValue);case 10:return function(e,t){let n=e.fields||{},r=t.fields||{},i=n[Fg]?.arrayValue,a=r[Fg]?.arrayValue,o=jh(i?.values?.length||0,a?.values?.length||0);return o===0?Vg(i,a):o}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Ng.mapValue&&t===Ng.mapValue)return 0;if(e===Ng.mapValue)return 1;if(t===Ng.mapValue)return-1;let n=e.fields||{},r=Object.keys(n),i=t.fields||{},a=Object.keys(i);r.sort(),a.sort();for(let e=0;e<r.length&&e<a.length;++e){let t=Mh(r[e],a[e]);if(t!==0)return t;let o=zg(n[r[e]],i[a[e]]);if(o!==0)return o}return jh(r.length,a.length)}(e.mapValue,t.mapValue);default:throw Sh(23264,{he:n})}}function Bg(e,t){if(typeof e==`string`&&typeof t==`string`&&e.length===t.length)return jh(e,t);let n=yg(e),r=yg(t),i=jh(n.seconds,r.seconds);return i===0?jh(n.nanos,r.nanos):i}function Vg(e,t){let n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){let t=zg(n[e],r[e]);if(t)return t}return jh(n.length,r.length)}function Hg(e){return Ug(e)}function Ug(e){return`nullValue`in e?`null`:`booleanValue`in e?``+e.booleanValue:`integerValue`in e?``+e.integerValue:`doubleValue`in e?``+e.doubleValue:`timestampValue`in e?function(e){let t=yg(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):`stringValue`in e?e.stringValue:`bytesValue`in e?function(e){return xg(e).toBase64()}(e.bytesValue):`referenceValue`in e?function(e){return zh.fromName(e).toString()}(e.referenceValue):`geoPointValue`in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):`arrayValue`in e?function(e){let t=`[`,n=!0;for(let r of e.values||[])n?n=!1:t+=`,`,t+=Ug(r);return t+`]`}(e.arrayValue):`mapValue`in e?function(e){let t=Object.keys(e.fields||{}).sort(),n=`{`,r=!0;for(let i of t)r?r=!1:n+=`,`,n+=`${i}:${Ug(e.fields[i])}`;return n+`}`}(e.mapValue):Sh(61005,{value:e})}function Wg(e){switch(Ig(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let t=Dg(e);return t?16+Wg(t):16;case 5:return 2*e.stringValue.length;case 6:return xg(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+Wg(t)),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return lg(e.fields,((e,n)=>{t+=e.length+Wg(n)})),t}(e.mapValue);default:throw Sh(13486,{value:e})}}function Gg(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Kg(e){return!!e&&`integerValue`in e}function qg(e){return!!e&&`arrayValue`in e}function Jg(e){return!!e&&`nullValue`in e}function Yg(e){return!!e&&`doubleValue`in e&&isNaN(Number(e.doubleValue))}function Xg(e){return!!e&&`mapValue`in e}function Zg(e){return(e?.mapValue?.fields||{})[jg]?.stringValue===Pg}function Qg(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&typeof e.timestampValue==`object`)return{timestampValue:{...e.timestampValue}};if(e.mapValue){let t={mapValue:{fields:{}}};return lg(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Qg(n))),t}if(e.arrayValue){let t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Qg(e.arrayValue.values[n]);return t}return{...e}}function $g(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Mg}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var e_=class e{constructor(e){this.value=e}static empty(){return new e({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Xg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qg(t)}setAll(e){let t=Rh.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){let e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Qg(e):r.push(i.lastSegment())}));let i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){let t=this.field(e.popLast());Xg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Lg(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Xg(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){lg(t,((t,n)=>e[t]=n));for(let t of n)delete e[t]}clone(){return new e(Qg(this.value))}};function t_(e){let t=[];return lg(e.fields,((e,n)=>{let r=new Rh([e]);if(Xg(n)){let e=t_(n.mapValue).fields;if(e.length===0)t.push(r);else for(let n of e)t.push(r.child(n))}else t.push(r)})),new gg(t)}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var n_=class e{constructor(e,t,n,r,i,a,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(t){return new e(t,0,Zh.min(),Zh.min(),Zh.min(),e_.empty(),0)}static newFoundDocument(t,n,r,i){return new e(t,1,n,Zh.min(),r,i,0)}static newNoDocument(t,n){return new e(t,2,n,Zh.min(),Zh.min(),e_.empty(),0)}static newUnknownDocument(t,n){return new e(t,3,n,Zh.min(),Zh.min(),e_.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Zh.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=e_.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=e_.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Zh.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new e(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}},r_=class{constructor(e,t){this.position=e,this.inclusive=t}};function i_(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){let a=t[i],o=e.position[i];if(r=a.field.isKeyField()?zh.comparator(zh.fromName(o.referenceValue),n.key):zg(o,n.data.field(a.field)),a.dir===`desc`&&(r*=-1),r!==0)break}return r}function a_(e,t){if(e===null)return t===null;if(t===null||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Lg(e.position[n],t.position[n]))return!1;return!0}
/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var o_=class{constructor(e,t=`asc`){this.field=e,this.dir=t}};function Nte(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}
/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var s_=class{},c_=class e extends s_{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(t,n,r){return t.isKeyField()?n===`in`||n===`not-in`?this.createKeyFieldInFilter(t,n,r):new Fte(t,n,r):n===`array-contains`?new Ite(t,r):n===`in`?new Lte(t,r):n===`not-in`?new Rte(t,r):n===`array-contains-any`?new zte(t,r):new e(t,n,r)}static createKeyFieldInFilter(e,t,n){return t===`in`?new h_(e,n):new g_(e,n)}matches(e){let t=e.data.field(this.field);return this.op===`!=`?t!==null&&t.nullValue===void 0&&this.matchesComparison(zg(t,this.value)):t!==null&&Ig(this.value)===Ig(t)&&this.matchesComparison(zg(t,this.value))}matchesComparison(e){switch(this.op){case`<`:return e<0;case`<=`:return e<=0;case`==`:return e===0;case`!=`:return e!==0;case`>`:return e>0;case`>=`:return e>=0;default:return Sh(47266,{operator:this.op})}}isInequality(){return[`<`,`<=`,`>`,`>=`,`!=`,`not-in`].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},l_=class e extends s_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(t,n){return new e(t,n)}matches(e){return u_(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function u_(e){return e.op===`and`}function d_(e){return Pte(e)&&u_(e)}function Pte(e){for(let t of e.filters)if(t instanceof l_)return!1;return!0}function f_(e){if(e instanceof c_)return e.field.canonicalString()+e.op.toString()+Hg(e.value);if(d_(e))return e.filters.map((e=>f_(e))).join(`,`);{let t=e.filters.map((e=>f_(e))).join(`,`);return`${e.op}(${t})`}}function p_(e,t){return e instanceof c_?function(e,t){return t instanceof c_&&e.op===t.op&&e.field.isEqual(t.field)&&Lg(e.value,t.value)}(e,t):e instanceof l_?function(e,t){return t instanceof l_&&e.op===t.op&&e.filters.length===t.filters.length?e.filters.reduce(((e,n,r)=>e&&p_(n,t.filters[r])),!0):!1}(e,t):void Sh(19439)}function m_(e){return e instanceof c_?function(e){return`${e.field.canonicalString()} ${e.op} ${Hg(e.value)}`}(e):e instanceof l_?function(e){return e.op.toString()+` {`+e.getFilters().map(m_).join(` ,`)+`}`}(e):`Filter`}var Fte=class extends c_{constructor(e,t,n){super(e,t,n),this.key=zh.fromName(n.referenceValue)}matches(e){let t=zh.comparator(e.key,this.key);return this.matchesComparison(t)}},h_=class extends c_{constructor(e,t){super(e,`in`,t),this.keys=__(`in`,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}},g_=class extends c_{constructor(e,t){super(e,`not-in`,t),this.keys=__(`not-in`,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}};function __(e,t){return(t.arrayValue?.values||[]).map((e=>zh.fromName(e.referenceValue)))}var Ite=class extends c_{constructor(e,t){super(e,`array-contains`,t)}matches(e){let t=e.data.field(this.field);return qg(t)&&Rg(t.arrayValue,this.value)}},Lte=class extends c_{constructor(e,t){super(e,`in`,t)}matches(e){let t=e.data.field(this.field);return t!==null&&Rg(this.value.arrayValue,t)}},Rte=class extends c_{constructor(e,t){super(e,`not-in`,t)}matches(e){if(Rg(this.value.arrayValue,{nullValue:`NULL_VALUE`}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Rg(this.value.arrayValue,t)}},zte=class extends c_{constructor(e,t){super(e,`array-contains-any`,t)}matches(e){let t=e.data.field(this.field);return!(!qg(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Rg(this.value.arrayValue,e)))}},Bte=class{constructor(e,t=null,n=[],r=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=a,this.endAt=o,this.Te=null}};function v_(e,t=null,n=[],r=[],i=null,a=null,o=null){return new Bte(e,t,n,r,i,a,o)}function y_(e){let t=Th(e);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+=`|cg:`+t.collectionGroup),e+=`|f:`,e+=t.filters.map((e=>f_(e))).join(`,`),e+=`|ob:`,e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(`,`),ig(t.limit)||(e+=`|l:`,e+=t.limit),t.startAt&&(e+=`|lb:`,e+=t.startAt.inclusive?`b:`:`a:`,e+=t.startAt.position.map((e=>Hg(e))).join(`,`)),t.endAt&&(e+=`|ub:`,e+=t.endAt.inclusive?`a:`:`b:`,e+=t.endAt.position.map((e=>Hg(e))).join(`,`)),t.Te=e}return t.Te}function b_(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Nte(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!p_(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!a_(e.startAt,t.startAt)&&a_(e.endAt,t.endAt)}function x_(e){return zh.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var S_=class{constructor(e,t=null,n=[],r=[],i=null,a=`F`,o=null,s=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=s,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}};function Vte(e,t,n,r,i,a,o,s){return new S_(e,t,n,r,i,a,o,s)}function C_(e){return new S_(e)}function w_(e){return e.filters.length===0&&e.limit===null&&e.startAt==null&&e.endAt==null&&(e.explicitOrderBy.length===0||e.explicitOrderBy.length===1&&e.explicitOrderBy[0].field.isKeyField())}function T_(e){return e.collectionGroup!==null}function E_(e){let t=Th(e);if(t.Ie===null){t.Ie=[];let e=new Set;for(let n of t.explicitOrderBy)t.Ie.push(n),e.add(n.field.canonicalString());let n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:`asc`;(function(e){let t=new mg(Rh.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t})(t).forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new o_(r,n))})),e.has(Rh.keyField().canonicalString())||t.Ie.push(new o_(Rh.keyField(),n))}return t.Ie}function D_(e){let t=Th(e);return t.Ee||=Hte(t,E_(e)),t.Ee}function Hte(e,t){if(e.limitType===`F`)return v_(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{let t=e.dir===`desc`?`asc`:`desc`;return new o_(e.field,t)}));let n=e.endAt?new r_(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new r_(e.startAt.position,e.startAt.inclusive):null;return v_(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function O_(e,t){let n=e.filters.concat([t]);return new S_(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function k_(e,t,n){return new S_(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function A_(e,t){return b_(D_(e),D_(t))&&e.limitType===t.limitType}function j_(e){return`${y_(D_(e))}|lt:${e.limitType}`}function M_(e){return`Query(target=${function(e){let t=e.path.canonicalString();return e.collectionGroup!==null&&(t+=` collectionGroup=`+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>m_(e))).join(`, `)}]`),ig(e.limit)||(t+=`, limit: `+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(`, `)}]`),e.startAt&&(t+=`, startAt: `,t+=e.startAt.inclusive?`b:`:`a:`,t+=e.startAt.position.map((e=>Hg(e))).join(`,`)),e.endAt&&(t+=`, endAt: `,t+=e.endAt.inclusive?`a:`:`b:`,t+=e.endAt.position.map((e=>Hg(e))).join(`,`)),`Target(${t})`}(D_(e))}; limitType=${e.limitType})`}function N_(e,t){return t.isFoundDocument()&&function(e,t){let n=t.key.path;return e.collectionGroup===null?zh.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n):t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n)}(e,t)&&function(e,t){for(let n of E_(e))if(!n.field.isKeyField()&&t.data.field(n.field)===null)return!1;return!0}(e,t)&&function(e,t){for(let n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){let r=i_(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,E_(e),t)||e.endAt&&!function(e,t,n){let r=i_(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,E_(e),t))}(e,t)}function Ute(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function P_(e){return(t,n)=>{let r=!1;for(let i of E_(e)){let e=Wte(i,t,n);if(e!==0)return e;r||=i.field.isKeyField()}return 0}}function Wte(e,t,n){let r=e.field.isKeyField()?zh.comparator(t.key,n.key):function(e,t,n){let r=t.data.field(e),i=n.data.field(e);return r!==null&&i!==null?zg(r,i):Sh(42886)}(e.field,t,n);switch(e.dir){case`asc`:return r;case`desc`:return-1*r;default:return Sh(19790,{direction:e.dir})}}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var F_=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(let[t,r]of n)if(this.equalsFn(t,e))return r}}has(e){return this.get(e)!==void 0}set(e,t){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return n.length===1?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){lg(this.inner,((t,n)=>{for(let[t,r]of n)e(t,r)}))}isEmpty(){return ug(this.inner)}size(){return this.innerSize}},Gte=new dg(zh.comparator);function I_(){return Gte}var L_=new dg(zh.comparator);function R_(...e){let t=L_;for(let n of e)t=t.insert(n.key,n);return t}function z_(e){let t=L_;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function B_(){return H_()}function V_(){return H_()}function H_(){return new F_((e=>e.toString()),((e,t)=>e.isEqual(t)))}var Kte=new dg(zh.comparator),qte=new mg(zh.comparator);function U_(...e){let t=qte;for(let n of e)t=t.add(n);return t}var Jte=new mg(jh);function Yte(){return Jte}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function W_(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:`NaN`};if(t===1/0)return{doubleValue:`Infinity`};if(t===-1/0)return{doubleValue:`-Infinity`}}return{doubleValue:ag(t)?`-0`:t}}function G_(e){return{integerValue:``+e}}function Xte(e,t){return Ote(t)?G_(t):W_(e,t)}
/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var K_=class{constructor(){this._=void 0}};function Zte(e,t,n){return e instanceof J_?function(e,t){let n={fields:{[Cg]:{stringValue:Sg},[Tg]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Eg(t)&&(t=Dg(t)),t&&(n.fields[wg]=t),{mapValue:n}}(n,t):e instanceof Y_?X_(e,t):e instanceof Z_?Q_(e,t):function(e,t){let n=q_(e,t),r=ev(n)+ev(e.Ae);return Kg(n)&&Kg(e.Ae)?G_(r):W_(e.serializer,r)}(e,t)}function Qte(e,t,n){return e instanceof Y_?X_(e,t):e instanceof Z_?Q_(e,t):n}function q_(e,t){return e instanceof $_?function(e){return Kg(e)||function(e){return!!e&&`doubleValue`in e}(e)}(t)?t:{integerValue:0}:null}var J_=class extends K_{},Y_=class extends K_{constructor(e){super(),this.elements=e}};function X_(e,t){let n=tv(t);for(let t of e.elements)n.some((e=>Lg(e,t)))||n.push(t);return{arrayValue:{values:n}}}var Z_=class extends K_{constructor(e){super(),this.elements=e}};function Q_(e,t){let n=tv(t);for(let t of e.elements)n=n.filter((e=>!Lg(e,t)));return{arrayValue:{values:n}}}var $_=class extends K_{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function ev(e){return bg(e.integerValue||e.doubleValue)}function tv(e){return qg(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var $te=class{constructor(e,t){this.field=e,this.transform=t}};function ene(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Y_&&t instanceof Y_||e instanceof Z_&&t instanceof Z_?Ph(e.elements,t.elements,Lg):e instanceof $_&&t instanceof $_?Lg(e.Ae,t.Ae):e instanceof J_&&t instanceof J_}(e.transform,t.transform)}var tne=class{constructor(e,t){this.version=e,this.transformResults=t}},nv=class e{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new e}static exists(t){return new e(void 0,t)}static updateTime(t){return new e(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function rv(e,t){return e.updateTime===void 0?e.exists===void 0||e.exists===t.isFoundDocument():t.isFoundDocument()&&t.version.isEqual(e.updateTime)}var iv=class{};function av(e,t){if(!e.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return e.isNoDocument()?new pv(e.key,nv.none()):new cv(e.key,e.data,nv.none());{let n=e.data,r=e_.empty(),i=new mg(Rh.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);t===null&&e.length>1&&(e=e.popLast(),t=n.field(e)),t===null?r.delete(e):r.set(e,t),i=i.add(e)}return new lv(e.key,r,new gg(i.toArray()),nv.none())}}function nne(e,t,n){e instanceof cv?function(e,t,n){let r=e.value.clone(),i=dv(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof lv?function(e,t,n){if(!rv(e.precondition,t))return void t.convertToUnknownDocument(n.version);let r=dv(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(uv(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function ov(e,t,n,r){return e instanceof cv?function(e,t,n,r){if(!rv(e.precondition,t))return n;let i=e.value.clone(),a=fv(e.fieldTransforms,r,t);return i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof lv?function(e,t,n,r){if(!rv(e.precondition,t))return n;let i=fv(e.fieldTransforms,r,t),a=t.data;return a.setAll(uv(e)),a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),n===null?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return rv(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function rne(e,t){let n=null;for(let r of e.fieldTransforms){let e=t.data.field(r.field),i=q_(r.transform,e||null);i!=null&&(n===null&&(n=e_.empty()),n.set(r.field,i))}return n||null}function sv(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return e===void 0&&t===void 0||!(!e||!t)&&Ph(e,t,((e,t)=>ene(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(e.type===0?e.value.isEqual(t.value):e.type!==1||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}var cv=class extends iv{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},lv=class extends iv{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}};function uv(e){let t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){let r=e.data.field(n);t.set(n,r)}})),t}function dv(e,t,n){let r=new Map;wh(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let i=0;i<n.length;i++){let a=e[i],o=a.transform,s=t.data.field(a.field);r.set(a.field,Qte(o,s,n[i]))}return r}function fv(e,t,n){let r=new Map;for(let i of e){let e=i.transform,a=n.data.field(i.field);r.set(i.field,Zte(e,a,t))}return r}var pv=class extends iv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},ine=class extends iv{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}},ane=class{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){let n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){let r=this.mutations[t];r.key.isEqual(e.key)&&nne(r,e,n[t])}}applyToLocalView(e,t){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(t=ov(n,e,t,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(t=ov(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let n=V_();return this.mutations.forEach((r=>{let i=e.get(r.key),a=i.overlayedDocument,o=this.applyToLocalView(a,i.mutatedFields);o=t.has(r.key)?null:o;let s=av(a,o);s!==null&&n.set(r.key,s),a.isValidDocument()||a.convertToNoDocument(Zh.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),U_())}isEqual(e){return this.batchId===e.batchId&&Ph(this.mutations,e.mutations,((e,t)=>sv(e,t)))&&Ph(this.baseMutations,e.baseMutations,((e,t)=>sv(e,t)))}},one=class e{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(t,n,r){wh(t.mutations.length===r.length,58842,{me:t.mutations.length,fe:r.length});let i=function(){return Kte}(),a=t.mutations;for(let e=0;e<a.length;e++)i=i.insert(a[e].key,r[e].version);return new e(t,n,r,i)}},sne=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}},cne=class{constructor(e,t){this.count=e,this.unchangedNames=t}},mv,hv;function lne(e){switch(e){case P.OK:return Sh(64938);case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0;default:return Sh(15467,{code:e})}}function gv(e){if(e===void 0)return yh(`GRPC error has no .code`),P.UNKNOWN;switch(e){case mv.OK:return P.OK;case mv.CANCELLED:return P.CANCELLED;case mv.UNKNOWN:return P.UNKNOWN;case mv.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case mv.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case mv.INTERNAL:return P.INTERNAL;case mv.UNAVAILABLE:return P.UNAVAILABLE;case mv.UNAUTHENTICATED:return P.UNAUTHENTICATED;case mv.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case mv.NOT_FOUND:return P.NOT_FOUND;case mv.ALREADY_EXISTS:return P.ALREADY_EXISTS;case mv.PERMISSION_DENIED:return P.PERMISSION_DENIED;case mv.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case mv.ABORTED:return P.ABORTED;case mv.OUT_OF_RANGE:return P.OUT_OF_RANGE;case mv.UNIMPLEMENTED:return P.UNIMPLEMENTED;case mv.DATA_LOSS:return P.DATA_LOSS;default:return Sh(39323,{code:e})}}(hv=mv||={})[hv.OK=0]=`OK`,hv[hv.CANCELLED=1]=`CANCELLED`,hv[hv.UNKNOWN=2]=`UNKNOWN`,hv[hv.INVALID_ARGUMENT=3]=`INVALID_ARGUMENT`,hv[hv.DEADLINE_EXCEEDED=4]=`DEADLINE_EXCEEDED`,hv[hv.NOT_FOUND=5]=`NOT_FOUND`,hv[hv.ALREADY_EXISTS=6]=`ALREADY_EXISTS`,hv[hv.PERMISSION_DENIED=7]=`PERMISSION_DENIED`,hv[hv.UNAUTHENTICATED=16]=`UNAUTHENTICATED`,hv[hv.RESOURCE_EXHAUSTED=8]=`RESOURCE_EXHAUSTED`,hv[hv.FAILED_PRECONDITION=9]=`FAILED_PRECONDITION`,hv[hv.ABORTED=10]=`ABORTED`,hv[hv.OUT_OF_RANGE=11]=`OUT_OF_RANGE`,hv[hv.UNIMPLEMENTED=12]=`UNIMPLEMENTED`,hv[hv.INTERNAL=13]=`INTERNAL`,hv[hv.UNAVAILABLE=14]=`UNAVAILABLE`,hv[hv.DATA_LOSS=15]=`DATA_LOSS`;
/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var une=null;
/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function dne(){return new TextEncoder}
/**
* @license
* Copyright 2022 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var fne=new eh([4294967295,4294967295],0);function _v(e){let t=dne().encode(e),n=new th;return n.update(t),new Uint8Array(n.digest())}function vv(e){let t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new eh([n,r],0),new eh([i,a],0)]}var pne=class e{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new yv(`Invalid padding: ${t}`);if(n<0||e.length>0&&this.hashCount===0)throw new yv(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new yv(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=eh.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(eh.fromNumber(n)));return r.compare(fne)===1&&(r=new eh([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=_v(e),[n,r]=vv(t);for(let e=0;e<this.hashCount;e++){let t=this.ye(n,r,e);if(!this.we(t))return!1}return!0}static create(t,n,r){let i=t%8==0?0:8-t%8,a=new Uint8Array(Math.ceil(t/8)),o=new e(a,i,n);return r.forEach((e=>o.insert(e))),o}insert(e){if(this.ge===0)return;let t=_v(e),[n,r]=vv(t);for(let e=0;e<this.hashCount;e++){let t=this.ye(n,r,e);this.Se(t)}}Se(e){let t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}},yv=class extends Error{constructor(){super(...arguments),this.name=`BloomFilterError`}},bv=class e{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(t,n,r){let i=new Map;return i.set(t,xv.createSynthesizedTargetChangeForCurrentChange(t,n,r)),new e(Zh.min(),i,new dg(jh),I_(),U_())}},xv=class e{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(t,n,r){return new e(r,n,U_(),U_(),U_())}},Sv=class{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}},Cv=class{constructor(e,t){this.targetId=e,this.Ce=t}},wv=class{constructor(e,t,n=vg.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}},Tv=class{constructor(){this.ve=0,this.Fe=Dv(),this.Me=vg.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=U_(),t=U_(),n=U_();return this.Fe.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Sh(38017,{changeType:i})}})),new xv(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=Dv()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){--this.ve,wh(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}},mne=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=I_(),this.Je=Ev(),this.He=Ev(),this.Ye=new dg(jh)}Ze(e){for(let t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{let n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:Sh(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((e,n)=>{this.rt(n)&&t(n)}))}st(e){let t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){let i=r.target;if(x_(i))if(n===0){let e=new zh(i.path);this.et(t,e,n_.newNoDocument(e,Zh.min()))}else wh(n===1,20013,{expectedCount:n});else{let r=this._t(t);if(r!==n){let n=this.ut(e),i=n?this.ct(n,e,r):1;if(i!==0){this.it(t);let e=i===2?`TargetPurposeExistenceFilterMismatchBloom`:`TargetPurposeExistenceFilterMismatch`;this.Ye=this.Ye.insert(t,e)}une?.lt(function(e,t,n,r,i){let a={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},o=t.unchangedNames;return o&&(a.bloomFilter={applied:i===0,hashCount:o?.hashCount??0,bitmapLength:o?.bits?.bitmap?.length??0,padding:o?.bits?.padding??0,mightContain:e=>r?.mightContain(e)??!1}),a}(r,e.Ce,this.Ge.ht(),n,i))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:n=``,padding:r=0},hashCount:i=0}=t,a,o;try{a=xg(n).toUint8Array()}catch(e){if(e instanceof _g)return bh(`Decoding the base64 bloom filter in existence filter failed (`+e.message+`); ignoring the bloom filter and falling back to full re-query.`),null;throw e}try{o=new pne(a,r,i)}catch(e){return bh(e instanceof yv?`BloomFilter error: `:`Applying bloom filter failed: `,e),null}return o.ge===0?null:o}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){let n=this.Ge.getRemoteKeysForTarget(t),r=0;return n.forEach((n=>{let i=this.Ge.ht(),a=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(a)||(this.et(t,n,null),r++)})),r}Tt(e){let t=new Map;this.ze.forEach(((n,r)=>{let i=this.ot(r);if(i){if(n.current&&x_(i.target)){let t=new zh(i.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,n_.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}}));let n=U_();this.He.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{let t=this.ot(e);return!t||t.purpose===`TargetPurposeLimboResolution`||(r=!1,!1)})),r&&(n=n.add(e))})),this.je.forEach(((t,n)=>n.setReadTime(e)));let r=new bv(e,t,this.Ye,this.je,n);return this.je=I_(),this.Je=Ev(),this.He=Ev(),this.Ye=new dg(jh),r}Xe(e,t){if(!this.rt(e))return;let n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;let r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new Tv,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new mg(jh),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new mg(jh),this.Je=this.Je.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||vh(`WatchChangeAggregator`,`Detected inactive target`,e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Tv),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function Ev(){return new dg(zh.comparator)}function Dv(){return new dg(zh.comparator)}var hne=(()=>({asc:`ASCENDING`,desc:`DESCENDING`}))(),gne=(()=>({"<":`LESS_THAN`,"<=":`LESS_THAN_OR_EQUAL`,">":`GREATER_THAN`,">=":`GREATER_THAN_OR_EQUAL`,"==":`EQUAL`,"!=":`NOT_EQUAL`,"array-contains":`ARRAY_CONTAINS`,in:`IN`,"not-in":`NOT_IN`,"array-contains-any":`ARRAY_CONTAINS_ANY`}))(),_ne=(()=>({and:`AND`,or:`OR`}))(),vne=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Ov(e,t){return e.useProto3Json||ig(t)?t:{value:t}}function kv(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,``).replace(`Z`,``)}.${(`000000000`+t.nanoseconds).slice(-9)}Z`:{seconds:``+t.seconds,nanos:t.nanoseconds}}function Av(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function yne(e,t){return kv(e,t.toTimestamp())}function jv(e){return wh(!!e,49232),Zh.fromTimestamp(function(e){let t=yg(e);return new Xh(t.seconds,t.nanos)}(e))}function Mv(e,t){return Nv(e,t).canonicalString()}function Nv(e,t){let n=function(e){return new Lh([`projects`,e.projectId,`databases`,e.database])}(e).child(`documents`);return t===void 0?n:n.child(t)}function Pv(e){let t=Lh.fromString(e);return wh(Gv(t),10190,{key:t.toString()}),t}function Fv(e,t){return Mv(e.databaseId,t.path)}function Iv(e,t){let n=Pv(t);if(n.get(1)!==e.databaseId.projectId)throw new Eh(P.INVALID_ARGUMENT,`Tried to deserialize key from different project: `+n.get(1)+` vs `+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Eh(P.INVALID_ARGUMENT,`Tried to deserialize key from different database: `+n.get(3)+` vs `+e.databaseId.database);return new zh(zv(n))}function Lv(e,t){return Mv(e.databaseId,t)}function bne(e){let t=Pv(e);return t.length===4?Lh.emptyPath():zv(t)}function Rv(e){return new Lh([`projects`,e.databaseId.projectId,`databases`,e.databaseId.database]).canonicalString()}function zv(e){return wh(e.length>4&&e.get(4)===`documents`,29091,{key:e.toString()}),e.popFirst(5)}function Bv(e,t,n){return{name:Fv(e,t),fields:n.value.mapValue.fields}}function xne(e,t){let n;if(`targetChange`in t){t.targetChange;let r=function(e){return e===`NO_CHANGE`?0:e===`ADD`?1:e===`REMOVE`?2:e===`CURRENT`?3:e===`RESET`?4:Sh(39313,{state:e})}(t.targetChange.targetChangeType||`NO_CHANGE`),i=t.targetChange.targetIds||[],a=function(e,t){return e.useProto3Json?(wh(t===void 0||typeof t==`string`,58123),vg.fromBase64String(t||``)):(wh(t===void 0||t instanceof Buffer||t instanceof Uint8Array,16193),vg.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&function(e){let t=e.code===void 0?P.UNKNOWN:gv(e.code);return new Eh(t,e.message||``)}(o);n=new wv(r,i,a,s||null)}else if(`documentChange`in t){t.documentChange;let r=t.documentChange;r.document,r.document.name,r.document.updateTime;let i=Iv(e,r.document.name),a=jv(r.document.updateTime),o=r.document.createTime?jv(r.document.createTime):Zh.min(),s=new e_({mapValue:{fields:r.document.fields}}),c=n_.newFoundDocument(i,a,o,s),l=r.targetIds||[],u=r.removedTargetIds||[];n=new Sv(l,u,c.key,c)}else if(`documentDelete`in t){t.documentDelete;let r=t.documentDelete;r.document;let i=Iv(e,r.document),a=r.readTime?jv(r.readTime):Zh.min(),o=n_.newNoDocument(i,a),s=r.removedTargetIds||[];n=new Sv([],s,o.key,o)}else if(`documentRemove`in t){t.documentRemove;let r=t.documentRemove;r.document;let i=Iv(e,r.document),a=r.removedTargetIds||[];n=new Sv([],a,i,null)}else{if(!(`filter`in t))return Sh(11601,{Rt:t});{t.filter;let e=t.filter;e.targetId;let{count:r=0,unchangedNames:i}=e,a=new cne(r,i),o=e.targetId;n=new Cv(o,a)}}return n}function Sne(e,t){let n;if(t instanceof cv)n={update:Bv(e,t.key,t.value)};else if(t instanceof pv)n={delete:Fv(e,t.key)};else if(t instanceof lv)n={update:Bv(e,t.key,t.data),updateMask:jne(t.fieldMask)};else{if(!(t instanceof ine))return Sh(16599,{Vt:t.type});n={verify:Fv(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){let n=t.transform;if(n instanceof J_)return{fieldPath:t.field.canonicalString(),setToServerValue:`REQUEST_TIME`};if(n instanceof Y_)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Z_)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof $_)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw Sh(20930,{transform:t.transform})}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return t.updateTime===void 0?t.exists===void 0?Sh(27497):{exists:t.exists}:{updateTime:yne(e,t.updateTime)}}(e,t.precondition)),n}function Cne(e,t){return e&&e.length>0?(wh(t!==void 0,14353),e.map((e=>function(e,t){let n=e.updateTime?jv(e.updateTime):jv(t);return n.isEqual(Zh.min())&&(n=jv(t)),new tne(n,e.transformResults||[])}(e,t)))):[]}function wne(e,t){return{documents:[Lv(e,t.path)]}}function Tne(e,t){let n={structuredQuery:{}},r=t.path,i;t.collectionGroup===null?(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]):(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]),n.parent=Lv(e,i);let a=function(e){if(e.length!==0)return Wv(l_.create(e,`and`))}(t.filters);a&&(n.structuredQuery.where=a);let o=function(e){if(e.length!==0)return e.map((e=>function(e){return{field:Hv(e.field),direction:One(e.dir)}}(e)))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);let s=Ov(e,t.limit);return s!==null&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:i}}function Ene(e){let t=bne(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){wh(r===1,65062);let e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let a=[];n.where&&(a=function(e){let t=Vv(e);return t instanceof l_&&d_(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new o_(Uv(e.field),function(e){switch(e){case`ASCENDING`:return`asc`;case`DESCENDING`:return`desc`;default:return}}(e.direction))}(e)))}(n.orderBy));let s=null;n.limit&&(s=function(e){let t;return t=typeof e==`object`?e.value:e,ig(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){let t=!!e.before,n=e.values||[];return new r_(n,t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){let t=!e.before,n=e.values||[];return new r_(n,t)}(n.endAt)),Vte(t,i,o,a,s,`F`,c,l)}function Dne(e,t){let n=function(e){switch(e){case`TargetPurposeListen`:return null;case`TargetPurposeExistenceFilterMismatch`:return`existence-filter-mismatch`;case`TargetPurposeExistenceFilterMismatchBloom`:return`existence-filter-mismatch-bloom`;case`TargetPurposeLimboResolution`:return`limbo-document`;default:return Sh(28987,{purpose:e})}}(t.purpose);return n==null?null:{"goog-listen-tags":n}}function Vv(e){return e.unaryFilter===void 0?e.fieldFilter===void 0?e.compositeFilter===void 0?Sh(30097,{filter:e}):function(e){return l_.create(e.compositeFilter.filters.map((e=>Vv(e))),function(e){switch(e){case`AND`:return`and`;case`OR`:return`or`;default:return Sh(1026)}}(e.compositeFilter.op))}(e):function(e){return c_.create(Uv(e.fieldFilter.field),function(e){switch(e){case`EQUAL`:return`==`;case`NOT_EQUAL`:return`!=`;case`GREATER_THAN`:return`>`;case`GREATER_THAN_OR_EQUAL`:return`>=`;case`LESS_THAN`:return`<`;case`LESS_THAN_OR_EQUAL`:return`<=`;case`ARRAY_CONTAINS`:return`array-contains`;case`IN`:return`in`;case`NOT_IN`:return`not-in`;case`ARRAY_CONTAINS_ANY`:return`array-contains-any`;case`OPERATOR_UNSPECIFIED`:return Sh(58110);default:return Sh(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):function(e){switch(e.unaryFilter.op){case`IS_NAN`:let t=Uv(e.unaryFilter.field);return c_.create(t,`==`,{doubleValue:NaN});case`IS_NULL`:let n=Uv(e.unaryFilter.field);return c_.create(n,`==`,{nullValue:`NULL_VALUE`});case`IS_NOT_NAN`:let r=Uv(e.unaryFilter.field);return c_.create(r,`!=`,{doubleValue:NaN});case`IS_NOT_NULL`:let i=Uv(e.unaryFilter.field);return c_.create(i,`!=`,{nullValue:`NULL_VALUE`});case`OPERATOR_UNSPECIFIED`:return Sh(61313);default:return Sh(60726)}}(e)}function One(e){return hne[e]}function kne(e){return gne[e]}function Ane(e){return _ne[e]}function Hv(e){return{fieldPath:e.canonicalString()}}function Uv(e){return Rh.fromServerFormat(e.fieldPath)}function Wv(e){return e instanceof c_?function(e){if(e.op===`==`){if(Yg(e.value))return{unaryFilter:{field:Hv(e.field),op:`IS_NAN`}};if(Jg(e.value))return{unaryFilter:{field:Hv(e.field),op:`IS_NULL`}}}else if(e.op===`!=`){if(Yg(e.value))return{unaryFilter:{field:Hv(e.field),op:`IS_NOT_NAN`}};if(Jg(e.value))return{unaryFilter:{field:Hv(e.field),op:`IS_NOT_NULL`}}}return{fieldFilter:{field:Hv(e.field),op:kne(e.op),value:e.value}}}(e):e instanceof l_?function(e){let t=e.getFilters().map((e=>Wv(e)));return t.length===1?t[0]:{compositeFilter:{op:Ane(e.op),filters:t}}}(e):Sh(54877,{filter:e})}function jne(e){let t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Gv(e){return e.length>=4&&e.get(0)===`projects`&&e.get(2)===`databases`}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Kv=class e{constructor(e,t,n,r,i=Zh.min(),a=Zh.min(),o=vg.EMPTY_BYTE_STRING,s=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=s}withSequenceNumber(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}},Mne=class{constructor(e){this.yt=e}};function Nne(e){let t=Ene({parent:e.parent,structuredQuery:e.structuredQuery});return e.limitType===`LAST`?k_(t,t.limit,`L`):t}
/**
* @license
* Copyright 2021 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var qv=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if(`nullValue`in e)this.Ft(t,5);else if(`booleanValue`in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if(`integerValue`in e)this.Ft(t,15),t.Mt(bg(e.integerValue));else if(`doubleValue`in e){let n=bg(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),ag(n)?t.Mt(0):t.Mt(n))}else if(`timestampValue`in e){let n=e.timestampValue;this.Ft(t,20),typeof n==`string`&&(n=yg(n)),t.xt(`${n.seconds||``}`),t.Mt(n.nanos||0)}else if(`stringValue`in e)this.Ot(e.stringValue,t),this.Nt(t);else if(`bytesValue`in e)this.Ft(t,30),t.Bt(xg(e.bytesValue)),this.Nt(t);else if(`referenceValue`in e)this.Lt(e.referenceValue,t);else if(`geoPointValue`in e){let n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else `mapValue`in e?$g(e)?this.Ft(t,2**53-1):Zg(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):`arrayValue`in e?(this.Qt(e.arrayValue,t),this.Nt(t)):Sh(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){let n=e.fields||{};this.Ft(t,55);for(let e of Object.keys(n))this.Ot(e,t),this.Ct(n[e],t)}kt(e,t){let n=e.fields||{};this.Ft(t,53);let r=Fg,i=n[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(bg(i)),this.Ot(r,t),this.Ct(n[r],t)}Qt(e,t){let n=e.values||[];this.Ft(t,50);for(let e of n)this.Ct(e,t)}Lt(e,t){this.Ft(t,37),zh.fromName(e).path.forEach((e=>{this.Ft(t,60),this.Ut(e,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};qv.Kt=new qv;
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Pne=class{constructor(){this.Cn=new Fne}addToCollectionParentIndex(e,t){return this.Cn.add(t),F.resolve()}getCollectionParents(e,t){return F.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return F.resolve()}deleteFieldIndex(e,t){return F.resolve()}deleteAllFieldIndexes(e){return F.resolve()}createTargetIndexes(e,t){return F.resolve()}getDocumentsMatchingTarget(e,t){return F.resolve(null)}getIndexType(e,t){return F.resolve(0)}getFieldIndexes(e,t){return F.resolve([])}getNextCollectionGroupToUpdate(e){return F.resolve(null)}getMinOffset(e,t){return F.resolve($h.min())}getMinOffsetFromCollectionGroup(e,t){return F.resolve($h.min())}updateCollectionGroup(e,t,n){return F.resolve()}updateIndexEntries(e,t){return F.resolve()}},Fne=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new mg(Lh.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new mg(Lh.comparator)).toArray()}};new Uint8Array;
/**
* @license
* Copyright 2018 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var Jv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Yv=41943040,Xv=class e{static withCacheSize(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}};
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
Xv.DEFAULT_COLLECTION_PERCENTILE=10,Xv.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xv.DEFAULT=new Xv(Yv,Xv.DEFAULT_COLLECTION_PERCENTILE,Xv.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xv.DISABLED=new Xv(-1,0,0);
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Zv=class e{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new e(0)}static cr(){return new e(-1)}},Qv=`LruGarbageCollector`,Ine=1048576;function $v([e,t],[n,r]){let i=jh(e,n);return i===0?jh(t,r):i}var ey=class{constructor(e){this.Ir=e,this.buffer=new mg($v),this.Er=0}dr(){return++this.Er}Ar(e){let t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{let e=this.buffer.last();$v(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}},ty=class{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&=(this.Rr.cancel(),null)}get started(){return this.Rr!==null}Vr(e){vh(Qv,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay(`lru_garbage_collection`,e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){tg(e)?vh(Qv,`Ignoring IndexedDB error during garbage collection: `,e):await eg(e)}await this.Vr(3e5)}))}},ny=class{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(t===0)return F.resolve(ng.ce);let n=new ey(t);return this.mr.forEachTarget(e,(e=>n.Ar(e.sequenceNumber))).next((()=>this.mr.pr(e,(e=>n.Ar(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(vh(`LruGarbageCollector`,`Garbage collection skipped; disabled`),F.resolve(Jv)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(vh(`LruGarbageCollector`,`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Jv):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,a,o,s,c,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(vh(`LruGarbageCollector`,`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,o=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,s=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(c=Date.now(),_h()<=Tl.DEBUG&&vh(`LruGarbageCollector`,`LRU Garbage Collection\n\tCounted targets in ${a-l}ms\n\tDetermined least recently used ${r} in `+(o-a)+`ms
\tRemoved ${i} targets in `+(s-o)+`ms
\tRemoved ${e} documents in `+(c-s)+`ms
Total Duration: ${c-l}ms`),F.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}};function ry(e,t){return new ny(e,t)}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var iy=class{constructor(){this.changes=new F_((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,n_.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let n=this.changes.get(t);return n===void 0?this.getFromCache(e,t):F.resolve(n)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}},ay=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}},oy=class{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(n!==null&&ov(n.mutation,e,gg.empty(),Xh.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,U_()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=U_()){let r=B_();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=R_();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){let n=B_();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,U_())))}populateOverlays(e,t,n){let r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=I_(),a=H_(),o=function(){return H_()}();return t.forEach(((e,t)=>{let o=n.get(t.key);r.has(t.key)&&(o===void 0||o.mutation instanceof lv)?i=i.insert(t.key,t):o===void 0?a.set(t.key,gg.empty()):(a.set(t.key,o.mutation.getFieldMask()),ov(o.mutation,t,o.mutation.getFieldMask(),Xh.now()))})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>a.set(e,t))),t.forEach(((e,t)=>o.set(e,new ay(t,a.get(e)??null)))),o)))}recalculateAndSaveOverlays(e,t){let n=H_(),r=new dg(((e,t)=>e-t)),i=U_();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(let i of e)i.keys().forEach((e=>{let a=t.get(e);if(a===null)return;let o=n.get(e)||gg.empty();o=i.applyToLocalView(a,o),n.set(e,o);let s=(r.get(i.batchId)||U_()).add(e);r=r.insert(i.batchId,s)}))})).next((()=>{let a=[],o=r.getReverseIterator();for(;o.hasNext();){let r=o.getNext(),s=r.key,c=r.value,l=V_();c.forEach((e=>{if(!i.has(e)){let r=av(t.get(e),n.get(e));r!==null&&l.set(e,r),i=i.add(e)}})),a.push(this.documentOverlayCache.saveOverlays(e,s,l))}return F.waitFor(a)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return zh.isDocumentKey(e.path)&&e.collectionGroup===null&&e.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):T_(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{let a=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):F.resolve(B_()),o=Qh,s=i;return a.next((t=>F.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?F.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{s=s.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,s,t,U_()))).next((e=>({batchId:o,changes:z_(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new zh(t)).next((e=>{let t=R_();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){let i=t.collectionGroup,a=R_();return this.indexManager.getCollectionParents(e,i).next((o=>F.forEach(o,(o=>{let s=function(e,t){return new S_(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,s,n,r).next((e=>{e.forEach(((e,t)=>{a=a.insert(e,t)}))}))})).next((()=>a))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{let r=n.getKey();e.get(r)===null&&(e=e.insert(r,n_.newInvalidDocument(r)))}));let n=R_();return e.forEach(((e,r)=>{let a=i.get(e);a!==void 0&&ov(a.mutation,r,gg.empty(),Xh.now()),N_(t,r)&&(n=n.insert(e,r))})),n}))}},sy=class{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return F.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:jv(e.createTime)}}(t)),F.resolve()}getNamedQuery(e,t){return F.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:Nne(e.bundledQuery),readTime:jv(e.readTime)}}(t)),F.resolve()}},cy=class{constructor(){this.overlays=new dg(zh.comparator),this.qr=new Map}getOverlay(e,t){return F.resolve(this.overlays.get(t))}getOverlays(e,t){let n=B_();return F.forEach(t,(t=>this.getOverlay(e,t).next((e=>{e!==null&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.St(e,t,r)})),F.resolve()}removeOverlaysForBatchId(e,t,n){let r=this.qr.get(n);return r!==void 0&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.qr.delete(n)),F.resolve()}getOverlaysForCollection(e,t,n){let r=B_(),i=t.length+1,a=new zh(t.child(``)),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){let e=o.getNext().value,a=e.getKey();if(!t.isPrefixOf(a.path))break;a.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return F.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new dg(((e,t)=>e-t)),a=this.overlays.getIterator();for(;a.hasNext();){let e=a.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);t===null&&(t=B_(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}let o=B_(),s=i.getIterator();for(;s.hasNext()&&(s.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return F.resolve(o)}St(e,t,n){let r=this.overlays.get(n.key);if(r!==null){let e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new sne(t,n));let i=this.qr.get(t);i===void 0&&(i=U_(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}},ly=class{constructor(){this.sessionToken=vg.EMPTY_BYTE_STRING}getSessionToken(e){return F.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,F.resolve()}},uy=class{constructor(){this.Qr=new mg(dy.$r),this.Ur=new mg(dy.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){let n=new dy(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Gr(new dy(e,t))}zr(e,t){e.forEach((e=>this.removeReference(e,t)))}jr(e){let t=new zh(new Lh([])),n=new dy(t,e),r=new dy(t,e+1),i=[];return this.Ur.forEachInRange([n,r],(e=>{this.Gr(e),i.push(e.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){let t=new zh(new Lh([])),n=new dy(t,e),r=new dy(t,e+1),i=U_();return this.Ur.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){let t=new dy(e,0),n=this.Qr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}},dy=class{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return zh.comparator(e.key,t.key)||jh(e.Yr,t.Yr)}static Kr(e,t){return jh(e.Yr,t.Yr)||zh.comparator(e.key,t.key)}},Lne=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new mg(dy.$r)}checkEmpty(e){return F.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,r){let i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new ane(i,t,n,r);this.mutationQueue.push(a);for(let t of r)this.Zr=this.Zr.add(new dy(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return F.resolve(a)}lookupMutationBatch(e,t){return F.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){let n=t+1,r=this.ei(n),i=r<0?0:r;return F.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return F.resolve(this.mutationQueue.length===0?rg:this.tr-1)}getAllMutationBatches(e){return F.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let n=new dy(t,0),r=new dy(t,1/0),i=[];return this.Zr.forEachInRange([n,r],(e=>{let t=this.Xr(e.Yr);i.push(t)})),F.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new mg(jh);return t.forEach((e=>{let t=new dy(e,0),r=new dy(e,1/0);this.Zr.forEachInRange([t,r],(e=>{n=n.add(e.Yr)}))})),F.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,r=n.length+1,i=n;zh.isDocumentKey(i)||(i=i.child(``));let a=new dy(new zh(i),0),o=new mg(jh);return this.Zr.forEachWhile((e=>{let t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Yr)),!0)}),a),F.resolve(this.ti(o))}ti(e){let t=[];return e.forEach((e=>{let n=this.Xr(e);n!==null&&t.push(n)})),t}removeMutationBatch(e,t){wh(this.ni(t.batchId,`removed`)===0,55003),this.mutationQueue.shift();let n=this.Zr;return F.forEach(t.mutations,(r=>{let i=new dy(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,t){let n=new dy(t,0),r=this.Zr.firstAfterOrEqual(n);return F.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,F.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){let t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}},Rne=class{constructor(e){this.ri=e,this.docs=function(){return new dg(zh.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let n=t.key,r=this.docs.get(n),i=r?r.size:0,a=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let n=this.docs.get(t);return F.resolve(n?n.document.mutableCopy():n_.newInvalidDocument(t))}getEntries(e,t){let n=I_();return t.forEach((e=>{let t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():n_.newInvalidDocument(e))})),F.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=I_(),a=t.path,o=new zh(a.child(`__id-9223372036854775808__`)),s=this.docs.getIteratorFrom(o);for(;s.hasNext();){let{key:e,value:{document:o}}=s.getNext();if(!a.isPrefixOf(e.path))break;e.path.length>a.length+1||wte(Cte(o),n)<=0||(r.has(o.key)||N_(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return F.resolve(i)}getAllFromCollectionGroup(e,t,n,r){Sh(9500)}ii(e,t){return F.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new zne(this)}getSize(e){return F.resolve(this.size)}},zne=class extends iy{constructor(e){super(),this.Nr=e}applyChanges(e){let t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)})),F.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}},Bne=class{constructor(e){this.persistence=e,this.si=new F_((e=>y_(e)),b_),this.lastRemoteSnapshotVersion=Zh.min(),this.highestTargetId=0,this.oi=0,this._i=new uy,this.targetCount=0,this.ai=Zv.ur()}forEachTarget(e,t){return this.si.forEach(((e,n)=>t(n))),F.resolve()}getLastRemoteSnapshotVersion(e){return F.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return F.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),F.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),F.resolve()}Pr(e){this.si.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ai=new Zv(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,F.resolve()}updateTargetData(e,t){return this.Pr(t),F.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),--this.targetCount,F.resolve()}removeTargets(e,t,n){let r=0,i=[];return this.si.forEach(((a,o)=>{o.sequenceNumber<=t&&n.get(o.targetId)===null&&(this.si.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),F.waitFor(i).next((()=>r))}getTargetCount(e){return F.resolve(this.targetCount)}getTargetData(e,t){let n=this.si.get(t)||null;return F.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),F.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);let r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),F.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),F.resolve()}getMatchingKeysForTargetId(e,t){let n=this._i.Hr(t);return F.resolve(n)}containsKey(e,t){return F.resolve(this._i.containsKey(t))}},fy=class{constructor(e,t){this.ui={},this.overlays={},this.ci=new ng(0),this.li=!1,this.li=!0,this.hi=new ly,this.referenceDelegate=e(this),this.Pi=new Bne(this),this.indexManager=new Pne,this.remoteDocumentCache=function(e){return new Rne(e)}((e=>this.referenceDelegate.Ti(e))),this.serializer=new Mne(t),this.Ii=new sy(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new cy,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new Lne(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){vh(`MemoryPersistence`,`Starting transaction:`,e);let r=new Vne(this.ci.next());return this.referenceDelegate.Ei(),n(r).next((e=>this.referenceDelegate.di(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Ai(e,t){return F.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,t))))}},Vne=class extends Ete{constructor(e){super(),this.currentSequenceNumber=e}},Hne=class e{constructor(e){this.persistence=e,this.Ri=new uy,this.Vi=null}static mi(t){return new e(t)}get fi(){if(this.Vi)return this.Vi;throw Sh(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),F.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),F.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),F.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((e=>this.fi.add(e.toString())));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.fi.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return F.forEach(this.fi,(n=>{let r=zh.fromPath(n);return this.gi(e,r).next((e=>{e||t.removeEntry(r,Zh.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return F.or([()=>F.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}},py=class e{constructor(e,t){this.persistence=e,this.pi=new F_((e=>kte(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=ry(this,t)}static mi(t,n){return new e(t,n)}Ei(){}di(e){return F.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){let t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}wr(e){let t=0;return this.pr(e,(e=>{t++})).next((()=>t))}pr(e,t){return F.forEach(this.pi,((n,r)=>this.br(e,n,r).next((e=>e?F.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0,r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,(r=>this.br(e,r,t).next((e=>{e||(n++,i.removeEntry(r,Zh.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),F.resolve()}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),F.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),F.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),F.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Wg(e.data.value)),t}br(e,t,n){return F.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let e=this.pi.get(t);return F.resolve(e!==void 0&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}},Une=class e{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(t,n){let r=U_(),i=U_();for(let e of n.docChanges)switch(e.type){case 0:r=r.add(e.doc.key);break;case 1:i=i.add(e.doc.key)}return new e(t,n.fromCache,r,i)}},Wne=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}},Gne=class{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=function(){return qc()?8:Dte(Bc())>0?6:4}()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){let i={result:null};return this.ys(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.ws(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;let n=new Wne;return this.Ss(e,t,n).next((r=>{if(i.result=r,this.Vs)return this.bs(e,t,n,r.size)}))})).next((()=>i.result))}bs(e,t,n,r){return n.documentReadCount<this.fs?(_h()<=Tl.DEBUG&&vh(`QueryEngine`,`SDK will not create cache indexes for query:`,M_(t),`since it only creates cache indexes for collection contains`,`more than or equal to`,this.fs,`documents`),F.resolve()):(_h()<=Tl.DEBUG&&vh(`QueryEngine`,`Query:`,M_(t),`scans`,n.documentReadCount,`local documents and returns`,r,`documents as results.`),n.documentReadCount>this.gs*r?(_h()<=Tl.DEBUG&&vh(`QueryEngine`,`The SDK decides to create cache indexes for query:`,M_(t),`as using cache indexes may help improve performance.`),this.indexManager.createTargetIndexes(e,D_(t))):F.resolve())}ys(e,t){if(w_(t))return F.resolve(null);let n=D_(t);return this.indexManager.getIndexType(e,n).next((r=>r===0?null:(t.limit!==null&&r===1&&(t=k_(t,null,`F`),n=D_(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{let i=U_(...r);return this.ps.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{let a=this.Ds(t,r);return this.Cs(t,a,i,n.readTime)?this.ys(e,k_(t,null,`F`)):this.vs(e,a,t,n)}))))})))))}ws(e,t,n,r){return w_(t)||r.isEqual(Zh.min())?F.resolve(null):this.ps.getDocuments(e,n).next((i=>{let a=this.Ds(t,i);return this.Cs(t,a,n,r)?F.resolve(null):(_h()<=Tl.DEBUG&&vh(`QueryEngine`,`Re-using previous result from %s to execute query: %s`,r.toString(),M_(t)),this.vs(e,a,t,Ste(r,Qh)).next((e=>e)))}))}Ds(e,t){let n=new mg(P_(e));return t.forEach(((t,r)=>{N_(e,r)&&(n=n.add(r))})),n}Cs(e,t,n,r){if(e.limit===null)return!1;if(n.size!==t.size)return!0;let i=e.limitType===`F`?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return _h()<=Tl.DEBUG&&vh(`QueryEngine`,`Using full collection scan to execute query:`,M_(t)),this.ps.getDocumentsMatchingQuery(e,t,$h.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}},my=`LocalStore`,Kne=3e8,qne=class{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new dg(jh),this.xs=new F_((e=>y_(e)),b_),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oy(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction(`Collect garbage`,`readwrite-primary`,(t=>e.collect(t,this.Ms)))}};function Jne(e,t,n,r){return new qne(e,t,n,r)}async function hy(e,t){let n=Th(e);return await n.persistence.runTransaction(`Handle user change`,`readonly`,(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.Bs(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{let i=[],a=[],o=U_();for(let e of r){i.push(e.batchId);for(let t of e.mutations)o=o.add(t.key)}for(let e of t){a.push(e.batchId);for(let t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({Ls:e,removedBatchIds:i,addedBatchIds:a})))}))}))}function Yne(e,t){let n=Th(e);return n.persistence.runTransaction(`Acknowledge batch`,`readwrite-primary`,(e=>{let r=t.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){let i=n.batch,a=i.keys(),o=F.resolve();return a.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{let a=n.docVersions.get(e);wh(a!==null,48541),t.version.compareTo(a)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=U_();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}function gy(e){let t=Th(e);return t.persistence.runTransaction(`Get last remote snapshot version`,`readonly`,(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function Xne(e,t){let n=Th(e),r=t.snapshotVersion,i=n.Ms;return n.persistence.runTransaction(`Apply remote event`,`readwrite-primary`,(e=>{let a=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;let o=[];t.targetChanges.forEach(((a,s)=>{let c=i.get(s);if(!c)return;o.push(n.Pi.removeMatchingKeys(e,a.removedDocuments,s).next((()=>n.Pi.addMatchingKeys(e,a.addedDocuments,s))));let l=c.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.get(s)===null?a.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(a.resumeToken,r)):l=l.withResumeToken(vg.EMPTY_BYTE_STRING,Zh.min()).withLastLimboFreeSnapshotVersion(Zh.min()),i=i.insert(s,l),function(e,t,n){return e.resumeToken.approximateByteSize()===0||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=Kne?!0:n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,l,a)&&o.push(n.Pi.updateTargetData(e,l))}));let s=I_(),c=U_();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(Zne(e,a,t.documentUpdates).next((e=>{s=e.ks,c=e.qs}))),!r.isEqual(Zh.min())){let t=n.Pi.getLastRemoteSnapshotVersion(e).next((t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return F.waitFor(o).next((()=>a.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,s,c))).next((()=>s))})).then((e=>(n.Ms=i,e)))}function Zne(e,t,n){let r=U_(),i=U_();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=I_();return n.forEach(((n,a)=>{let o=e.get(n);a.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),a.isNoDocument()&&a.version.isEqual(Zh.min())?(t.removeEntry(n,a.readTime),r=r.insert(n,a)):!o.isValidDocument()||a.version.compareTo(o.version)>0||a.version.compareTo(o.version)===0&&o.hasPendingWrites?(t.addEntry(a),r=r.insert(n,a)):vh(my,`Ignoring outdated watch update for `,n,`. Current version:`,o.version,` Watch version:`,a.version)})),{ks:r,qs:i}}))}function Qne(e,t){let n=Th(e);return n.persistence.runTransaction(`Get next mutation batch`,`readonly`,(e=>(t===void 0&&(t=rg),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function $ne(e,t){let n=Th(e);return n.persistence.runTransaction(`Allocate target`,`readwrite`,(e=>{let r;return n.Pi.getTargetData(e,t).next((i=>i?(r=i,F.resolve(r)):n.Pi.allocateTargetId(e).next((i=>(r=new Kv(t,i,`TargetPurposeListen`,e.currentSequenceNumber),n.Pi.addTargetData(e,r).next((()=>r)))))))})).then((e=>{let r=n.Ms.get(e.targetId);return(r===null||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e}))}async function _y(e,t,n){let r=Th(e),i=r.Ms.get(t),a=n?`readwrite`:`readwrite-primary`;try{n||await r.persistence.runTransaction(`Release target`,a,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!tg(e))throw e;vh(my,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ms=r.Ms.remove(t),r.xs.delete(i.target)}function vy(e,t,n){let r=Th(e),i=Zh.min(),a=U_();return r.persistence.runTransaction(`Execute query`,`readwrite`,(e=>function(e,t,n){let r=Th(e),i=r.xs.get(n);return i===void 0?r.Pi.getTargetData(t,n):F.resolve(r.Ms.get(i))}(r,e,D_(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next((e=>{a=e}))})).next((()=>r.Fs.getDocumentsMatchingQuery(e,t,n?i:Zh.min(),n?a:U_()))).next((e=>(ere(r,Ute(t),e),{documents:e,Qs:a})))))}function ere(e,t,n){let r=e.Os.get(t)||Zh.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Os.set(t,r)}var yy=class{constructor(){this.activeTargetIds=Yte()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},tre=class{constructor(){this.Mo=new yy,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||`not-current`}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new yy,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}},nre=class{Oo(e){}shutdown(){}},by=`ConnectivityMonitor`,xy=class{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener(`online`,this.No),window.removeEventListener(`offline`,this.Lo)}Qo(){window.addEventListener(`online`,this.No),window.addEventListener(`offline`,this.Lo)}Bo(){vh(by,`Network connectivity changed: AVAILABLE`);for(let e of this.qo)e(0)}ko(){vh(by,`Network connectivity changed: UNAVAILABLE`);for(let e of this.qo)e(1)}static v(){return typeof window<`u`&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}},Sy=null;function Cy(){return Sy===null?Sy=function(){return 268435456+Math.round(2147483648*Math.random())}():Sy++,`0x`+Sy.toString(16)}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var wy=`RestConnection`,rre={BatchGetDocuments:`batchGet`,Commit:`commit`,RunQuery:`runQuery`,RunAggregationQuery:`runAggregationQuery`},ire=class{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?`https`:`http`,n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+`://`+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===kg?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,i){let a=Cy(),o=this.zo(e,t.toUriEncodedString());vh(wy,`Sending RPC '${e}' ${a}:`,o,n);let s={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(s,r,i);let{host:c}=new URL(o),l=Mc(c);return this.Jo(e,o,s,n,l).then((t=>(vh(wy,`Received RPC '${e}' ${a}: `,t),t)),(t=>{throw bh(wy,`RPC '${e}' ${a} failed with error: `,t,`url: `,o,`request:`,n),t}))}Ho(e,t,n,r,i,a){return this.Go(e,t,n,r,i)}jo(e,t,n){e[`X-Goog-Api-Client`]=function(){return`gl-js/ fire/`+hh}(),e[`Content-Type`]=`text/plain`,this.databaseInfo.appId&&(e[`X-Firebase-GMPID`]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}zo(e,t){let n=rre[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}},are=class{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}},Ty=`WebChannelConnection`,ore=class extends ire{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){let a=Cy();return new Promise(((i,o)=>{let s=new ih;s.setWithCredentials(!0),s.listenOnce(oh.COMPLETE,(()=>{try{switch(s.getLastErrorCode()){case sh.NO_ERROR:let t=s.getResponseJson();vh(Ty,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(t)),i(t);break;case sh.TIMEOUT:vh(Ty,`RPC '${e}' ${a} timed out`),o(new Eh(P.DEADLINE_EXCEEDED,`Request time out`));break;case sh.HTTP_ERROR:let n=s.getStatus();if(vh(Ty,`RPC '${e}' ${a} failed with status:`,n,`response text:`,s.getResponseText()),n>0){let e=s.getResponseJson();Array.isArray(e)&&(e=e[0]);let t=e?.error;if(t&&t.status&&t.message){let e=function(e){let t=e.toLowerCase().replace(/_/g,`-`);return Object.values(P).indexOf(t)>=0?t:P.UNKNOWN}(t.status);o(new Eh(e,t.message))}else o(new Eh(P.UNKNOWN,`Server responded with status `+s.getStatus()))}else o(new Eh(P.UNAVAILABLE,`Connection failed.`));break;default:Sh(9055,{l_:e,streamId:a,h_:s.getLastErrorCode(),P_:s.getLastError()})}}finally{vh(Ty,`RPC '${e}' ${a} completed.`)}}));let c=JSON.stringify(r);vh(Ty,`RPC '${e}' ${a} sending request:`,r),s.send(t,`POST`,c,n,15)}))}T_(e,t,n){let r=Cy(),i=[this.Uo,`/`,`google.firestore.v1.Firestore`,`/`,e,`/channel`],a=dh(),o=uh(),s={httpSessionIdParam:`gsessionid`,initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(s.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(s.useFetchStreams=!0),this.jo(s.initMessageHeaders,t,n),s.encodeInitMessageHeaders=!0;let l=i.join(``);vh(Ty,`Creating RPC '${e}' stream ${r}: ${l}`,s);let u=a.createWebChannel(l,s);this.I_(u);let d=!1,f=!1,p=new are({Yo:t=>{f?vh(Ty,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(d||=(vh(Ty,`Opening RPC '${e}' stream ${r} transport.`),u.open(),!0),vh(Ty,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Zo:()=>u.close()}),m=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return m(u,ah.EventType.OPEN,(()=>{f||(vh(Ty,`RPC '${e}' stream ${r} transport opened.`),p.o_())})),m(u,ah.EventType.CLOSE,(()=>{f||(f=!0,vh(Ty,`RPC '${e}' stream ${r} transport closed`),p.a_(),this.E_(u))})),m(u,ah.EventType.ERROR,(t=>{f||(f=!0,bh(Ty,`RPC '${e}' stream ${r} transport errored. Name:`,t.name,`Message:`,t.message),p.a_(new Eh(P.UNAVAILABLE,`The operation could not be completed`)))})),m(u,ah.EventType.MESSAGE,(t=>{if(!f){let n=t.data[0];wh(!!n,16349);let i=n,a=i?.error||i[0]?.error;if(a){vh(Ty,`RPC '${e}' stream ${r} received error:`,a);let t=a.status,n=function(e){let t=mv[e];if(t!==void 0)return gv(t)}(t),i=a.message;n===void 0&&(n=P.INTERNAL,i=`Unknown error status: `+t+` with message `+a.message),f=!0,p.a_(new Eh(n,i)),u.close()}else vh(Ty,`RPC '${e}' stream ${r} received:`,n),p.u_(n)}})),m(o,lh.STAT_EVENT,(t=>{t.stat===ch.PROXY?vh(Ty,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===ch.NOPROXY&&vh(Ty,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{p.__()}),0),p}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}};function Ey(){return typeof document<`u`?document:null}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function Dy(e){return new vne(e,!0)}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Oy=class{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();let t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&vh(`ExponentialBackoff`,`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}},ky=`PersistentStream`,Ay=class{constructor(e,t,n,r,i,a,o,s){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=s,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Oy(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state===4?this.N_():this.auth()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&=(this.C_.cancel(),null)}U_(){this.v_&&=(this.v_.cancel(),null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e===4?t&&t.code===P.RESOURCE_EXHAUSTED?(yh(t.toString()),yh(`Using maximum backoff delay to prevent overloading the backend.`),this.M_.g_()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()):this.M_.reset(),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;let e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.D_===t&&this.G_(e,n)}),(t=>{e((()=>{let e=new Eh(P.UNKNOWN,`Fetching auth token failed: `+t.message);return this.z_(e)}))}))}G_(e,t){let n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((e=>{n((()=>this.z_(e)))})),this.stream.onMessage((e=>{n((()=>++this.F_==1?this.J_(e):this.onNext(e)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return vh(ky,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(vh(ky,`stream callback skipped by getCloseGuardedDispatcher.`),Promise.resolve())))}}},sre=class extends Ay{constructor(e,t,n,r,i,a){super(e,`listen_stream_connection_backoff`,`listen_stream_idle`,`health_check_timeout`,t,n,r,a),this.serializer=i}j_(e,t){return this.connection.T_(`Listen`,e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=xne(this.serializer,e),n=function(e){if(!(`targetChange`in e))return Zh.min();let t=e.targetChange;return t.targetIds&&t.targetIds.length?Zh.min():t.readTime?jv(t.readTime):Zh.min()}(e);return this.listener.H_(t,n)}Y_(e){let t={};t.database=Rv(this.serializer),t.addTarget=function(e,t){let n,r=t.target;if(n=x_(r)?{documents:wne(e,r)}:{query:Tne(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Av(e,t.resumeToken);let r=Ov(e,t.expectedCount);r!==null&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Zh.min())>0){n.readTime=kv(e,t.snapshotVersion.toTimestamp());let r=Ov(e,t.expectedCount);r!==null&&(n.expectedCount=r)}return n}(this.serializer,e);let n=Dne(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){let t={};t.database=Rv(this.serializer),t.removeTarget=e,this.q_(t)}},cre=class extends Ay{constructor(e,t,n,r,i,a){super(e,`write_stream_connection_backoff`,`write_stream_idle`,`health_check_timeout`,t,n,r,a),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_(`Write`,e,t)}J_(e){return wh(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,wh(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){wh(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=Cne(e.writeResults,e.commitTime),n=jv(e.commitTime);return this.listener.na(n,t)}ra(){let e={};e.database=Rv(this.serializer),this.q_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map((e=>Sne(this.serializer,e)))};this.q_(t)}},lre=class{},ure=class extends lre{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new Eh(P.FAILED_PRECONDITION,`The client has already been terminated.`)}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,a])=>this.connection.Go(e,Nv(t,n),r,i,a))).catch((e=>{throw e.name===`FirebaseError`?(e.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Eh(P.UNKNOWN,e.toString())}))}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,o])=>this.connection.Ho(e,Nv(t,n),r,a,o,i))).catch((e=>{throw e.name===`FirebaseError`?(e.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Eh(P.UNKNOWN,e.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}},dre=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state=`Unknown`,this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca(`Unknown`),this._a=this.asyncQueue.enqueueAfterDelay(`online_state_timeout`,1e4,(()=>(this._a=null,this.la(`Backend didn't respond within 10 seconds.`),this.ca(`Offline`),Promise.resolve()))))}ha(e){this.state===`Online`?this.ca(`Unknown`):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca(`Offline`)))}set(e){this.Pa(),this.oa=0,e===`Online`&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(yh(t),this.aa=!1):vh(`OnlineStateTracker`,t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}},jy=`RemoteStore`,fre=class{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((e=>{n.enqueueAndForget((async()=>{By(this)&&(vh(jy,`Restarting streams for network reachability change.`),await async function(e){let t=Th(e);t.Ea.add(4),await Ny(t),t.Ra.set(`Unknown`),t.Ea.delete(4),await My(t)}(this))}))})),this.Ra=new dre(n,r)}};async function My(e){if(By(e))for(let t of e.da)await t(!0)}async function Ny(e){for(let t of e.da)await t(!1)}function Py(e,t){let n=Th(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),zy(n)?Ry(n):Jy(n).O_()&&Iy(n,t))}function Fy(e,t){let n=Th(e),r=Jy(n);n.Ia.delete(t),r.O_()&&Ly(n,t),n.Ia.size===0&&(r.O_()?r.L_():By(n)&&n.Ra.set(`Unknown`))}function Iy(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Zh.min())>0){let n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Jy(e).Y_(t)}function Ly(e,t){e.Va.Ue(t),Jy(e).Z_(t)}function Ry(e){e.Va=new mne({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),Jy(e).start(),e.Ra.ua()}function zy(e){return By(e)&&!Jy(e).x_()&&e.Ia.size>0}function By(e){return Th(e).Ea.size===0}function Vy(e){e.Va=void 0}async function pre(e){e.Ra.set(`Online`)}async function mre(e){e.Ia.forEach(((t,n)=>{Iy(e,t)}))}async function hre(e,t){Vy(e),zy(e)?(e.Ra.ha(t),Ry(e)):e.Ra.set(`Unknown`)}async function gre(e,t,n){if(e.Ra.set(`Online`),t instanceof wv&&t.state===2&&t.cause)try{await async function(e,t){let n=t.cause;for(let r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){vh(jy,`Failed to remove targets %s: %s `,t.targetIds.join(`,`),n),await Hy(e,n)}else if(t instanceof Sv?e.Va.Ze(t):t instanceof Cv?e.Va.st(t):e.Va.tt(t),!n.isEqual(Zh.min()))try{let t=await gy(e.localStore);n.compareTo(t)>=0&&await function(e,t){let n=e.Va.Tt(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){let i=e.Ia.get(r);i&&e.Ia.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{let r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(vg.EMPTY_BYTE_STRING,r.snapshotVersion)),Ly(e,t);let i=new Kv(r.target,t,n,r.sequenceNumber);Iy(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){vh(jy,`Failed to raise snapshot:`,t),await Hy(e,t)}}async function Hy(e,t,n){if(!tg(t))throw t;e.Ea.add(1),await Ny(e),e.Ra.set(`Offline`),n||=()=>gy(e.localStore),e.asyncQueue.enqueueRetryable((async()=>{vh(jy,`Retrying IndexedDB access`),await n(),e.Ea.delete(1),await My(e)}))}function Uy(e,t){return t().catch((n=>Hy(e,n,t)))}async function Wy(e){let t=Th(e),n=Yy(t),r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:rg;for(;_re(t);)try{let e=await Qne(t.localStore,r);if(e===null){t.Ta.length===0&&n.L_();break}r=e.batchId,vre(t,e)}catch(e){await Hy(t,e)}Gy(t)&&Ky(t)}function _re(e){return By(e)&&e.Ta.length<10}function vre(e,t){e.Ta.push(t);let n=Yy(e);n.O_()&&n.X_&&n.ea(t.mutations)}function Gy(e){return By(e)&&!Yy(e).x_()&&e.Ta.length>0}function Ky(e){Yy(e).start()}async function yre(e){Yy(e).ra()}async function bre(e){let t=Yy(e);for(let n of e.Ta)t.ea(n.mutations)}async function xre(e,t,n){let r=e.Ta.shift(),i=one.from(r,t,n);await Uy(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await Wy(e)}async function Sre(e,t){t&&Yy(e).X_&&await async function(e,t){if(function(e){return lne(e)&&e!==P.ABORTED}(t.code)){let n=e.Ta.shift();Yy(e).B_(),await Uy(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await Wy(e)}}(e,t),Gy(e)&&Ky(e)}async function qy(e,t){let n=Th(e);n.asyncQueue.verifyOperationInProgress(),vh(jy,`RemoteStore received new credentials`);let r=By(n);n.Ea.add(3),await Ny(n),r&&n.Ra.set(`Unknown`),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await My(n)}async function Cre(e,t){let n=Th(e);t?(n.Ea.delete(2),await My(n)):t||(n.Ea.add(2),await Ny(n),n.Ra.set(`Unknown`))}function Jy(e){return e.ma||(e.ma=function(e,t,n){let r=Th(e);return r.sa(),new sre(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:pre.bind(null,e),t_:mre.bind(null,e),r_:hre.bind(null,e),H_:gre.bind(null,e)}),e.da.push((async t=>{t?(e.ma.B_(),zy(e)?Ry(e):e.Ra.set(`Unknown`)):(await e.ma.stop(),Vy(e))}))),e.ma}function Yy(e){return e.fa||(e.fa=function(e,t,n){let r=Th(e);return r.sa(),new cre(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:yre.bind(null,e),r_:Sre.bind(null,e),ta:bre.bind(null,e),na:xre.bind(null,e)}),e.da.push((async t=>{t?(e.fa.B_(),await Wy(e)):(await e.fa.stop(),e.Ta.length>0&&(vh(jy,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))}))),e.fa}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var wre=class e{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Dh,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,n,r,i,a){let o=Date.now()+r,s=new e(t,n,o,i,a);return s.start(r),s}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Eh(P.CANCELLED,`Operation cancelled`+(e?`: `+e:``))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle===null?Promise.resolve():(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e))))))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Xy(e,t){if(yh(`AsyncQueue`,`${t}: ${e}`),tg(e))return new Eh(P.UNAVAILABLE,`${t}: ${e}`);throw e}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Zy=class e{static emptySet(t){return new e(t.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||zh.comparator(t.key,n.key):(e,t)=>zh.comparator(e.key,t.key),this.keyedMap=R_(),this.sortedSet=new dg(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(t){if(!(t instanceof e)||this.size!==t.size)return!1;let n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();for(;n.hasNext();){let e=n.getNext().key,t=r.getNext().key;if(!e.isEqual(t))return!1}return!0}toString(){let e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?`DocumentSet ()`:`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(t,n){let r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}},Qy=class{constructor(){this.ga=new dg(zh.comparator)}track(e){let t=e.doc.key,n=this.ga.get(t);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(t,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(t):e.type===1&&n.type===2?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):Sh(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}},$y=class e{constructor(e,t,n,r,i,a,o,s,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=s,this.hasCachedResults=c}static fromInitialDocuments(t,n,r,i,a){let o=[];return n.forEach((e=>{o.push({type:0,doc:e})})),new e(t,n,Zy.emptySet(n),o,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&A_(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}},Tre=class{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}},Ere=class{constructor(){this.queries=eb(),this.onlineState=`Unknown`,this.Ca=new Set}terminate(){(function(e,t){let n=Th(e),r=n.queries;n.queries=eb(),r.forEach(((e,n)=>{for(let e of n.Sa)e.onError(t)}))})(this,new Eh(P.ABORTED,`Firestore shutting down`))}};function eb(){return new F_((e=>j_(e)),A_)}async function Dre(e,t){let n=Th(e),r=3,i=t.query,a=n.queries.get(i);a?!a.ba()&&t.Da()&&(r=2):(a=new Tre,r=t.Da()?0:1);try{switch(r){case 0:a.wa=await n.onListen(i,!0);break;case 1:a.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){let n=Xy(e,`Initialization of query '${M_(t.query)}' failed`);t.onError(n);return}n.queries.set(i,a),a.Sa.push(t),t.va(n.onlineState),a.wa&&t.Fa(a.wa)&&tb(n)}async function Ore(e,t){let n=Th(e),r=t.query,i=3,a=n.queries.get(r);if(a){let e=a.Sa.indexOf(t);e>=0&&(a.Sa.splice(e,1),a.Sa.length===0?i=t.Da()?0:1:!a.ba()&&t.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function kre(e,t){let n=Th(e),r=!1;for(let e of t){let t=e.query,i=n.queries.get(t);if(i){for(let t of i.Sa)t.Fa(e)&&(r=!0);i.wa=e}}r&&tb(n)}function Are(e,t,n){let r=Th(e),i=r.queries.get(t);if(i)for(let e of i.Sa)e.onError(n);r.queries.delete(t)}function tb(e){e.Ca.forEach((e=>{e.next()}))}var nb,rb;(rb=nb||={}).Ma=`default`,rb.Cache=`cache`;var jre=class{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState=`Unknown`,this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){let t=[];for(let n of e.docChanges)n.type!==3&&t.push(n);e=new $y(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let n=t!==`Offline`;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t===`Offline`)}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=$y.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==nb.Cache}},ib=class{constructor(e){this.key=e}},ab=class{constructor(e){this.key=e}},Mre=class{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=U_(),this.mutatedKeys=U_(),this.eu=P_(e),this.tu=new Zy(this.eu)}get nu(){return this.Ya}ru(e,t){let n=t?t.iu:new Qy,r=t?t.tu:this.tu,i=t?t.mutatedKeys:this.mutatedKeys,a=r,o=!1,s=this.query.limitType===`F`&&r.size===this.query.limit?r.last():null,c=this.query.limitType===`L`&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{let l=r.get(e),u=N_(this.query,t)?t:null,d=!!l&&this.mutatedKeys.has(l.key),f=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations),p=!1;l&&u?l.data.isEqual(u.data)?d!==f&&(n.track({type:3,doc:u}),p=!0):this.su(l,u)||(n.track({type:2,doc:u}),p=!0,(s&&this.eu(u,s)>0||c&&this.eu(u,c)<0)&&(o=!0)):!l&&u?(n.track({type:0,doc:u}),p=!0):l&&!u&&(n.track({type:1,doc:l}),p=!0,(s||c)&&(o=!0)),p&&(u?(a=a.add(u),i=f?i.add(e):i.delete(e)):(a=a.delete(e),i=i.delete(e)))})),this.query.limit!==null)for(;a.size>this.query.limit;){let e=this.query.limitType===`F`?a.last():a.first();a=a.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{tu:a,iu:n,Cs:o,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){let i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let a=e.iu.ya();a.sort(((e,t)=>function(e,t){let n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Sh(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc))),this.ou(n),r??=!1;let o=t&&!r?this._u():[],s=this.Xa.size===0&&this.current&&!r?1:0,c=s!==this.Za;return this.Za=s,a.length!==0||c?{snapshot:new $y(this.query,e.tu,i,a,e.mutatedKeys,s===0,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&e===`Offline`?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Qy,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((e=>this.Ya=this.Ya.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Ya=this.Ya.delete(e))),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Xa;this.Xa=U_(),this.tu.forEach((e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))}));let t=[];return e.forEach((e=>{this.Xa.has(e)||t.push(new ab(e))})),this.Xa.forEach((n=>{e.has(n)||t.push(new ib(n))})),t}cu(e){this.Ya=e.Qs,this.Xa=U_();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return $y.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}},ob=`SyncEngine`,Nre=class{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}},Pre=class{constructor(e){this.key=e,this.hu=!1}},Fre=class{constructor(e,t,n,r,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Pu={},this.Tu=new F_((e=>j_(e)),A_),this.Iu=new Map,this.Eu=new Set,this.du=new dg(zh.comparator),this.Au=new Map,this.Ru=new uy,this.Vu={},this.mu=new Map,this.fu=Zv.cr(),this.onlineState=`Unknown`,this.gu=void 0}get isPrimaryClient(){return!0===this.gu}};async function Ire(e,t,n=!0){let r=_b(e),i,a=r.Tu.get(t);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.lu()):i=await sb(r,t,n,!0),i}async function Lre(e,t){let n=_b(e);await sb(n,t,!0,!1)}async function sb(e,t,n,r){let i=await $ne(e.localStore,D_(t)),a=i.targetId,o=e.sharedClientState.addLocalQueryTarget(a,n),s;return r&&(s=await Rre(e,t,a,o===`current`,i.resumeToken)),e.isPrimaryClient&&n&&Py(e.remoteStore,i),s}async function Rre(e,t,n,r,i){e.pu=(t,n,r)=>async function(e,t,n,r){let i=t.view.ru(n);i.Cs&&(i=await vy(e.localStore,t.query,!1).then((({documents:e})=>t.view.ru(e,i))));let a=r&&r.targetChanges.get(t.targetId),o=r&&r.targetMismatches.get(t.targetId)!=null,s=t.view.applyChanges(i,e.isPrimaryClient,a,o);return mb(e,t.targetId,s.au),s.snapshot}(e,t,n,r);let a=await vy(e.localStore,t,!0),o=new Mre(t,a.Qs),s=o.ru(a.documents),c=xv.createSynthesizedTargetChangeForCurrentChange(n,r&&e.onlineState!==`Offline`,i),l=o.applyChanges(s,e.isPrimaryClient,c);mb(e,n,l.au);let u=new Nre(t,n,o);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),l.snapshot}async function zre(e,t,n){let r=Th(e),i=r.Tu.get(t),a=r.Iu.get(i.targetId);if(a.length>1)return r.Iu.set(i.targetId,a.filter((e=>!A_(e,t)))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await _y(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Fy(r.remoteStore,i.targetId),fb(r,i.targetId)})).catch(eg)):(fb(r,i.targetId),await _y(r.localStore,i.targetId,!0))}async function Bre(e,t){let n=Th(e),r=n.Tu.get(t),i=n.Iu.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Fy(n.remoteStore,r.targetId))}async function Vre(e,t,n){let r=Jre(e);try{let e=await function(e,t){let n=Th(e),r=Xh.now(),i=t.reduce(((e,t)=>e.add(t.key)),U_()),a,o;return n.persistence.runTransaction(`Locally write mutations`,`readwrite`,(e=>{let s=I_(),c=U_();return n.Ns.getEntries(e,i).next((e=>{s=e,s.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,s))).next((i=>{a=i;let o=[];for(let e of t){let t=rne(e,a.get(e.key).overlayedDocument);t!=null&&o.push(new lv(e.key,t,t_(t.value.mapValue),nv.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;let r=t.applyToLocalDocumentSet(a,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:z_(a)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||=new dg(jh),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await gb(r,e.changes),await Wy(r.remoteStore)}catch(e){let t=Xy(e,`Failed to persist write`);n.reject(t)}}async function cb(e,t){let n=Th(e);try{let e=await Xne(n.localStore,t);t.targetChanges.forEach(((e,t)=>{let r=n.Au.get(t);r&&(wh(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?wh(r.hu,14607):e.removedDocuments.size>0&&(wh(r.hu,42227),r.hu=!1))})),await gb(n,e,t)}catch(e){await eg(e)}}function lb(e,t,n){let r=Th(e);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let e=[];r.Tu.forEach(((n,r)=>{let i=r.view.va(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){let n=Th(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(let e of n.Sa)e.va(t)&&(r=!0)})),r&&tb(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Hre(e,t,n){let r=Th(e);r.sharedClientState.updateQueryState(t,`rejected`,n);let i=r.Au.get(t),a=i&&i.key;if(a){let e=new dg(zh.comparator);e=e.insert(a,n_.newNoDocument(a,Zh.min()));let n=U_().add(a),i=new bv(Zh.min(),new Map,new dg(jh),e,n);await cb(r,i),r.du=r.du.remove(a),r.Au.delete(t),hb(r)}else await _y(r.localStore,t,!1).then((()=>fb(r,t,n))).catch(eg)}async function Ure(e,t){let n=Th(e),r=t.batch.batchId;try{let e=await Yne(n.localStore,t);db(n,r,null),ub(n,r),n.sharedClientState.updateMutationState(r,`acknowledged`),await gb(n,e)}catch(e){await eg(e)}}async function Wre(e,t,n){let r=Th(e);try{let e=await function(e,t){let n=Th(e);return n.persistence.runTransaction(`Reject batch`,`readwrite-primary`,(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(wh(t!==null,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);db(r,t,n),ub(r,t),r.sharedClientState.updateMutationState(t,`rejected`,n),await gb(r,e)}catch(e){await eg(e)}}function ub(e,t){(e.mu.get(t)||[]).forEach((e=>{e.resolve()})),e.mu.delete(t)}function db(e,t,n){let r=Th(e),i=r.Vu[r.currentUser.toKey()];if(i){let e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Vu[r.currentUser.toKey()]=i}}function fb(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(let r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach((t=>{e.Ru.containsKey(t)||pb(e,t)}))}function pb(e,t){e.Eu.delete(t.path.canonicalString());let n=e.du.get(t);n!==null&&(Fy(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),hb(e))}function mb(e,t,n){for(let r of n)r instanceof ib?(e.Ru.addReference(r.key,t),Gre(e,r)):r instanceof ab?(vh(ob,`Document no longer in limbo: `+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||pb(e,r.key)):Sh(19791,{wu:r})}function Gre(e,t){let n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(vh(ob,`New document in limbo: `+n),e.Eu.add(r),hb(e))}function hb(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){let t=e.Eu.values().next().value;e.Eu.delete(t);let n=new zh(Lh.fromString(t)),r=e.fu.next();e.Au.set(r,new Pre(n)),e.du=e.du.insert(n,r),Py(e.remoteStore,new Kv(D_(C_(n.path)),r,`TargetPurposeLimboResolution`,ng.ce))}}async function gb(e,t,n){let r=Th(e),i=[],a=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((e,s)=>{o.push(r.pu(s,t,n).then((e=>{if((e||n)&&r.isPrimaryClient){let t=e?!e.fromCache:n?.targetChanges.get(s.targetId)?.current;r.sharedClientState.updateQueryState(s.targetId,t?`current`:`not-current`)}if(e){i.push(e);let t=Une.As(s.targetId,e);a.push(t)}})))})),await Promise.all(o),r.Pu.H_(i),await async function(e,t){let n=Th(e);try{await n.persistence.runTransaction(`notifyLocalViewChanges`,`readwrite`,(e=>F.forEach(t,(t=>F.forEach(t.Es,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>F.forEach(t.ds,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!tg(e))throw e;vh(my,`Failed to update sequence numbers: `+e)}for(let e of t){let t=e.targetId;if(!e.fromCache){let e=n.Ms.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(t,i)}}}(r.localStore,a))}async function Kre(e,t){let n=Th(e);if(!n.currentUser.isEqual(t)){vh(ob,`User change. New user:`,t.toKey());let e=await hy(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach((e=>{e.forEach((e=>{e.reject(new Eh(P.CANCELLED,t))}))})),e.mu.clear()}(n,`'waitForPendingWrites' promise is rejected due to a user change.`),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await gb(n,e.Ls)}}function qre(e,t){let n=Th(e),r=n.Au.get(t);if(r&&r.hu)return U_().add(r.key);{let e=U_(),r=n.Iu.get(t);if(!r)return e;for(let t of r){let r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function _b(e){let t=Th(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=cb.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=qre.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Hre.bind(null,t),t.Pu.H_=kre.bind(null,t.eventManager),t.Pu.yu=Are.bind(null,t.eventManager),t}function Jre(e){let t=Th(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Ure.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Wre.bind(null,t),t}var vb=class{constructor(){this.kind=`memory`,this.synchronizeTabs=!1}async initialize(e){this.serializer=Dy(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Jne(this.persistence,new Gne,e.initialUser,this.serializer)}Cu(e){return new fy(Hne.mi,this.serializer)}Du(e){return new tre}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}};vb.provider={build:()=>new vb};var Yre=class extends vb{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){wh(this.persistence.referenceDelegate instanceof py,46915);let n=this.persistence.referenceDelegate.garbageCollector;return new ty(n,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes===void 0?Xv.DEFAULT:Xv.withCacheSize(this.cacheSizeBytes);return new fy((e=>py.mi(e,t)),this.serializer)}},yb=class{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>lb(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Kre.bind(null,this.syncEngine),await Cre(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Ere}()}createDatastore(e){let t=Dy(e.databaseInfo.databaseId),n=function(e){return new ore(e)}(e.databaseInfo);return function(e,t,n,r){return new ure(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new fre(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>lb(this.syncEngine,e,0)),function(){return xy.v()?new xy:new nre}())}createSyncEngine(e,t){return function(e,t,n,r,i,a,o){let s=new Fre(e,t,n,r,i,a);return o&&(s.gu=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(e){let t=Th(e);vh(jy,`RemoteStore shutting down.`),t.Ea.add(5),await Ny(t),t.Aa.shutdown(),t.Ra.set(`Unknown`)}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}};yb.provider={build:()=>new yb};
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Xre=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):yh(`Uncaught Error in snapshot listener:`,e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}},bb=`FirestoreClient`,Zre=class{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=mh.UNAUTHENTICATED,this.clientId=Ah.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async e=>{vh(bb,`Received user=`,e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(vh(bb,`Received new app check token=`,e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Dh;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let n=Xy(t,`Failed to shutdown persistence`);e.reject(n)}})),e.promise}};async function xb(e,t){e.asyncQueue.verifyOperationInProgress(),vh(bb,`Initializing OfflineComponentProvider`);let n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await hy(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function Sb(e,t){e.asyncQueue.verifyOperationInProgress();let n=await Qre(e);vh(bb,`Initializing OnlineComponentProvider`),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>qy(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>qy(t.remoteStore,n))),e._onlineComponents=t}async function Qre(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){vh(bb,`Using user provided OfflineComponentProvider`);try{await xb(e,e._uninitializedComponentsProvider._offline)}catch(t){let n=t;if(!function(e){return e.name===`FirebaseError`?e.code===P.FAILED_PRECONDITION||e.code===P.UNIMPLEMENTED:!(typeof DOMException<`u`&&e instanceof DOMException)||e.code===22||e.code===20||e.code===11}(n))throw n;bh(`Error using user provided cache. Falling back to memory cache: `+n),await xb(e,new vb)}}else vh(bb,`Using default OfflineComponentProvider`),await xb(e,new Yre(void 0));return e._offlineComponents}async function Cb(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(vh(bb,`Using user provided OnlineComponentProvider`),await Sb(e,e._uninitializedComponentsProvider._online)):(vh(bb,`Using default OnlineComponentProvider`),await Sb(e,new yb))),e._onlineComponents}function $re(e){return Cb(e).then((e=>e.syncEngine))}async function wb(e){let t=await Cb(e),n=t.eventManager;return n.onListen=Ire.bind(null,t.syncEngine),n.onUnlisten=zre.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Lre.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Bre.bind(null,t.syncEngine),n}
/**
* @license
* Copyright 2023 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function Tb(e){let t={};return e.timeoutSeconds!==void 0&&(t.timeoutSeconds=e.timeoutSeconds),t}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var Eb=new Map,Db=`firestore.googleapis.com`,Ob=!0,kb=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Eh(P.INVALID_ARGUMENT,`Can't provide ssl option if host option is not set`);this.host=Db,this.ssl=Ob}else this.host=e.host,this.ssl=e.ssl??Ob;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Yv;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Ine)throw new Eh(P.INVALID_ARGUMENT,`cacheSizeBytes must be at least 1048576`);this.cacheSizeBytes=e.cacheSizeBytes}yte(`experimentalForceLongPolling`,e.experimentalForceLongPolling,`experimentalAutoDetectLongPolling`,e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Tb(e.experimentalLongPollingOptions??{}),function(e){if(e.timeoutSeconds!==void 0){if(isNaN(e.timeoutSeconds))throw new Eh(P.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new Eh(P.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new Eh(P.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Ab=class{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type=`firestore-lite`,this._persistenceKey=`(lite)`,this._settings=new kb({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask=`notTerminated`}get app(){if(!this._app)throw new Eh(P.FAILED_PRECONDITION,`Firestore was not initialized using the Firebase SDK. 'app' is not available`);return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==`notTerminated`}_setSettings(e){if(this._settingsFrozen)throw new Eh(P.FAILED_PRECONDITION,`Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.`);this._settings=new kb(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(e){if(!e)return new lte;switch(e.type){case`firstParty`:return new pte(e.sessionIndex||`0`,e.iamToken||null,e.authTokenFactory||null);case`provider`:return e.client;default:throw new Eh(P.INVALID_ARGUMENT,`makeAuthCredentialsProvider failed due to invalid credential type`)}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask===`notTerminated`&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask===`notTerminated`?await this._terminate():this._terminateTask=`notTerminated`}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){let t=Eb.get(e);t&&(vh(`ComponentProvider`,`Removing Datastore`),Eb.delete(e),t.terminate())}(this),Promise.resolve()}};function eie(e,t,n,r={}){e=Gh(e,Ab);let i=Mc(t),a=e._getSettings(),o={...a,emulatorOptions:e._getEmulatorOptions()},s=`${t}:${n}`;i&&(Nc(`https://${s}`),zc(`Firestore`,!0)),a.host!==Db&&a.host!==s&&bh(`Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.`);let c={...a,host:s,ssl:i,emulatorOptions:r};if(!rl(c,o)&&(e._setSettings(c),r.mockUserToken)){let t,n;if(typeof r.mockUserToken==`string`)t=r.mockUserToken,n=mh.MOCK_USER;else{t=Pc(r.mockUserToken,e._app?.options.projectId);let i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new Eh(P.INVALID_ARGUMENT,`mockUserToken must contain 'sub' or 'user_id' field!`);n=new mh(i)}e._authCredentials=new ute(new Oh(t,n))}}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var jb=class e{constructor(e,t,n){this.converter=t,this._query=n,this.type=`query`,this.firestore=e}withConverter(t){return new e(this.firestore,t,this._query)}},Mb=class e{constructor(e,t,n){this.converter=t,this._key=n,this.type=`document`,this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nb(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new e(this.firestore,t,this._key)}toJSON(){return{type:e._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,n,r){if(qh(n,e._jsonSchema))return new e(t,r||null,new zh(Lh.fromString(n.referencePath)))}};Mb._jsonSchemaVersion=`firestore/documentReference/1.0`,Mb._jsonSchema={type:Kh(`string`,Mb._jsonSchemaVersion),referencePath:Kh(`string`)};var Nb=class e extends jb{constructor(e,t,n){super(e,t,C_(n)),this._path=n,this.type=`collection`}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Mb(this.firestore,null,new zh(e))}withConverter(t){return new e(this.firestore,t,this._path)}};function Pb(e,t,...n){if(e=_l(e),Bh(`collection`,`path`,t),e instanceof Ab){let r=Lh.fromString(t,...n);return Hh(r),new Nb(e,null,r)}{if(!(e instanceof Mb||e instanceof Nb))throw new Eh(P.INVALID_ARGUMENT,`Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore`);let r=e._path.child(Lh.fromString(t,...n));return Hh(r),new Nb(e.firestore,null,r)}}function Fb(e,t,...n){if(e=_l(e),arguments.length===1&&(t=Ah.newId()),Bh(`doc`,`path`,t),e instanceof Ab){let r=Lh.fromString(t,...n);return Vh(r),new Mb(e,null,new zh(r))}{if(!(e instanceof Mb||e instanceof Nb))throw new Eh(P.INVALID_ARGUMENT,`Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore`);let r=e._path.child(Lh.fromString(t,...n));return Vh(r),new Mb(e.firestore,e instanceof Nb?e.converter:null,new zh(r))}}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var Ib=`AsyncQueue`,Lb=class{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Oy(this,`async_queue_retry`),this._c=()=>{let e=Ey();e&&vh(Ib,`Visibility state changed to `+e.visibilityState),this.M_.w_()},this.ac=e;let t=Ey();t&&typeof t.addEventListener==`function`&&t.addEventListener(`visibilitychange`,this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=Ey();t&&typeof t.removeEventListener==`function`&&t.removeEventListener(`visibilitychange`,this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));let t=new Dh;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!tg(e))throw e;vh(Ib,`Operation failed with retryable error: `+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){let t=this.ac.then((()=>(this.rc=!0,e().catch((e=>{throw this.nc=e,this.rc=!1,yh(`INTERNAL UNHANDLED ERROR: `,Rb(e)),e})).then((e=>(this.rc=!1,e))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let r=wre.createAndSchedule(this,e,t,n,(e=>this.hc(e)));return this.tc.push(r),r}uc(){this.nc&&Sh(47125,{Pc:Rb(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(let t of this.tc)if(t.skipDelay(),e!==`all`&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function Rb(e){let t=e.message||``;return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+`
`+e.stack),t}
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function zb(e){return function(e,t){if(typeof e!=`object`||!e)return!1;let n=e;for(let e of t)if(e in n&&typeof n[e]==`function`)return!0;return!1}(e,[`next`,`error`,`complete`])}var Bb=class extends Ab{constructor(e,t,n,r){super(e,t,n,r),this.type=`firestore`,this._queue=new Lb,this._persistenceKey=r?.name||`[DEFAULT]`}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Lb(e),this._firestoreClient=void 0,await e}}};function tie(e,t){let n=typeof e==`object`?e:Gu(),r=typeof e==`string`?e:t||kg,i=zu(n,`firestore`).getImmediate({identifier:r});if(!i._initialized){let e=Oc(`firestore`);e&&eie(i,...e)}return i}function Vb(e){if(e._terminated)throw new Eh(P.FAILED_PRECONDITION,`The client has already been terminated.`);return e._firestoreClient||nie(e),e._firestoreClient}function nie(e){let t=e._freezeSettings(),n=function(e,t,n,r){return new Mte(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Tb(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,e._app?.options.appId||``,e._persistenceKey,t);e._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),e._firestoreClient=new Zre(e._authCredentials,e._appCheckCredentials,e._queue,n,e._componentsProvider&&function(e){let t=e?._online.build();return{_offline:e?._offline.build(t),_online:t}}(e._componentsProvider))}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Hb=class e{constructor(e){this._byteString=e}static fromBase64String(t){try{return new e(vg.fromBase64String(t))}catch(e){throw new Eh(P.INVALID_ARGUMENT,`Failed to construct data from Base64 string: `+e)}}static fromUint8Array(t){return new e(vg.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return`Bytes(base64: `+this.toBase64()+`)`}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:e._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(qh(t,e._jsonSchema))return e.fromBase64String(t.bytes)}};Hb._jsonSchemaVersion=`firestore/bytes/1.0`,Hb._jsonSchema={type:Kh(`string`,Hb._jsonSchemaVersion),bytes:Kh(`string`)};
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Ub=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Eh(P.INVALID_ARGUMENT,`Invalid field name at argument $(i + 1). Field names must not be empty.`);this._internalPath=new Rh(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}},Wb=class{constructor(e){this._methodName=e}},Gb=class e{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Eh(P.INVALID_ARGUMENT,`Latitude must be a number between -90 and 90, but was: `+e);if(!isFinite(t)||t<-180||t>180)throw new Eh(P.INVALID_ARGUMENT,`Longitude must be a number between -180 and 180, but was: `+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return jh(this._lat,e._lat)||jh(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:e._jsonSchemaVersion}}static fromJSON(t){if(qh(t,e._jsonSchema))return new e(t.latitude,t.longitude)}};Gb._jsonSchemaVersion=`firestore/geoPoint/1.0`,Gb._jsonSchema={type:Kh(`string`,Gb._jsonSchemaVersion),latitude:Kh(`number`),longitude:Kh(`number`)};
/**
* @license
* Copyright 2024 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Kb=class e{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:e._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(qh(t,e._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e==`number`)))return new e(t.vectorValues);throw new Eh(P.INVALID_ARGUMENT,`Expected 'vectorValues' field to be a number array`)}}};Kb._jsonSchemaVersion=`firestore/vectorValue/1.0`,Kb._jsonSchema={type:Kh(`string`,Kb._jsonSchemaVersion),vectorValues:Kh(`object`)};
/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var rie=/^__.*__$/,iie=class{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask===null?new cv(e,this.data,t,this.fieldTransforms):new lv(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function qb(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Sh(40011,{Ac:e})}}var aie=class e{constructor(e,t,n,r,i,a){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,i===void 0&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new e({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){let t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){let t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return ex(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc(`Document fields must not be empty`);if(qb(this.Ac)&&rie.test(e))throw this.Sc(`Document fields cannot begin and end with "__"`)}},oie=class{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Dy(e)}Cc(e,t,n,r=!1){return new aie({Ac:e,methodName:t,Dc:n,path:Rh.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Jb(e){let t=e._freezeSettings(),n=Dy(e._databaseId);return new oie(e._databaseId,!!t.ignoreUndefinedProperties,n)}function sie(e,t,n,r,i,a={}){let o=e.Cc(a.merge||a.mergeFields?2:0,t,n,i);Qb(`Data must be an object, but it was:`,o,r);let s=Xb(r,o),c,l;if(a.merge)c=new gg(o.fieldMask),l=o.fieldTransforms;else if(a.mergeFields){let e=[];for(let r of a.mergeFields){let i=uie(t,r,n);if(!o.contains(i))throw new Eh(P.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);fie(e,i)||e.push(i)}c=new gg(e),l=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,l=o.fieldTransforms;return new iie(new e_(s),c,l)}var cie=class e extends Wb{_toFieldTransform(e){return new $te(e.path,new J_)}isEqual(t){return t instanceof e}};function lie(e,t,n,r=!1){return Yb(n,e.Cc(r?4:3,t))}function Yb(e,t){if(Zb(e=_l(e)))return Qb(`Unsupported field value:`,t,e),Xb(e,t);if(e instanceof Wb)return function(e,t){if(!qb(t.Ac))throw t.Sc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Sc(`${e._methodName}() is not currently supported inside arrays`);let n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(e===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc(`Nested arrays are not supported`);return function(e,t){let n=[],r=0;for(let i of e){let e=Yb(i,t.wc(r));e??={nullValue:`NULL_VALUE`},n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if((e=_l(e))===null)return{nullValue:`NULL_VALUE`};if(typeof e==`number`)return Xte(t.serializer,e);if(typeof e==`boolean`)return{booleanValue:e};if(typeof e==`string`)return{stringValue:e};if(e instanceof Date){let n=Xh.fromDate(e);return{timestampValue:kv(t.serializer,n)}}if(e instanceof Xh){let n=new Xh(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:kv(t.serializer,n)}}if(e instanceof Gb)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Hb)return{bytesValue:Av(t.serializer,e._byteString)};if(e instanceof Mb){let n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Mv(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Kb)return function(e,t){return{mapValue:{fields:{[jg]:{stringValue:Pg},[Fg]:{arrayValue:{values:e.toArray().map((e=>{if(typeof e!=`number`)throw t.Sc(`VectorValues must only contain numeric values.`);return W_(t.serializer,e)}))}}}}}}(e,t);throw t.Sc(`Unsupported field value: ${Wh(e)}`)}(e,t)}function Xb(e,t){let n={};return ug(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):lg(e,((e,r)=>{let i=Yb(r,t.mc(e));i!=null&&(n[e]=i)})),{mapValue:{fields:n}}}function Zb(e){return!(typeof e!=`object`||!e||e instanceof Array||e instanceof Date||e instanceof Xh||e instanceof Gb||e instanceof Hb||e instanceof Mb||e instanceof Wb||e instanceof Kb)}function Qb(e,t,n){if(!Zb(n)||!Uh(n)){let r=Wh(n);throw r===`an object`?t.Sc(e+` a custom object`):t.Sc(e+` `+r)}}function uie(e,t,n){if((t=_l(t))instanceof Ub)return t._internalPath;if(typeof t==`string`)return $b(e,t);throw ex(`Field path arguments must be of type string or `,e,!1,void 0,n)}var die=RegExp(`[~\\*/\\[\\]]`);function $b(e,t,n){if(t.search(die)>=0)throw ex(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Ub(...t.split(`.`))._internalPath}catch{throw ex(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function ex(e,t,n,r,i){let a=r&&!r.isEmpty(),o=i!==void 0,s=`Function ${t}() called with invalid data`;n&&(s+=" (via `toFirestore()`)"),s+=`. `;let c=``;return(a||o)&&(c+=` (found`,a&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=`)`),new Eh(P.INVALID_ARGUMENT,s+e+c)}function fie(e,t){return e.some((e=>e.isEqual(t)))}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var tx=class{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Mb(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new pie(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(nx(`DocumentSnapshot.get`,e));if(t!==null)return this._userDataWriter.convertValue(t)}}},pie=class extends tx{data(){return super.data()}};function nx(e,t){return typeof t==`string`?$b(e,t):t instanceof Ub?t._internalPath:t._delegate._internalPath}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/function mie(e){if(e.limitType===`L`&&e.explicitOrderBy.length===0)throw new Eh(P.UNIMPLEMENTED,`limitToLast() queries require specifying at least one orderBy() clause`)}var rx=class{},ix=class extends rx{};function ax(e,t,...n){let r=[];t instanceof rx&&r.push(t),r=r.concat(n),function(e){let t=e.filter((e=>e instanceof gie)).length,n=e.filter((e=>e instanceof ox)).length;if(t>1||t>0&&n>0)throw new Eh(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let t of r)e=t._apply(e);return e}var ox=class e extends ix{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type=`where`}static _create(t,n,r){return new e(t,n,r)}_apply(e){let t=this._parse(e);return ux(e._query,t),new jb(e.firestore,e.converter,O_(e._query,t))}_parse(e){let t=Jb(e.firestore);return function(e,t,n,r,i,a,o){let s;if(i.isKeyField()){if(a===`array-contains`||a===`array-contains-any`)throw new Eh(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${a}' queries on documentId().`);if(a===`in`||a===`not-in`){lx(o,a);let t=[];for(let n of o)t.push(cx(r,e,n));s={arrayValue:{values:t}}}else s=cx(r,e,o)}else a!==`in`&&a!==`not-in`&&a!==`array-contains-any`||lx(o,a),s=lie(n,t,o,a===`in`||a===`not-in`);return c_.create(i,a,s)}(e._query,`where`,t,e.firestore._databaseId,this._field,this._op,this._value)}};function hie(e,t,n){let r=t,i=nx(`where`,e);return ox._create(i,r,n)}var gie=class e extends rx{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(t,n){return new e(t,n)}_parse(e){let t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return t.length===1?t[0]:l_.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(e,t){let n=e,r=t.getFlattenedFilters();for(let e of r)ux(n,e),n=O_(n,e)}(e._query,t),new jb(e.firestore,e.converter,O_(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type===`and`?`and`:`or`}},_ie=class e extends ix{constructor(e,t){super(),this._field=e,this._direction=t,this.type=`orderBy`}static _create(t,n){return new e(t,n)}_apply(e){let t=function(e,t,n){if(e.startAt!==null)throw new Eh(P.INVALID_ARGUMENT,`Invalid query. You must not call startAt() or startAfter() before calling orderBy().`);if(e.endAt!==null)throw new Eh(P.INVALID_ARGUMENT,`Invalid query. You must not call endAt() or endBefore() before calling orderBy().`);return new o_(t,n)}(e._query,this._field,this._direction);return new jb(e.firestore,e.converter,function(e,t){let n=e.explicitOrderBy.concat([t]);return new S_(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}};function sx(e,t=`asc`){let n=t,r=nx(`orderBy`,e);return _ie._create(r,n)}var vie=class e extends ix{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(t,n,r){return new e(t,n,r)}_apply(e){return new jb(e.firestore,e.converter,k_(e._query,this._limit,this._limitType))}};function yie(e){return bte(`limit`,e),vie._create(`limit`,e,`F`)}function cx(e,t,n){if(typeof(n=_l(n))==`string`){if(n===``)throw new Eh(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.`);if(!T_(t)&&n.indexOf(`/`)!==-1)throw new Eh(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=t.path.child(Lh.fromString(n));if(!zh.isDocumentKey(r))throw new Eh(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Gg(e,new zh(r))}if(n instanceof Mb)return Gg(e,n._key);throw new Eh(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Wh(n)}.`)}function lx(e,t){if(!Array.isArray(e)||e.length===0)throw new Eh(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function ux(e,t){let n=function(e,t){for(let n of e)for(let e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case`!=`:return[`!=`,`not-in`];case`array-contains-any`:case`in`:return[`not-in`];case`not-in`:return[`array-contains-any`,`in`,`not-in`,`!=`];default:return[]}}(t.op));if(n!==null)throw n===t.op?new Eh(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Eh(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}var bie=class{convertValue(e,t=`none`){switch(Ig(e)){case 0:return null;case 1:return e.booleanValue;case 2:return bg(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(xg(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Sh(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t=`none`){let n={};return lg(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){let t=e.fields?.[Fg].arrayValue?.values?.map((e=>bg(e.doubleValue)));return new Kb(t)}convertGeoPoint(e){return new Gb(bg(e.latitude),bg(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case`previous`:let n=Dg(e);return n==null?null:this.convertValue(n,t);case`estimate`:return this.convertTimestamp(Og(e));default:return null}}convertTimestamp(e){let t=yg(e);return new Xh(t.seconds,t.nanos)}convertDocumentKey(e,t){let n=Lh.fromString(e);wh(Gv(n),9688,{name:e});let r=new Ag(n.get(1),n.get(3)),i=new zh(n.popFirst(5));return r.isEqual(t)||yh(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}};
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function xie(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}var dx=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},fx=class e extends tx{constructor(e,t,n,r,i,a){super(e,t,n,r,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new px(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let n=this._document.data.field(nx(`DocumentSnapshot.get`,e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Eh(P.FAILED_PRECONDITION,`DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().`);let t=this._document,n={};return n.type=e._jsonSchemaVersion,n.bundle=``,n.bundleSource=`DocumentSnapshot`,n.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,`previous`),n.bundle=(this._firestore,this.ref.path,`NOT SUPPORTED`),n)}};fx._jsonSchemaVersion=`firestore/documentSnapshot/1.0`,fx._jsonSchema={type:Kh(`string`,fx._jsonSchemaVersion),bundleSource:Kh(`string`,`DocumentSnapshot`),bundleName:Kh(`string`),bundle:Kh(`string`)};var px=class extends fx{data(e={}){return super.data(e)}},mx=class e{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new dx(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){let e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new px(this._firestore,this._userDataWriter,n.key,n,new dx(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Eh(P.INVALID_ARGUMENT,`To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().`);return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{let r=new px(e._firestore,e._userDataWriter,n.doc.key,n.doc,new dx(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:`added`,doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||e.type!==3)).map((t=>{let r=new px(e._firestore,e._userDataWriter,t.doc.key,t.doc,new dx(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,a=-1;return t.type!==0&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),t.type!==1&&(n=n.add(t.doc),a=n.indexOf(t.doc.key)),{type:Sie(t.type),doc:r,oldIndex:i,newIndex:a}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Eh(P.FAILED_PRECONDITION,`QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().`);let t={};t.type=e._jsonSchemaVersion,t.bundleSource=`QuerySnapshot`,t.bundleName=Ah.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let n=[],r=[],i=[];return this.docs.forEach((e=>{e._document!==null&&(n.push(e._document),r.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,`previous`)),i.push(e.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,`NOT SUPPORTED`),t}};function Sie(e){switch(e){case 0:return`added`;case 2:case 3:return`modified`;case 1:return`removed`;default:return Sh(61501,{type:e})}}mx._jsonSchemaVersion=`firestore/querySnapshot/1.0`,mx._jsonSchema={type:Kh(`string`,mx._jsonSchemaVersion),bundleSource:Kh(`string`,`QuerySnapshot`),bundleName:Kh(`string`),bundle:Kh(`string`)};var hx=class extends bie{constructor(e){super(),this.firestore=e}convertBytes(e){return new Hb(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new Mb(this.firestore,null,t)}};function Cie(e,t){let n=Gh(e.firestore,Bb),r=Fb(e),i=xie(e.converter,t);return wie(n,[sie(Jb(e.firestore),`addDoc`,r._key,i,e.converter!==null,{}).toMutation(r._key,nv.exists(!1))]).then((()=>r))}function gx(e,...t){e=_l(e);let n={includeMetadataChanges:!1,source:`default`},r=0;typeof t[r]!=`object`||zb(t[r])||(n=t[r++]);let i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(zb(t[r])){let e=t[r];t[r]=e.next?.bind(e),t[r+1]=e.error?.bind(e),t[r+2]=e.complete?.bind(e)}let a,o,s;if(e instanceof Mb)o=Gh(e.firestore,Bb),s=C_(e._key.path),a={next:n=>{t[r]&&t[r](Tie(o,e,n))},error:t[r+1],complete:t[r+2]};else{let n=Gh(e,jb);o=Gh(n.firestore,Bb),s=n._query;let i=new hx(o);a={next:e=>{t[r]&&t[r](new mx(o,i,n,e))},error:t[r+1],complete:t[r+2]},mie(e._query)}return function(e,t,n,r){let i=new Xre(r),a=new jre(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>Dre(await wb(e),a))),()=>{i.Nu(),e.asyncQueue.enqueueAndForget((async()=>Ore(await wb(e),a)))}}(Vb(o),s,i,a)}function wie(e,t){return function(e,t){let n=new Dh;return e.asyncQueue.enqueueAndForget((async()=>Vre(await $re(e),t,n))),n.promise}(Vb(e),t)}function Tie(e,t,n){let r=n.docs.get(t._key),i=new hx(e);return new fx(e,i,t._key,r,new dx(n.hasPendingWrites,n.fromCache),t.converter)}function Eie(){return new cie(`serverTimestamp`)}(function(e,t=!0){(function(e){hh=e})(Uu),Ru(new vl(`firestore`,((e,{instanceIdentifier:n,options:r})=>{let i=e.getProvider(`app`).getImmediate(),a=new Bb(new dte(e.getProvider(`auth-internal`)),new mte(i,e.getProvider(`app-check-internal`)),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,[`projectId`]))throw new Eh(P.INVALID_ARGUMENT,`"projectId" not provided in firebase.initializeApp.`);return new Ag(e.options.projectId,t)}(i,n),i);return r={useFetchStreams:t,...r},a._setSettings(r),a}),`PUBLIC`).setMultipleInstances(!0)),Ku(fh,ph,e),Ku(fh,ph,`esm2020`)})();var _x=`@firebase/installations`,vx=`0.6.19`,yx=1e4,bx=`w:${vx}`,xx=`FIS_v2`,Die=`https://firebaseinstallations.googleapis.com/v1`,Oie=3600*1e3,Sx=new $c(`installations`,`Installations`,{"missing-app-config-values":`Missing App configuration value: "{$valueName}"`,"not-registered":`Firebase Installation is not registered.`,"installation-not-found":`Firebase Installation not found.`,"request-failed":`{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"`,"app-offline":`Could not process request. Application offline.`,"delete-pending-registration":`Can't delete installation while there is a pending registration request.`});function Cx(e){return e instanceof Qc&&e.code.includes(`request-failed`)}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function wx({projectId:e}){return`${Die}/projects/${e}/installations`}function Tx(e){return{token:e.token,requestStatus:2,expiresIn:Aie(e.expiresIn),creationTime:Date.now()}}async function Ex(e,t){let n=(await t.json()).error;return Sx.create(`request-failed`,{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Dx({apiKey:e}){return new Headers({"Content-Type":`application/json`,Accept:`application/json`,"x-goog-api-key":e})}function kie(e,{refreshToken:t}){let n=Dx(e);return n.append(`Authorization`,jie(t)),n}async function Ox(e){let t=await e();return t.status>=500&&t.status<600?e():t}function Aie(e){return Number(e.replace(`s`,`000`))}function jie(e){return`${xx} ${e}`}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function Mie({appConfig:e,heartbeatServiceProvider:t},{fid:n}){let r=wx(e),i=Dx(e),a=t.getImmediate({optional:!0});if(a){let e=await a.getHeartbeatsHeader();e&&i.append(`x-firebase-client`,e)}let o={fid:n,authVersion:xx,appId:e.appId,sdkVersion:bx},s={method:`POST`,headers:i,body:JSON.stringify(o)},c=await Ox(()=>fetch(r,s));if(c.ok){let e=await c.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:Tx(e.authToken)}}else throw await Ex(`Create Installation`,c)}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function kx(e){return new Promise(t=>{setTimeout(t,e)})}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function Nie(e){return btoa(String.fromCharCode(...e)).replace(/\+/g,`-`).replace(/\//g,`_`)}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Pie=/^[cdef][\w-]{21}$/,Ax=``;function Fie(){try{let e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;let t=Iie(e);return Pie.test(t)?t:Ax}catch{return Ax}}function Iie(e){return Nie(e).substr(0,22)}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function jx(e){return`${e.appName}!${e.appId}`}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Mx=new Map;function Nx(e,t){let n=jx(e);Px(n,t),Lie(n,t)}function Px(e,t){let n=Mx.get(e);if(n)for(let e of n)e(t)}function Lie(e,t){let n=Rie();n&&n.postMessage({key:e,fid:t}),zie()}var Fx=null;function Rie(){return!Fx&&`BroadcastChannel`in self&&(Fx=new BroadcastChannel(`[Firebase] FID Change`),Fx.onmessage=e=>{Px(e.data.key,e.data.fid)}),Fx}function zie(){Mx.size===0&&Fx&&(Fx.close(),Fx=null)}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Bie=`firebase-installations-database`,Vie=1,Ix=`firebase-installations-store`,Lx=null;function Rx(){return Lx||=Yl(Bie,Vie,{upgrade:(e,t)=>{switch(t){case 0:e.createObjectStore(Ix)}}}),Lx}async function zx(e,t){let n=jx(e),r=(await Rx()).transaction(Ix,`readwrite`),i=r.objectStore(Ix),a=await i.get(n);return await i.put(t,n),await r.done,(!a||a.fid!==t.fid)&&Nx(e,t.fid),t}async function Bx(e){let t=jx(e),n=(await Rx()).transaction(Ix,`readwrite`);await n.objectStore(Ix).delete(t),await n.done}async function Vx(e,t){let n=jx(e),r=(await Rx()).transaction(Ix,`readwrite`),i=r.objectStore(Ix),a=await i.get(n),o=t(a);return o===void 0?await i.delete(n):await i.put(o,n),await r.done,o&&(!a||a.fid!==o.fid)&&Nx(e,o.fid),o}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function Hx(e){let t,n=await Vx(e.appConfig,n=>{let r=Hie(n),i=Uie(e,r);return t=i.registrationPromise,i.installationEntry});return n.fid===Ax?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}function Hie(e){let t=e||{fid:Fie(),registrationStatus:0};return Wx(t)}function Uie(e,t){if(t.registrationStatus===0){if(!navigator.onLine){let e=Promise.reject(Sx.create(`app-offline`));return{installationEntry:t,registrationPromise:e}}let n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=Wie(e,n);return{installationEntry:n,registrationPromise:r}}else if(t.registrationStatus===1)return{installationEntry:t,registrationPromise:Gie(e)};else return{installationEntry:t}}async function Wie(e,t){try{let n=await Mie(e,t);return zx(e.appConfig,n)}catch(n){throw Cx(n)&&n.customData.serverCode===409?await Bx(e.appConfig):await zx(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}async function Gie(e){let t=await Ux(e.appConfig);for(;t.registrationStatus===1;)await kx(100),t=await Ux(e.appConfig);if(t.registrationStatus===0){let{installationEntry:t,registrationPromise:n}=await Hx(e);return n||t}return t}function Ux(e){return Vx(e,e=>{if(!e)throw Sx.create(`installation-not-found`);return Wx(e)})}function Wx(e){return Kie(e)?{fid:e.fid,registrationStatus:0}:e}function Kie(e){return e.registrationStatus===1&&e.registrationTime+yx<Date.now()}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function qie({appConfig:e,heartbeatServiceProvider:t},n){let r=Jie(e,n),i=kie(e,n),a=t.getImmediate({optional:!0});if(a){let e=await a.getHeartbeatsHeader();e&&i.append(`x-firebase-client`,e)}let o={installation:{sdkVersion:bx,appId:e.appId}},s={method:`POST`,headers:i,body:JSON.stringify(o)},c=await Ox(()=>fetch(r,s));if(c.ok){let e=await c.json();return Tx(e)}else throw await Ex(`Generate Auth Token`,c)}function Jie(e,{fid:t}){return`${wx(e)}/${t}/authTokens:generate`}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function Gx(e,t=!1){let n,r=await Vx(e.appConfig,r=>{if(!qx(r))throw Sx.create(`not-registered`);let i=r.authToken;if(!t&&Zie(i))return r;if(i.requestStatus===1)return n=Yie(e,t),r;{if(!navigator.onLine)throw Sx.create(`app-offline`);let t=$ie(r);return n=Xie(e,t),t}});return n?await n:r.authToken}async function Yie(e,t){let n=await Kx(e.appConfig);for(;n.authToken.requestStatus===1;)await kx(100),n=await Kx(e.appConfig);let r=n.authToken;return r.requestStatus===0?Gx(e,t):r}function Kx(e){return Vx(e,e=>{if(!qx(e))throw Sx.create(`not-registered`);let t=e.authToken;return eae(t)?{...e,authToken:{requestStatus:0}}:e})}async function Xie(e,t){try{let n=await qie(e,t),r={...t,authToken:n};return await zx(e.appConfig,r),n}catch(n){if(Cx(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await Bx(e.appConfig);else{let n={...t,authToken:{requestStatus:0}};await zx(e.appConfig,n)}throw n}}function qx(e){return e!==void 0&&e.registrationStatus===2}function Zie(e){return e.requestStatus===2&&!Qie(e)}function Qie(e){let t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+Oie}function $ie(e){let t={requestStatus:1,requestTime:Date.now()};return{...e,authToken:t}}function eae(e){return e.requestStatus===1&&e.requestTime+yx<Date.now()}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function tae(e){let t=e,{installationEntry:n,registrationPromise:r}=await Hx(t);return r?r.catch(console.error):Gx(t).catch(console.error),n.fid}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function nae(e,t=!1){let n=e;return await rae(n),(await Gx(n,t)).token}async function rae(e){let{registrationPromise:t}=await Hx(e);t&&await t}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function Jx(e){if(!e||!e.options)throw Yx(`App Configuration`);if(!e.name)throw Yx(`App Name`);for(let t of[`projectId`,`apiKey`,`appId`])if(!e.options[t])throw Yx(t);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}function Yx(e){return Sx.create(`missing-app-config-values`,{valueName:e})}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var Xx=`installations`,Zx=`installations-internal`,Qx=e=>{let t=e.getProvider(`app`).getImmediate(),n=Jx(t),r=zu(t,`heartbeat`);return{app:t,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},$x=e=>{let t=e.getProvider(`app`).getImmediate(),n=zu(t,Xx).getImmediate();return{getId:()=>tae(n),getToken:e=>nae(n,e)}};function eS(){Ru(new vl(Xx,Qx,`PUBLIC`)),Ru(new vl(Zx,$x,`PRIVATE`))}eS(),Ku(_x,vx),Ku(_x,vx,`esm2020`);
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var tS=`analytics`,nS=`firebase_id`,rS=`origin`,iS=60*1e3,aS=`https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig`,oS=`https://www.googletagmanager.com/gtag/js`,sS=new Al(`@firebase/analytics`),cS=new $c(`analytics`,`Analytics`,{"already-exists":`A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.`,"already-initialized":`initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.`,"already-initialized-settings":`Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.`,"interop-component-reg-failed":`Firebase Analytics Interop Component failed to instantiate: {$reason}`,"invalid-analytics-context":`Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}`,"indexeddb-unavailable":`IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}`,"fetch-throttle":`The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.`,"config-fetch-failed":`Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}`,"no-api-key":`The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.`,"no-app-id":`The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.`,"no-client-id":`The "client_id" field is empty.`,"invalid-gtag-resource":`Trusted Types detected an invalid gtag resource: {$gtagURL}.`});
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
function lS(e){if(!e.startsWith(oS)){let t=cS.create(`invalid-gtag-resource`,{gtagURL:e});return sS.warn(t.message),``}return e}function uS(e){return Promise.all(e.map(e=>e.catch(e=>e)))}function dS(e,t){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(e,t)),n}function fS(e,t){let n=dS(`firebase-js-sdk-policy`,{createScriptURL:lS}),r=document.createElement(`script`),i=`${oS}?l=${e}&id=${t}`;r.src=n?n?.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function pS(e){let t=[];return Array.isArray(window[e])?t=window[e]:window[e]=t,t}async function mS(e,t,n,r,i,a){let o=r[i];try{if(o)await t[o];else{let e=(await uS(n)).find(e=>e.measurementId===i);e&&await t[e.appId]}}catch(e){sS.error(e)}e(`config`,i,a)}async function hS(e,t,n,r,i){try{let a=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);let r=await uS(n);for(let n of e){let e=r.find(e=>e.measurementId===n),i=e&&t[e.appId];if(i)a.push(i);else{a=[];break}}}a.length===0&&(a=Object.values(t)),await Promise.all(a),e(`event`,r,i||{})}catch(e){sS.error(e)}}function gS(e,t,n,r){async function i(i,...a){try{if(i===`event`){let[r,i]=a;await hS(e,t,n,r,i)}else if(i===`config`){let[i,o]=a;await mS(e,t,n,r,i,o)}else if(i===`consent`){let[t,n]=a;e(`consent`,t,n)}else if(i===`get`){let[t,n,r]=a;e(`get`,t,n,r)}else if(i===`set`){let[t]=a;e(`set`,t)}else e(i,...a)}catch(e){sS.error(e)}}return i}function _S(e,t,n,r,i){let a=function(...e){window[r].push(arguments)};return window[i]&&typeof window[i]==`function`&&(a=window[i]),window[i]=gS(a,e,t,n),{gtagCore:a,wrappedGtag:window[i]}}function vS(e){let t=window.document.getElementsByTagName(`script`);for(let n of Object.values(t))if(n.src&&n.src.includes(oS)&&n.src.includes(e))return n;return null}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var yS=30,bS=1e3,xS=new class{constructor(e={},t=bS){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function SS(e){return new Headers({Accept:`application/json`,"x-goog-api-key":e})}async function CS(e){let{appId:t,apiKey:n}=e,r={method:`GET`,headers:SS(n)},i=aS.replace(`{app-id}`,t),a=await fetch(i,r);if(a.status!==200&&a.status!==304){let e=``;try{let t=await a.json();t.error?.message&&(e=t.error.message)}catch{}throw cS.create(`config-fetch-failed`,{httpStatus:a.status,responseMessage:e})}return a.json()}async function wS(e,t=xS,n){let{appId:r,apiKey:i,measurementId:a}=e.options;if(!r)throw cS.create(`no-app-id`);if(!i){if(a)return{measurementId:a,appId:r};throw cS.create(`no-api-key`)}let o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},s=new OS;return setTimeout(async()=>{s.abort()},n===void 0?iS:n),TS({appId:r,apiKey:i,measurementId:a},o,s,t)}async function TS(e,{throttleEndTimeMillis:t,backoffCount:n},r,i=xS){let{appId:a,measurementId:o}=e;try{await ES(r,t)}catch(e){if(o)return sS.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${e?.message}]`),{appId:a,measurementId:o};throw e}try{let t=await CS(e);return i.deleteThrottleMetadata(a),t}catch(t){let s=t;if(!DS(s)){if(i.deleteThrottleMetadata(a),o)return sS.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${s?.message}]`),{appId:a,measurementId:o};throw t}let c=Number(s?.customData?.httpStatus)===503?gl(n,i.intervalMillis,yS):gl(n,i.intervalMillis),l={throttleEndTimeMillis:Date.now()+c,backoffCount:n+1};return i.setThrottleMetadata(a,l),sS.debug(`Calling attemptFetch again in ${c} millis`),TS(e,l,r,i)}}function ES(e,t){return new Promise((n,r)=>{let i=Math.max(t-Date.now(),0),a=setTimeout(n,i);e.addEventListener(()=>{clearTimeout(a),r(cS.create(`fetch-throttle`,{throttleEndTimeMillis:t}))})})}function DS(e){if(!(e instanceof Qc)||!e.customData)return!1;let t=Number(e.customData.httpStatus);return t===429||t===500||t===503||t===504}var OS=class{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}},kS;async function AS(e,t,n,r,i){if(i&&i.global){e(`event`,n,r);return}else{let i=await t,a={...r,send_to:i};e(`event`,n,a)}}async function jS(e,t,n,r){if(r&&r.global){let t={};for(let e of Object.keys(n))t[`user_properties.${e}`]=n[e];return e(`set`,t),Promise.resolve()}else{let r=await t;e(`config`,r,{update:!0,user_properties:n})}}var MS;function NS(e){MS=e}function PS(e){kS=e}
/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
async function FS(){if(Jc())try{await Yc()}catch(e){return sS.warn(cS.create(`indexeddb-unavailable`,{errorInfo:e?.toString()}).message),!1}else return sS.warn(cS.create(`indexeddb-unavailable`,{errorInfo:`IndexedDB is not available in this environment.`}).message),!1;return!0}async function IS(e,t,n,r,i,a,o){let s=wS(e);s.then(t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&sS.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(e=>sS.error(e)),t.push(s);let c=FS().then(e=>{if(e)return r.getId()}),[l,u]=await Promise.all([s,c]);vS(a)||fS(a,l.measurementId),MS&&(i(`consent`,`default`,MS),NS(void 0)),i(`js`,new Date);let d=o?.config??{};return d[rS]=`firebase`,d.update=!0,u!=null&&(d[nS]=u),i(`config`,l.measurementId,d),kS&&(i(`set`,kS),PS(void 0)),l.measurementId}
/**
* @license
* Copyright 2019 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var LS=class{constructor(e){this.app=e}_delete(){return delete RS[this.app.options.appId],Promise.resolve()}},RS={},zS=[],BS={},VS=`dataLayer`,iae=`gtag`,HS,US,WS=!1;function aae(){let e=[];if(Wc()&&e.push(`This is a browser extension environment.`),Xc()||e.push(`Cookies are not available.`),e.length>0){let t=e.map((e,t)=>`(${t+1}) ${e}`).join(` `),n=cS.create(`invalid-analytics-context`,{errorInfo:t});sS.warn(n.message)}}function oae(e,t,n){aae();let r=e.options.appId;if(!r)throw cS.create(`no-app-id`);if(!e.options.apiKey)if(e.options.measurementId)sS.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw cS.create(`no-api-key`);if(RS[r]!=null)throw cS.create(`already-exists`,{id:r});if(!WS){pS(VS);let{wrappedGtag:e,gtagCore:t}=_S(RS,zS,BS,VS,iae);US=e,HS=t,WS=!0}return RS[r]=IS(e,zS,BS,t,HS,VS,n),new LS(e)}function sae(e=Gu()){e=_l(e);let t=zu(e,tS);return t.isInitialized()?t.getImmediate():cae(e)}function cae(e,t={}){let n=zu(e,tS);if(n.isInitialized()){let e=n.getImmediate();if(rl(t,n.getOptions()))return e;throw cS.create(`already-initialized`)}return n.initialize({options:t})}async function lae(){if(Wc()||!Xc()||!Jc())return!1;try{return await Yc()}catch{return!1}}function uae(e,t,n){e=_l(e),jS(US,RS[e.app.options.appId],t,n).catch(e=>sS.error(e))}function dae(e,t,n,r){e=_l(e),AS(US,RS[e.app.options.appId],t,n,r).catch(e=>sS.error(e))}var GS=`@firebase/analytics`,KS=`0.10.19`;function fae(){Ru(new vl(tS,(e,{options:t})=>{let n=e.getProvider(`app`).getImmediate(),r=e.getProvider(`installations-internal`).getImmediate();return oae(n,r,t)},`PUBLIC`)),Ru(new vl(`analytics-internal`,e,`PRIVATE`)),Ku(GS,KS),Ku(GS,KS,`esm2020`);function e(e){try{let t=e.getProvider(tS).getImmediate();return{logEvent:(e,n,r)=>dae(t,e,n,r),setUserProperties:(e,n)=>uae(t,e,n)}}catch(e){throw cS.create(`interop-component-reg-failed`,{reason:e})}}}fae();var qS={apiKey:`AIzaSyBYDab_i0dtcQ1AncXJLhzvDcSud6YWKrw`,authDomain:`tpsaludmental-9856a.firebaseapp.com`,projectId:`tpsaludmental-9856a`,storageBucket:`tpsaludmental-9856a.firebasestorage.app`,appId:`1:682588881335:web:508ae8838aa362c6672832`,measurementId:`G-6MRJ83JP9Z`,messagingSenderId:`682588881335`},JS=Wu(qS);const YS=ote(JS),pae=new Ap,XS=tie(JS);typeof window<`u`&&qS.measurementId?lae().then(e=>e?sae(JS):null):Promise.resolve(null);var mae=o((e=>{var t=Symbol.for(`react.transitional.element`),n=Symbol.for(`react.fragment`);function r(e,n,r){var i=null;if(r!==void 0&&(i=``+r),n.key!==void 0&&(i=``+n.key),`key`in n)for(var a in r={},n)a!==`key`&&(r[a]=n[a]);else r=n;return n=r.ref,{$$typeof:t,type:e,key:i,ref:n===void 0?null:n,props:r}}e.Fragment=n,e.jsx=r,e.jsxs=r})),I=l(o(((e,t)=>{t.exports=mae()}))()),ZS=(0,N.createContext)({user:void 0});function hae({children:e}){let[t,n]=(0,N.useState)(void 0);return(0,N.useEffect)(()=>qp(YS,n),[]),(0,I.jsx)(ZS.Provider,{value:{user:t},children:e})}function QS(){return(0,N.useContext)(ZS)}function $S({children:e}){let{user:t}=QS();return t===void 0?(0,I.jsx)(`div`,{className:`container py-5`,children:`Cargando`}):t?(0,I.jsx)(I.Fragment,{children:e}):(0,I.jsxs)(`div`,{className:`container py-5`,children:[`No autenticado. `,(0,I.jsx)(`a`,{href:`/login`,children:`Inicia sesin`})]})}var gae=o((e=>{function t(e,t){var n=e.length;e.push(t);a:for(;0<n;){var r=n-1>>>1,a=e[r];if(0<i(a,t))e[r]=t,e[n]=a,n=r;else break a}}function n(e){return e.length===0?null:e[0]}function r(e){if(e.length===0)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;a:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,c=e[s],l=s+1,u=e[l];if(0>i(c,n))l<a&&0>i(u,c)?(e[r]=u,e[l]=n,r=l):(e[r]=c,e[s]=n,r=s);else if(l<a&&0>i(u,n))e[r]=u,e[l]=n,r=l;else break a}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return n===0?e.id-t.id:n}if(e.unstable_now=void 0,typeof performance==`object`&&typeof performance.now==`function`){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,s=o.now();e.unstable_now=function(){return o.now()-s}}var c=[],l=[],u=1,d=null,f=3,p=!1,m=!1,h=!1,g=!1,_=typeof setTimeout==`function`?setTimeout:null,v=typeof clearTimeout==`function`?clearTimeout:null,y=typeof setImmediate<`u`?setImmediate:null;function b(e){for(var i=n(l);i!==null;){if(i.callback===null)r(l);else if(i.startTime<=e)r(l),i.sortIndex=i.expirationTime,t(c,i);else break;i=n(l)}}function x(e){if(h=!1,b(e),!m)if(n(c)!==null)m=!0,S||(S=!0,O());else{var t=n(l);t!==null&&te(x,t.startTime-e)}}var S=!1,C=-1,w=5,T=-1;function E(){return g?!0:!(e.unstable_now()-T<w)}function D(){if(g=!1,S){var t=e.unstable_now();T=t;var i=!0;try{a:{m=!1,h&&(h=!1,v(C),C=-1),p=!0;var a=f;try{b:{for(b(t),d=n(c);d!==null&&!(d.expirationTime>t&&E());){var o=d.callback;if(typeof o==`function`){d.callback=null,f=d.priorityLevel;var s=o(d.expirationTime<=t);if(t=e.unstable_now(),typeof s==`function`){d.callback=s,b(t),i=!0;break b}d===n(c)&&r(c),b(t)}else r(c);d=n(c)}if(d!==null)i=!0;else{var u=n(l);u!==null&&te(x,u.startTime-t),i=!1}}break a}finally{d=null,f=a,p=!1}i=void 0}}finally{i?O():S=!1}}}var O;if(typeof y==`function`)O=function(){y(D)};else if(typeof MessageChannel<`u`){var k=new MessageChannel,ee=k.port2;k.port1.onmessage=D,O=function(){ee.postMessage(null)}}else O=function(){_(D,0)};function te(t,n){C=_(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error(`forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported`):w=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},e.unstable_requestPaint=function(){g=!0},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},e.unstable_scheduleCallback=function(r,i,a){var o=e.unstable_now();switch(typeof a==`object`&&a?(a=a.delay,a=typeof a==`number`&&0<a?o+a:o):a=o,r){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return s=a+s,r={id:u++,callback:i,priorityLevel:r,startTime:a,expirationTime:s,sortIndex:-1},a>o?(r.sortIndex=a,t(l,r),n(c)===null&&r===n(l)&&(h?(v(C),C=-1):h=!0,te(x,a-o))):(r.sortIndex=s,t(c,r),m||p||(m=!0,S||(S=!0,O()))),r},e.unstable_shouldYield=E,e.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}})),_ae=o(((e,t)=>{t.exports=gae()})),vae=o((e=>{var t=Zm();function n(e){var t=`https://react.dev/errors/`+e;if(1<arguments.length){t+=`?args[]=`+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+=`&args[]=`+encodeURIComponent(arguments[n])}return`Minified React error #`+e+`; visit `+t+` for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`}function r(){}var i={d:{f:r,r:function(){throw Error(n(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for(`react.portal`);function o(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:r==null?null:``+r,children:e,containerInfo:t,implementation:n}}var s=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){if(e===`font`)return``;if(typeof t==`string`)return t===`use-credentials`?t:``}e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,e.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)throw Error(n(299));return o(e,t,null,r)},e.flushSync=function(e){var t=s.T,n=i.p;try{if(s.T=null,i.p=2,e)return e()}finally{s.T=t,i.p=n,i.d.f()}},e.preconnect=function(e,t){typeof e==`string`&&(t?(t=t.crossOrigin,t=typeof t==`string`?t===`use-credentials`?t:``:void 0):t=null,i.d.C(e,t))},e.prefetchDNS=function(e){typeof e==`string`&&i.d.D(e)},e.preinit=function(e,t){if(typeof e==`string`&&t&&typeof t.as==`string`){var n=t.as,r=c(n,t.crossOrigin),a=typeof t.integrity==`string`?t.integrity:void 0,o=typeof t.fetchPriority==`string`?t.fetchPriority:void 0;n===`style`?i.d.S(e,typeof t.precedence==`string`?t.precedence:void 0,{crossOrigin:r,integrity:a,fetchPriority:o}):n===`script`&&i.d.X(e,{crossOrigin:r,integrity:a,fetchPriority:o,nonce:typeof t.nonce==`string`?t.nonce:void 0})}},e.preinitModule=function(e,t){if(typeof e==`string`)if(typeof t==`object`&&t){if(t.as==null||t.as===`script`){var n=c(t.as,t.crossOrigin);i.d.M(e,{crossOrigin:n,integrity:typeof t.integrity==`string`?t.integrity:void 0,nonce:typeof t.nonce==`string`?t.nonce:void 0})}}else t??i.d.M(e)},e.preload=function(e,t){if(typeof e==`string`&&typeof t==`object`&&t&&typeof t.as==`string`){var n=t.as,r=c(n,t.crossOrigin);i.d.L(e,n,{crossOrigin:r,integrity:typeof t.integrity==`string`?t.integrity:void 0,nonce:typeof t.nonce==`string`?t.nonce:void 0,type:typeof t.type==`string`?t.type:void 0,fetchPriority:typeof t.fetchPriority==`string`?t.fetchPriority:void 0,referrerPolicy:typeof t.referrerPolicy==`string`?t.referrerPolicy:void 0,imageSrcSet:typeof t.imageSrcSet==`string`?t.imageSrcSet:void 0,imageSizes:typeof t.imageSizes==`string`?t.imageSizes:void 0,media:typeof t.media==`string`?t.media:void 0})}},e.preloadModule=function(e,t){if(typeof e==`string`)if(t){var n=c(t.as,t.crossOrigin);i.d.m(e,{as:typeof t.as==`string`&&t.as!==`script`?t.as:void 0,crossOrigin:n,integrity:typeof t.integrity==`string`?t.integrity:void 0})}else i.d.m(e)},e.requestFormReset=function(e){i.d.r(e)},e.unstable_batchedUpdates=function(e,t){return e(t)},e.useFormState=function(e,t,n){return s.H.useFormState(e,t,n)},e.useFormStatus=function(){return s.H.useHostTransitionStatus()},e.version=`19.2.0`})),eC=o(((e,t)=>{function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>`u`||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!=`function`))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}n(),t.exports=vae()})),yae=o((e=>{var t=_ae(),n=Zm(),r=eC();function i(e){var t=`https://react.dev/errors/`+e;if(1<arguments.length){t+=`?args[]=`+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+=`&args[]=`+encodeURIComponent(arguments[n])}return`Minified React error #`+e+`; visit `+t+` for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`}function a(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function o(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function s(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function c(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function l(e){if(o(e)!==e)throw Error(i(188))}function u(e){var t=e.alternate;if(!t){if(t=o(e),t===null)throw Error(i(188));return t===e?e:null}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var s=a.alternate;if(s===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return l(a),e;if(s===r)return l(a),t;s=s.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=s;else{for(var c=!1,u=a.child;u;){if(u===n){c=!0,n=a,r=s;break}if(u===r){c=!0,r=a,n=s;break}u=u.sibling}if(!c){for(u=s.child;u;){if(u===n){c=!0,n=s,r=a;break}if(u===r){c=!0,r=s,n=a;break}u=u.sibling}if(!c)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(n.tag!==3)throw Error(i(188));return n.stateNode.current===n?e:t}function d(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=d(e),t!==null)return t;e=e.sibling}return null}var f=Object.assign,p=Symbol.for(`react.element`),m=Symbol.for(`react.transitional.element`),h=Symbol.for(`react.portal`),g=Symbol.for(`react.fragment`),_=Symbol.for(`react.strict_mode`),v=Symbol.for(`react.profiler`),y=Symbol.for(`react.consumer`),b=Symbol.for(`react.context`),x=Symbol.for(`react.forward_ref`),S=Symbol.for(`react.suspense`),C=Symbol.for(`react.suspense_list`),w=Symbol.for(`react.memo`),T=Symbol.for(`react.lazy`),E=Symbol.for(`react.activity`),D=Symbol.for(`react.memo_cache_sentinel`),O=Symbol.iterator;function k(e){return typeof e!=`object`||!e?null:(e=O&&e[O]||e[`@@iterator`],typeof e==`function`?e:null)}var ee=Symbol.for(`react.client.reference`);function te(e){if(e==null)return null;if(typeof e==`function`)return e.$$typeof===ee?null:e.displayName||e.name||null;if(typeof e==`string`)return e;switch(e){case g:return`Fragment`;case v:return`Profiler`;case _:return`StrictMode`;case S:return`Suspense`;case C:return`SuspenseList`;case E:return`Activity`}if(typeof e==`object`)switch(e.$$typeof){case h:return`Portal`;case b:return e.displayName||`Context`;case y:return(e._context.displayName||`Context`)+`.Consumer`;case x:var t=e.render;return e=e.displayName,e||=(e=t.displayName||t.name||``,e===``?`ForwardRef`:`ForwardRef(`+e+`)`),e;case w:return t=e.displayName||null,t===null?te(e.type)||`Memo`:t;case T:t=e._payload,e=e._init;try{return te(e(t))}catch{}}return null}var ne=Array.isArray,A=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re={pending:!1,data:null,method:null,action:null},ie=[],ae=-1;function oe(e){return{current:e}}function se(e){0>ae||(e.current=ie[ae],ie[ae]=null,ae--)}function ce(e,t){ae++,ie[ae]=e.current,e.current=t}var le=oe(null),ue=oe(null),de=oe(null),fe=oe(null);function pe(e,t){switch(ce(de,t),ce(ue,e),ce(le,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?Sf(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=Sf(t),e=Cf(t,e);else switch(e){case`svg`:e=1;break;case`math`:e=2;break;default:e=0}}se(le),ce(le,e)}function me(){se(le),se(ue),se(de)}function he(e){e.memoizedState!==null&&ce(fe,e);var t=le.current,n=Cf(t,e.type);t!==n&&(ce(ue,e),ce(le,n))}function ge(e){ue.current===e&&(se(le),se(ue)),fe.current===e&&(se(fe),Mp._currentValue=re)}var _e,ve;function ye(e){if(_e===void 0)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);_e=t&&t[1]||``,ve=-1<e.stack.indexOf(`
    at`)?` (<anonymous>)`:-1<e.stack.indexOf(`@`)?`@unknown:0:0`:``}return`
`+_e+e+ve}var be=!1;function xe(e,t){if(!e||be)return``;be=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,`props`,{set:function(){throw Error()}}),typeof Reflect==`object`&&Reflect.construct){try{Reflect.construct(n,[])}catch(e){var r=e}Reflect.construct(e,[],n)}else{try{n.call()}catch(e){r=e}e.call(n.prototype)}}else{try{throw Error()}catch(e){r=e}(n=e())&&typeof n.catch==`function`&&n.catch(function(){})}}catch(e){if(e&&r&&typeof e.stack==`string`)return[e.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName=`DetermineComponentFrameRoot`;var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,`name`);i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,`name`,{value:`DetermineComponentFrameRoot`});var a=r.DetermineComponentFrameRoot(),o=a[0],s=a[1];if(o&&s){var c=o.split(`
`),l=s.split(`
`);for(i=r=0;r<c.length&&!c[r].includes(`DetermineComponentFrameRoot`);)r++;for(;i<l.length&&!l[i].includes(`DetermineComponentFrameRoot`);)i++;if(r===c.length||i===l.length)for(r=c.length-1,i=l.length-1;1<=r&&0<=i&&c[r]!==l[i];)i--;for(;1<=r&&0<=i;r--,i--)if(c[r]!==l[i]){if(r!==1||i!==1)do if(r--,i--,0>i||c[r]!==l[i]){var u=`
`+c[r].replace(` at new `,` at `);return e.displayName&&u.includes(`<anonymous>`)&&(u=u.replace(`<anonymous>`,e.displayName)),u}while(1<=r&&0<=i);break}}}finally{be=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:``)?ye(n):``}function Se(e,t){switch(e.tag){case 26:case 27:case 5:return ye(e.type);case 16:return ye(`Lazy`);case 13:return e.child!==t&&t!==null?ye(`Suspense Fallback`):ye(`Suspense`);case 19:return ye(`SuspenseList`);case 0:case 15:return xe(e.type,!1);case 11:return xe(e.type.render,!1);case 1:return xe(e.type,!0);case 31:return ye(`Activity`);default:return``}}function Ce(e){try{var t=``,n=null;do t+=Se(e,n),n=e,e=e.return;while(e);return t}catch(e){return`
Error generating stack: `+e.message+`
`+e.stack}}var we=Object.prototype.hasOwnProperty,Te=t.unstable_scheduleCallback,Ee=t.unstable_cancelCallback,De=t.unstable_shouldYield,Oe=t.unstable_requestPaint,ke=t.unstable_now,Ae=t.unstable_getCurrentPriorityLevel,je=t.unstable_ImmediatePriority,Me=t.unstable_UserBlockingPriority,Ne=t.unstable_NormalPriority,Pe=t.unstable_LowPriority,Fe=t.unstable_IdlePriority,Ie=t.log,Le=t.unstable_setDisableYieldValue,Re=null,ze=null;function Be(e){if(typeof Ie==`function`&&Le(e),ze&&typeof ze.setStrictMode==`function`)try{ze.setStrictMode(Re,e)}catch{}}var Ve=Math.clz32?Math.clz32:We,He=Math.log,Ue=Math.LN2;function We(e){return e>>>=0,e===0?32:31-(He(e)/Ue|0)|0}var Ge=256,Ke=262144,qe=4194304;function Je(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ye(e,t,n){var r=e.pendingLanes;if(r===0)return 0;var i=0,a=e.suspendedLanes,o=e.pingedLanes;e=e.warmLanes;var s=r&134217727;return s===0?(s=r&~a,s===0?o===0?n||(n=r&~e,n!==0&&(i=Je(n))):i=Je(o):i=Je(s)):(r=s&~a,r===0?(o&=s,o===0?n||(n=s&~e,n!==0&&(i=Je(n))):i=Je(o)):i=Je(r)),i===0?0:t!==0&&t!==i&&(t&a)===0&&(a=i&-i,n=t&-t,a>=n||a===32&&n&4194048)?t:i}function Xe(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Ze(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qe(){var e=qe;return qe<<=1,!(qe&62914560)&&(qe=4194304),e}function $e(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function et(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function tt(e,t,n,r,i,a){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var s=e.entanglements,c=e.expirationTimes,l=e.hiddenUpdates;for(n=o&~n;0<n;){var u=31-Ve(n),d=1<<u;s[u]=0,c[u]=-1;var f=l[u];if(f!==null)for(l[u]=null,u=0;u<f.length;u++){var p=f[u];p!==null&&(p.lane&=-536870913)}n&=~d}r!==0&&nt(e,r,0),a!==0&&i===0&&e.tag!==0&&(e.suspendedLanes|=a&~(o&~t))}function nt(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-Ve(t);e.entangledLanes|=t,e.entanglements[r]=e.entanglements[r]|1073741824|n&261930}function rt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ve(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function it(e,t){var n=t&-t;return n=n&42?1:at(n),(n&(e.suspendedLanes|t))===0?n:0}function at(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ot(e){return e&=-e,2<e?8<e?e&134217727?32:268435456:8:2}function st(){var e=j.p;return e===0?(e=window.event,e===void 0?32:Jp(e.type)):e}function ct(e,t){var n=j.p;try{return j.p=e,t()}finally{j.p=n}}var lt=Math.random().toString(36).slice(2),ut=`__reactFiber$`+lt,dt=`__reactProps$`+lt,ft=`__reactContainer$`+lt,pt=`__reactEvents$`+lt,mt=`__reactListeners$`+lt,ht=`__reactHandles$`+lt,gt=`__reactResources$`+lt,_t=`__reactMarker$`+lt;function vt(e){delete e[ut],delete e[dt],delete e[pt],delete e[mt],delete e[ht]}function yt(e){var t=e[ut];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ft]||n[ut]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Gf(e);e!==null;){if(n=e[ut])return n;e=Gf(e)}return t}e=n,n=e.parentNode}return null}function bt(e){if(e=e[ut]||e[ft]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function xt(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(i(33))}function St(e){var t=e[gt];return t||=e[gt]={hoistableStyles:new Map,hoistableScripts:new Map},t}function Ct(e){e[_t]=!0}var wt=new Set,Tt={};function Et(e,t){Dt(e,t),Dt(e+`Capture`,t)}function Dt(e,t){for(Tt[e]=t,e=0;e<t.length;e++)wt.add(t[e])}var Ot=RegExp(`^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$`),kt={},At={};function jt(e){return we.call(At,e)?!0:we.call(kt,e)?!1:Ot.test(e)?At[e]=!0:(kt[e]=!0,!1)}function Mt(e,t,n){if(jt(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case`undefined`:case`function`:case`symbol`:e.removeAttribute(t);return;case`boolean`:var r=t.toLowerCase().slice(0,5);if(r!==`data-`&&r!==`aria-`){e.removeAttribute(t);return}}e.setAttribute(t,``+n)}}function Nt(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case`undefined`:case`function`:case`symbol`:case`boolean`:e.removeAttribute(t);return}e.setAttribute(t,``+n)}}function Pt(e,t,n,r){if(r===null)e.removeAttribute(n);else{switch(typeof r){case`undefined`:case`function`:case`symbol`:case`boolean`:e.removeAttribute(n);return}e.setAttributeNS(t,n,``+r)}}function Ft(e){switch(typeof e){case`bigint`:case`boolean`:case`number`:case`string`:case`undefined`:return e;case`object`:return e;default:return``}}function It(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()===`input`&&(t===`checkbox`||t===`radio`)}function Lt(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&r!==void 0&&typeof r.get==`function`&&typeof r.set==`function`){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=``+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=``+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Rt(e){if(!e._valueTracker){var t=It(e)?`checked`:`value`;e._valueTracker=Lt(e,t,``+e[t])}}function zt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r=``;return e&&(r=It(e)?e.checked?`true`:`false`:e.value),e=r,e===n?!1:(t.setValue(e),!0)}function Bt(e){if(e||=typeof document<`u`?document:void 0,e===void 0)return null;try{return e.activeElement||e.body}catch{return e.body}}var Vt=/[\n"\\]/g;function Ht(e){return e.replace(Vt,function(e){return`\\`+e.charCodeAt(0).toString(16)+` `})}function Ut(e,t,n,r,i,a,o,s){e.name=``,o!=null&&typeof o!=`function`&&typeof o!=`symbol`&&typeof o!=`boolean`?e.type=o:e.removeAttribute(`type`),t==null?o!==`submit`&&o!==`reset`||e.removeAttribute(`value`):o===`number`?(t===0&&e.value===``||e.value!=t)&&(e.value=``+Ft(t)):e.value!==``+Ft(t)&&(e.value=``+Ft(t)),t==null?n==null?r!=null&&e.removeAttribute(`value`):Gt(e,o,Ft(n)):Gt(e,o,Ft(t)),i==null&&a!=null&&(e.defaultChecked=!!a),i!=null&&(e.checked=i&&typeof i!=`function`&&typeof i!=`symbol`),s!=null&&typeof s!=`function`&&typeof s!=`symbol`&&typeof s!=`boolean`?e.name=``+Ft(s):e.removeAttribute(`name`)}function Wt(e,t,n,r,i,a,o,s){if(a!=null&&typeof a!=`function`&&typeof a!=`symbol`&&typeof a!=`boolean`&&(e.type=a),t!=null||n!=null){if(!(a!==`submit`&&a!==`reset`||t!=null)){Rt(e);return}n=n==null?``:``+Ft(n),t=t==null?n:``+Ft(t),s||t===e.value||(e.value=t),e.defaultValue=t}r??=i,r=typeof r!=`function`&&typeof r!=`symbol`&&!!r,e.checked=s?e.checked:!!r,e.defaultChecked=!!r,o!=null&&typeof o!=`function`&&typeof o!=`symbol`&&typeof o!=`boolean`&&(e.name=o),Rt(e)}function Gt(e,t,n){t===`number`&&Bt(e.ownerDocument)===e||e.defaultValue===``+n||(e.defaultValue=``+n)}function Kt(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t[`$`+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty(`$`+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=``+Ft(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function qt(e,t,n){if(t!=null&&(t=``+Ft(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n==null?``:``+Ft(n)}function Jt(e,t,n,r){if(t==null){if(r!=null){if(n!=null)throw Error(i(92));if(ne(r)){if(1<r.length)throw Error(i(93));r=r[0]}n=r}n??=``,t=n}n=Ft(t),e.defaultValue=n,r=e.textContent,r===n&&r!==``&&r!==null&&(e.value=r),Rt(e)}function Yt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Xt=new Set(`animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp`.split(` `));function Zt(e,t,n){var r=t.indexOf(`--`)===0;n==null||typeof n==`boolean`||n===``?r?e.setProperty(t,``):t===`float`?e.cssFloat=``:e[t]=``:r?e.setProperty(t,n):typeof n!=`number`||n===0||Xt.has(t)?t===`float`?e.cssFloat=n:e[t]=(``+n).trim():e[t]=n+`px`}function Qt(e,t,n){if(t!=null&&typeof t!=`object`)throw Error(i(62));if(e=e.style,n!=null){for(var r in n)!n.hasOwnProperty(r)||t!=null&&t.hasOwnProperty(r)||(r.indexOf(`--`)===0?e.setProperty(r,``):r===`float`?e.cssFloat=``:e[r]=``);for(var a in t)r=t[a],t.hasOwnProperty(a)&&n[a]!==r&&Zt(e,a,r)}else for(var o in t)t.hasOwnProperty(o)&&Zt(e,o,t[o])}function $t(e){if(e.indexOf(`-`)===-1)return!1;switch(e){case`annotation-xml`:case`color-profile`:case`font-face`:case`font-face-src`:case`font-face-uri`:case`font-face-format`:case`font-face-name`:case`missing-glyph`:return!1;default:return!0}}var en=new Map([[`acceptCharset`,`accept-charset`],[`htmlFor`,`for`],[`httpEquiv`,`http-equiv`],[`crossOrigin`,`crossorigin`],[`accentHeight`,`accent-height`],[`alignmentBaseline`,`alignment-baseline`],[`arabicForm`,`arabic-form`],[`baselineShift`,`baseline-shift`],[`capHeight`,`cap-height`],[`clipPath`,`clip-path`],[`clipRule`,`clip-rule`],[`colorInterpolation`,`color-interpolation`],[`colorInterpolationFilters`,`color-interpolation-filters`],[`colorProfile`,`color-profile`],[`colorRendering`,`color-rendering`],[`dominantBaseline`,`dominant-baseline`],[`enableBackground`,`enable-background`],[`fillOpacity`,`fill-opacity`],[`fillRule`,`fill-rule`],[`floodColor`,`flood-color`],[`floodOpacity`,`flood-opacity`],[`fontFamily`,`font-family`],[`fontSize`,`font-size`],[`fontSizeAdjust`,`font-size-adjust`],[`fontStretch`,`font-stretch`],[`fontStyle`,`font-style`],[`fontVariant`,`font-variant`],[`fontWeight`,`font-weight`],[`glyphName`,`glyph-name`],[`glyphOrientationHorizontal`,`glyph-orientation-horizontal`],[`glyphOrientationVertical`,`glyph-orientation-vertical`],[`horizAdvX`,`horiz-adv-x`],[`horizOriginX`,`horiz-origin-x`],[`imageRendering`,`image-rendering`],[`letterSpacing`,`letter-spacing`],[`lightingColor`,`lighting-color`],[`markerEnd`,`marker-end`],[`markerMid`,`marker-mid`],[`markerStart`,`marker-start`],[`overlinePosition`,`overline-position`],[`overlineThickness`,`overline-thickness`],[`paintOrder`,`paint-order`],[`panose-1`,`panose-1`],[`pointerEvents`,`pointer-events`],[`renderingIntent`,`rendering-intent`],[`shapeRendering`,`shape-rendering`],[`stopColor`,`stop-color`],[`stopOpacity`,`stop-opacity`],[`strikethroughPosition`,`strikethrough-position`],[`strikethroughThickness`,`strikethrough-thickness`],[`strokeDasharray`,`stroke-dasharray`],[`strokeDashoffset`,`stroke-dashoffset`],[`strokeLinecap`,`stroke-linecap`],[`strokeLinejoin`,`stroke-linejoin`],[`strokeMiterlimit`,`stroke-miterlimit`],[`strokeOpacity`,`stroke-opacity`],[`strokeWidth`,`stroke-width`],[`textAnchor`,`text-anchor`],[`textDecoration`,`text-decoration`],[`textRendering`,`text-rendering`],[`transformOrigin`,`transform-origin`],[`underlinePosition`,`underline-position`],[`underlineThickness`,`underline-thickness`],[`unicodeBidi`,`unicode-bidi`],[`unicodeRange`,`unicode-range`],[`unitsPerEm`,`units-per-em`],[`vAlphabetic`,`v-alphabetic`],[`vHanging`,`v-hanging`],[`vIdeographic`,`v-ideographic`],[`vMathematical`,`v-mathematical`],[`vectorEffect`,`vector-effect`],[`vertAdvY`,`vert-adv-y`],[`vertOriginX`,`vert-origin-x`],[`vertOriginY`,`vert-origin-y`],[`wordSpacing`,`word-spacing`],[`writingMode`,`writing-mode`],[`xmlnsXlink`,`xmlns:xlink`],[`xHeight`,`x-height`]]),tn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function nn(e){return tn.test(``+e)?`javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')`:e}function rn(){}var an=null;function on(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var sn=null,cn=null;function ln(e){var t=bt(e);if(t&&(e=t.stateNode)){var n=e[dt]||null;a:switch(e=t.stateNode,t.type){case`input`:if(Ut(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type===`radio`&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll(`input[name="`+Ht(``+t)+`"][type="radio"]`),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=r[dt]||null;if(!a)throw Error(i(90));Ut(r,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<n.length;t++)r=n[t],r.form===e.form&&zt(r)}break a;case`textarea`:qt(e,n.value,n.defaultValue);break a;case`select`:t=n.value,t!=null&&Kt(e,!!n.multiple,t,!1)}}}var un=!1;function dn(e,t,n){if(un)return e(t,n);un=!0;try{return e(t)}finally{if(un=!1,(sn!==null||cn!==null)&&(Ju(),sn&&(t=sn,e=cn,cn=sn=null,ln(t),e)))for(t=0;t<e.length;t++)ln(e[t])}}function fn(e,t){var n=e.stateNode;if(n===null)return null;var r=n[dt]||null;if(r===null)return null;n=r[t];a:switch(t){case`onClick`:case`onClickCapture`:case`onDoubleClick`:case`onDoubleClickCapture`:case`onMouseDown`:case`onMouseDownCapture`:case`onMouseMove`:case`onMouseMoveCapture`:case`onMouseUp`:case`onMouseUpCapture`:case`onMouseEnter`:(r=!r.disabled)||(e=e.type,r=!(e===`button`||e===`input`||e===`select`||e===`textarea`)),e=!r;break a;default:e=!1}if(e)return null;if(n&&typeof n!=`function`)throw Error(i(231,t,typeof n));return n}var pn=!(typeof window>`u`||window.document===void 0||window.document.createElement===void 0),mn=!1;if(pn)try{var hn={};Object.defineProperty(hn,`passive`,{get:function(){mn=!0}}),window.addEventListener(`test`,hn,hn),window.removeEventListener(`test`,hn,hn)}catch{mn=!1}var gn=null,_n=null,vn=null;function yn(){if(vn)return vn;var e,t=_n,n=t.length,r,i=`value`in gn?gn.value:gn.textContent,a=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[a-r];r++);return vn=i.slice(e,1<r?1-r:void 0)}function bn(e){var t=e.keyCode;return`charCode`in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function xn(){return!0}function Sn(){return!1}function Cn(e){function t(t,n,r,i,a){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented==null?!1===i.returnValue:i.defaultPrevented)?xn:Sn,this.isPropagationStopped=Sn,this}return f(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():typeof e.returnValue!=`unknown`&&(e.returnValue=!1),this.isDefaultPrevented=xn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():typeof e.cancelBubble!=`unknown`&&(e.cancelBubble=!0),this.isPropagationStopped=xn)},persist:function(){},isPersistent:xn}),t}var wn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Tn=Cn(wn),En=f({},wn,{view:0,detail:0}),M=Cn(En),Dn,On,kn,An=f({},En,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Kn,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return`movementX`in e?e.movementX:(e!==kn&&(kn&&e.type===`mousemove`?(Dn=e.screenX-kn.screenX,On=e.screenY-kn.screenY):On=Dn=0,kn=e),Dn)},movementY:function(e){return`movementY`in e?e.movementY:On}}),jn=Cn(An),Mn=f({},An,{dataTransfer:0}),Nn=Cn(Mn),Pn=f({},En,{relatedTarget:0}),Fn=Cn(Pn),In=f({},wn,{animationName:0,elapsedTime:0,pseudoElement:0}),Ln=Cn(In),Rn=f({},wn,{clipboardData:function(e){return`clipboardData`in e?e.clipboardData:window.clipboardData}}),zn=Cn(Rn),Bn=f({},wn,{data:0}),Vn=Cn(Bn),Hn={Esc:`Escape`,Spacebar:` `,Left:`ArrowLeft`,Up:`ArrowUp`,Right:`ArrowRight`,Down:`ArrowDown`,Del:`Delete`,Win:`OS`,Menu:`ContextMenu`,Apps:`ContextMenu`,Scroll:`ScrollLock`,MozPrintableKey:`Unidentified`},Un={8:`Backspace`,9:`Tab`,12:`Clear`,13:`Enter`,16:`Shift`,17:`Control`,18:`Alt`,19:`Pause`,20:`CapsLock`,27:`Escape`,32:` `,33:`PageUp`,34:`PageDown`,35:`End`,36:`Home`,37:`ArrowLeft`,38:`ArrowUp`,39:`ArrowRight`,40:`ArrowDown`,45:`Insert`,46:`Delete`,112:`F1`,113:`F2`,114:`F3`,115:`F4`,116:`F5`,117:`F6`,118:`F7`,119:`F8`,120:`F9`,121:`F10`,122:`F11`,123:`F12`,144:`NumLock`,145:`ScrollLock`,224:`Meta`},Wn={Alt:`altKey`,Control:`ctrlKey`,Meta:`metaKey`,Shift:`shiftKey`};function Gn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Wn[e])?!!t[e]:!1}function Kn(){return Gn}var qn=f({},En,{key:function(e){if(e.key){var t=Hn[e.key]||e.key;if(t!==`Unidentified`)return t}return e.type===`keypress`?(e=bn(e),e===13?`Enter`:String.fromCharCode(e)):e.type===`keydown`||e.type===`keyup`?Un[e.keyCode]||`Unidentified`:``},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Kn,charCode:function(e){return e.type===`keypress`?bn(e):0},keyCode:function(e){return e.type===`keydown`||e.type===`keyup`?e.keyCode:0},which:function(e){return e.type===`keypress`?bn(e):e.type===`keydown`||e.type===`keyup`?e.keyCode:0}}),Jn=Cn(qn),Yn=f({},An,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xn=Cn(Yn),Zn=f({},En,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Kn}),Qn=Cn(Zn),$n=f({},wn,{propertyName:0,elapsedTime:0,pseudoElement:0}),er=Cn($n),tr=f({},An,{deltaX:function(e){return`deltaX`in e?e.deltaX:`wheelDeltaX`in e?-e.wheelDeltaX:0},deltaY:function(e){return`deltaY`in e?e.deltaY:`wheelDeltaY`in e?-e.wheelDeltaY:`wheelDelta`in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),nr=Cn(tr),rr=f({},wn,{newState:0,oldState:0}),ir=Cn(rr),ar=[9,13,27,32],or=pn&&`CompositionEvent`in window,sr=null;pn&&`documentMode`in document&&(sr=document.documentMode);var cr=pn&&`TextEvent`in window&&!sr,lr=pn&&(!or||sr&&8<sr&&11>=sr),ur=` `,dr=!1;function fr(e,t){switch(e){case`keyup`:return ar.indexOf(t.keyCode)!==-1;case`keydown`:return t.keyCode!==229;case`keypress`:case`mousedown`:case`focusout`:return!0;default:return!1}}function pr(e){return e=e.detail,typeof e==`object`&&`data`in e?e.data:null}var mr=!1;function hr(e,t){switch(e){case`compositionend`:return pr(t);case`keypress`:return t.which===32?(dr=!0,ur):null;case`textInput`:return e=t.data,e===ur&&dr?null:e;default:return null}}function gr(e,t){if(mr)return e===`compositionend`||!or&&fr(e,t)?(e=yn(),vn=_n=gn=null,mr=!1,e):null;switch(e){case`paste`:return null;case`keypress`:if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case`compositionend`:return lr&&t.locale!==`ko`?null:t.data;default:return null}}var _r={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t===`input`?!!_r[e.type]:t===`textarea`}function yr(e,t,n,r){sn?cn?cn.push(r):cn=[r]:sn=r,t=af(t,`onChange`),0<t.length&&(n=new Tn(`onChange`,`change`,null,n,r),e.push({event:n,listeners:t}))}var br=null,xr=null;function Sr(e){Xd(e,0)}function Cr(e){var t=xt(e);if(zt(t))return e}function wr(e,t){if(e===`change`)return t}var Tr=!1;if(pn){var Er;if(pn){var Dr=`oninput`in document;if(!Dr){var Or=document.createElement(`div`);Or.setAttribute(`oninput`,`return;`),Dr=typeof Or.oninput==`function`}Er=Dr}else Er=!1;Tr=Er&&(!document.documentMode||9<document.documentMode)}function kr(){br&&(br.detachEvent(`onpropertychange`,Ar),xr=br=null)}function Ar(e){if(e.propertyName===`value`&&Cr(xr)){var t=[];yr(t,xr,e,on(e)),dn(Sr,t)}}function jr(e,t,n){e===`focusin`?(kr(),br=t,xr=n,br.attachEvent(`onpropertychange`,Ar)):e===`focusout`&&kr()}function Mr(e){if(e===`selectionchange`||e===`keyup`||e===`keydown`)return Cr(xr)}function Nr(e,t){if(e===`click`)return Cr(t)}function Pr(e,t){if(e===`input`||e===`change`)return Cr(t)}function Fr(e,t){return e===t&&(e!==0||1/e==1/t)||e!==e&&t!==t}var Ir=typeof Object.is==`function`?Object.is:Fr;function Lr(e,t){if(Ir(e,t))return!0;if(typeof e!=`object`||!e||typeof t!=`object`||!t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!we.call(t,i)||!Ir(e[i],t[i]))return!1}return!0}function Rr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function zr(e,t){var n=Rr(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}a:{for(;n;){if(n.nextSibling){n=n.nextSibling;break a}n=n.parentNode}n=void 0}n=Rr(n)}}function Br(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Br(e,t.parentNode):`contains`in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Vr(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Bt(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href==`string`}catch{n=!1}if(n)e=t.contentWindow;else break;t=Bt(e.document)}return t}function Hr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t===`input`&&(e.type===`text`||e.type===`search`||e.type===`tel`||e.type===`url`||e.type===`password`)||t===`textarea`||e.contentEditable===`true`)}var Ur=pn&&`documentMode`in document&&11>=document.documentMode,Wr=null,Gr=null,Kr=null,qr=!1;function Jr(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;qr||Wr==null||Wr!==Bt(r)||(r=Wr,`selectionStart`in r&&Hr(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Kr&&Lr(Kr,r)||(Kr=r,r=af(Gr,`onSelect`),0<r.length&&(t=new Tn(`onSelect`,`select`,null,t,n),e.push({event:t,listeners:r}),t.target=Wr)))}function Yr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n[`Webkit`+e]=`webkit`+t,n[`Moz`+e]=`moz`+t,n}var Xr={animationend:Yr(`Animation`,`AnimationEnd`),animationiteration:Yr(`Animation`,`AnimationIteration`),animationstart:Yr(`Animation`,`AnimationStart`),transitionrun:Yr(`Transition`,`TransitionRun`),transitionstart:Yr(`Transition`,`TransitionStart`),transitioncancel:Yr(`Transition`,`TransitionCancel`),transitionend:Yr(`Transition`,`TransitionEnd`)},Zr={},Qr={};pn&&(Qr=document.createElement(`div`).style,`AnimationEvent`in window||(delete Xr.animationend.animation,delete Xr.animationiteration.animation,delete Xr.animationstart.animation),`TransitionEvent`in window||delete Xr.transitionend.transition);function $r(e){if(Zr[e])return Zr[e];if(!Xr[e])return e;var t=Xr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Qr)return Zr[e]=t[n];return e}var ei=$r(`animationend`),ti=$r(`animationiteration`),ni=$r(`animationstart`),ri=$r(`transitionrun`),ii=$r(`transitionstart`),ai=$r(`transitioncancel`),oi=$r(`transitionend`),si=new Map,ci=`abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel`.split(` `);ci.push(`scrollEnd`);function li(e,t){si.set(e,t),Et(t,[e])}var ui=typeof reportError==`function`?reportError:function(e){if(typeof window==`object`&&typeof window.ErrorEvent==`function`){var t=new window.ErrorEvent(`error`,{bubbles:!0,cancelable:!0,message:typeof e==`object`&&e&&typeof e.message==`string`?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process==`object`&&typeof process.emit==`function`){process.emit(`uncaughtException`,e);return}console.error(e)},di=[],fi=0,pi=0;function mi(){for(var e=fi,t=pi=fi=0;t<e;){var n=di[t];di[t++]=null;var r=di[t];di[t++]=null;var i=di[t];di[t++]=null;var a=di[t];if(di[t++]=null,r!==null&&i!==null){var o=r.pending;o===null?i.next=i:(i.next=o.next,o.next=i),r.pending=i}a!==0&&vi(n,i,a)}}function hi(e,t,n,r){di[fi++]=e,di[fi++]=t,di[fi++]=n,di[fi++]=r,pi|=r,e.lanes|=r,e=e.alternate,e!==null&&(e.lanes|=r)}function gi(e,t,n,r){return hi(e,t,n,r),yi(e)}function _i(e,t){return hi(e,null,null,t),yi(e)}function vi(e,t,n){e.lanes|=n;var r=e.alternate;r!==null&&(r.lanes|=n);for(var i=!1,a=e.return;a!==null;)a.childLanes|=n,r=a.alternate,r!==null&&(r.childLanes|=n),a.tag===22&&(e=a.stateNode,e===null||e._visibility&1||(i=!0)),e=a,a=a.return;return e.tag===3?(a=e.stateNode,i&&t!==null&&(i=31-Ve(n),e=a.hiddenUpdates,r=e[i],r===null?e[i]=[t]:r.push(t),t.lane=n|536870912),a):null}function yi(e){if(50<zu)throw zu=0,Bu=null,Error(i(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var bi={};function xi(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Si(e,t,n,r){return new xi(e,t,n,r)}function Ci(e){return e=e.prototype,!(!e||!e.isReactComponent)}function wi(e,t){var n=e.alternate;return n===null?(n=Si(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function Ti(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ei(e,t,n,r,a,o){var s=0;if(r=e,typeof e==`function`)Ci(e)&&(s=1);else if(typeof e==`string`)s=Cp(e,n,le.current)?26:e===`html`||e===`head`||e===`body`?27:5;else a:switch(e){case E:return e=Si(31,n,t,a),e.elementType=E,e.lanes=o,e;case g:return Di(n.children,a,o,t);case _:s=8,a|=24;break;case v:return e=Si(12,n,t,a|2),e.elementType=v,e.lanes=o,e;case S:return e=Si(13,n,t,a),e.elementType=S,e.lanes=o,e;case C:return e=Si(19,n,t,a),e.elementType=C,e.lanes=o,e;default:if(typeof e==`object`&&e)switch(e.$$typeof){case b:s=10;break a;case y:s=9;break a;case x:s=11;break a;case w:s=14;break a;case T:s=16,r=null;break a}s=29,n=Error(i(130,e===null?`null`:typeof e,``)),r=null}return t=Si(s,n,t,a),t.elementType=e,t.type=r,t.lanes=o,t}function Di(e,t,n,r){return e=Si(7,e,r,t),e.lanes=n,e}function Oi(e,t,n){return e=Si(6,e,null,t),e.lanes=n,e}function ki(e){var t=Si(18,null,null,0);return t.stateNode=e,t}function Ai(e,t,n){return t=Si(4,e.children===null?[]:e.children,e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var ji=new WeakMap;function Mi(e,t){if(typeof e==`object`&&e){var n=ji.get(e);return n===void 0?(t={value:e,source:t,stack:Ce(t)},ji.set(e,t),t):n}return{value:e,source:t,stack:Ce(t)}}var Ni=[],Pi=0,Fi=null,Ii=0,Li=[],Ri=0,zi=null,Bi=1,Vi=``;function Hi(e,t){Ni[Pi++]=Ii,Ni[Pi++]=Fi,Fi=e,Ii=t}function Ui(e,t,n){Li[Ri++]=Bi,Li[Ri++]=Vi,Li[Ri++]=zi,zi=e;var r=Bi;e=Vi;var i=32-Ve(r)-1;r&=~(1<<i),n+=1;var a=32-Ve(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Bi=1<<32-Ve(t)+i|n<<i|r,Vi=a+e}else Bi=1<<a|n<<i|r,Vi=e}function Wi(e){e.return!==null&&(Hi(e,1),Ui(e,1,0))}function Gi(e){for(;e===Fi;)Fi=Ni[--Pi],Ni[Pi]=null,Ii=Ni[--Pi],Ni[Pi]=null;for(;e===zi;)zi=Li[--Ri],Li[Ri]=null,Vi=Li[--Ri],Li[Ri]=null,Bi=Li[--Ri],Li[Ri]=null}function Ki(e,t){Li[Ri++]=Bi,Li[Ri++]=Vi,Li[Ri++]=zi,Bi=t.id,Vi=t.overflow,zi=e}var qi=null,Ji=null,Yi=!1,Xi=null,Zi=!1,Qi=Error(i(519));function $i(e){var t=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?`text`:`HTML`,``));throw aa(Mi(t,e)),Qi}function ea(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[ut]=e,t[dt]=r,n){case`dialog`:Zd(`cancel`,t),Zd(`close`,t);break;case`iframe`:case`object`:case`embed`:Zd(`load`,t);break;case`video`:case`audio`:for(n=0;n<Jd.length;n++)Zd(Jd[n],t);break;case`source`:Zd(`error`,t);break;case`img`:case`image`:case`link`:Zd(`error`,t),Zd(`load`,t);break;case`details`:Zd(`toggle`,t);break;case`input`:Zd(`invalid`,t),Wt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case`select`:Zd(`invalid`,t);break;case`textarea`:Zd(`invalid`,t),Jt(t,r.value,r.defaultValue,r.children)}n=r.children,typeof n!=`string`&&typeof n!=`number`&&typeof n!=`bigint`||t.textContent===``+n||!0===r.suppressHydrationWarning||ff(t.textContent,n)?(r.popover!=null&&(Zd(`beforetoggle`,t),Zd(`toggle`,t)),r.onScroll!=null&&Zd(`scroll`,t),r.onScrollEnd!=null&&Zd(`scrollend`,t),r.onClick!=null&&(t.onclick=rn),t=!0):t=!1,t||$i(e,!0)}function ta(e){for(qi=e.return;qi;)switch(qi.tag){case 5:case 31:case 13:Zi=!1;return;case 27:case 3:Zi=!0;return;default:qi=qi.return}}function na(e){if(e!==qi)return!1;if(!Yi)return ta(e),Yi=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!==`form`&&n!==`button`)||wf(e.type,e.memoizedProps)),n=!n),n&&Ji&&$i(e),ta(e),t===13){if(e=e.memoizedState,e=e===null?null:e.dehydrated,!e)throw Error(i(317));Ji=Wf(e)}else if(t===31){if(e=e.memoizedState,e=e===null?null:e.dehydrated,!e)throw Error(i(317));Ji=Wf(e)}else t===27?(t=Ji,Mf(e.type)?(e=Uf,Uf=null,Ji=e):Ji=t):Ji=qi?Hf(e.stateNode.nextSibling):null;return!0}function ra(){Ji=qi=null,Yi=!1}function ia(){var e=Xi;return e!==null&&(Tu===null?Tu=e:Tu.push.apply(Tu,e),Xi=null),e}function aa(e){Xi===null?Xi=[e]:Xi.push(e)}var oa=oe(null),sa=null,ca=null;function la(e,t,n){ce(oa,t._currentValue),t._currentValue=n}function ua(e){e._currentValue=oa.current,se(oa)}function da(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)===t?r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t):(e.childLanes|=t,r!==null&&(r.childLanes|=t)),e===n)break;e=e.return}}function fa(e,t,n,r){var a=e.child;for(a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){var s=a.child;o=o.firstContext;a:for(;o!==null;){var c=o;o=a;for(var l=0;l<t.length;l++)if(c.context===t[l]){o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),da(o.return,n,e),r||(s=null);break a}o=c.next}}else if(a.tag===18){if(s=a.return,s===null)throw Error(i(341));s.lanes|=n,o=s.alternate,o!==null&&(o.lanes|=n),da(s,n,e),s=null}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===e){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}}function pa(e,t,n,r){e=null;for(var a=t,o=!1;a!==null;){if(!o){if(a.flags&524288)o=!0;else if(a.flags&262144)break}if(a.tag===10){var s=a.alternate;if(s===null)throw Error(i(387));if(s=s.memoizedProps,s!==null){var c=a.type;Ir(a.pendingProps.value,s.value)||(e===null?e=[c]:e.push(c))}}else if(a===fe.current){if(s=a.alternate,s===null)throw Error(i(387));s.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(e===null?e=[Mp]:e.push(Mp))}a=a.return}e!==null&&fa(t,e,n,r),t.flags|=262144}function ma(e){for(e=e.firstContext;e!==null;){if(!Ir(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function ha(e){sa=e,ca=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function ga(e){return va(sa,e)}function _a(e,t){return sa===null&&ha(e),va(e,t)}function va(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},ca===null){if(e===null)throw Error(i(308));ca=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else ca=ca.next=t;return n}var ya=typeof AbortController<`u`?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},ba=t.unstable_scheduleCallback,xa=t.unstable_NormalPriority,Sa={$$typeof:b,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ca(){return{controller:new ya,data:new Map,refCount:0}}function wa(e){e.refCount--,e.refCount===0&&ba(xa,function(){e.controller.abort()})}var Ta=null,Ea=0,Da=0,Oa=null;function ka(e,t){if(Ta===null){var n=Ta=[];Ea=0,Da=Bd(),Oa={status:`pending`,value:void 0,then:function(e){n.push(e)}}}return Ea++,t.then(Aa,Aa),t}function Aa(){if(--Ea===0&&Ta!==null){Oa!==null&&(Oa.status=`fulfilled`);var e=Ta;Ta=null,Da=0,Oa=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function ja(e,t){var n=[],r={status:`pending`,value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status=`fulfilled`,r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status=`rejected`,r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}var Ma=A.S;A.S=function(e,t){Ou=ke(),typeof t==`object`&&t&&typeof t.then==`function`&&ka(e,t),Ma!==null&&Ma(e,t)};var Na=oe(null);function Pa(){var e=Na.current;return e===null?lu.pooledCache:e}function Fa(e,t){t===null?ce(Na,Na.current):ce(Na,t.pool)}function Ia(){var e=Pa();return e===null?null:{parent:Sa._currentValue,pool:e}}var La=Error(i(460)),Ra=Error(i(474)),za=Error(i(542)),Ba={then:function(){}};function Va(e){return e=e.status,e===`fulfilled`||e===`rejected`}function Ha(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(rn,rn),t=n),t.status){case`fulfilled`:return t.value;case`rejected`:throw e=t.reason,Ka(e),e;default:if(typeof t.status==`string`)t.then(rn,rn);else{if(e=lu,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=t,e.status=`pending`,e.then(function(e){if(t.status===`pending`){var n=t;n.status=`fulfilled`,n.value=e}},function(e){if(t.status===`pending`){var n=t;n.status=`rejected`,n.reason=e}})}switch(t.status){case`fulfilled`:return t.value;case`rejected`:throw e=t.reason,Ka(e),e}throw Wa=t,La}}function Ua(e){try{var t=e._init;return t(e._payload)}catch(e){throw typeof e==`object`&&e&&typeof e.then==`function`?(Wa=e,La):e}}var Wa=null;function Ga(){if(Wa===null)throw Error(i(459));var e=Wa;return Wa=null,e}function Ka(e){if(e===La||e===za)throw Error(i(483))}var qa=null,Ja=0;function Ya(e){var t=Ja;return Ja+=1,qa===null&&(qa=[]),Ha(qa,e,t)}function Xa(e,t){t=t.props.ref,e.ref=t===void 0?null:t}function Za(e,t){throw t.$$typeof===p?Error(i(525)):(e=Object.prototype.toString.call(t),Error(i(31,e===`[object Object]`?`object with keys {`+Object.keys(t).join(`, `)+`}`:e)))}function Qa(e){function t(t,n){if(e){var r=t.deletions;r===null?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;r!==null;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;e!==null;)e.key===null?t.set(e.index,e):t.set(e.key,e),e=e.sibling;return t}function a(e,t){return e=wi(e,t),e.index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?(r=t.alternate,r===null?(t.flags|=67108866,n):(r=r.index,r<n?(t.flags|=67108866,n):r)):(t.flags|=1048576,n)}function s(t){return e&&t.alternate===null&&(t.flags|=67108866),t}function c(e,t,n,r){return t===null||t.tag!==6?(t=Oi(n,e.mode,r),t.return=e,t):(t=a(t,n),t.return=e,t)}function l(e,t,n,r){var i=n.type;return i===g?d(e,t,n.props.children,r,n.key):t!==null&&(t.elementType===i||typeof i==`object`&&i&&i.$$typeof===T&&Ua(i)===t.type)?(t=a(t,n.props),Xa(t,n),t.return=e,t):(t=Ei(n.type,n.key,n.props,null,e.mode,r),Xa(t,n),t.return=e,t)}function u(e,t,n,r){return t===null||t.tag!==4||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?(t=Ai(n,e.mode,r),t.return=e,t):(t=a(t,n.children||[]),t.return=e,t)}function d(e,t,n,r,i){return t===null||t.tag!==7?(t=Di(n,e.mode,r,i),t.return=e,t):(t=a(t,n),t.return=e,t)}function f(e,t,n){if(typeof t==`string`&&t!==``||typeof t==`number`||typeof t==`bigint`)return t=Oi(``+t,e.mode,n),t.return=e,t;if(typeof t==`object`&&t){switch(t.$$typeof){case m:return n=Ei(t.type,t.key,t.props,null,e.mode,n),Xa(n,t),n.return=e,n;case h:return t=Ai(t,e.mode,n),t.return=e,t;case T:return t=Ua(t),f(e,t,n)}if(ne(t)||k(t))return t=Di(t,e.mode,n,null),t.return=e,t;if(typeof t.then==`function`)return f(e,Ya(t),n);if(t.$$typeof===b)return f(e,_a(e,t),n);Za(e,t)}return null}function p(e,t,n,r){var i=t===null?null:t.key;if(typeof n==`string`&&n!==``||typeof n==`number`||typeof n==`bigint`)return i===null?c(e,t,``+n,r):null;if(typeof n==`object`&&n){switch(n.$$typeof){case m:return n.key===i?l(e,t,n,r):null;case h:return n.key===i?u(e,t,n,r):null;case T:return n=Ua(n),p(e,t,n,r)}if(ne(n)||k(n))return i===null?d(e,t,n,r,null):null;if(typeof n.then==`function`)return p(e,t,Ya(n),r);if(n.$$typeof===b)return p(e,t,_a(e,n),r);Za(e,n)}return null}function _(e,t,n,r,i){if(typeof r==`string`&&r!==``||typeof r==`number`||typeof r==`bigint`)return e=e.get(n)||null,c(t,e,``+r,i);if(typeof r==`object`&&r){switch(r.$$typeof){case m:return e=e.get(r.key===null?n:r.key)||null,l(t,e,r,i);case h:return e=e.get(r.key===null?n:r.key)||null,u(t,e,r,i);case T:return r=Ua(r),_(e,t,n,r,i)}if(ne(r)||k(r))return e=e.get(n)||null,d(t,e,r,i,null);if(typeof r.then==`function`)return _(e,t,n,Ya(r),i);if(r.$$typeof===b)return _(e,t,n,_a(t,r),i);Za(t,r)}return null}function v(i,a,s,c){for(var l=null,u=null,d=a,m=a=0,h=null;d!==null&&m<s.length;m++){d.index>m?(h=d,d=null):h=d.sibling;var g=p(i,d,s[m],c);if(g===null){d===null&&(d=h);break}e&&d&&g.alternate===null&&t(i,d),a=o(g,a,m),u===null?l=g:u.sibling=g,u=g,d=h}if(m===s.length)return n(i,d),Yi&&Hi(i,m),l;if(d===null){for(;m<s.length;m++)d=f(i,s[m],c),d!==null&&(a=o(d,a,m),u===null?l=d:u.sibling=d,u=d);return Yi&&Hi(i,m),l}for(d=r(d);m<s.length;m++)h=_(d,i,m,s[m],c),h!==null&&(e&&h.alternate!==null&&d.delete(h.key===null?m:h.key),a=o(h,a,m),u===null?l=h:u.sibling=h,u=h);return e&&d.forEach(function(e){return t(i,e)}),Yi&&Hi(i,m),l}function y(a,s,c,l){if(c==null)throw Error(i(151));for(var u=null,d=null,m=s,h=s=0,g=null,v=c.next();m!==null&&!v.done;h++,v=c.next()){m.index>h?(g=m,m=null):g=m.sibling;var y=p(a,m,v.value,l);if(y===null){m===null&&(m=g);break}e&&m&&y.alternate===null&&t(a,m),s=o(y,s,h),d===null?u=y:d.sibling=y,d=y,m=g}if(v.done)return n(a,m),Yi&&Hi(a,h),u;if(m===null){for(;!v.done;h++,v=c.next())v=f(a,v.value,l),v!==null&&(s=o(v,s,h),d===null?u=v:d.sibling=v,d=v);return Yi&&Hi(a,h),u}for(m=r(m);!v.done;h++,v=c.next())v=_(m,a,h,v.value,l),v!==null&&(e&&v.alternate!==null&&m.delete(v.key===null?h:v.key),s=o(v,s,h),d===null?u=v:d.sibling=v,d=v);return e&&m.forEach(function(e){return t(a,e)}),Yi&&Hi(a,h),u}function x(e,r,o,c){if(typeof o==`object`&&o&&o.type===g&&o.key===null&&(o=o.props.children),typeof o==`object`&&o){switch(o.$$typeof){case m:a:{for(var l=o.key;r!==null;){if(r.key===l){if(l=o.type,l===g){if(r.tag===7){n(e,r.sibling),c=a(r,o.props.children),c.return=e,e=c;break a}}else if(r.elementType===l||typeof l==`object`&&l&&l.$$typeof===T&&Ua(l)===r.type){n(e,r.sibling),c=a(r,o.props),Xa(c,o),c.return=e,e=c;break a}n(e,r);break}else t(e,r);r=r.sibling}o.type===g?(c=Di(o.props.children,e.mode,c,o.key),c.return=e,e=c):(c=Ei(o.type,o.key,o.props,null,e.mode,c),Xa(c,o),c.return=e,e=c)}return s(e);case h:a:{for(l=o.key;r!==null;){if(r.key===l)if(r.tag===4&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(e,r.sibling),c=a(r,o.children||[]),c.return=e,e=c;break a}else{n(e,r);break}else t(e,r);r=r.sibling}c=Ai(o,e.mode,c),c.return=e,e=c}return s(e);case T:return o=Ua(o),x(e,r,o,c)}if(ne(o))return v(e,r,o,c);if(k(o)){if(l=k(o),typeof l!=`function`)throw Error(i(150));return o=l.call(o),y(e,r,o,c)}if(typeof o.then==`function`)return x(e,r,Ya(o),c);if(o.$$typeof===b)return x(e,r,_a(e,o),c);Za(e,o)}return typeof o==`string`&&o!==``||typeof o==`number`||typeof o==`bigint`?(o=``+o,r!==null&&r.tag===6?(n(e,r.sibling),c=a(r,o),c.return=e,e=c):(n(e,r),c=Oi(o,e.mode,c),c.return=e,e=c),s(e)):n(e,r)}return function(e,t,n,r){try{Ja=0;var i=x(e,t,n,r);return qa=null,i}catch(t){if(t===La||t===za)throw t;var a=Si(29,t,null,e.mode);return a.lanes=r,a.return=e,a}}}var $a=Qa(!0),eo=Qa(!1),to=!1;function no(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ro(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function io(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ao(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,cu&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=yi(e),vi(e,null,n),t}return hi(e,r,t,n),yi(e)}function oo(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,n&4194048)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,rt(e,n)}}function so(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};a===null?i=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?i=a=t:a=a.next=t}else i=a=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,callbacks:r.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var co=!1;function lo(){if(co){var e=Oa;if(e!==null)throw e}}function uo(e,t,n,r){co=!1;var i=e.updateQueue;to=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var c=s,l=c.next;c.next=null,o===null?a=l:o.next=l,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,s=u.lastBaseUpdate,s!==o&&(s===null?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=c))}if(a!==null){var d=i.baseState;o=0,u=l=c=null,s=a;do{var p=s.lane&-536870913,m=p!==s.lane;if(m?(du&p)===p:(r&p)===p){p!==0&&p===Da&&(co=!0),u!==null&&(u=u.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});a:{var h=e,g=s;p=t;var _=n;switch(g.tag){case 1:if(h=g.payload,typeof h==`function`){d=h.call(_,d,p);break a}d=h;break a;case 3:h.flags=h.flags&-65537|128;case 0:if(h=g.payload,p=typeof h==`function`?h.call(_,d,p):h,p==null)break a;d=f({},d,p);break a;case 2:to=!0}}p=s.callback,p!==null&&(e.flags|=64,m&&(e.flags|=8192),m=i.callbacks,m===null?i.callbacks=[p]:m.push(p))}else m={lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},u===null?(l=u=m,c=d):u=u.next=m,o|=p;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;m=s,s=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(1);u===null&&(c=d),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,a===null&&(i.shared.lanes=0),yu|=o,e.lanes=o,e.memoizedState=d}}function fo(e,t){if(typeof e!=`function`)throw Error(i(191,e));e.call(t)}function po(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)fo(n[e],t)}var mo=oe(null),ho=oe(0);function go(e,t){e=_u,ce(ho,e),ce(mo,t),_u=e|t.baseLanes}function _o(){ce(ho,_u),ce(mo,mo.current)}function vo(){_u=ho.current,se(mo),se(ho)}var yo=oe(null),bo=null;function xo(e){var t=e.alternate;ce(Eo,Eo.current&1),ce(yo,e),bo===null&&(t===null||mo.current!==null||t.memoizedState!==null)&&(bo=e)}function So(e){ce(Eo,Eo.current),ce(yo,e),bo===null&&(bo=e)}function Co(e){e.tag===22?(ce(Eo,Eo.current),ce(yo,e),bo===null&&(bo=e)):wo(e)}function wo(){ce(Eo,Eo.current),ce(yo,yo.current)}function To(e){se(yo),bo===e&&(bo=null),se(Eo)}var Eo=oe(0);function Do(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||zf(n)||Bf(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder===`forwards`||t.memoizedProps.revealOrder===`backwards`||t.memoizedProps.revealOrder===`unstable_legacy-backwards`||t.memoizedProps.revealOrder===`together`)){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Oo=0,ko=null,Ao=null,jo=null,Mo=!1,No=!1,Po=!1,Fo=0,Io=0,Lo=null,Ro=0;function zo(){throw Error(i(321))}function Bo(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Ir(e[n],t[n]))return!1;return!0}function Vo(e,t,n,r,i,a){return Oo=a,ko=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,A.H=e===null||e.memoizedState===null?oc:sc,Po=!1,a=n(r,i),Po=!1,No&&(a=Uo(t,n,r,i)),Ho(e),a}function Ho(e){A.H=ac;var t=Ao!==null&&Ao.next!==null;if(Oo=0,jo=Ao=ko=null,Mo=!1,Io=0,Lo=null,t)throw Error(i(300));e===null||wc||(e=e.dependencies,e!==null&&ma(e)&&(wc=!0))}function Uo(e,t,n,r){ko=e;var a=0;do{if(No&&(Lo=null),Io=0,No=!1,25<=a)throw Error(i(301));if(a+=1,jo=Ao=null,e.updateQueue!=null){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,o.memoCache!=null&&(o.memoCache.index=0)}A.H=cc,o=t(n,r)}while(No);return o}function Wo(){var e=A.H,t=e.useState()[0];return t=typeof t.then==`function`?Zo(t):t,e=e.useState()[0],(Ao===null?null:Ao.memoizedState)!==e&&(ko.flags|=1024),t}function Go(){var e=Fo!==0;return Fo=0,e}function Ko(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function qo(e){if(Mo){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Mo=!1}Oo=0,jo=Ao=ko=null,No=!1,Io=Fo=0,Lo=null}function Jo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jo===null?ko.memoizedState=jo=e:jo=jo.next=e,jo}function Yo(){if(Ao===null){var e=ko.alternate;e=e===null?null:e.memoizedState}else e=Ao.next;var t=jo===null?ko.memoizedState:jo.next;if(t!==null)jo=t,Ao=e;else{if(e===null)throw ko.alternate===null?Error(i(467)):Error(i(310));Ao=e,e={memoizedState:Ao.memoizedState,baseState:Ao.baseState,baseQueue:Ao.baseQueue,queue:Ao.queue,next:null},jo===null?ko.memoizedState=jo=e:jo=jo.next=e}return jo}function Xo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Zo(e){var t=Io;return Io+=1,Lo===null&&(Lo=[]),e=Ha(Lo,e,t),t=ko,(jo===null?t.memoizedState:jo.next)===null&&(t=t.alternate,A.H=t===null||t.memoizedState===null?oc:sc),e}function Qo(e){if(typeof e==`object`&&e){if(typeof e.then==`function`)return Zo(e);if(e.$$typeof===b)return ga(e)}throw Error(i(438,String(e)))}function $o(e){var t=null,n=ko.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var r=ko.alternate;r!==null&&(r=r.updateQueue,r!==null&&(r=r.memoCache,r!=null&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(t??={data:[],index:0},n===null&&(n=Xo(),ko.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=D;return t.index++,n}function es(e,t){return typeof t==`function`?t(e):t}function ts(e){var t=Yo();return ns(t,Ao,e)}function ns(e,t,n){var r=e.queue;if(r===null)throw Error(i(311));r.lastRenderedReducer=n;var a=e.baseQueue,o=r.pending;if(o!==null){if(a!==null){var s=a.next;a.next=o.next,o.next=s}t.baseQueue=a=o,r.pending=null}if(o=e.baseState,a===null)e.memoizedState=o;else{t=a.next;var c=s=null,l=null,u=t,d=!1;do{var f=u.lane&-536870913;if(f===u.lane?(Oo&f)===f:(du&f)===f){var p=u.revertLane;if(p===0)l!==null&&(l=l.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),f===Da&&(d=!0);else if((Oo&p)===p){u=u.next,p===Da&&(d=!0);continue}else f={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},l===null?(c=l=f,s=o):l=l.next=f,ko.lanes|=p,yu|=p;f=u.action,Po&&n(o,f),o=u.hasEagerState?u.eagerState:n(o,f)}else p={lane:f,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},l===null?(c=l=p,s=o):l=l.next=p,ko.lanes|=f,yu|=f;u=u.next}while(u!==null&&u!==t);if(l===null?s=o:l.next=c,!Ir(o,e.memoizedState)&&(wc=!0,d&&(n=Oa,n!==null)))throw n;e.memoizedState=o,e.baseState=s,e.baseQueue=l,r.lastRenderedState=o}return a===null&&(r.lanes=0),[e.memoizedState,r.dispatch]}function rs(e){var t=Yo(),n=t.queue;if(n===null)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(a!==null){n.pending=null;var s=a=a.next;do o=e(o,s.action),s=s.next;while(s!==a);Ir(o,t.memoizedState)||(wc=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function os(e,t,n){var r=ko,a=Yo(),o=Yi;if(o){if(n===void 0)throw Error(i(407));n=n()}else n=t();var s=!Ir((Ao||a).memoizedState,n);if(s&&(a.memoizedState=n,wc=!0),a=a.queue,js(ls.bind(null,r,a,e),[e]),a.getSnapshot!==t||s||jo!==null&&jo.memoizedState.tag&1){if(r.flags|=2048,Es(9,{destroy:void 0},cs.bind(null,r,a,n,t),null),lu===null)throw Error(i(349));o||Oo&127||ss(r,t,n)}return n}function ss(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ko.updateQueue,t===null?(t=Xo(),ko.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function cs(e,t,n,r){t.value=n,t.getSnapshot=r,us(t)&&ds(e)}function ls(e,t,n){return n(function(){us(t)&&ds(e)})}function us(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ir(e,n)}catch{return!0}}function ds(e){var t=_i(e,2);t!==null&&Uu(t,e,2)}function fs(e){var t=Jo();if(typeof e==`function`){var n=e;if(e=n(),Po){Be(!0);try{n()}finally{Be(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:es,lastRenderedState:e},t}function ps(e,t,n,r){return e.baseState=n,ns(e,Ao,typeof r==`function`?r:es)}function ms(e,t,n,r,a){if(nc(e))throw Error(i(485));if(e=t.action,e!==null){var o={payload:a,action:e,next:null,isTransition:!0,status:`pending`,value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};A.T===null?o.isTransition=!1:n(!0),r(o),n=t.pending,n===null?(o.next=t.pending=o,hs(t,o)):(o.next=n.next,t.pending=n.next=o)}}function hs(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var a=A.T,o={};A.T=o;try{var s=n(i,r),c=A.S;c!==null&&c(o,s),gs(e,t,s)}catch(n){vs(e,t,n)}finally{a!==null&&o.types!==null&&(a.types=o.types),A.T=a}}else try{a=n(i,r),gs(e,t,a)}catch(n){vs(e,t,n)}}function gs(e,t,n){typeof n==`object`&&n&&typeof n.then==`function`?n.then(function(n){_s(e,t,n)},function(n){return vs(e,t,n)}):_s(e,t,n)}function _s(e,t,n){t.status=`fulfilled`,t.value=n,ys(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,hs(e,n)))}function vs(e,t,n){var r=e.pending;if(e.pending=null,r!==null){r=r.next;do t.status=`rejected`,t.reason=n,ys(t),t=t.next;while(t!==r)}e.action=null}function ys(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function bs(e,t){return t}function xs(e,t){if(Yi){var n=lu.formState;if(n!==null){a:{var r=ko;if(Yi){if(Ji){b:{for(var i=Ji,a=Zi;i.nodeType!==8;){if(!a){i=null;break b}if(i=Hf(i.nextSibling),i===null){i=null;break b}}a=i.data,i=a===`F!`||a===`F`?i:null}if(i){Ji=Hf(i.nextSibling),r=i.data===`F!`;break a}}$i(r)}r=!1}r&&(t=n[0])}}return n=Jo(),n.memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:bs,lastRenderedState:t},n.queue=r,n=$s.bind(null,ko,r),r.dispatch=n,r=fs(!1),a=tc.bind(null,ko,!1,r.queue),r=Jo(),i={state:t,dispatch:null,action:e,pending:null},r.queue=i,n=ms.bind(null,ko,i,a,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function Ss(e){var t=Yo();return Cs(t,Ao,e)}function Cs(e,t,n){if(t=ns(e,t,bs)[0],e=ts(es)[0],typeof t==`object`&&t&&typeof t.then==`function`)try{var r=Zo(t)}catch(e){throw e===La?za:e}else r=t;t=Yo();var i=t.queue,a=i.dispatch;return n!==t.memoizedState&&(ko.flags|=2048,Es(9,{destroy:void 0},ws.bind(null,i,n),null)),[r,a,e]}function ws(e,t){e.action=t}function Ts(e){var t=Yo(),n=Ao;if(n!==null)return Cs(t,n,e);Yo(),t=t.memoizedState,n=Yo();var r=n.queue.dispatch;return n.memoizedState=e,[t,r,!1]}function Es(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},t=ko.updateQueue,t===null&&(t=Xo(),ko.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ds(){return Yo().memoizedState}function Os(e,t,n,r){var i=Jo();ko.flags|=e,i.memoizedState=Es(1|t,{destroy:void 0},n,r===void 0?null:r)}function ks(e,t,n,r){var i=Yo();r=r===void 0?null:r;var a=i.memoizedState.inst;Ao!==null&&r!==null&&Bo(r,Ao.memoizedState.deps)?i.memoizedState=Es(t,a,n,r):(ko.flags|=e,i.memoizedState=Es(1|t,a,n,r))}function As(e,t){Os(8390656,8,e,t)}function js(e,t){ks(2048,8,e,t)}function Ms(e){ko.flags|=4;var t=ko.updateQueue;if(t===null)t=Xo(),ko.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function Ns(e){var t=Yo().memoizedState;return Ms({ref:t,nextImpl:e}),function(){if(cu&2)throw Error(i(440));return t.impl.apply(void 0,arguments)}}function Ps(e,t){return ks(4,2,e,t)}function Fs(e,t){return ks(4,4,e,t)}function Is(e,t){if(typeof t==`function`){e=e();var n=t(e);return function(){typeof n==`function`?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Ls(e,t,n){n=n==null?null:n.concat([e]),ks(4,4,Is.bind(null,t,e),n)}function Rs(){}function zs(e,t){var n=Yo();t=t===void 0?null:t;var r=n.memoizedState;return t!==null&&Bo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Bs(e,t){var n=Yo();t=t===void 0?null:t;var r=n.memoizedState;if(t!==null&&Bo(t,r[1]))return r[0];if(r=e(),Po){Be(!0);try{e()}finally{Be(!1)}}return n.memoizedState=[r,t],r}function Vs(e,t,n){return n===void 0||Oo&1073741824&&!(du&261930)?e.memoizedState=t:(e.memoizedState=n,e=Hu(),ko.lanes|=e,yu|=e,n)}function Hs(e,t,n,r){return Ir(n,t)?n:mo.current===null?!(Oo&42)||Oo&1073741824&&!(du&261930)?(wc=!0,e.memoizedState=n):(e=Hu(),ko.lanes|=e,yu|=e,t):(e=Vs(e,n,r),Ir(e,t)||(wc=!0),e)}function Us(e,t,n,r,i){var a=j.p;j.p=a!==0&&8>a?a:8;var o=A.T,s={};A.T=s,tc(e,!1,t,n);try{var c=i(),l=A.S;if(l!==null&&l(s,c),typeof c==`object`&&c&&typeof c.then==`function`){var u=ja(c,r);ec(e,t,u,Vu(e))}else ec(e,t,r,Vu(e))}catch(n){ec(e,t,{then:function(){},status:`rejected`,reason:n},Vu())}finally{j.p=a,o!==null&&s.types!==null&&(o.types=s.types),A.T=o}}function Ws(){}function Gs(e,t,n,r){if(e.tag!==5)throw Error(i(476));var a=Ks(e).queue;Us(e,a,t,re,n===null?Ws:function(){return qs(e),n(r)})}function Ks(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:re,baseState:re,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:es,lastRenderedState:re},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:es,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function qs(e){var t=Ks(e);t.next===null&&(t=e.alternate.memoizedState),ec(e,t.next.queue,{},Vu())}function Js(){return ga(Mp)}function Ys(){return Yo().memoizedState}function Xs(){return Yo().memoizedState}function Zs(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=Vu();e=io(n);var r=ao(t,e,n);r!==null&&(Uu(r,t,n),oo(r,t,n)),t={cache:Ca()},e.payload=t;return}t=t.return}}function Qs(e,t,n){var r=Vu();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},nc(e)?rc(t,n):(n=gi(e,t,n,r),n!==null&&(Uu(n,e,r),ic(n,t,r)))}function $s(e,t,n){var r=Vu();ec(e,t,n,r)}function ec(e,t,n,r){var i={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(nc(e))rc(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,s=a(o,n);if(i.hasEagerState=!0,i.eagerState=s,Ir(s,o))return hi(e,t,i,0),lu===null&&mi(),!1}catch{}if(n=gi(e,t,i,r),n!==null)return Uu(n,e,r),ic(n,t,r),!0}return!1}function tc(e,t,n,r){if(r={lane:2,revertLane:Bd(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},nc(e)){if(t)throw Error(i(479))}else t=gi(e,n,r,2),t!==null&&Uu(t,e,2)}function nc(e){var t=e.alternate;return e===ko||t!==null&&t===ko}function rc(e,t){No=Mo=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ic(e,t,n){if(n&4194048){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,rt(e,n)}}var ac={readContext:ga,use:Qo,useCallback:zo,useContext:zo,useEffect:zo,useImperativeHandle:zo,useLayoutEffect:zo,useInsertionEffect:zo,useMemo:zo,useReducer:zo,useRef:zo,useState:zo,useDebugValue:zo,useDeferredValue:zo,useTransition:zo,useSyncExternalStore:zo,useId:zo,useHostTransitionStatus:zo,useFormState:zo,useActionState:zo,useOptimistic:zo,useMemoCache:zo,useCacheRefresh:zo};ac.useEffectEvent=zo;var oc={readContext:ga,use:Qo,useCallback:function(e,t){return Jo().memoizedState=[e,t===void 0?null:t],e},useContext:ga,useEffect:As,useImperativeHandle:function(e,t,n){n=n==null?null:n.concat([e]),Os(4194308,4,Is.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Os(4194308,4,e,t)},useInsertionEffect:function(e,t){Os(4,2,e,t)},useMemo:function(e,t){var n=Jo();t=t===void 0?null:t;var r=e();if(Po){Be(!0);try{e()}finally{Be(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=Jo();if(n!==void 0){var i=n(t);if(Po){Be(!0);try{n(t)}finally{Be(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=Qs.bind(null,ko,e),[r.memoizedState,e]},useRef:function(e){var t=Jo();return e={current:e},t.memoizedState=e},useState:function(e){e=fs(e);var t=e.queue,n=$s.bind(null,ko,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Rs,useDeferredValue:function(e,t){var n=Jo();return Vs(n,e,t)},useTransition:function(){var e=fs(!1);return e=Us.bind(null,ko,e.queue,!0,!1),Jo().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=ko,a=Jo();if(Yi){if(n===void 0)throw Error(i(407));n=n()}else{if(n=t(),lu===null)throw Error(i(349));du&127||ss(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,As(ls.bind(null,r,o,e),[e]),r.flags|=2048,Es(9,{destroy:void 0},cs.bind(null,r,o,n,t),null),n},useId:function(){var e=Jo(),t=lu.identifierPrefix;if(Yi){var n=Vi,r=Bi;n=(r&~(1<<32-Ve(r)-1)).toString(32)+n,t=`_`+t+`R_`+n,n=Fo++,0<n&&(t+=`H`+n.toString(32)),t+=`_`}else n=Ro++,t=`_`+t+`r_`+n.toString(32)+`_`;return e.memoizedState=t},useHostTransitionStatus:Js,useFormState:xs,useActionState:xs,useOptimistic:function(e){var t=Jo();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=tc.bind(null,ko,!0,n),n.dispatch=t,[e,t]},useMemoCache:$o,useCacheRefresh:function(){return Jo().memoizedState=Zs.bind(null,ko)},useEffectEvent:function(e){var t=Jo(),n={impl:e};return t.memoizedState=n,function(){if(cu&2)throw Error(i(440));return n.impl.apply(void 0,arguments)}}},sc={readContext:ga,use:Qo,useCallback:zs,useContext:ga,useEffect:js,useImperativeHandle:Ls,useInsertionEffect:Ps,useLayoutEffect:Fs,useMemo:Bs,useReducer:ts,useRef:Ds,useState:function(){return ts(es)},useDebugValue:Rs,useDeferredValue:function(e,t){var n=Yo();return Hs(n,Ao.memoizedState,e,t)},useTransition:function(){var e=ts(es)[0],t=Yo().memoizedState;return[typeof e==`boolean`?e:Zo(e),t]},useSyncExternalStore:os,useId:Ys,useHostTransitionStatus:Js,useFormState:Ss,useActionState:Ss,useOptimistic:function(e,t){var n=Yo();return ps(n,Ao,e,t)},useMemoCache:$o,useCacheRefresh:Xs};sc.useEffectEvent=Ns;var cc={readContext:ga,use:Qo,useCallback:zs,useContext:ga,useEffect:js,useImperativeHandle:Ls,useInsertionEffect:Ps,useLayoutEffect:Fs,useMemo:Bs,useReducer:rs,useRef:Ds,useState:function(){return rs(es)},useDebugValue:Rs,useDeferredValue:function(e,t){var n=Yo();return Ao===null?Vs(n,e,t):Hs(n,Ao.memoizedState,e,t)},useTransition:function(){var e=rs(es)[0],t=Yo().memoizedState;return[typeof e==`boolean`?e:Zo(e),t]},useSyncExternalStore:os,useId:Ys,useHostTransitionStatus:Js,useFormState:Ts,useActionState:Ts,useOptimistic:function(e,t){var n=Yo();return Ao===null?(n.baseState=e,[e,n.queue.dispatch]):ps(n,Ao,e,t)},useMemoCache:$o,useCacheRefresh:Xs};cc.useEffectEvent=Ns;function lc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:f({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var uc={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Vu(),i=io(r);i.payload=t,n!=null&&(i.callback=n),t=ao(e,i,r),t!==null&&(Uu(t,e,r),oo(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Vu(),i=io(r);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=ao(e,i,r),t!==null&&(Uu(t,e,r),oo(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Vu(),r=io(n);r.tag=2,t!=null&&(r.callback=t),t=ao(e,r,n),t!==null&&(Uu(t,e,n),oo(t,e,n))}};function dc(e,t,n,r,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate==`function`?e.shouldComponentUpdate(r,a,o):t.prototype&&t.prototype.isPureReactComponent?!Lr(n,r)||!Lr(i,a):!0}function fc(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps==`function`&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps==`function`&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&uc.enqueueReplaceState(t,t.state,null)}function pc(e,t){var n=t;if(`ref`in t)for(var r in n={},t)r!==`ref`&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=f({},n)),e)n[i]===void 0&&(n[i]=e[i]);return n}function mc(e){ui(e)}function hc(e){console.error(e)}function gc(e){ui(e)}function _c(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(e){setTimeout(function(){throw e})}}function vc(e,t,n){try{var r=e.onCaughtError;r(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(e){setTimeout(function(){throw e})}}function yc(e,t,n){return n=io(n),n.tag=3,n.payload={element:null},n.callback=function(){_c(e,t)},n}function bc(e){return e=io(e),e.tag=3,e}function xc(e,t,n,r){var i=n.type.getDerivedStateFromError;if(typeof i==`function`){var a=r.value;e.payload=function(){return i(a)},e.callback=function(){vc(t,n,r)}}var o=n.stateNode;o!==null&&typeof o.componentDidCatch==`function`&&(e.callback=function(){vc(t,n,r),typeof i!=`function`&&(ju===null?ju=new Set([this]):ju.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:e===null?``:e})})}function Sc(e,t,n,r,a){if(n.flags|=32768,typeof r==`object`&&r&&typeof r.then==`function`){if(t=n.alternate,t!==null&&pa(t,n,a,!0),n=yo.current,n!==null){switch(n.tag){case 31:case 13:return bo===null?td():n.alternate===null&&vu===0&&(vu=3),n.flags&=-257,n.flags|=65536,n.lanes=a,r===Ba?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([r]):t.add(r),bd(e,r,a)),!1;case 22:return n.flags|=65536,r===Ba?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([r]):n.add(r)),bd(e,r,a)),!1}throw Error(i(435,n.tag))}return bd(e,r,a),td(),!1}if(Yi)return t=yo.current,t===null?(r!==Qi&&(t=Error(i(423),{cause:r}),aa(Mi(t,n))),e=e.current.alternate,e.flags|=65536,a&=-a,e.lanes|=a,r=Mi(r,n),a=yc(e.stateNode,r,a),so(e,a),vu!==4&&(vu=2)):(!(t.flags&65536)&&(t.flags|=256),t.flags|=65536,t.lanes=a,r!==Qi&&(e=Error(i(422),{cause:r}),aa(Mi(e,n)))),!1;var o=Error(i(520),{cause:r});if(o=Mi(o,n),wu===null?wu=[o]:wu.push(o),vu!==4&&(vu=2),t===null)return!0;r=Mi(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=a&-a,n.lanes|=e,e=yc(n.stateNode,r,e),so(n,e),!1;case 1:if(t=n.type,o=n.stateNode,!(n.flags&128)&&(typeof t.getDerivedStateFromError==`function`||o!==null&&typeof o.componentDidCatch==`function`&&(ju===null||!ju.has(o))))return n.flags|=65536,a&=-a,n.lanes|=a,a=bc(a),xc(a,e,n,r),so(n,a),!1}n=n.return}while(n!==null);return!1}var Cc=Error(i(461)),wc=!1;function Tc(e,t,n,r){t.child=e===null?eo(t,null,n,r):$a(t,e.child,n,r)}function Ec(e,t,n,r,i){n=n.render;var a=t.ref;if(`ref`in r){var o={};for(var s in r)s!==`ref`&&(o[s]=r[s])}else o=r;return ha(t),r=Vo(e,t,n,o,a,i),s=Go(),e!==null&&!wc?(Ko(e,t,i),Xc(e,t,i)):(Yi&&s&&Wi(t),t.flags|=1,Tc(e,t,r,i),t.child)}function Dc(e,t,n,r,i){if(e===null){var a=n.type;return typeof a==`function`&&!Ci(a)&&a.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=a,Oc(e,t,a,r,i)):(e=Ei(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!Zc(e,i)){var o=a.memoizedProps;if(n=n.compare,n=n===null?Lr:n,n(o,r)&&e.ref===t.ref)return Xc(e,t,i)}return t.flags|=1,e=wi(a,r),e.ref=t.ref,e.return=t,t.child=e}function Oc(e,t,n,r,i){if(e!==null){var a=e.memoizedProps;if(Lr(a,r)&&e.ref===t.ref)if(wc=!1,t.pendingProps=r=a,Zc(e,i))e.flags&131072&&(wc=!0);else return t.lanes=e.lanes,Xc(e,t,i)}return Ic(e,t,n,r,i)}function kc(e,t,n,r){var i=r.children,a=e===null?null:e.memoizedState;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.mode===`hidden`){if(t.flags&128){if(a=a===null?n:a.baseLanes|n,e!==null){for(r=t.child=e.child,i=0;r!==null;)i=i|r.lanes|r.childLanes,r=r.sibling;r=i&~a}else r=0,t.child=null;return jc(e,t,a,n,r)}if(n&536870912)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Fa(t,a===null?null:a.cachePool),a===null?_o():go(t,a),Co(t);else return r=t.lanes=536870912,jc(e,t,a===null?n:a.baseLanes|n,n,r)}else a===null?(e!==null&&Fa(t,null),_o(),wo(t)):(Fa(t,a.cachePool),go(t,a),wo(t),t.memoizedState=null);return Tc(e,t,i,n),t.child}function Ac(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function jc(e,t,n,r,i){var a=Pa();return a=a===null?null:{parent:Sa._currentValue,pool:a},t.memoizedState={baseLanes:n,cachePool:a},e!==null&&Fa(t,null),_o(),Co(t),e!==null&&pa(e,t,r,!0),t.childLanes=i,null}function Mc(e,t){return t=Gc({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function Nc(e,t,n){return $a(t,e.child,null,n),e=Mc(t,t.pendingProps),e.flags|=2,To(t),t.memoizedState=null,e}function Pc(e,t,n){var r=t.pendingProps,a=(t.flags&128)!=0;if(t.flags&=-129,e===null){if(Yi){if(r.mode===`hidden`)return e=Mc(t,r),t.lanes=536870912,Ac(null,e);if(So(t),(e=Ji)?(e=Rf(e,Zi),e=e!==null&&e.data===`&`?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:zi===null?null:{id:Bi,overflow:Vi},retryLane:536870912,hydrationErrors:null},n=ki(e),n.return=t,t.child=n,qi=t,Ji=null)):e=null,e===null)throw $i(t);return t.lanes=536870912,null}return Mc(t,r)}var o=e.memoizedState;if(o!==null){var s=o.dehydrated;if(So(t),a)if(t.flags&256)t.flags&=-257,t=Nc(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(i(558));else if(wc||pa(e,t,n,!1),a=(n&e.childLanes)!==0,wc||a){if(r=lu,r!==null&&(s=it(r,n),s!==0&&s!==o.retryLane))throw o.retryLane=s,_i(e,s),Uu(r,e,s),Cc;td(),t=Nc(e,t,n)}else e=o.treeContext,Ji=Hf(s.nextSibling),qi=t,Yi=!0,Xi=null,Zi=!1,e!==null&&Ki(t,e),t=Mc(t,r),t.flags|=4096;return t}return e=wi(e.child,{mode:r.mode,children:r.children}),e.ref=t.ref,t.child=e,e.return=t,e}function Fc(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!=`function`&&typeof n!=`object`)throw Error(i(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function Ic(e,t,n,r,i){return ha(t),n=Vo(e,t,n,r,void 0,i),r=Go(),e!==null&&!wc?(Ko(e,t,i),Xc(e,t,i)):(Yi&&r&&Wi(t),t.flags|=1,Tc(e,t,n,i),t.child)}function Lc(e,t,n,r,i,a){return ha(t),t.updateQueue=null,n=Uo(t,r,n,i),Ho(e),r=Go(),e!==null&&!wc?(Ko(e,t,a),Xc(e,t,a)):(Yi&&r&&Wi(t),t.flags|=1,Tc(e,t,n,a),t.child)}function Rc(e,t,n,r,i){if(ha(t),t.stateNode===null){var a=bi,o=n.contextType;typeof o==`object`&&o&&(a=ga(o)),a=new n(r,a),t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=uc,t.stateNode=a,a._reactInternals=t,a=t.stateNode,a.props=r,a.state=t.memoizedState,a.refs={},no(t),o=n.contextType,a.context=typeof o==`object`&&o?ga(o):bi,a.state=t.memoizedState,o=n.getDerivedStateFromProps,typeof o==`function`&&(lc(t,n,o,r),a.state=t.memoizedState),typeof n.getDerivedStateFromProps==`function`||typeof a.getSnapshotBeforeUpdate==`function`||typeof a.UNSAFE_componentWillMount!=`function`&&typeof a.componentWillMount!=`function`||(o=a.state,typeof a.componentWillMount==`function`&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount==`function`&&a.UNSAFE_componentWillMount(),o!==a.state&&uc.enqueueReplaceState(a,a.state,null),uo(t,r,a,i),lo(),a.state=t.memoizedState),typeof a.componentDidMount==`function`&&(t.flags|=4194308),r=!0}else if(e===null){a=t.stateNode;var s=t.memoizedProps,c=pc(n,s);a.props=c;var l=a.context,u=n.contextType;o=bi,typeof u==`object`&&u&&(o=ga(u));var d=n.getDerivedStateFromProps;u=typeof d==`function`||typeof a.getSnapshotBeforeUpdate==`function`,s=t.pendingProps!==s,u||typeof a.UNSAFE_componentWillReceiveProps!=`function`&&typeof a.componentWillReceiveProps!=`function`||(s||l!==o)&&fc(t,a,r,o),to=!1;var f=t.memoizedState;a.state=f,uo(t,r,a,i),lo(),l=t.memoizedState,s||f!==l||to?(typeof d==`function`&&(lc(t,n,d,r),l=t.memoizedState),(c=to||dc(t,n,c,r,f,l,o))?(u||typeof a.UNSAFE_componentWillMount!=`function`&&typeof a.componentWillMount!=`function`||(typeof a.componentWillMount==`function`&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount==`function`&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount==`function`&&(t.flags|=4194308)):(typeof a.componentDidMount==`function`&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=o,r=c):(typeof a.componentDidMount==`function`&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,ro(e,t),o=t.memoizedProps,u=pc(n,o),a.props=u,d=t.pendingProps,f=a.context,l=n.contextType,c=bi,typeof l==`object`&&l&&(c=ga(l)),s=n.getDerivedStateFromProps,(l=typeof s==`function`||typeof a.getSnapshotBeforeUpdate==`function`)||typeof a.UNSAFE_componentWillReceiveProps!=`function`&&typeof a.componentWillReceiveProps!=`function`||(o!==d||f!==c)&&fc(t,a,r,c),to=!1,f=t.memoizedState,a.state=f,uo(t,r,a,i),lo();var p=t.memoizedState;o!==d||f!==p||to||e!==null&&e.dependencies!==null&&ma(e.dependencies)?(typeof s==`function`&&(lc(t,n,s,r),p=t.memoizedState),(u=to||dc(t,n,u,r,f,p,c)||e!==null&&e.dependencies!==null&&ma(e.dependencies))?(l||typeof a.UNSAFE_componentWillUpdate!=`function`&&typeof a.componentWillUpdate!=`function`||(typeof a.componentWillUpdate==`function`&&a.componentWillUpdate(r,p,c),typeof a.UNSAFE_componentWillUpdate==`function`&&a.UNSAFE_componentWillUpdate(r,p,c)),typeof a.componentDidUpdate==`function`&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate==`function`&&(t.flags|=1024)):(typeof a.componentDidUpdate!=`function`||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!=`function`||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=c,r=u):(typeof a.componentDidUpdate!=`function`||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!=`function`||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return a=r,Fc(e,t),r=(t.flags&128)!=0,a||r?(a=t.stateNode,n=r&&typeof n.getDerivedStateFromError!=`function`?null:a.render(),t.flags|=1,e!==null&&r?(t.child=$a(t,e.child,null,i),t.child=$a(t,null,n,i)):Tc(e,t,n,i),t.memoizedState=a.state,e=t.child):e=Xc(e,t,i),e}function zc(e,t,n,r){return ra(),t.flags|=256,Tc(e,t,n,r),t.child}var Bc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Vc(e){return{baseLanes:e,cachePool:Ia()}}function Hc(e,t,n){return e=e===null?0:e.childLanes&~n,t&&(e|=Su),e}function Uc(e,t,n){var r=t.pendingProps,a=!1,o=(t.flags&128)!=0,s;if((s=o)||(s=e!==null&&e.memoizedState===null?!1:(Eo.current&2)!=0),s&&(a=!0,t.flags&=-129),s=(t.flags&32)!=0,t.flags&=-33,e===null){if(Yi){if(a?xo(t):wo(t),(e=Ji)?(e=Rf(e,Zi),e=e!==null&&e.data!==`&`?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:zi===null?null:{id:Bi,overflow:Vi},retryLane:536870912,hydrationErrors:null},n=ki(e),n.return=t,t.child=n,qi=t,Ji=null)):e=null,e===null)throw $i(t);return Bf(e)?t.lanes=32:t.lanes=536870912,null}var c=r.children;return r=r.fallback,a?(wo(t),a=t.mode,c=Gc({mode:`hidden`,children:c},a),r=Di(r,a,n,null),c.return=t,r.return=t,c.sibling=r,t.child=c,r=t.child,r.memoizedState=Vc(n),r.childLanes=Hc(e,s,n),t.memoizedState=Bc,Ac(null,r)):(xo(t),Wc(t,c))}var l=e.memoizedState;if(l!==null&&(c=l.dehydrated,c!==null)){if(o)t.flags&256?(xo(t),t.flags&=-257,t=Kc(e,t,n)):t.memoizedState===null?(wo(t),c=r.fallback,a=t.mode,r=Gc({mode:`visible`,children:r.children},a),c=Di(c,a,n,null),c.flags|=2,r.return=t,c.return=t,r.sibling=c,t.child=r,$a(t,e.child,null,n),r=t.child,r.memoizedState=Vc(n),r.childLanes=Hc(e,s,n),t.memoizedState=Bc,t=Ac(null,r)):(wo(t),t.child=e.child,t.flags|=128,t=null);else if(xo(t),Bf(c)){if(s=c.nextSibling&&c.nextSibling.dataset,s)var u=s.dgst;s=u,r=Error(i(419)),r.stack=``,r.digest=s,aa({value:r,source:null,stack:null}),t=Kc(e,t,n)}else if(wc||pa(e,t,n,!1),s=(n&e.childLanes)!==0,wc||s){if(s=lu,s!==null&&(r=it(s,n),r!==0&&r!==l.retryLane))throw l.retryLane=r,_i(e,r),Uu(s,e,r),Cc;zf(c)||td(),t=Kc(e,t,n)}else zf(c)?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,Ji=Hf(c.nextSibling),qi=t,Yi=!0,Xi=null,Zi=!1,e!==null&&Ki(t,e),t=Wc(t,r.children),t.flags|=4096);return t}return a?(wo(t),c=r.fallback,a=t.mode,l=e.child,u=l.sibling,r=wi(l,{mode:`hidden`,children:r.children}),r.subtreeFlags=l.subtreeFlags&65011712,u===null?(c=Di(c,a,n,null),c.flags|=2):c=wi(u,c),c.return=t,r.return=t,r.sibling=c,t.child=r,Ac(null,r),r=t.child,c=e.child.memoizedState,c===null?c=Vc(n):(a=c.cachePool,a===null?a=Ia():(l=Sa._currentValue,a=a.parent===l?a:{parent:l,pool:l}),c={baseLanes:c.baseLanes|n,cachePool:a}),r.memoizedState=c,r.childLanes=Hc(e,s,n),t.memoizedState=Bc,Ac(e.child,r)):(xo(t),n=e.child,e=n.sibling,n=wi(n,{mode:`visible`,children:r.children}),n.return=t,n.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=n,t.memoizedState=null,n)}function Wc(e,t){return t=Gc({mode:`visible`,children:t},e.mode),t.return=e,e.child=t}function Gc(e,t){return e=Si(22,e,null,t),e.lanes=0,e}function Kc(e,t,n){return $a(t,e.child,null,n),e=Wc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function qc(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),da(e.return,t,n)}function Jc(e,t,n,r,i,a){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,treeForkCount:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i,o.treeForkCount=a)}function Yc(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;r=r.children;var o=Eo.current,s=(o&2)!=0;if(s?(o=o&1|2,t.flags|=128):o&=1,ce(Eo,o),Tc(e,t,r,n),r=Yi?Ii:0,!s&&e!==null&&e.flags&128)a:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&qc(e,n,t);else if(e.tag===19)qc(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break a;for(;e.sibling===null;){if(e.return===null||e.return===t)break a;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(i){case`forwards`:for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&Do(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Jc(t,!1,i,n,a,r);break;case`backwards`:case`unstable_legacy-backwards`:for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&Do(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Jc(t,!0,n,null,a,r);break;case`together`:Jc(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function Xc(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),yu|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(pa(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(i(153));if(t.child!==null){for(e=t.child,n=wi(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=wi(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Zc(e,t){return(e.lanes&t)===0?(e=e.dependencies,!!(e!==null&&ma(e))):!0}function Qc(e,t,n){switch(t.tag){case 3:pe(t,t.stateNode.containerInfo),la(t,Sa,e.memoizedState.cache),ra();break;case 27:case 5:he(t);break;case 4:pe(t,t.stateNode.containerInfo);break;case 10:la(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,So(t),null;break;case 13:var r=t.memoizedState;if(r!==null)return r.dehydrated===null?(n&t.child.childLanes)===0?(xo(t),e=Xc(e,t,n),e===null?null:e.sibling):Uc(e,t,n):(xo(t),t.flags|=128,null);xo(t);break;case 19:var i=(e.flags&128)!=0;if(r=(n&t.childLanes)!==0,r||=(pa(e,t,n,!1),(n&t.childLanes)!==0),i){if(r)return Yc(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ce(Eo,Eo.current),r)break;return null;case 22:return t.lanes=0,kc(e,t,n,t.pendingProps);case 24:la(t,Sa,e.memoizedState.cache)}return Xc(e,t,n)}function $c(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)wc=!0;else{if(!Zc(e,n)&&!(t.flags&128))return wc=!1,Qc(e,t,n);wc=!!(e.flags&131072)}else wc=!1,Yi&&t.flags&1048576&&Ui(t,Ii,t.index);switch(t.lanes=0,t.tag){case 16:a:{var r=t.pendingProps;if(e=Ua(t.elementType),t.type=e,typeof e==`function`)Ci(e)?(r=pc(e,r),t.tag=1,t=Rc(null,t,e,r,n)):(t.tag=0,t=Ic(null,t,e,r,n));else{if(e!=null){var a=e.$$typeof;if(a===x){t.tag=11,t=Ec(null,t,e,r,n);break a}else if(a===w){t.tag=14,t=Dc(null,t,e,r,n);break a}}throw t=te(e)||e,Error(i(306,t,``))}}return t;case 0:return Ic(e,t,t.type,t.pendingProps,n);case 1:return r=t.type,a=pc(r,t.pendingProps),Rc(e,t,r,a,n);case 3:a:{if(pe(t,t.stateNode.containerInfo),e===null)throw Error(i(387));r=t.pendingProps;var o=t.memoizedState;a=o.element,ro(e,t),uo(t,r,null,n);var s=t.memoizedState;if(r=s.cache,la(t,Sa,r),r!==o.cache&&fa(t,[Sa],n,!0),lo(),r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){t=zc(e,t,r,n);break a}else if(r!==a){a=Mi(Error(i(424)),t),aa(a),t=zc(e,t,r,n);break a}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName===`HTML`?e.ownerDocument.body:e}for(Ji=Hf(e.firstChild),qi=t,Yi=!0,Xi=null,Zi=!0,n=eo(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(ra(),r===a){t=Xc(e,t,n);break a}Tc(e,t,r,n)}t=t.child}return t;case 26:return Fc(e,t),e===null?(n=lp(t.type,null,t.pendingProps,null))?t.memoizedState=n:Yi||(n=t.type,e=t.pendingProps,r=xf(de.current).createElement(n),r[ut]=t,r[dt]=e,hf(r,n,e),Ct(r),t.stateNode=r):t.memoizedState=lp(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return he(t),e===null&&Yi&&(r=t.stateNode=Kf(t.type,t.pendingProps,de.current),qi=t,Zi=!0,a=Ji,Mf(t.type)?(Uf=a,Ji=Hf(r.firstChild)):Ji=a),Tc(e,t,t.pendingProps.children,n),Fc(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Yi&&((a=r=Ji)&&(r=If(r,t.type,t.pendingProps,Zi),r===null?a=!1:(t.stateNode=r,qi=t,Ji=Hf(r.firstChild),Zi=!1,a=!0)),a||$i(t)),he(t),a=t.type,o=t.pendingProps,s=e===null?null:e.memoizedProps,r=o.children,wf(a,o)?r=null:s!==null&&wf(a,s)&&(t.flags|=32),t.memoizedState!==null&&(a=Vo(e,t,Wo,null,null,n),Mp._currentValue=a),Fc(e,t),Tc(e,t,r,n),t.child;case 6:return e===null&&Yi&&((e=n=Ji)&&(n=Lf(n,t.pendingProps,Zi),n===null?e=!1:(t.stateNode=n,qi=t,Ji=null,e=!0)),e||$i(t)),null;case 13:return Uc(e,t,n);case 4:return pe(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=$a(t,null,r,n):Tc(e,t,r,n),t.child;case 11:return Ec(e,t,t.type,t.pendingProps,n);case 7:return Tc(e,t,t.pendingProps,n),t.child;case 8:return Tc(e,t,t.pendingProps.children,n),t.child;case 12:return Tc(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,la(t,t.type,r.value),Tc(e,t,r.children,n),t.child;case 9:return a=t.type._context,r=t.pendingProps.children,ha(t),a=ga(a),r=r(a),t.flags|=1,Tc(e,t,r,n),t.child;case 14:return Dc(e,t,t.type,t.pendingProps,n);case 15:return Oc(e,t,t.type,t.pendingProps,n);case 19:return Yc(e,t,n);case 31:return Pc(e,t,n);case 22:return kc(e,t,n,t.pendingProps);case 24:return ha(t),r=ga(Sa),e===null?(a=Pa(),a===null&&(a=lu,o=Ca(),a.pooledCache=o,o.refCount++,o!==null&&(a.pooledCacheLanes|=n),a=o),t.memoizedState={parent:r,cache:a},no(t),la(t,Sa,a)):((e.lanes&n)!==0&&(ro(e,t),uo(t,null,null,n),lo()),a=e.memoizedState,o=t.memoizedState,a.parent===r?(r=o.cache,la(t,Sa,r),r!==a.cache&&fa(t,[Sa],n,!0)):(a={parent:r,cache:r},t.memoizedState=a,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=a),la(t,Sa,r))),Tc(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function el(e){e.flags|=4}function tl(e,t,n,r,i){if((t=(e.mode&32)!=0)&&(t=!1),t){if(e.flags|=16777216,(i&335544128)===i)if(e.stateNode.complete)e.flags|=8192;else if(Qu())e.flags|=8192;else throw Wa=Ba,Ra}else e.flags&=-16777217}function nl(e,t){if(t.type!==`stylesheet`||t.state.loading&4)e.flags&=-16777217;else if(e.flags|=16777216,!wp(t))if(Qu())e.flags|=8192;else throw Wa=Ba,Ra}function rl(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag===22?536870912:Qe(),e.lanes|=t,Cu|=t)}function il(e,t){if(!Yi)switch(e.tailMode){case`hidden`:t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case`collapsed`:n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function al(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&65011712,r|=i.flags&65011712,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function ol(e,t,n){var r=t.pendingProps;switch(Gi(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return al(t),null;case 1:return al(t),null;case 3:return n=t.stateNode,r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),ua(Sa),me(),n.pendingContext&&=(n.context=n.pendingContext,null),(e===null||e.child===null)&&(na(t)?el(t):e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ia())),al(t),null;case 26:var a=t.type,o=t.memoizedState;return e===null?(el(t),o===null?(al(t),tl(t,a,null,r,n)):(al(t),nl(t,o))):o?o===e.memoizedState?(al(t),t.flags&=-16777217):(el(t),al(t),nl(t,o)):(e=e.memoizedProps,e!==r&&el(t),al(t),tl(t,a,e,r,n)),null;case 27:if(ge(t),n=de.current,a=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==r&&el(t);else{if(!r){if(t.stateNode===null)throw Error(i(166));return al(t),null}e=le.current,na(t)?ea(t,e):(e=Kf(a,r,n),t.stateNode=e,el(t))}return al(t),null;case 5:if(ge(t),a=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==r&&el(t);else{if(!r){if(t.stateNode===null)throw Error(i(166));return al(t),null}if(o=le.current,na(t))ea(t,o);else{var s=xf(de.current);switch(o){case 1:o=s.createElementNS(`http://www.w3.org/2000/svg`,a);break;case 2:o=s.createElementNS(`http://www.w3.org/1998/Math/MathML`,a);break;default:switch(a){case`svg`:o=s.createElementNS(`http://www.w3.org/2000/svg`,a);break;case`math`:o=s.createElementNS(`http://www.w3.org/1998/Math/MathML`,a);break;case`script`:o=s.createElement(`div`),o.innerHTML=`<script><\/script>`,o=o.removeChild(o.firstChild);break;case`select`:o=typeof r.is==`string`?s.createElement(`select`,{is:r.is}):s.createElement(`select`),r.multiple?o.multiple=!0:r.size&&(o.size=r.size);break;default:o=typeof r.is==`string`?s.createElement(a,{is:r.is}):s.createElement(a)}}o[ut]=t,o[dt]=r;a:for(s=t.child;s!==null;){if(s.tag===5||s.tag===6)o.appendChild(s.stateNode);else if(s.tag!==4&&s.tag!==27&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break a;for(;s.sibling===null;){if(s.return===null||s.return===t)break a;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=o;a:switch(hf(o,a,r),a){case`button`:case`input`:case`select`:case`textarea`:r=!!r.autoFocus;break a;case`img`:r=!0;break a;default:r=!1}r&&el(t)}}return al(t),tl(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==r&&el(t);else{if(typeof r!=`string`&&t.stateNode===null)throw Error(i(166));if(e=de.current,na(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,a=qi,a!==null)switch(a.tag){case 27:case 5:r=a.memoizedProps}e[ut]=t,e=!!(e.nodeValue===n||r!==null&&!0===r.suppressHydrationWarning||ff(e.nodeValue,n)),e||$i(t,!0)}else e=xf(e).createTextNode(r),e[ut]=t,t.stateNode=e}return al(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(r=na(t),n!==null){if(e===null){if(!r)throw Error(i(318));if(e=t.memoizedState,e=e===null?null:e.dehydrated,!e)throw Error(i(557));e[ut]=t}else ra(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;al(t),e=!1}else n=ia(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(To(t),t):(To(t),null);if(t.flags&128)throw Error(i(558))}return al(t),null;case 13:if(r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(a=na(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(i(318));if(a=t.memoizedState,a=a===null?null:a.dehydrated,!a)throw Error(i(317));a[ut]=t}else ra(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;al(t),a=!1}else a=ia(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),a=!0;if(!a)return t.flags&256?(To(t),t):(To(t),null)}return To(t),t.flags&128?(t.lanes=n,t):(n=r!==null,e=e!==null&&e.memoizedState!==null,n&&(r=t.child,a=null,r.alternate!==null&&r.alternate.memoizedState!==null&&r.alternate.memoizedState.cachePool!==null&&(a=r.alternate.memoizedState.cachePool.pool),o=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),o!==a&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),rl(t,t.updateQueue),al(t),null);case 4:return me(),e===null&&ef(t.stateNode.containerInfo),al(t),null;case 10:return ua(t.type),al(t),null;case 19:if(se(Eo),r=t.memoizedState,r===null)return al(t),null;if(a=(t.flags&128)!=0,o=r.rendering,o===null)if(a)il(r,!1);else{if(vu!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Do(e),o!==null){for(t.flags|=128,il(r,!1),e=o.updateQueue,t.updateQueue=e,rl(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)Ti(n,e),n=n.sibling;return ce(Eo,Eo.current&1|2),Yi&&Hi(t,r.treeForkCount),t.child}e=e.sibling}r.tail!==null&&ke()>ku&&(t.flags|=128,a=!0,il(r,!1),t.lanes=4194304)}else{if(!a)if(e=Do(o),e!==null){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,rl(t,e),il(r,!0),r.tail===null&&r.tailMode===`hidden`&&!o.alternate&&!Yi)return al(t),null}else 2*ke()-r.renderingStartTime>ku&&n!==536870912&&(t.flags|=128,a=!0,il(r,!1),t.lanes=4194304);r.isBackwards?(o.sibling=t.child,t.child=o):(e=r.last,e===null?t.child=o:e.sibling=o,r.last=o)}return r.tail===null?(al(t),null):(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=ke(),e.sibling=null,n=Eo.current,ce(Eo,a?n&1|2:n&1),Yi&&Hi(t,r.treeForkCount),e);case 22:case 23:return To(t),vo(),r=t.memoizedState!==null,e===null?r&&(t.flags|=8192):e.memoizedState!==null!==r&&(t.flags|=8192),r?n&536870912&&!(t.flags&128)&&(al(t),t.subtreeFlags&6&&(t.flags|=8192)):al(t),n=t.updateQueue,n!==null&&rl(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),r=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),e!==null&&se(Na),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),ua(Sa),al(t),null;case 25:return null;case 30:return null}throw Error(i(156,t.tag))}function sl(e,t){switch(Gi(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ua(Sa),me(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return ge(t),null;case 31:if(t.memoizedState!==null){if(To(t),t.alternate===null)throw Error(i(340));ra()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(To(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(i(340));ra()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return se(Eo),null;case 4:return me(),null;case 10:return ua(t.type),null;case 22:case 23:return To(t),vo(),e!==null&&se(Na),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return ua(Sa),null;case 25:return null;default:return null}}function cl(e,t){switch(Gi(t),t.tag){case 3:ua(Sa),me();break;case 26:case 27:case 5:ge(t);break;case 4:me();break;case 31:t.memoizedState!==null&&To(t);break;case 13:To(t);break;case 19:se(Eo);break;case 10:ua(t.type);break;case 22:case 23:To(t),vo(),e!==null&&se(Na);break;case 24:ua(Sa)}}function ll(e,t){try{var n=t.updateQueue,r=n===null?null:n.lastEffect;if(r!==null){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var a=n.create,o=n.inst;r=a(),o.destroy=r}n=n.next}while(n!==i)}}catch(e){yd(t,t.return,e)}}function ul(e,t,n){try{var r=t.updateQueue,i=r===null?null:r.lastEffect;if(i!==null){var a=i.next;r=a;do{if((r.tag&e)===e){var o=r.inst,s=o.destroy;if(s!==void 0){o.destroy=void 0,i=t;var c=n,l=s;try{l()}catch(e){yd(i,c,e)}}}r=r.next}while(r!==a)}}catch(e){yd(t,t.return,e)}}function dl(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{po(t,n)}catch(t){yd(e,e.return,t)}}}function fl(e,t,n){n.props=pc(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(n){yd(e,t,n)}}function pl(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;case 30:r=e.stateNode;break;default:r=e.stateNode}typeof n==`function`?e.refCleanup=n(r):n.current=r}}catch(n){yd(e,t,n)}}function ml(e,t){var n=e.ref,r=e.refCleanup;if(n!==null)if(typeof r==`function`)try{r()}catch(n){yd(e,t,n)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n==`function`)try{n(null)}catch(n){yd(e,t,n)}else n.current=null}function hl(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{a:switch(t){case`button`:case`input`:case`select`:case`textarea`:n.autoFocus&&r.focus();break a;case`img`:n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(t){yd(e,e.return,t)}}function gl(e,t,n){try{var r=e.stateNode;gf(r,e.type,n,t),r[dt]=t}catch(t){yd(e,e.return,t)}}function _l(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Mf(e.type)||e.tag===4}function vl(e){a:for(;;){for(;e.sibling===null;){if(e.return===null||_l(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Mf(e.type)||e.flags&2||e.child===null||e.tag===4)continue a;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function yl(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName===`HTML`?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName===`HTML`?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=rn));else if(r!==4&&(r===27&&Mf(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(yl(e,t,n),e=e.sibling;e!==null;)yl(e,t,n),e=e.sibling}function bl(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(r===27&&Mf(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(bl(e,t,n),e=e.sibling;e!==null;)bl(e,t,n),e=e.sibling}function xl(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);hf(t,r,n),t[ut]=e,t[dt]=n}catch(t){yd(e,e.return,t)}}var Sl=!1,Cl=!1,wl=!1,Tl=typeof WeakSet==`function`?WeakSet:Set,El=null;function Dl(e,t){if(e=e.containerInfo,yf=Vp,e=Vr(e),Hr(e)){if(`selectionStart`in e)var n={start:e.selectionStart,end:e.selectionEnd};else a:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break a}var s=0,c=-1,l=-1,u=0,d=0,f=e,p=null;b:for(;;){for(var m;f!==n||a!==0&&f.nodeType!==3||(c=s+a),f!==o||r!==0&&f.nodeType!==3||(l=s+r),f.nodeType===3&&(s+=f.nodeValue.length),(m=f.firstChild)!==null;)p=f,f=m;for(;;){if(f===e)break b;if(p===n&&++u===a&&(c=s),p===o&&++d===r&&(l=s),(m=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=m}n=c===-1||l===-1?null:{start:c,end:l}}else n=null}n||={start:0,end:0}}else n=null;for(bf={focusedElem:e,selectionRange:n},Vp=!1,El=t;El!==null;)if(t=El,e=t.child,t.subtreeFlags&1028&&e!==null)e.return=t,El=e;else for(;El!==null;){switch(t=El,o=t.alternate,e=t.flags,t.tag){case 0:if(e&4&&(e=t.updateQueue,e=e===null?null:e.events,e!==null))for(n=0;n<e.length;n++)a=e[n],a.ref.impl=a.nextImpl;break;case 11:case 15:break;case 1:if(e&1024&&o!==null){e=void 0,n=t,a=o.memoizedProps,o=o.memoizedState,r=n.stateNode;try{var h=pc(n.type,a);e=r.getSnapshotBeforeUpdate(h,o),r.__reactInternalSnapshotBeforeUpdate=e}catch(e){yd(n,n.return,e)}}break;case 3:if(e&1024){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)Ff(e);else if(n===1)switch(e.nodeName){case`HEAD`:case`HTML`:case`BODY`:Ff(e);break;default:e.textContent=``}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(e&1024)throw Error(i(163))}if(e=t.sibling,e!==null){e.return=t.return,El=e;break}El=t.return}}function Ol(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:Ul(e,n),r&4&&ll(5,n);break;case 1:if(Ul(e,n),r&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(e){yd(n,n.return,e)}else{var i=pc(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(e){yd(n,n.return,e)}}r&64&&dl(n),r&512&&pl(n,n.return);break;case 3:if(Ul(e,n),r&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{po(e,t)}catch(e){yd(n,n.return,e)}}break;case 27:t===null&&r&4&&xl(n);case 26:case 5:Ul(e,n),t===null&&r&4&&hl(n),r&512&&pl(n,n.return);break;case 12:Ul(e,n);break;case 31:Ul(e,n),r&4&&Pl(e,n);break;case 13:Ul(e,n),r&4&&Fl(e,n),r&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=Cd.bind(null,n),Vf(e,n))));break;case 22:if(r=n.memoizedState!==null||Sl,!r){t=t!==null&&t.memoizedState!==null||Cl,i=Sl;var a=Cl;Sl=r,(Cl=t)&&!a?Gl(e,n,(n.subtreeFlags&8772)!=0):Ul(e,n),Sl=i,Cl=a}break;case 30:break;default:Ul(e,n)}}function kl(e){var t=e.alternate;t!==null&&(e.alternate=null,kl(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&vt(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Al=null,jl=!1;function Ml(e,t,n){for(n=n.child;n!==null;)Nl(e,t,n),n=n.sibling}function Nl(e,t,n){if(ze&&typeof ze.onCommitFiberUnmount==`function`)try{ze.onCommitFiberUnmount(Re,n)}catch{}switch(n.tag){case 26:Cl||ml(n,t),Ml(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Cl||ml(n,t);var r=Al,i=jl;Mf(n.type)&&(Al=n.stateNode,jl=!1),Ml(e,t,n),qf(n.stateNode),Al=r,jl=i;break;case 5:Cl||ml(n,t);case 6:if(r=Al,i=jl,Al=null,Ml(e,t,n),Al=r,jl=i,Al!==null)if(jl)try{(Al.nodeType===9?Al.body:Al.nodeName===`HTML`?Al.ownerDocument.body:Al).removeChild(n.stateNode)}catch(e){yd(n,t,e)}else try{Al.removeChild(n.stateNode)}catch(e){yd(n,t,e)}break;case 18:Al!==null&&(jl?(e=Al,Nf(e.nodeType===9?e.body:e.nodeName===`HTML`?e.ownerDocument.body:e,n.stateNode),pm(e)):Nf(Al,n.stateNode));break;case 4:r=Al,i=jl,Al=n.stateNode.containerInfo,jl=!0,Ml(e,t,n),Al=r,jl=i;break;case 0:case 11:case 14:case 15:ul(2,n,t),Cl||ul(4,n,t),Ml(e,t,n);break;case 1:Cl||(ml(n,t),r=n.stateNode,typeof r.componentWillUnmount==`function`&&fl(n,t,r)),Ml(e,t,n);break;case 21:Ml(e,t,n);break;case 22:Cl=(r=Cl)||n.memoizedState!==null,Ml(e,t,n),Cl=r;break;default:Ml(e,t,n)}}function Pl(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{pm(e)}catch(e){yd(t,t.return,e)}}}function Fl(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{pm(e)}catch(e){yd(t,t.return,e)}}function Il(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Tl),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Tl),t;default:throw Error(i(435,e.tag))}}function Ll(e,t){var n=Il(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var r=wd.bind(null,e,t);t.then(r,r)}})}function Rl(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r],o=e,s=t,c=s;a:for(;c!==null;){switch(c.tag){case 27:if(Mf(c.type)){Al=c.stateNode,jl=!1;break a}break;case 5:Al=c.stateNode,jl=!1;break a;case 3:case 4:Al=c.stateNode.containerInfo,jl=!0;break a}c=c.return}if(Al===null)throw Error(i(160));Nl(o,s,a),Al=null,jl=!1,o=a.alternate,o!==null&&(o.return=null),a.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Bl(t,e),t=t.sibling}var zl=null;function Bl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Rl(t,e),Vl(e),r&4&&(ul(3,e,e.return),ll(3,e),ul(5,e,e.return));break;case 1:Rl(t,e),Vl(e),r&512&&(Cl||n===null||ml(n,n.return)),r&64&&Sl&&(e=e.updateQueue,e!==null&&(r=e.callbacks,r!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?r:n.concat(r))));break;case 26:var a=zl;if(Rl(t,e),Vl(e),r&512&&(Cl||n===null||ml(n,n.return)),r&4){var o=n===null?null:n.memoizedState;if(r=e.memoizedState,n===null)if(r===null)if(e.stateNode===null){a:{r=e.type,n=e.memoizedProps,a=a.ownerDocument||a;b:switch(r){case`title`:o=a.getElementsByTagName(`title`)[0],(!o||o[_t]||o[ut]||o.namespaceURI===`http://www.w3.org/2000/svg`||o.hasAttribute(`itemprop`))&&(o=a.createElement(r),a.head.insertBefore(o,a.querySelector(`head > title`))),hf(o,r,n),o[ut]=e,Ct(o),r=o;break a;case`link`:var s=xp(`link`,`href`,a).get(r+(n.href||``));if(s){for(var c=0;c<s.length;c++)if(o=s[c],o.getAttribute(`href`)===(n.href==null||n.href===``?null:n.href)&&o.getAttribute(`rel`)===(n.rel==null?null:n.rel)&&o.getAttribute(`title`)===(n.title==null?null:n.title)&&o.getAttribute(`crossorigin`)===(n.crossOrigin==null?null:n.crossOrigin)){s.splice(c,1);break b}}o=a.createElement(r),hf(o,r,n),a.head.appendChild(o);break;case`meta`:if(s=xp(`meta`,`content`,a).get(r+(n.content||``))){for(c=0;c<s.length;c++)if(o=s[c],o.getAttribute(`content`)===(n.content==null?null:``+n.content)&&o.getAttribute(`name`)===(n.name==null?null:n.name)&&o.getAttribute(`property`)===(n.property==null?null:n.property)&&o.getAttribute(`http-equiv`)===(n.httpEquiv==null?null:n.httpEquiv)&&o.getAttribute(`charset`)===(n.charSet==null?null:n.charSet)){s.splice(c,1);break b}}o=a.createElement(r),hf(o,r,n),a.head.appendChild(o);break;default:throw Error(i(468,r))}o[ut]=e,Ct(o),r=o}e.stateNode=r}else Sp(a,e.type,e.stateNode);else e.stateNode=gp(a,r,e.memoizedProps);else o===r?r===null&&e.stateNode!==null&&gl(e,e.memoizedProps,n.memoizedProps):(o===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):o.count--,r===null?Sp(a,e.type,e.stateNode):gp(a,r,e.memoizedProps))}break;case 27:Rl(t,e),Vl(e),r&512&&(Cl||n===null||ml(n,n.return)),n!==null&&r&4&&gl(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Rl(t,e),Vl(e),r&512&&(Cl||n===null||ml(n,n.return)),e.flags&32){a=e.stateNode;try{Yt(a,``)}catch(t){yd(e,e.return,t)}}r&4&&e.stateNode!=null&&(a=e.memoizedProps,gl(e,a,n===null?a:n.memoizedProps)),r&1024&&(wl=!0);break;case 6:if(Rl(t,e),Vl(e),r&4){if(e.stateNode===null)throw Error(i(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(t){yd(e,e.return,t)}}break;case 3:if(bp=null,a=zl,zl=Xf(t.containerInfo),Rl(t,e),zl=a,Vl(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{pm(t.containerInfo)}catch(t){yd(e,e.return,t)}wl&&(wl=!1,Hl(e));break;case 4:r=zl,zl=Xf(e.stateNode.containerInfo),Rl(t,e),Vl(e),zl=r;break;case 12:Rl(t,e),Vl(e);break;case 31:Rl(t,e),Vl(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,Ll(e,r)));break;case 13:Rl(t,e),Vl(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(Du=ke()),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,Ll(e,r)));break;case 22:a=e.memoizedState!==null;var l=n!==null&&n.memoizedState!==null,u=Sl,d=Cl;if(Sl=u||a,Cl=d||l,Rl(t,e),Cl=d,Sl=u,Vl(e),r&8192)a:for(t=e.stateNode,t._visibility=a?t._visibility&-2:t._visibility|1,a&&(n===null||l||Sl||Cl||Wl(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){l=n=t;try{if(o=l.stateNode,a)s=o.style,typeof s.setProperty==`function`?s.setProperty(`display`,`none`,`important`):s.display=`none`;else{c=l.stateNode;var f=l.memoizedProps.style,p=f!=null&&f.hasOwnProperty(`display`)?f.display:null;c.style.display=p==null||typeof p==`boolean`?``:(``+p).trim()}}catch(e){yd(l,l.return,e)}}}else if(t.tag===6){if(n===null){l=t;try{l.stateNode.nodeValue=a?``:l.memoizedProps}catch(e){yd(l,l.return,e)}}}else if(t.tag===18){if(n===null){l=t;try{var m=l.stateNode;a?Pf(m,!0):Pf(l.stateNode,!1)}catch(e){yd(l,l.return,e)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break a;for(;t.sibling===null;){if(t.return===null||t.return===e)break a;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}r&4&&(r=e.updateQueue,r!==null&&(n=r.retryQueue,n!==null&&(r.retryQueue=null,Ll(e,n))));break;case 19:Rl(t,e),Vl(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,Ll(e,r)));break;case 30:break;case 21:break;default:Rl(t,e),Vl(e)}}function Vl(e){var t=e.flags;if(t&2){try{for(var n,r=e.return;r!==null;){if(_l(r)){n=r;break}r=r.return}if(n==null)throw Error(i(160));switch(n.tag){case 27:var a=n.stateNode,o=vl(e);bl(e,o,a);break;case 5:var s=n.stateNode;n.flags&32&&(Yt(s,``),n.flags&=-33);var c=vl(e);bl(e,c,s);break;case 3:case 4:var l=n.stateNode.containerInfo,u=vl(e);yl(e,u,l);break;default:throw Error(i(161))}}catch(t){yd(e,e.return,t)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Hl(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Hl(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Ul(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Ol(e,t.alternate,t),t=t.sibling}function Wl(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ul(4,t,t.return),Wl(t);break;case 1:ml(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount==`function`&&fl(t,t.return,n),Wl(t);break;case 27:qf(t.stateNode);case 26:case 5:ml(t,t.return),Wl(t);break;case 22:t.memoizedState===null&&Wl(t);break;case 30:Wl(t);break;default:Wl(t)}e=e.sibling}}function Gl(e,t,n){for(n&&=(t.subtreeFlags&8772)!=0,t=t.child;t!==null;){var r=t.alternate,i=e,a=t,o=a.flags;switch(a.tag){case 0:case 11:case 15:Gl(i,a,n),ll(4,a);break;case 1:if(Gl(i,a,n),r=a,i=r.stateNode,typeof i.componentDidMount==`function`)try{i.componentDidMount()}catch(e){yd(r,r.return,e)}if(r=a,i=r.updateQueue,i!==null){var s=r.stateNode;try{var c=i.shared.hiddenCallbacks;if(c!==null)for(i.shared.hiddenCallbacks=null,i=0;i<c.length;i++)fo(c[i],s)}catch(e){yd(r,r.return,e)}}n&&o&64&&dl(a),pl(a,a.return);break;case 27:xl(a);case 26:case 5:Gl(i,a,n),n&&r===null&&o&4&&hl(a),pl(a,a.return);break;case 12:Gl(i,a,n);break;case 31:Gl(i,a,n),n&&o&4&&Pl(i,a);break;case 13:Gl(i,a,n),n&&o&4&&Fl(i,a);break;case 22:a.memoizedState===null&&Gl(i,a,n),pl(a,a.return);break;case 30:break;default:Gl(i,a,n)}t=t.sibling}}function Kl(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&wa(n))}function ql(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&wa(e))}function Jl(e,t,n,r){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Yl(e,t,n,r),t=t.sibling}function Yl(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:Jl(e,t,n,r),i&2048&&ll(9,t);break;case 1:Jl(e,t,n,r);break;case 3:Jl(e,t,n,r),i&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&wa(e)));break;case 12:if(i&2048){Jl(e,t,n,r),e=t.stateNode;try{var a=t.memoizedProps,o=a.id,s=a.onPostCommit;typeof s==`function`&&s(o,t.alternate===null?`mount`:`update`,e.passiveEffectDuration,-0)}catch(e){yd(t,t.return,e)}}else Jl(e,t,n,r);break;case 31:Jl(e,t,n,r);break;case 13:Jl(e,t,n,r);break;case 23:break;case 22:a=t.stateNode,o=t.alternate,t.memoizedState===null?a._visibility&2?Jl(e,t,n,r):(a._visibility|=2,Xl(e,t,n,r,(t.subtreeFlags&10256)!=0||!1)):a._visibility&2?Jl(e,t,n,r):Zl(e,t),i&2048&&Kl(o,t);break;case 24:Jl(e,t,n,r),i&2048&&ql(t.alternate,t);break;default:Jl(e,t,n,r)}}function Xl(e,t,n,r,i){for(i&&=(t.subtreeFlags&10256)!=0||!1,t=t.child;t!==null;){var a=e,o=t,s=n,c=r,l=o.flags;switch(o.tag){case 0:case 11:case 15:Xl(a,o,s,c,i),ll(8,o);break;case 23:break;case 22:var u=o.stateNode;o.memoizedState===null?(u._visibility|=2,Xl(a,o,s,c,i)):u._visibility&2?Xl(a,o,s,c,i):Zl(a,o),i&&l&2048&&Kl(o.alternate,o);break;case 24:Xl(a,o,s,c,i),i&&l&2048&&ql(o.alternate,o);break;default:Xl(a,o,s,c,i)}t=t.sibling}}function Zl(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:Zl(n,r),i&2048&&Kl(r.alternate,r);break;case 24:Zl(n,r),i&2048&&ql(r.alternate,r);break;default:Zl(n,r)}t=t.sibling}}var Ql=8192;function $l(e,t,n){if(e.subtreeFlags&Ql)for(e=e.child;e!==null;)eu(e,t,n),e=e.sibling}function eu(e,t,n){switch(e.tag){case 26:$l(e,t,n),e.flags&Ql&&e.memoizedState!==null&&Tp(n,zl,e.memoizedState,e.memoizedProps);break;case 5:$l(e,t,n);break;case 3:case 4:var r=zl;zl=Xf(e.stateNode.containerInfo),$l(e,t,n),zl=r;break;case 22:e.memoizedState===null&&(r=e.alternate,r!==null&&r.memoizedState!==null?(r=Ql,Ql=16777216,$l(e,t,n),Ql=r):$l(e,t,n));break;default:$l(e,t,n)}}function tu(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function nu(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];El=r,au(r,e)}tu(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)ru(e),e=e.sibling}function ru(e){switch(e.tag){case 0:case 11:case 15:nu(e),e.flags&2048&&ul(9,e,e.return);break;case 3:nu(e);break;case 12:nu(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,iu(e)):nu(e);break;default:nu(e)}}function iu(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];El=r,au(r,e)}tu(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:ul(8,t,t.return),iu(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,iu(t));break;default:iu(t)}e=e.sibling}}function au(e,t){for(;El!==null;){var n=El;switch(n.tag){case 0:case 11:case 15:ul(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var r=n.memoizedState.cachePool.pool;r!=null&&r.refCount++}break;case 24:wa(n.memoizedState.cache)}if(r=n.child,r!==null)r.return=n,El=r;else a:for(n=e;El!==null;){r=El;var i=r.sibling,a=r.return;if(kl(r),r===n){El=null;break a}if(i!==null){i.return=a,El=i;break a}El=a}}}var ou={getCacheForType:function(e){var t=ga(Sa),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return ga(Sa).controller.signal}},su=typeof WeakMap==`function`?WeakMap:Map,cu=0,lu=null,uu=null,du=0,fu=0,pu=null,mu=!1,hu=!1,gu=!1,_u=0,vu=0,yu=0,bu=0,xu=0,Su=0,Cu=0,wu=null,Tu=null,Eu=!1,Du=0,Ou=0,ku=1/0,Au=null,ju=null,Mu=0,Nu=null,Pu=null,Fu=0,Iu=0,Lu=null,Ru=null,zu=0,Bu=null;function Vu(){return cu&2&&du!==0?du&-du:A.T===null?st():Bd()}function Hu(){if(Su===0)if(!(du&536870912)||Yi){var e=Ke;Ke<<=1,!(Ke&3932160)&&(Ke=262144),Su=e}else Su=536870912;return e=yo.current,e!==null&&(e.flags|=32),Su}function Uu(e,t,n){(e===lu&&(fu===2||fu===9)||e.cancelPendingCommit!==null)&&(Xu(e,0),qu(e,du,Su,!1)),et(e,n),(!(cu&2)||e!==lu)&&(e===lu&&(!(cu&2)&&(bu|=n),vu===4&&qu(e,du,Su,!1)),Md(e))}function Wu(e,t,n){if(cu&6)throw Error(i(327));var r=!n&&(t&127)==0&&(t&e.expiredLanes)===0||Xe(e,t),a=r?id(e,t):nd(e,t,!0),o=r;do{if(a===0){hu&&!r&&qu(e,t,0,!1);break}else{if(n=e.current.alternate,o&&!Ku(n)){a=nd(e,t,!1),o=!1;continue}if(a===2){if(o=t,e.errorRecoveryDisabledLanes&o)var s=0;else s=e.pendingLanes&-536870913,s=s===0?s&536870912?536870912:0:s;if(s!==0){t=s;a:{var c=e;a=wu;var l=c.current.memoizedState.isDehydrated;if(l&&(Xu(c,s).flags|=256),s=nd(c,s,!1),s!==2){if(gu&&!l){c.errorRecoveryDisabledLanes|=o,bu|=o,a=4;break a}o=Tu,Tu=a,o!==null&&(Tu===null?Tu=o:Tu.push.apply(Tu,o))}a=s}if(o=!1,a!==2)continue}}if(a===1){Xu(e,0),qu(e,t,0,!0);break}a:{switch(r=e,o=a,o){case 0:case 1:throw Error(i(345));case 4:if((t&4194048)!==t)break;case 6:qu(r,t,Su,!mu);break a;case 2:Tu=null;break;case 3:case 5:break;default:throw Error(i(329))}if((t&62914560)===t&&(a=Du+300-ke(),10<a)){if(qu(r,t,Su,!mu),Ye(r,0,!0)!==0)break a;Fu=t,r.timeoutHandle=Df(Gu.bind(null,r,n,Tu,Au,Eu,t,Su,bu,Cu,mu,o,`Throttled`,-0,0),a);break a}Gu(r,n,Tu,Au,Eu,t,Su,bu,Cu,mu,o,null,-0,0)}}break}while(1);Md(e)}function Gu(e,t,n,r,i,a,o,s,c,l,u,d,f,p){if(e.timeoutHandle=-1,d=t.subtreeFlags,d&8192||(d&16785408)==16785408){d={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:rn},eu(t,a,d);var m=(a&62914560)===a?Du-ke():(a&4194048)===a?Ou-ke():0;if(m=Dp(d,m),m!==null){Fu=a,e.cancelPendingCommit=m(dd.bind(null,e,t,a,n,r,i,o,s,c,u,d,null,f,p)),qu(e,a,o,!l);return}}dd(e,t,a,n,r,i,o,s,c)}function Ku(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!Ir(a(),i))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function qu(e,t,n,r){t&=~xu,t&=~bu,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var a=31-Ve(i),o=1<<a;r[a]=-1,i&=~o}n!==0&&nt(e,n,t)}function Ju(){return cu&6?!0:(Nd(0,!1),!1)}function Yu(){if(uu!==null){if(fu===0)var e=uu.return;else e=uu,ca=sa=null,qo(e),qa=null,Ja=0,e=uu;for(;e!==null;)cl(e.alternate,e),e=e.return;uu=null}}function Xu(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,Of(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),Fu=0,Yu(),lu=e,uu=n=wi(e.current,null),du=t,fu=0,pu=null,mu=!1,hu=Xe(e,t),gu=!1,Cu=Su=xu=bu=yu=vu=0,Tu=wu=null,Eu=!1,t&8&&(t|=t&32);var r=e.entangledLanes;if(r!==0)for(e=e.entanglements,r&=t;0<r;){var i=31-Ve(r),a=1<<i;t|=e[i],r&=~a}return _u=t,mi(),n}function Zu(e,t){ko=null,A.H=ac,t===La||t===za?(t=Ga(),fu=3):t===Ra?(t=Ga(),fu=4):fu=t===Cc?8:typeof t==`object`&&t&&typeof t.then==`function`?6:1,pu=t,uu===null&&(vu=1,_c(e,Mi(t,e.current)))}function Qu(){var e=yo.current;return e===null?!0:(du&4194048)===du?bo===null:(du&62914560)===du||du&536870912?e===bo:!1}function $u(){var e=A.H;return A.H=ac,e===null?ac:e}function ed(){var e=A.A;return A.A=ou,e}function td(){vu=4,mu||(du&4194048)!==du&&yo.current!==null||(hu=!0),!(yu&134217727)&&!(bu&134217727)||lu===null||qu(lu,du,Su,!1)}function nd(e,t,n){var r=cu;cu|=2;var i=$u(),a=ed();(lu!==e||du!==t)&&(Au=null,Xu(e,t)),t=!1;var o=vu;a:do try{if(fu!==0&&uu!==null){var s=uu,c=pu;switch(fu){case 8:Yu(),o=6;break a;case 3:case 2:case 9:case 6:yo.current===null&&(t=!0);var l=fu;if(fu=0,pu=null,cd(e,s,c,l),n&&hu){o=0;break a}break;default:l=fu,fu=0,pu=null,cd(e,s,c,l)}}rd(),o=vu;break}catch(t){Zu(e,t)}while(1);return t&&e.shellSuspendCounter++,ca=sa=null,cu=r,A.H=i,A.A=a,uu===null&&(lu=null,du=0,mi()),o}function rd(){for(;uu!==null;)od(uu)}function id(e,t){var n=cu;cu|=2;var r=$u(),a=ed();lu!==e||du!==t?(Au=null,ku=ke()+500,Xu(e,t)):hu=Xe(e,t);a:do try{if(fu!==0&&uu!==null){t=uu;var o=pu;b:switch(fu){case 1:fu=0,pu=null,cd(e,t,o,1);break;case 2:case 9:if(Va(o)){fu=0,pu=null,sd(t);break}t=function(){fu!==2&&fu!==9||lu!==e||(fu=7),Md(e)},o.then(t,t);break a;case 3:fu=7;break a;case 4:fu=5;break a;case 7:Va(o)?(fu=0,pu=null,sd(t)):(fu=0,pu=null,cd(e,t,o,7));break;case 5:var s=null;switch(uu.tag){case 26:s=uu.memoizedState;case 5:case 27:var c=uu;if(s?wp(s):c.stateNode.complete){fu=0,pu=null;var l=c.sibling;if(l!==null)uu=l;else{var u=c.return;u===null?uu=null:(uu=u,ld(u))}break b}}fu=0,pu=null,cd(e,t,o,5);break;case 6:fu=0,pu=null,cd(e,t,o,6);break;case 8:Yu(),vu=6;break a;default:throw Error(i(462))}}ad();break}catch(t){Zu(e,t)}while(1);return ca=sa=null,A.H=r,A.A=a,cu=n,uu===null?(lu=null,du=0,mi(),vu):0}function ad(){for(;uu!==null&&!De();)od(uu)}function od(e){var t=$c(e.alternate,e,_u);e.memoizedProps=e.pendingProps,t===null?ld(e):uu=t}function sd(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Lc(n,t,t.pendingProps,t.type,void 0,du);break;case 11:t=Lc(n,t,t.pendingProps,t.type.render,t.ref,du);break;case 5:qo(t);default:cl(n,t),t=uu=Ti(t,_u),t=$c(n,t,_u)}e.memoizedProps=e.pendingProps,t===null?ld(e):uu=t}function cd(e,t,n,r){ca=sa=null,qo(t),qa=null,Ja=0;var i=t.return;try{if(Sc(e,i,t,n,du)){vu=1,_c(e,Mi(n,e.current)),uu=null;return}}catch(t){if(i!==null)throw uu=i,t;vu=1,_c(e,Mi(n,e.current)),uu=null;return}t.flags&32768?(Yi||r===1?e=!0:hu||du&536870912?e=!1:(mu=e=!0,(r===2||r===9||r===3||r===6)&&(r=yo.current,r!==null&&r.tag===13&&(r.flags|=16384))),ud(t,e)):ld(t)}function ld(e){var t=e;do{if(t.flags&32768){ud(t,mu);return}e=t.return;var n=ol(t.alternate,t,_u);if(n!==null){uu=n;return}if(t=t.sibling,t!==null){uu=t;return}uu=t=e}while(t!==null);vu===0&&(vu=5)}function ud(e,t){do{var n=sl(e.alternate,e);if(n!==null){n.flags&=32767,uu=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){uu=e;return}uu=e=n}while(e!==null);vu=6,uu=null}function dd(e,t,n,r,a,o,s,c,l){e.cancelPendingCommit=null;do gd();while(Mu!==0);if(cu&6)throw Error(i(327));if(t!==null){if(t===e.current)throw Error(i(177));if(o=t.lanes|t.childLanes,o|=pi,tt(e,n,o,s,c,l),e===lu&&(uu=lu=null,du=0),Pu=t,Nu=e,Fu=n,Iu=o,Lu=a,Ru=r,t.subtreeFlags&10256||t.flags&10256?(e.callbackNode=null,e.callbackPriority=0,Td(Ne,function(){return _d(),null})):(e.callbackNode=null,e.callbackPriority=0),r=(t.flags&13878)!=0,t.subtreeFlags&13878||r){r=A.T,A.T=null,a=j.p,j.p=2,s=cu,cu|=4;try{Dl(e,t,n)}finally{cu=s,j.p=a,A.T=r}}Mu=1,fd(),pd(),md()}}function fd(){if(Mu===1){Mu=0;var e=Nu,t=Pu,n=(t.flags&13878)!=0;if(t.subtreeFlags&13878||n){n=A.T,A.T=null;var r=j.p;j.p=2;var i=cu;cu|=4;try{Bl(t,e);var a=bf,o=Vr(e.containerInfo),s=a.focusedElem,c=a.selectionRange;if(o!==s&&s&&s.ownerDocument&&Br(s.ownerDocument.documentElement,s)){if(c!==null&&Hr(s)){var l=c.start,u=c.end;if(u===void 0&&(u=l),`selectionStart`in s)s.selectionStart=l,s.selectionEnd=Math.min(u,s.value.length);else{var d=s.ownerDocument||document,f=d&&d.defaultView||window;if(f.getSelection){var p=f.getSelection(),m=s.textContent.length,h=Math.min(c.start,m),g=c.end===void 0?h:Math.min(c.end,m);!p.extend&&h>g&&(o=g,g=h,h=o);var _=zr(s,h),v=zr(s,g);if(_&&v&&(p.rangeCount!==1||p.anchorNode!==_.node||p.anchorOffset!==_.offset||p.focusNode!==v.node||p.focusOffset!==v.offset)){var y=d.createRange();y.setStart(_.node,_.offset),p.removeAllRanges(),h>g?(p.addRange(y),p.extend(v.node,v.offset)):(y.setEnd(v.node,v.offset),p.addRange(y))}}}}for(d=[],p=s;p=p.parentNode;)p.nodeType===1&&d.push({element:p,left:p.scrollLeft,top:p.scrollTop});for(typeof s.focus==`function`&&s.focus(),s=0;s<d.length;s++){var b=d[s];b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}Vp=!!yf,bf=yf=null}finally{cu=i,j.p=r,A.T=n}}e.current=t,Mu=2}}function pd(){if(Mu===2){Mu=0;var e=Nu,t=Pu,n=(t.flags&8772)!=0;if(t.subtreeFlags&8772||n){n=A.T,A.T=null;var r=j.p;j.p=2;var i=cu;cu|=4;try{Ol(e,t.alternate,t)}finally{cu=i,j.p=r,A.T=n}}Mu=3}}function md(){if(Mu===4||Mu===3){Mu=0,Oe();var e=Nu,t=Pu,n=Fu,r=Ru;t.subtreeFlags&10256||t.flags&10256?Mu=5:(Mu=0,Pu=Nu=null,hd(e,e.pendingLanes));var i=e.pendingLanes;if(i===0&&(ju=null),ot(n),t=t.stateNode,ze&&typeof ze.onCommitFiberRoot==`function`)try{ze.onCommitFiberRoot(Re,t,void 0,(t.current.flags&128)==128)}catch{}if(r!==null){t=A.T,i=j.p,j.p=2,A.T=null;try{for(var a=e.onRecoverableError,o=0;o<r.length;o++){var s=r[o];a(s.value,{componentStack:s.stack})}}finally{A.T=t,j.p=i}}Fu&3&&gd(),Md(e),i=e.pendingLanes,n&261930&&i&42?e===Bu?zu++:(zu=0,Bu=e):zu=0,Nd(0,!1)}}function hd(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,wa(t)))}function gd(){return fd(),pd(),md(),_d()}function _d(){if(Mu!==5)return!1;var e=Nu,t=Iu;Iu=0;var n=ot(Fu),r=A.T,a=j.p;try{j.p=32>n?32:n,A.T=null,n=Lu,Lu=null;var o=Nu,s=Fu;if(Mu=0,Pu=Nu=null,Fu=0,cu&6)throw Error(i(331));var c=cu;if(cu|=4,ru(o.current),Yl(o,o.current,s,n),cu=c,Nd(0,!1),ze&&typeof ze.onPostCommitFiberRoot==`function`)try{ze.onPostCommitFiberRoot(Re,o)}catch{}return!0}finally{j.p=a,A.T=r,hd(e,t)}}function vd(e,t,n){t=Mi(n,t),t=yc(e.stateNode,t,2),e=ao(e,t,2),e!==null&&(et(e,2),Md(e))}function yd(e,t,n){if(e.tag===3)vd(e,e,n);else for(;t!==null;){if(t.tag===3){vd(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError==`function`||typeof r.componentDidCatch==`function`&&(ju===null||!ju.has(r))){e=Mi(n,e),n=bc(2),r=ao(t,n,2),r!==null&&(xc(n,r,t,e),et(r,2),Md(r));break}}t=t.return}}function bd(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new su;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(gu=!0,i.add(n),e=xd.bind(null,e,t,n),t.then(e,e))}function xd(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,lu===e&&(du&n)===n&&(vu===4||vu===3&&(du&62914560)===du&&300>ke()-Du?!(cu&2)&&Xu(e,0):xu|=n,Cu===du&&(Cu=0)),Md(e)}function Sd(e,t){t===0&&(t=Qe()),e=_i(e,t),e!==null&&(et(e,t),Md(e))}function Cd(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Sd(e,n)}function wd(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(i(314))}r!==null&&r.delete(t),Sd(e,n)}function Td(e,t){return Te(e,t)}var Ed=null,Dd=null,Od=!1,kd=!1,Ad=!1,jd=0;function Md(e){e!==Dd&&e.next===null&&(Dd===null?Ed=Dd=e:Dd=Dd.next=e),kd=!0,Od||(Od=!0,zd())}function Nd(e,t){if(!Ad&&kd){Ad=!0;do for(var n=!1,r=Ed;r!==null;){if(!t)if(e!==0){var i=r.pendingLanes;if(i===0)var a=0;else{var o=r.suspendedLanes,s=r.pingedLanes;a=(1<<31-Ve(42|e)+1)-1,a&=i&~(o&~s),a=a&201326741?a&201326741|1:a?a|2:0}a!==0&&(n=!0,Rd(r,a))}else a=du,a=Ye(r,r===lu?a:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),!(a&3)||Xe(r,a)||(n=!0,Rd(r,a));r=r.next}while(n);Ad=!1}}function Pd(){Fd()}function Fd(){kd=Od=!1;var e=0;jd!==0&&Ef()&&(e=jd);for(var t=ke(),n=null,r=Ed;r!==null;){var i=r.next,a=Id(r,t);a===0?(r.next=null,n===null?Ed=i:n.next=i,i===null&&(Dd=n)):(n=r,(e!==0||a&3)&&(kd=!0)),r=i}Mu!==0&&Mu!==5||Nd(e,!1),jd!==0&&(jd=0)}function Id(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes&-62914561;0<a;){var o=31-Ve(a),s=1<<o,c=i[o];c===-1?((s&n)===0||(s&r)!==0)&&(i[o]=Ze(s,t)):c<=t&&(e.expiredLanes|=s),a&=~s}if(t=lu,n=du,n=Ye(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r=e.callbackNode,n===0||e===t&&(fu===2||fu===9)||e.cancelPendingCommit!==null)return r!==null&&r!==null&&Ee(r),e.callbackNode=null,e.callbackPriority=0;if(!(n&3)||Xe(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(r!==null&&Ee(r),ot(n)){case 2:case 8:n=Me;break;case 32:n=Ne;break;case 268435456:n=Fe;break;default:n=Ne}return r=Ld.bind(null,e),n=Te(n,r),e.callbackPriority=t,e.callbackNode=n,t}return r!==null&&r!==null&&Ee(r),e.callbackPriority=2,e.callbackNode=null,2}function Ld(e,t){if(Mu!==0&&Mu!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(gd()&&e.callbackNode!==n)return null;var r=du;return r=Ye(e,e===lu?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r===0?null:(Wu(e,r,t),Id(e,ke()),e.callbackNode!=null&&e.callbackNode===n?Ld.bind(null,e):null)}function Rd(e,t){if(gd())return null;Wu(e,t,!0)}function zd(){Af(function(){cu&6?Te(je,Pd):Fd()})}function Bd(){if(jd===0){var e=Da;e===0&&(e=Ge,Ge<<=1,!(Ge&261888)&&(Ge=256)),jd=e}return jd}function Vd(e){return e==null||typeof e==`symbol`||typeof e==`boolean`?null:typeof e==`function`?e:nn(``+e)}function Hd(e,t){var n=t.ownerDocument.createElement(`input`);return n.name=t.name,n.value=t.value,e.id&&n.setAttribute(`form`,e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Ud(e,t,n,r,i){if(t===`submit`&&n&&n.stateNode===i){var a=Vd((i[dt]||null).action),o=r.submitter;o&&(t=(t=o[dt]||null)?Vd(t.formAction):o.getAttribute(`formAction`),t!==null&&(a=t,o=null));var s=new Tn(`action`,`action`,null,r,i);e.push({event:s,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(jd!==0){var e=o?Hd(i,o):new FormData(i);Gs(n,{pending:!0,data:e,method:i.method,action:a},null,e)}}else typeof a==`function`&&(s.preventDefault(),e=o?Hd(i,o):new FormData(i),Gs(n,{pending:!0,data:e,method:i.method,action:a},a,e))},currentTarget:i}]})}}for(var Wd=0;Wd<ci.length;Wd++){var Gd=ci[Wd],Kd=Gd.toLowerCase(),qd=Gd[0].toUpperCase()+Gd.slice(1);li(Kd,`on`+qd)}li(ei,`onAnimationEnd`),li(ti,`onAnimationIteration`),li(ni,`onAnimationStart`),li(`dblclick`,`onDoubleClick`),li(`focusin`,`onFocus`),li(`focusout`,`onBlur`),li(ri,`onTransitionRun`),li(ii,`onTransitionStart`),li(ai,`onTransitionCancel`),li(oi,`onTransitionEnd`),Dt(`onMouseEnter`,[`mouseout`,`mouseover`]),Dt(`onMouseLeave`,[`mouseout`,`mouseover`]),Dt(`onPointerEnter`,[`pointerout`,`pointerover`]),Dt(`onPointerLeave`,[`pointerout`,`pointerover`]),Et(`onChange`,`change click focusin focusout input keydown keyup selectionchange`.split(` `)),Et(`onSelect`,`focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange`.split(` `)),Et(`onBeforeInput`,[`compositionend`,`keypress`,`textInput`,`paste`]),Et(`onCompositionEnd`,`compositionend focusout keydown keypress keyup mousedown`.split(` `)),Et(`onCompositionStart`,`compositionstart focusout keydown keypress keyup mousedown`.split(` `)),Et(`onCompositionUpdate`,`compositionupdate focusout keydown keypress keyup mousedown`.split(` `));var Jd=`abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting`.split(` `),Yd=new Set(`beforetoggle cancel close invalid load scroll scrollend toggle`.split(` `).concat(Jd));function Xd(e,t){t=(t&4)!=0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;a:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==a&&i.isPropagationStopped())break a;a=s,i.currentTarget=l;try{a(i)}catch(e){ui(e)}i.currentTarget=null,a=c}else for(o=0;o<r.length;o++){if(s=r[o],c=s.instance,l=s.currentTarget,s=s.listener,c!==a&&i.isPropagationStopped())break a;a=s,i.currentTarget=l;try{a(i)}catch(e){ui(e)}i.currentTarget=null,a=c}}}}function Zd(e,t){var n=t[pt];n===void 0&&(n=t[pt]=new Set);var r=e+`__bubble`;n.has(r)||(tf(t,e,2,!1),n.add(r))}function Qd(e,t,n){var r=0;t&&(r|=4),tf(n,e,r,t)}var $d=`_reactListening`+Math.random().toString(36).slice(2);function ef(e){if(!e[$d]){e[$d]=!0,wt.forEach(function(t){t!==`selectionchange`&&(Yd.has(t)||Qd(t,!1,e),Qd(t,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[$d]||(t[$d]=!0,Qd(`selectionchange`,!1,t))}}function tf(e,t,n,r){switch(Jp(t)){case 2:var i=Hp;break;case 8:i=Up;break;default:i=Wp}n=i.bind(null,t,n,e),i=void 0,!mn||t!==`touchstart`&&t!==`touchmove`&&t!==`wheel`||(i=!0),r?i===void 0?e.addEventListener(t,n,!0):e.addEventListener(t,n,{capture:!0,passive:i}):i===void 0?e.addEventListener(t,n,!1):e.addEventListener(t,n,{passive:i})}function nf(e,t,n,r,i){var a=r;if(!(t&1)&&!(t&2)&&r!==null)a:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var c=r.stateNode.containerInfo;if(c===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&s.stateNode.containerInfo===i)return;s=s.return}for(;c!==null;){if(s=yt(c),s===null)return;if(l=s.tag,l===5||l===6||l===26||l===27){r=a=s;continue a}c=c.parentNode}}r=r.return}dn(function(){var r=a,i=on(n),s=[];a:{var c=si.get(e);if(c!==void 0){var l=Tn,u=e;switch(e){case`keypress`:if(bn(n)===0)break a;case`keydown`:case`keyup`:l=Jn;break;case`focusin`:u=`focus`,l=Fn;break;case`focusout`:u=`blur`,l=Fn;break;case`beforeblur`:case`afterblur`:l=Fn;break;case`click`:if(n.button===2)break a;case`auxclick`:case`dblclick`:case`mousedown`:case`mousemove`:case`mouseup`:case`mouseout`:case`mouseover`:case`contextmenu`:l=jn;break;case`drag`:case`dragend`:case`dragenter`:case`dragexit`:case`dragleave`:case`dragover`:case`dragstart`:case`drop`:l=Nn;break;case`touchcancel`:case`touchend`:case`touchmove`:case`touchstart`:l=Qn;break;case ei:case ti:case ni:l=Ln;break;case oi:l=er;break;case`scroll`:case`scrollend`:l=M;break;case`wheel`:l=nr;break;case`copy`:case`cut`:case`paste`:l=zn;break;case`gotpointercapture`:case`lostpointercapture`:case`pointercancel`:case`pointerdown`:case`pointermove`:case`pointerout`:case`pointerover`:case`pointerup`:l=Xn;break;case`toggle`:case`beforetoggle`:l=ir}var d=(t&4)!=0,f=!d&&(e===`scroll`||e===`scrollend`),p=d?c===null?null:c+`Capture`:c;d=[];for(var m=r,h;m!==null;){var g=m;if(h=g.stateNode,g=g.tag,g!==5&&g!==26&&g!==27||h===null||p===null||(g=fn(m,p),g!=null&&d.push(rf(m,g,h))),f)break;m=m.return}0<d.length&&(c=new l(c,u,null,n,i),s.push({event:c,listeners:d}))}}if(!(t&7)){a:{if(c=e===`mouseover`||e===`pointerover`,l=e===`mouseout`||e===`pointerout`,c&&n!==an&&(u=n.relatedTarget||n.fromElement)&&(yt(u)||u[ft]))break a;if((l||c)&&(c=i.window===i?i:(c=i.ownerDocument)?c.defaultView||c.parentWindow:window,l?(u=n.relatedTarget||n.toElement,l=r,u=u?yt(u):null,u!==null&&(f=o(u),d=u.tag,u!==f||d!==5&&d!==27&&d!==6)&&(u=null)):(l=null,u=r),l!==u)){if(d=jn,g=`onMouseLeave`,p=`onMouseEnter`,m=`mouse`,(e===`pointerout`||e===`pointerover`)&&(d=Xn,g=`onPointerLeave`,p=`onPointerEnter`,m=`pointer`),f=l==null?c:xt(l),h=u==null?c:xt(u),c=new d(g,m+`leave`,l,n,i),c.target=f,c.relatedTarget=h,g=null,yt(i)===r&&(d=new d(p,m+`enter`,u,n,i),d.target=h,d.relatedTarget=f,g=d),f=g,l&&u)b:{for(d=sf,p=l,m=u,h=0,g=p;g;g=d(g))h++;g=0;for(var _=m;_;_=d(_))g++;for(;0<h-g;)p=d(p),h--;for(;0<g-h;)m=d(m),g--;for(;h--;){if(p===m||m!==null&&p===m.alternate){d=p;break b}p=d(p),m=d(m)}d=null}else d=null;l!==null&&cf(s,c,l,d,!1),u!==null&&f!==null&&cf(s,f,u,d,!0)}}a:{if(c=r?xt(r):window,l=c.nodeName&&c.nodeName.toLowerCase(),l===`select`||l===`input`&&c.type===`file`)var v=wr;else if(vr(c))if(Tr)v=Pr;else{v=Mr;var y=jr}else l=c.nodeName,!l||l.toLowerCase()!==`input`||c.type!==`checkbox`&&c.type!==`radio`?r&&$t(r.elementType)&&(v=wr):v=Nr;if(v&&=v(e,r)){yr(s,v,n,i);break a}y&&y(e,c,r),e===`focusout`&&r&&c.type===`number`&&r.memoizedProps.value!=null&&Gt(c,`number`,c.value)}switch(y=r?xt(r):window,e){case`focusin`:(vr(y)||y.contentEditable===`true`)&&(Wr=y,Gr=r,Kr=null);break;case`focusout`:Kr=Gr=Wr=null;break;case`mousedown`:qr=!0;break;case`contextmenu`:case`mouseup`:case`dragend`:qr=!1,Jr(s,n,i);break;case`selectionchange`:if(Ur)break;case`keydown`:case`keyup`:Jr(s,n,i)}var b;if(or)b:{switch(e){case`compositionstart`:var x=`onCompositionStart`;break b;case`compositionend`:x=`onCompositionEnd`;break b;case`compositionupdate`:x=`onCompositionUpdate`;break b}x=void 0}else mr?fr(e,n)&&(x=`onCompositionEnd`):e===`keydown`&&n.keyCode===229&&(x=`onCompositionStart`);x&&(lr&&n.locale!==`ko`&&(mr||x!==`onCompositionStart`?x===`onCompositionEnd`&&mr&&(b=yn()):(gn=i,_n=`value`in gn?gn.value:gn.textContent,mr=!0)),y=af(r,x),0<y.length&&(x=new Vn(x,e,null,n,i),s.push({event:x,listeners:y}),b?x.data=b:(b=pr(n),b!==null&&(x.data=b)))),(b=cr?hr(e,n):gr(e,n))&&(x=af(r,`onBeforeInput`),0<x.length&&(y=new Vn(`onBeforeInput`,`beforeinput`,null,n,i),s.push({event:y,listeners:x}),y.data=b)),Ud(s,e,r,n,i)}Xd(s,t)})}function rf(e,t,n){return{instance:e,listener:t,currentTarget:n}}function af(e,t){for(var n=t+`Capture`,r=[];e!==null;){var i=e,a=i.stateNode;if(i=i.tag,i!==5&&i!==26&&i!==27||a===null||(i=fn(e,n),i!=null&&r.unshift(rf(e,i,a)),i=fn(e,t),i!=null&&r.push(rf(e,i,a))),e.tag===3)return r;e=e.return}return[]}function sf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function cf(e,t,n,r,i){for(var a=t._reactName,o=[];n!==null&&n!==r;){var s=n,c=s.alternate,l=s.stateNode;if(s=s.tag,c!==null&&c===r)break;s!==5&&s!==26&&s!==27||l===null||(c=l,i?(l=fn(n,a),l!=null&&o.unshift(rf(n,l,c))):i||(l=fn(n,a),l!=null&&o.push(rf(n,l,c)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var lf=/\r\n?/g,uf=/\u0000|\uFFFD/g;function df(e){return(typeof e==`string`?e:``+e).replace(lf,`
`).replace(uf,``)}function ff(e,t){return t=df(t),df(e)===t}function pf(e,t,n,r,a,o){switch(n){case`children`:typeof r==`string`?t===`body`||t===`textarea`&&r===``||Yt(e,r):(typeof r==`number`||typeof r==`bigint`)&&t!==`body`&&Yt(e,``+r);break;case`className`:Nt(e,`class`,r);break;case`tabIndex`:Nt(e,`tabindex`,r);break;case`dir`:case`role`:case`viewBox`:case`width`:case`height`:Nt(e,n,r);break;case`style`:Qt(e,r,o);break;case`data`:if(t!==`object`){Nt(e,`data`,r);break}case`src`:case`href`:if(r===``&&(t!==`a`||n!==`href`)){e.removeAttribute(n);break}if(r==null||typeof r==`function`||typeof r==`symbol`||typeof r==`boolean`){e.removeAttribute(n);break}r=nn(``+r),e.setAttribute(n,r);break;case`action`:case`formAction`:if(typeof r==`function`){e.setAttribute(n,`javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')`);break}else typeof o==`function`&&(n===`formAction`?(t!==`input`&&pf(e,t,`name`,a.name,a,null),pf(e,t,`formEncType`,a.formEncType,a,null),pf(e,t,`formMethod`,a.formMethod,a,null),pf(e,t,`formTarget`,a.formTarget,a,null)):(pf(e,t,`encType`,a.encType,a,null),pf(e,t,`method`,a.method,a,null),pf(e,t,`target`,a.target,a,null)));if(r==null||typeof r==`symbol`||typeof r==`boolean`){e.removeAttribute(n);break}r=nn(``+r),e.setAttribute(n,r);break;case`onClick`:r!=null&&(e.onclick=rn);break;case`onScroll`:r!=null&&Zd(`scroll`,e);break;case`onScrollEnd`:r!=null&&Zd(`scrollend`,e);break;case`dangerouslySetInnerHTML`:if(r!=null){if(typeof r!=`object`||!(`__html`in r))throw Error(i(61));if(n=r.__html,n!=null){if(a.children!=null)throw Error(i(60));e.innerHTML=n}}break;case`multiple`:e.multiple=r&&typeof r!=`function`&&typeof r!=`symbol`;break;case`muted`:e.muted=r&&typeof r!=`function`&&typeof r!=`symbol`;break;case`suppressContentEditableWarning`:case`suppressHydrationWarning`:case`defaultValue`:case`defaultChecked`:case`innerHTML`:case`ref`:break;case`autoFocus`:break;case`xlinkHref`:if(r==null||typeof r==`function`||typeof r==`boolean`||typeof r==`symbol`){e.removeAttribute(`xlink:href`);break}n=nn(``+r),e.setAttributeNS(`http://www.w3.org/1999/xlink`,`xlink:href`,n);break;case`contentEditable`:case`spellCheck`:case`draggable`:case`value`:case`autoReverse`:case`externalResourcesRequired`:case`focusable`:case`preserveAlpha`:r!=null&&typeof r!=`function`&&typeof r!=`symbol`?e.setAttribute(n,``+r):e.removeAttribute(n);break;case`inert`:case`allowFullScreen`:case`async`:case`autoPlay`:case`controls`:case`default`:case`defer`:case`disabled`:case`disablePictureInPicture`:case`disableRemotePlayback`:case`formNoValidate`:case`hidden`:case`loop`:case`noModule`:case`noValidate`:case`open`:case`playsInline`:case`readOnly`:case`required`:case`reversed`:case`scoped`:case`seamless`:case`itemScope`:r&&typeof r!=`function`&&typeof r!=`symbol`?e.setAttribute(n,``):e.removeAttribute(n);break;case`capture`:case`download`:!0===r?e.setAttribute(n,``):!1!==r&&r!=null&&typeof r!=`function`&&typeof r!=`symbol`?e.setAttribute(n,r):e.removeAttribute(n);break;case`cols`:case`rows`:case`size`:case`span`:r!=null&&typeof r!=`function`&&typeof r!=`symbol`&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case`rowSpan`:case`start`:r==null||typeof r==`function`||typeof r==`symbol`||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case`popover`:Zd(`beforetoggle`,e),Zd(`toggle`,e),Mt(e,`popover`,r);break;case`xlinkActuate`:Pt(e,`http://www.w3.org/1999/xlink`,`xlink:actuate`,r);break;case`xlinkArcrole`:Pt(e,`http://www.w3.org/1999/xlink`,`xlink:arcrole`,r);break;case`xlinkRole`:Pt(e,`http://www.w3.org/1999/xlink`,`xlink:role`,r);break;case`xlinkShow`:Pt(e,`http://www.w3.org/1999/xlink`,`xlink:show`,r);break;case`xlinkTitle`:Pt(e,`http://www.w3.org/1999/xlink`,`xlink:title`,r);break;case`xlinkType`:Pt(e,`http://www.w3.org/1999/xlink`,`xlink:type`,r);break;case`xmlBase`:Pt(e,`http://www.w3.org/XML/1998/namespace`,`xml:base`,r);break;case`xmlLang`:Pt(e,`http://www.w3.org/XML/1998/namespace`,`xml:lang`,r);break;case`xmlSpace`:Pt(e,`http://www.w3.org/XML/1998/namespace`,`xml:space`,r);break;case`is`:Mt(e,`is`,r);break;case`innerText`:case`textContent`:break;default:(!(2<n.length)||n[0]!==`o`&&n[0]!==`O`||n[1]!==`n`&&n[1]!==`N`)&&(n=en.get(n)||n,Mt(e,n,r))}}function mf(e,t,n,r,a,o){switch(n){case`style`:Qt(e,r,o);break;case`dangerouslySetInnerHTML`:if(r!=null){if(typeof r!=`object`||!(`__html`in r))throw Error(i(61));if(n=r.__html,n!=null){if(a.children!=null)throw Error(i(60));e.innerHTML=n}}break;case`children`:typeof r==`string`?Yt(e,r):(typeof r==`number`||typeof r==`bigint`)&&Yt(e,``+r);break;case`onScroll`:r!=null&&Zd(`scroll`,e);break;case`onScrollEnd`:r!=null&&Zd(`scrollend`,e);break;case`onClick`:r!=null&&(e.onclick=rn);break;case`suppressContentEditableWarning`:case`suppressHydrationWarning`:case`innerHTML`:case`ref`:break;case`innerText`:case`textContent`:break;default:if(!Tt.hasOwnProperty(n))a:{if(n[0]===`o`&&n[1]===`n`&&(a=n.endsWith(`Capture`),t=n.slice(2,a?n.length-7:void 0),o=e[dt]||null,o=o==null?null:o[n],typeof o==`function`&&e.removeEventListener(t,o,a),typeof r==`function`)){typeof o!=`function`&&o!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,a);break a}n in e?e[n]=r:!0===r?e.setAttribute(n,``):Mt(e,n,r)}}}function hf(e,t,n){switch(t){case`div`:case`span`:case`svg`:case`path`:case`a`:case`g`:case`p`:case`li`:break;case`img`:Zd(`error`,e),Zd(`load`,e);var r=!1,a=!1,o;for(o in n)if(n.hasOwnProperty(o)){var s=n[o];if(s!=null)switch(o){case`src`:r=!0;break;case`srcSet`:a=!0;break;case`children`:case`dangerouslySetInnerHTML`:throw Error(i(137,t));default:pf(e,t,o,s,n,null)}}a&&pf(e,t,`srcSet`,n.srcSet,n,null),r&&pf(e,t,`src`,n.src,n,null);return;case`input`:Zd(`invalid`,e);var c=o=s=a=null,l=null,u=null;for(r in n)if(n.hasOwnProperty(r)){var d=n[r];if(d!=null)switch(r){case`name`:a=d;break;case`type`:s=d;break;case`checked`:l=d;break;case`defaultChecked`:u=d;break;case`value`:o=d;break;case`defaultValue`:c=d;break;case`children`:case`dangerouslySetInnerHTML`:if(d!=null)throw Error(i(137,t));break;default:pf(e,t,r,d,n,null)}}Wt(e,o,c,l,u,s,a,!1);return;case`select`:for(a in Zd(`invalid`,e),r=s=o=null,n)if(n.hasOwnProperty(a)&&(c=n[a],c!=null))switch(a){case`value`:o=c;break;case`defaultValue`:s=c;break;case`multiple`:r=c;default:pf(e,t,a,c,n,null)}t=o,n=s,e.multiple=!!r,t==null?n!=null&&Kt(e,!!r,n,!0):Kt(e,!!r,t,!1);return;case`textarea`:for(s in Zd(`invalid`,e),o=a=r=null,n)if(n.hasOwnProperty(s)&&(c=n[s],c!=null))switch(s){case`value`:r=c;break;case`defaultValue`:a=c;break;case`children`:o=c;break;case`dangerouslySetInnerHTML`:if(c!=null)throw Error(i(91));break;default:pf(e,t,s,c,n,null)}Jt(e,r,a,o);return;case`option`:for(l in n)if(n.hasOwnProperty(l)&&(r=n[l],r!=null))switch(l){case`selected`:e.selected=r&&typeof r!=`function`&&typeof r!=`symbol`;break;default:pf(e,t,l,r,n,null)}return;case`dialog`:Zd(`beforetoggle`,e),Zd(`toggle`,e),Zd(`cancel`,e),Zd(`close`,e);break;case`iframe`:case`object`:Zd(`load`,e);break;case`video`:case`audio`:for(r=0;r<Jd.length;r++)Zd(Jd[r],e);break;case`image`:Zd(`error`,e),Zd(`load`,e);break;case`details`:Zd(`toggle`,e);break;case`embed`:case`source`:case`link`:Zd(`error`,e),Zd(`load`,e);case`area`:case`base`:case`br`:case`col`:case`hr`:case`keygen`:case`meta`:case`param`:case`track`:case`wbr`:case`menuitem`:for(u in n)if(n.hasOwnProperty(u)&&(r=n[u],r!=null))switch(u){case`children`:case`dangerouslySetInnerHTML`:throw Error(i(137,t));default:pf(e,t,u,r,n,null)}return;default:if($t(t)){for(d in n)n.hasOwnProperty(d)&&(r=n[d],r!==void 0&&mf(e,t,d,r,n,void 0));return}}for(c in n)n.hasOwnProperty(c)&&(r=n[c],r!=null&&pf(e,t,c,r,n,null))}function gf(e,t,n,r){switch(t){case`div`:case`span`:case`svg`:case`path`:case`a`:case`g`:case`p`:case`li`:break;case`input`:var a=null,o=null,s=null,c=null,l=null,u=null,d=null;for(m in n){var f=n[m];if(n.hasOwnProperty(m)&&f!=null)switch(m){case`checked`:break;case`value`:break;case`defaultValue`:l=f;default:r.hasOwnProperty(m)||pf(e,t,m,null,r,f)}}for(var p in r){var m=r[p];if(f=n[p],r.hasOwnProperty(p)&&(m!=null||f!=null))switch(p){case`type`:o=m;break;case`name`:a=m;break;case`checked`:u=m;break;case`defaultChecked`:d=m;break;case`value`:s=m;break;case`defaultValue`:c=m;break;case`children`:case`dangerouslySetInnerHTML`:if(m!=null)throw Error(i(137,t));break;default:m!==f&&pf(e,t,p,m,r,f)}}Ut(e,s,c,l,u,d,o,a);return;case`select`:for(o in m=s=c=p=null,n)if(l=n[o],n.hasOwnProperty(o)&&l!=null)switch(o){case`value`:break;case`multiple`:m=l;default:r.hasOwnProperty(o)||pf(e,t,o,null,r,l)}for(a in r)if(o=r[a],l=n[a],r.hasOwnProperty(a)&&(o!=null||l!=null))switch(a){case`value`:p=o;break;case`defaultValue`:c=o;break;case`multiple`:s=o;default:o!==l&&pf(e,t,a,o,r,l)}t=c,n=s,r=m,p==null?!!r!=!!n&&(t==null?Kt(e,!!n,n?[]:``,!1):Kt(e,!!n,t,!0)):Kt(e,!!n,p,!1);return;case`textarea`:for(c in m=p=null,n)if(a=n[c],n.hasOwnProperty(c)&&a!=null&&!r.hasOwnProperty(c))switch(c){case`value`:break;case`children`:break;default:pf(e,t,c,null,r,a)}for(s in r)if(a=r[s],o=n[s],r.hasOwnProperty(s)&&(a!=null||o!=null))switch(s){case`value`:p=a;break;case`defaultValue`:m=a;break;case`children`:break;case`dangerouslySetInnerHTML`:if(a!=null)throw Error(i(91));break;default:a!==o&&pf(e,t,s,a,r,o)}qt(e,p,m);return;case`option`:for(var h in n)if(p=n[h],n.hasOwnProperty(h)&&p!=null&&!r.hasOwnProperty(h))switch(h){case`selected`:e.selected=!1;break;default:pf(e,t,h,null,r,p)}for(l in r)if(p=r[l],m=n[l],r.hasOwnProperty(l)&&p!==m&&(p!=null||m!=null))switch(l){case`selected`:e.selected=p&&typeof p!=`function`&&typeof p!=`symbol`;break;default:pf(e,t,l,p,r,m)}return;case`img`:case`link`:case`area`:case`base`:case`br`:case`col`:case`embed`:case`hr`:case`keygen`:case`meta`:case`param`:case`source`:case`track`:case`wbr`:case`menuitem`:for(var g in n)p=n[g],n.hasOwnProperty(g)&&p!=null&&!r.hasOwnProperty(g)&&pf(e,t,g,null,r,p);for(u in r)if(p=r[u],m=n[u],r.hasOwnProperty(u)&&p!==m&&(p!=null||m!=null))switch(u){case`children`:case`dangerouslySetInnerHTML`:if(p!=null)throw Error(i(137,t));break;default:pf(e,t,u,p,r,m)}return;default:if($t(t)){for(var _ in n)p=n[_],n.hasOwnProperty(_)&&p!==void 0&&!r.hasOwnProperty(_)&&mf(e,t,_,void 0,r,p);for(d in r)p=r[d],m=n[d],!r.hasOwnProperty(d)||p===m||p===void 0&&m===void 0||mf(e,t,d,p,r,m);return}}for(var v in n)p=n[v],n.hasOwnProperty(v)&&p!=null&&!r.hasOwnProperty(v)&&pf(e,t,v,null,r,p);for(f in r)p=r[f],m=n[f],!r.hasOwnProperty(f)||p===m||p==null&&m==null||pf(e,t,f,p,r,m)}function _f(e){switch(e){case`css`:case`script`:case`font`:case`img`:case`image`:case`input`:case`link`:return!0;default:return!1}}function vf(){if(typeof performance.getEntriesByType==`function`){for(var e=0,t=0,n=performance.getEntriesByType(`resource`),r=0;r<n.length;r++){var i=n[r],a=i.transferSize,o=i.initiatorType,s=i.duration;if(a&&s&&_f(o)){for(o=0,s=i.responseEnd,r+=1;r<n.length;r++){var c=n[r],l=c.startTime;if(l>s)break;var u=c.transferSize,d=c.initiatorType;u&&_f(d)&&(c=c.responseEnd,o+=u*(c<s?1:(s-l)/(c-l)))}if(--r,t+=8*(a+o)/(i.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e==`number`)?e:5}var yf=null,bf=null;function xf(e){return e.nodeType===9?e:e.ownerDocument}function Sf(e){switch(e){case`http://www.w3.org/2000/svg`:return 1;case`http://www.w3.org/1998/Math/MathML`:return 2;default:return 0}}function Cf(e,t){if(e===0)switch(t){case`svg`:return 1;case`math`:return 2;default:return 0}return e===1&&t===`foreignObject`?0:e}function wf(e,t){return e===`textarea`||e===`noscript`||typeof t.children==`string`||typeof t.children==`number`||typeof t.children==`bigint`||typeof t.dangerouslySetInnerHTML==`object`&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Tf=null;function Ef(){var e=window.event;return e&&e.type===`popstate`?e===Tf?!1:(Tf=e,!0):(Tf=null,!1)}var Df=typeof setTimeout==`function`?setTimeout:void 0,Of=typeof clearTimeout==`function`?clearTimeout:void 0,kf=typeof Promise==`function`?Promise:void 0,Af=typeof queueMicrotask==`function`?queueMicrotask:kf===void 0?Df:function(e){return kf.resolve(null).then(e).catch(jf)};function jf(e){setTimeout(function(){throw e})}function Mf(e){return e===`head`}function Nf(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n===`/$`||n===`/&`){if(r===0){e.removeChild(i),pm(t);return}r--}else if(n===`$`||n===`$?`||n===`$~`||n===`$!`||n===`&`)r++;else if(n===`html`)qf(e.ownerDocument.documentElement);else if(n===`head`){n=e.ownerDocument.head,qf(n);for(var a=n.firstChild;a;){var o=a.nextSibling,s=a.nodeName;a[_t]||s===`SCRIPT`||s===`STYLE`||s===`LINK`&&a.rel.toLowerCase()===`stylesheet`||n.removeChild(a),a=o}}else n===`body`&&qf(e.ownerDocument.body);n=i}while(n);pm(t)}function Pf(e,t){var n=e;e=0;do{var r=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display=`none`):(n.style.display=n._stashedDisplay||``,n.getAttribute(`style`)===``&&n.removeAttribute(`style`)):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=``):n.nodeValue=n._stashedText||``),r&&r.nodeType===8)if(n=r.data,n===`/$`){if(e===0)break;e--}else n!==`$`&&n!==`$?`&&n!==`$~`&&n!==`$!`||e++;n=r}while(n)}function Ff(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case`HTML`:case`HEAD`:case`BODY`:Ff(n),vt(n);continue;case`SCRIPT`:case`STYLE`:continue;case`LINK`:if(n.rel.toLowerCase()===`stylesheet`)continue}e.removeChild(n)}}function If(e,t,n,r){for(;e.nodeType===1;){var i=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&(e.nodeName!==`INPUT`||e.type!==`hidden`))break}else if(r){if(!e[_t])switch(t){case`meta`:if(!e.hasAttribute(`itemprop`))break;return e;case`link`:if(a=e.getAttribute(`rel`),a===`stylesheet`&&e.hasAttribute(`data-precedence`)||a!==i.rel||e.getAttribute(`href`)!==(i.href==null||i.href===``?null:i.href)||e.getAttribute(`crossorigin`)!==(i.crossOrigin==null?null:i.crossOrigin)||e.getAttribute(`title`)!==(i.title==null?null:i.title))break;return e;case`style`:if(e.hasAttribute(`data-precedence`))break;return e;case`script`:if(a=e.getAttribute(`src`),(a!==(i.src==null?null:i.src)||e.getAttribute(`type`)!==(i.type==null?null:i.type)||e.getAttribute(`crossorigin`)!==(i.crossOrigin==null?null:i.crossOrigin))&&a&&e.hasAttribute(`async`)&&!e.hasAttribute(`itemprop`))break;return e;default:return e}}else if(t===`input`&&e.type===`hidden`){var a=i.name==null?null:``+i.name;if(i.type===`hidden`&&e.getAttribute(`name`)===a)return e}else return e;if(e=Hf(e.nextSibling),e===null)break}return null}function Lf(e,t,n){if(t===``)return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!==`INPUT`||e.type!==`hidden`)&&!n||(e=Hf(e.nextSibling),e===null))return null;return e}function Rf(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!==`INPUT`||e.type!==`hidden`)&&!t||(e=Hf(e.nextSibling),e===null))return null;return e}function zf(e){return e.data===`$?`||e.data===`$~`}function Bf(e){return e.data===`$!`||e.data===`$?`&&e.ownerDocument.readyState!==`loading`}function Vf(e,t){var n=e.ownerDocument;if(e.data===`$~`)e._reactRetry=t;else if(e.data!==`$?`||n.readyState!==`loading`)t();else{var r=function(){t(),n.removeEventListener(`DOMContentLoaded`,r)};n.addEventListener(`DOMContentLoaded`,r),e._reactRetry=r}}function Hf(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t===`$`||t===`$!`||t===`$?`||t===`$~`||t===`&`||t===`F!`||t===`F`)break;if(t===`/$`||t===`/&`)return null}}return e}var Uf=null;function Wf(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n===`/$`||n===`/&`){if(t===0)return Hf(e.nextSibling);t--}else n!==`$`&&n!==`$!`&&n!==`$?`&&n!==`$~`&&n!==`&`||t++}e=e.nextSibling}return null}function Gf(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n===`$`||n===`$!`||n===`$?`||n===`$~`||n===`&`){if(t===0)return e;t--}else n!==`/$`&&n!==`/&`||t++}e=e.previousSibling}return null}function Kf(e,t,n){switch(t=xf(n),e){case`html`:if(e=t.documentElement,!e)throw Error(i(452));return e;case`head`:if(e=t.head,!e)throw Error(i(453));return e;case`body`:if(e=t.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function qf(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);vt(e)}var Jf=new Map,Yf=new Set;function Xf(e){return typeof e.getRootNode==`function`?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Zf=j.d;j.d={f:Qf,r:$f,D:np,C:rp,L:ip,m:ap,X:sp,S:op,M:cp};function Qf(){var e=Zf.f(),t=Ju();return e||t}function $f(e){var t=bt(e);t!==null&&t.tag===5&&t.type===`form`?qs(t):Zf.r(e)}var ep=typeof document>`u`?null:document;function tp(e,t,n){var r=ep;if(r&&typeof t==`string`&&t){var i=Ht(t);i=`link[rel="`+e+`"][href="`+i+`"]`,typeof n==`string`&&(i+=`[crossorigin="`+n+`"]`),Yf.has(i)||(Yf.add(i),e={rel:e,crossOrigin:n,href:t},r.querySelector(i)===null&&(t=r.createElement(`link`),hf(t,`link`,e),Ct(t),r.head.appendChild(t)))}}function np(e){Zf.D(e),tp(`dns-prefetch`,e,null)}function rp(e,t){Zf.C(e,t),tp(`preconnect`,e,t)}function ip(e,t,n){Zf.L(e,t,n);var r=ep;if(r&&e&&t){var i=`link[rel="preload"][as="`+Ht(t)+`"]`;t===`image`&&n&&n.imageSrcSet?(i+=`[imagesrcset="`+Ht(n.imageSrcSet)+`"]`,typeof n.imageSizes==`string`&&(i+=`[imagesizes="`+Ht(n.imageSizes)+`"]`)):i+=`[href="`+Ht(e)+`"]`;var a=i;switch(t){case`style`:a=up(e);break;case`script`:a=mp(e)}Jf.has(a)||(e=f({rel:`preload`,href:t===`image`&&n&&n.imageSrcSet?void 0:e,as:t},n),Jf.set(a,e),r.querySelector(i)!==null||t===`style`&&r.querySelector(dp(a))||t===`script`&&r.querySelector(hp(a))||(t=r.createElement(`link`),hf(t,`link`,e),Ct(t),r.head.appendChild(t)))}}function ap(e,t){Zf.m(e,t);var n=ep;if(n&&e){var r=t&&typeof t.as==`string`?t.as:`script`,i=`link[rel="modulepreload"][as="`+Ht(r)+`"][href="`+Ht(e)+`"]`,a=i;switch(r){case`audioworklet`:case`paintworklet`:case`serviceworker`:case`sharedworker`:case`worker`:case`script`:a=mp(e)}if(!Jf.has(a)&&(e=f({rel:`modulepreload`,href:e},t),Jf.set(a,e),n.querySelector(i)===null)){switch(r){case`audioworklet`:case`paintworklet`:case`serviceworker`:case`sharedworker`:case`worker`:case`script`:if(n.querySelector(hp(a)))return}r=n.createElement(`link`),hf(r,`link`,e),Ct(r),n.head.appendChild(r)}}}function op(e,t,n){Zf.S(e,t,n);var r=ep;if(r&&e){var i=St(r).hoistableStyles,a=up(e);t||=`default`;var o=i.get(a);if(!o){var s={loading:0,preload:null};if(o=r.querySelector(dp(a)))s.loading=5;else{e=f({rel:`stylesheet`,href:e,"data-precedence":t},n),(n=Jf.get(a))&&vp(e,n);var c=o=r.createElement(`link`);Ct(c),hf(c,`link`,e),c._p=new Promise(function(e,t){c.onload=e,c.onerror=t}),c.addEventListener(`load`,function(){s.loading|=1}),c.addEventListener(`error`,function(){s.loading|=2}),s.loading|=4,_p(o,t,r)}o={type:`stylesheet`,instance:o,count:1,state:s},i.set(a,o)}}}function sp(e,t){Zf.X(e,t);var n=ep;if(n&&e){var r=St(n).hoistableScripts,i=mp(e),a=r.get(i);a||(a=n.querySelector(hp(i)),a||(e=f({src:e,async:!0},t),(t=Jf.get(i))&&yp(e,t),a=n.createElement(`script`),Ct(a),hf(a,`link`,e),n.head.appendChild(a)),a={type:`script`,instance:a,count:1,state:null},r.set(i,a))}}function cp(e,t){Zf.M(e,t);var n=ep;if(n&&e){var r=St(n).hoistableScripts,i=mp(e),a=r.get(i);a||(a=n.querySelector(hp(i)),a||(e=f({src:e,async:!0,type:`module`},t),(t=Jf.get(i))&&yp(e,t),a=n.createElement(`script`),Ct(a),hf(a,`link`,e),n.head.appendChild(a)),a={type:`script`,instance:a,count:1,state:null},r.set(i,a))}}function lp(e,t,n,r){var a=(a=de.current)?Xf(a):null;if(!a)throw Error(i(446));switch(e){case`meta`:case`title`:return null;case`style`:return typeof n.precedence==`string`&&typeof n.href==`string`?(t=up(n.href),n=St(a).hoistableStyles,r=n.get(t),r||(r={type:`style`,instance:null,count:0,state:null},n.set(t,r)),r):{type:`void`,instance:null,count:0,state:null};case`link`:if(n.rel===`stylesheet`&&typeof n.href==`string`&&typeof n.precedence==`string`){e=up(n.href);var o=St(a).hoistableStyles,s=o.get(e);if(s||(a=a.ownerDocument||a,s={type:`stylesheet`,instance:null,count:0,state:{loading:0,preload:null}},o.set(e,s),(o=a.querySelector(dp(e)))&&!o._p&&(s.instance=o,s.state.loading=5),Jf.has(e)||(n={rel:`preload`,as:`style`,href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Jf.set(e,n),o||pp(a,e,n,s.state))),t&&r===null)throw Error(i(528,``));return s}if(t&&r!==null)throw Error(i(529,``));return null;case`script`:return t=n.async,n=n.src,typeof n==`string`&&t&&typeof t!=`function`&&typeof t!=`symbol`?(t=mp(n),n=St(a).hoistableScripts,r=n.get(t),r||(r={type:`script`,instance:null,count:0,state:null},n.set(t,r)),r):{type:`void`,instance:null,count:0,state:null};default:throw Error(i(444,e))}}function up(e){return`href="`+Ht(e)+`"`}function dp(e){return`link[rel="stylesheet"][`+e+`]`}function fp(e){return f({},e,{"data-precedence":e.precedence,precedence:null})}function pp(e,t,n,r){e.querySelector(`link[rel="preload"][as="style"][`+t+`]`)?r.loading=1:(t=e.createElement(`link`),r.preload=t,t.addEventListener(`load`,function(){return r.loading|=1}),t.addEventListener(`error`,function(){return r.loading|=2}),hf(t,`link`,n),Ct(t),e.head.appendChild(t))}function mp(e){return`[src="`+Ht(e)+`"]`}function hp(e){return`script[async]`+e}function gp(e,t,n){if(t.count++,t.instance===null)switch(t.type){case`style`:var r=e.querySelector(`style[data-href~="`+Ht(n.href)+`"]`);if(r)return t.instance=r,Ct(r),r;var a=f({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return r=(e.ownerDocument||e).createElement(`style`),Ct(r),hf(r,`style`,a),_p(r,n.precedence,e),t.instance=r;case`stylesheet`:a=up(n.href);var o=e.querySelector(dp(a));if(o)return t.state.loading|=4,t.instance=o,Ct(o),o;r=fp(n),(a=Jf.get(a))&&vp(r,a),o=(e.ownerDocument||e).createElement(`link`),Ct(o);var s=o;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),hf(o,`link`,r),t.state.loading|=4,_p(o,n.precedence,e),t.instance=o;case`script`:return o=mp(n.src),(a=e.querySelector(hp(o)))?(t.instance=a,Ct(a),a):(r=n,(a=Jf.get(o))&&(r=f({},n),yp(r,a)),e=e.ownerDocument||e,a=e.createElement(`script`),Ct(a),hf(a,`link`,r),e.head.appendChild(a),t.instance=a);case`void`:return null;default:throw Error(i(443,t.type))}else t.type===`stylesheet`&&!(t.state.loading&4)&&(r=t.instance,t.state.loading|=4,_p(r,n.precedence,e));return t.instance}function _p(e,t,n){for(var r=n.querySelectorAll(`link[rel="stylesheet"][data-precedence],style[data-precedence]`),i=r.length?r[r.length-1]:null,a=i,o=0;o<r.length;o++){var s=r[o];if(s.dataset.precedence===t)a=s;else if(a!==i)break}a?a.parentNode.insertBefore(e,a.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function vp(e,t){e.crossOrigin??=t.crossOrigin,e.referrerPolicy??=t.referrerPolicy,e.title??=t.title}function yp(e,t){e.crossOrigin??=t.crossOrigin,e.referrerPolicy??=t.referrerPolicy,e.integrity??=t.integrity}var bp=null;function xp(e,t,n){if(bp===null){var r=new Map,i=bp=new Map;i.set(n,r)}else i=bp,r=i.get(n),r||(r=new Map,i.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),i=0;i<n.length;i++){var a=n[i];if(!(a[_t]||a[ut]||e===`link`&&a.getAttribute(`rel`)===`stylesheet`)&&a.namespaceURI!==`http://www.w3.org/2000/svg`){var o=a.getAttribute(t)||``;o=e+o;var s=r.get(o);s?s.push(a):r.set(o,[a])}}return r}function Sp(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t===`title`?e.querySelector(`head > title`):null)}function Cp(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case`meta`:case`title`:return!0;case`style`:if(typeof t.precedence!=`string`||typeof t.href!=`string`||t.href===``)break;return!0;case`link`:if(typeof t.rel!=`string`||typeof t.href!=`string`||t.href===``||t.onLoad||t.onError)break;switch(t.rel){case`stylesheet`:return e=t.disabled,typeof t.precedence==`string`&&e==null;default:return!0}case`script`:if(t.async&&typeof t.async!=`function`&&typeof t.async!=`symbol`&&!t.onLoad&&!t.onError&&t.src&&typeof t.src==`string`)return!0}return!1}function wp(e){return!(e.type===`stylesheet`&&!(e.state.loading&3))}function Tp(e,t,n,r){if(n.type===`stylesheet`&&(typeof r.media!=`string`||!1!==matchMedia(r.media).matches)&&!(n.state.loading&4)){if(n.instance===null){var i=up(r.href),a=t.querySelector(dp(i));if(a){t=a._p,typeof t==`object`&&t&&typeof t.then==`function`&&(e.count++,e=Op.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=a,Ct(a);return}a=t.ownerDocument||t,r=fp(r),(i=Jf.get(i))&&vp(r,i),a=a.createElement(`link`),Ct(a);var o=a;o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),hf(a,`link`,r),n.instance=a}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&!(n.state.loading&3)&&(e.count++,n=Op.bind(e),t.addEventListener(`load`,n),t.addEventListener(`error`,n))}}var Ep=0;function Dp(e,t){return e.stylesheets&&e.count===0&&Ap(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&Ap(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&Ep===0&&(Ep=62500*vf());var i=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&Ap(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>Ep?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(i)}}:null}function Op(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ap(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var kp=null;function Ap(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,kp=new Map,t.forEach(jp,e),kp=null,Op.call(e))}function jp(e,t){if(!(t.state.loading&4)){var n=kp.get(e);if(n)var r=n.get(null);else{n=new Map,kp.set(e,n);for(var i=e.querySelectorAll(`link[data-precedence],style[data-precedence]`),a=0;a<i.length;a++){var o=i[a];(o.nodeName===`LINK`||o.getAttribute(`media`)!==`not all`)&&(n.set(o.dataset.precedence,o),r=o)}r&&n.set(null,r)}i=t.instance,o=i.getAttribute(`data-precedence`),a=n.get(o)||r,a===r&&n.set(null,i),n.set(o,i),this.count++,r=Op.bind(this),i.addEventListener(`load`,r),i.addEventListener(`error`,r),a?a.parentNode.insertBefore(i,a.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(i,e.firstChild)),t.state.loading|=4}}var Mp={$$typeof:b,Provider:null,Consumer:null,_currentValue:re,_currentValue2:re,_threadCount:0};function Np(e,t,n,r,i,a,o,s,c){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=$e(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$e(0),this.hiddenUpdates=$e(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=a,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=c,this.incompleteTransitions=new Map}function Pp(e,t,n,r,i,a,o,s,c,l,u,d){return e=new Np(e,t,n,o,c,l,u,d,s),t=1,!0===a&&(t|=24),a=Si(3,null,null,t),e.current=a,a.stateNode=e,t=Ca(),t.refCount++,e.pooledCache=t,t.refCount++,a.memoizedState={element:r,isDehydrated:n,cache:t},no(a),e}function Fp(e){return e?(e=bi,e):bi}function Ip(e,t,n,r,i,a){i=Fp(i),r.context===null?r.context=i:r.pendingContext=i,r=io(t),r.payload={element:n},a=a===void 0?null:a,a!==null&&(r.callback=a),n=ao(e,r,t),n!==null&&(Uu(n,e,t),oo(n,e,t))}function Lp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Rp(e,t){Lp(e,t),(e=e.alternate)&&Lp(e,t)}function zp(e){if(e.tag===13||e.tag===31){var t=_i(e,67108864);t!==null&&Uu(t,e,67108864),Rp(e,67108864)}}function Bp(e){if(e.tag===13||e.tag===31){var t=Vu();t=at(t);var n=_i(e,t);n!==null&&Uu(n,e,t),Rp(e,t)}}var Vp=!0;function Hp(e,t,n,r){var i=A.T;A.T=null;var a=j.p;try{j.p=2,Wp(e,t,n,r)}finally{j.p=a,A.T=i}}function Up(e,t,n,r){var i=A.T;A.T=null;var a=j.p;try{j.p=8,Wp(e,t,n,r)}finally{j.p=a,A.T=i}}function Wp(e,t,n,r){if(Vp){var i=Gp(r);if(i===null)nf(e,t,r,Kp,n),rm(e,r);else if(am(i,e,t,n,r))r.stopPropagation();else if(rm(e,r),t&4&&-1<nm.indexOf(e)){for(;i!==null;){var a=bt(i);if(a!==null)switch(a.tag){case 3:if(a=a.stateNode,a.current.memoizedState.isDehydrated){var o=Je(a.pendingLanes);if(o!==0){var s=a;for(s.pendingLanes|=2,s.entangledLanes|=2;o;){var c=1<<31-Ve(o);s.entanglements[1]|=c,o&=~c}Md(a),!(cu&6)&&(ku=ke()+500,Nd(0,!1))}}break;case 31:case 13:s=_i(a,2),s!==null&&Uu(s,a,2),Ju(),Rp(a,2)}if(a=Gp(r),a===null&&nf(e,t,r,Kp,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else nf(e,t,r,null,n)}}function Gp(e){return e=on(e),qp(e)}var Kp=null;function qp(e){if(Kp=null,e=yt(e),e!==null){var t=o(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=s(t),e!==null)return e;e=null}else if(n===31){if(e=c(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Kp=e,null}function Jp(e){switch(e){case`beforetoggle`:case`cancel`:case`click`:case`close`:case`contextmenu`:case`copy`:case`cut`:case`auxclick`:case`dblclick`:case`dragend`:case`dragstart`:case`drop`:case`focusin`:case`focusout`:case`input`:case`invalid`:case`keydown`:case`keypress`:case`keyup`:case`mousedown`:case`mouseup`:case`paste`:case`pause`:case`play`:case`pointercancel`:case`pointerdown`:case`pointerup`:case`ratechange`:case`reset`:case`resize`:case`seeked`:case`submit`:case`toggle`:case`touchcancel`:case`touchend`:case`touchstart`:case`volumechange`:case`change`:case`selectionchange`:case`textInput`:case`compositionstart`:case`compositionend`:case`compositionupdate`:case`beforeblur`:case`afterblur`:case`beforeinput`:case`blur`:case`fullscreenchange`:case`focus`:case`hashchange`:case`popstate`:case`select`:case`selectstart`:return 2;case`drag`:case`dragenter`:case`dragexit`:case`dragleave`:case`dragover`:case`mousemove`:case`mouseout`:case`mouseover`:case`pointermove`:case`pointerout`:case`pointerover`:case`scroll`:case`touchmove`:case`wheel`:case`mouseenter`:case`mouseleave`:case`pointerenter`:case`pointerleave`:return 8;case`message`:switch(Ae()){case je:return 2;case Me:return 8;case Ne:case Pe:return 32;case Fe:return 268435456;default:return 32}default:return 32}}var Yp=!1,Xp=null,Zp=null,Qp=null,$p=new Map,em=new Map,tm=[],nm=`mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset`.split(` `);function rm(e,t){switch(e){case`focusin`:case`focusout`:Xp=null;break;case`dragenter`:case`dragleave`:Zp=null;break;case`mouseover`:case`mouseout`:Qp=null;break;case`pointerover`:case`pointerout`:$p.delete(t.pointerId);break;case`gotpointercapture`:case`lostpointercapture`:em.delete(t.pointerId)}}function im(e,t,n,r,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},t!==null&&(t=bt(t),t!==null&&zp(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function am(e,t,n,r,i){switch(t){case`focusin`:return Xp=im(Xp,e,t,n,r,i),!0;case`dragenter`:return Zp=im(Zp,e,t,n,r,i),!0;case`mouseover`:return Qp=im(Qp,e,t,n,r,i),!0;case`pointerover`:var a=i.pointerId;return $p.set(a,im($p.get(a)||null,e,t,n,r,i)),!0;case`gotpointercapture`:return a=i.pointerId,em.set(a,im(em.get(a)||null,e,t,n,r,i)),!0}return!1}function om(e){var t=yt(e.target);if(t!==null){var n=o(t);if(n!==null){if(t=n.tag,t===13){if(t=s(n),t!==null){e.blockedOn=t,ct(e.priority,function(){Bp(n)});return}}else if(t===31){if(t=c(n),t!==null){e.blockedOn=t,ct(e.priority,function(){Bp(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function sm(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Gp(e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);an=r,n.target.dispatchEvent(r),an=null}else return t=bt(n),t!==null&&zp(t),e.blockedOn=n,!1;t.shift()}return!0}function cm(e,t,n){sm(e)&&n.delete(t)}function lm(){Yp=!1,Xp!==null&&sm(Xp)&&(Xp=null),Zp!==null&&sm(Zp)&&(Zp=null),Qp!==null&&sm(Qp)&&(Qp=null),$p.forEach(cm),em.forEach(cm)}function um(e,n){e.blockedOn===n&&(e.blockedOn=null,Yp||(Yp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,lm)))}var dm=null;function fm(e){dm!==e&&(dm=e,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){dm===e&&(dm=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],i=e[t+2];if(typeof r!=`function`){if(qp(r||n)===null)continue;break}var a=bt(n);a!==null&&(e.splice(t,3),t-=3,Gs(a,{pending:!0,data:i,method:n.method,action:r},r,i))}}))}function pm(e){function t(t){return um(t,e)}Xp!==null&&um(Xp,e),Zp!==null&&um(Zp,e),Qp!==null&&um(Qp,e),$p.forEach(t),em.forEach(t);for(var n=0;n<tm.length;n++){var r=tm[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<tm.length&&(n=tm[0],n.blockedOn===null);)om(n),n.blockedOn===null&&tm.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(r=0;r<n.length;r+=3){var i=n[r],a=n[r+1],o=i[dt]||null;if(typeof a==`function`)o||fm(n);else if(o){var s=null;if(a&&a.hasAttribute(`formAction`)){if(i=a,o=a[dt]||null)s=o.formAction;else if(qp(i)!==null)continue}else s=o.action;typeof s==`function`?n[r+1]=s:(n.splice(r,3),r-=3),fm(n)}}}function mm(){function e(e){e.canIntercept&&e.info===`react-transition`&&e.intercept({handler:function(){return new Promise(function(e){return i=e})},focusReset:`manual`,scroll:`manual`})}function t(){i!==null&&(i(),i=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var e=navigation.currentEntry;e&&e.url!=null&&navigation.navigate(e.url,{state:e.getState(),info:`react-transition`,history:`replace`})}}if(typeof navigation==`object`){var r=!1,i=null;return navigation.addEventListener(`navigate`,e),navigation.addEventListener(`navigatesuccess`,t),navigation.addEventListener(`navigateerror`,t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener(`navigate`,e),navigation.removeEventListener(`navigatesuccess`,t),navigation.removeEventListener(`navigateerror`,t),i!==null&&(i(),i=null)}}}function hm(e){this._internalRoot=e}gm.prototype.render=hm.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(i(409));var n=t.current,r=Vu();Ip(n,r,e,t,null,null)},gm.prototype.unmount=hm.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ip(e.current,2,null,e,null,null),Ju(),t[ft]=null}};function gm(e){this._internalRoot=e}gm.prototype.unstable_scheduleHydration=function(e){if(e){var t=st();e={blockedOn:null,target:e,priority:t};for(var n=0;n<tm.length&&t!==0&&t<tm[n].priority;n++);tm.splice(n,0,e),n===0&&om(e)}};var _m=n.version;if(_m!==`19.2.0`)throw Error(i(527,_m,`19.2.0`));j.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render==`function`?Error(i(188)):(e=Object.keys(e).join(`,`),Error(i(268,e)));return e=u(t),e=e===null?null:d(e),e=e===null?null:e.stateNode,e};var vm={bundleType:0,version:`19.2.0`,rendererPackageName:`react-dom`,currentDispatcherRef:A,reconcilerVersion:`19.2.0`};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<`u`){var ym=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ym.isDisabled&&ym.supportsFiber)try{Re=ym.inject(vm),ze=ym}catch{}}e.createRoot=function(e,t){if(!a(e))throw Error(i(299));var n=!1,r=``,o=mc,s=hc,c=gc;return t!=null&&(!0===t.unstable_strictMode&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onUncaughtError!==void 0&&(o=t.onUncaughtError),t.onCaughtError!==void 0&&(s=t.onCaughtError),t.onRecoverableError!==void 0&&(c=t.onRecoverableError)),t=Pp(e,1,!1,null,null,n,r,null,o,s,c,mm),e[ft]=t.current,ef(e),new hm(t)}})),bae=l(o(((e,t)=>{function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>`u`||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!=`function`))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}n(),t.exports=yae()}))()),xae=`modulepreload`,Sae=function(e){return`/Taller-P/`+e},tC={};const Cae=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=document.getElementsByTagName(`link`),i=document.querySelector(`meta[property=csp-nonce]`),a=i?.nonce||i?.getAttribute(`nonce`);function o(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:`fulfilled`,value:e}),e=>({status:`rejected`,reason:e}))))}r=o(t.map(t=>{if(t=Sae(t,n),t in tC)return;tC[t]=!0;let r=t.endsWith(`.css`),i=r?`[rel="stylesheet"]`:``;if(n)for(let n=e.length-1;n>=0;n--){let i=e[n];if(i.href===t&&(!r||i.rel===`stylesheet`))return}else if(document.querySelector(`link[href="${t}"]${i}`))return;let o=document.createElement(`link`);if(o.rel=r?`stylesheet`:xae,r||(o.as=`script`),o.crossOrigin=``,o.href=t,a&&o.setAttribute(`nonce`,a),document.head.appendChild(o),r)return new Promise((e,n)=>{o.addEventListener(`load`,e),o.addEventListener(`error`,()=>n(Error(`Unable to preload CSS for ${t}`)))})}))}function i(e){let t=new Event(`vite:preloadError`,{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(let e of t||[])e.status===`rejected`&&i(e.reason);return e().catch(i)})};var nC=`popstate`;function wae(e={}){function t(e,t){let{pathname:n,search:r,hash:i}=e.location;return oC(``,{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||`default`)}function n(e,t){return typeof t==`string`?t:sC(t)}return Eae(t,n,null,e)}function rC(e,t){if(e===!1||e==null)throw Error(t)}function iC(e,t){if(!e){typeof console<`u`&&console.warn(t);try{throw Error(t)}catch{}}}function Tae(){return Math.random().toString(36).substring(2,10)}function aC(e,t){return{usr:e.state,key:e.key,idx:t}}function oC(e,t,n=null,r){return{pathname:typeof e==`string`?e:e.pathname,search:``,hash:``,...typeof t==`string`?cC(t):t,state:n,key:t&&t.key||r||Tae()}}function sC({pathname:e=`/`,search:t=``,hash:n=``}){return t&&t!==`?`&&(e+=t.charAt(0)===`?`?t:`?`+t),n&&n!==`#`&&(e+=n.charAt(0)===`#`?n:`#`+n),e}function cC(e){let t={};if(e){let n=e.indexOf(`#`);n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf(`?`);r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function Eae(e,t,n,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,s=`POP`,c=null,l=u();l??(l=0,o.replaceState({...o.state,idx:l},``));function u(){return(o.state||{idx:null}).idx}function d(){s=`POP`;let e=u(),t=e==null?null:e-l;l=e,c&&c({action:s,location:h.location,delta:t})}function f(e,t){s=`PUSH`;let r=oC(h.location,e,t);n&&n(r,e),l=u()+1;let d=aC(r,l),f=h.createHref(r);try{o.pushState(d,``,f)}catch(e){if(e instanceof DOMException&&e.name===`DataCloneError`)throw e;i.location.assign(f)}a&&c&&c({action:s,location:h.location,delta:1})}function p(e,t){s=`REPLACE`;let r=oC(h.location,e,t);n&&n(r,e),l=u();let i=aC(r,l),d=h.createHref(r);o.replaceState(i,``,d),a&&c&&c({action:s,location:h.location,delta:0})}function m(e){return Dae(e)}let h={get action(){return s},get location(){return e(i,o)},listen(e){if(c)throw Error(`A history only accepts one active listener`);return i.addEventListener(nC,d),c=e,()=>{i.removeEventListener(nC,d),c=null}},createHref(e){return t(i,e)},createURL:m,encodeLocation(e){let t=m(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:f,replace:p,go(e){return o.go(e)}};return h}function Dae(e,t=!1){let n=`http://localhost`;typeof window<`u`&&(n=window.location.origin===`null`?window.location.href:window.location.origin),rC(n,`No window.location.(origin|href) available to create URL`);let r=typeof e==`string`?e:sC(e);return r=r.replace(/ $/,`%20`),!t&&r.startsWith(`//`)&&(r=n+r),new URL(r,n)}function lC(e,t,n=`/`){return Oae(e,t,n,!1)}function Oae(e,t,n,r){let i=typeof t==`string`?cC(t):t,a=mC(i.pathname||`/`,n);if(a==null)return null;let o=uC(e);Aae(o);let s=null;for(let e=0;s==null&&e<o.length;++e){let t=Vae(a);s=zae(o[e],t,r)}return s}function kae(e,t){let{route:n,pathname:r,params:i}=e;return{id:n.id,pathname:r,params:i,data:t[n.id],loaderData:t[n.id],handle:n.handle}}function uC(e,t=[],n=[],r=``,i=!1){let a=(e,a,o=i,s)=>{let c={relativePath:s===void 0?e.path||``:s,caseSensitive:e.caseSensitive===!0,childrenIndex:a,route:e};if(c.relativePath.startsWith(`/`)){if(!c.relativePath.startsWith(r)&&o)return;rC(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length)}let l=vC([r,c.relativePath]),u=n.concat(c);e.children&&e.children.length>0&&(rC(e.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),uC(e.children,t,u,l,o)),!(e.path==null&&!e.index)&&t.push({path:l,score:Lae(l,e.index),routesMeta:u})};return e.forEach((e,t)=>{if(e.path===``||!e.path?.includes(`?`))a(e,t);else for(let n of dC(e.path))a(e,t,!0,n)}),t}function dC(e){let t=e.split(`/`);if(t.length===0)return[];let[n,...r]=t,i=n.endsWith(`?`),a=n.replace(/\?$/,``);if(r.length===0)return i?[a,``]:[a];let o=dC(r.join(`/`)),s=[];return s.push(...o.map(e=>e===``?a:[a,e].join(`/`))),i&&s.push(...o),s.map(t=>e.startsWith(`/`)&&t===``?`/`:t)}function Aae(e){e.sort((e,t)=>e.score===t.score?Rae(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)):t.score-e.score)}var jae=/^:[\w-]+$/,Mae=3,Nae=2,Pae=1,Fae=10,Iae=-2,fC=e=>e===`*`;function Lae(e,t){let n=e.split(`/`),r=n.length;return n.some(fC)&&(r+=Iae),t&&(r+=Nae),n.filter(e=>!fC(e)).reduce((e,t)=>e+(jae.test(t)?Mae:t===``?Pae:Fae),r)}function Rae(e,t){return e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n])?e[e.length-1]-t[t.length-1]:0}function zae(e,t,n=!1){let{routesMeta:r}=e,i={},a=`/`,o=[];for(let e=0;e<r.length;++e){let s=r[e],c=e===r.length-1,l=a===`/`?t:t.slice(a.length)||`/`,u=pC({path:s.relativePath,caseSensitive:s.caseSensitive,end:c},l),d=s.route;if(!u&&c&&n&&!r[r.length-1].route.index&&(u=pC({path:s.relativePath,caseSensitive:s.caseSensitive,end:!1},l)),!u)return null;Object.assign(i,u.params),o.push({params:i,pathname:vC([a,u.pathname]),pathnameBase:Gae(vC([a,u.pathnameBase])),route:d}),u.pathnameBase!==`/`&&(a=vC([a,u.pathnameBase]))}return o}function pC(e,t){typeof e==`string`&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=Bae(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,`$1`),s=i.slice(1);return{params:r.reduce((e,{paramName:t,isOptional:n},r)=>{if(t===`*`){let e=s[r]||``;o=a.slice(0,a.length-e.length).replace(/(.)\/+$/,`$1`)}let i=s[r];return n&&!i?e[t]=void 0:e[t]=(i||``).replace(/%2F/g,`/`),e},{}),pathname:a,pathnameBase:o,pattern:e}}function Bae(e,t=!1,n=!0){iC(e===`*`||!e.endsWith(`*`)||e.endsWith(`/*`),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,`/*`)}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,`/*`)}".`);let r=[],i=`^`+e.replace(/\/*\*?$/,``).replace(/^\/*/,`/`).replace(/[\\.*+^${}|()[\]]/g,`\\$&`).replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:n!=null}),n?`/?([^\\/]+)?`:`/([^\\/]+)`)).replace(/\/([\w-]+)\?(\/|$)/g,`(/$1)?$2`);return e.endsWith(`*`)?(r.push({paramName:`*`}),i+=e===`*`||e===`/*`?`(.*)$`:`(?:\\/(.+)|\\/*)$`):n?i+=`\\/*$`:e!==``&&e!==`/`&&(i+=`(?:(?=\\/|$))`),[new RegExp(i,t?void 0:`i`),r]}function Vae(e){try{return e.split(`/`).map(e=>decodeURIComponent(e).replace(/\//g,`%2F`)).join(`/`)}catch(t){return iC(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function mC(e,t){if(t===`/`)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith(`/`)?t.length-1:t.length,r=e.charAt(n);return r&&r!==`/`?null:e.slice(n)||`/`}function Hae(e,t=`/`){let{pathname:n,search:r=``,hash:i=``}=typeof e==`string`?cC(e):e;return{pathname:n?n.startsWith(`/`)?n:Uae(n,t):t,search:Kae(r),hash:qae(i)}}function Uae(e,t){let n=t.replace(/\/+$/,``).split(`/`);return e.split(`/`).forEach(e=>{e===`..`?n.length>1&&n.pop():e!==`.`&&n.push(e)}),n.length>1?n.join(`/`):`/`}function hC(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Wae(e){return e.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function gC(e){let t=Wae(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function _C(e,t,n,r=!1){let i;typeof e==`string`?i=cC(e):(i={...e},rC(!i.pathname||!i.pathname.includes(`?`),hC(`?`,`pathname`,`search`,i)),rC(!i.pathname||!i.pathname.includes(`#`),hC(`#`,`pathname`,`hash`,i)),rC(!i.search||!i.search.includes(`#`),hC(`#`,`search`,`hash`,i)));let a=e===``||i.pathname===``,o=a?`/`:i.pathname,s;if(o==null)s=n;else{let e=t.length-1;if(!r&&o.startsWith(`..`)){let t=o.split(`/`);for(;t[0]===`..`;)t.shift(),--e;i.pathname=t.join(`/`)}s=e>=0?t[e]:`/`}let c=Hae(i,s),l=o&&o!==`/`&&o.endsWith(`/`),u=(a||o===`.`)&&n.endsWith(`/`);return!c.pathname.endsWith(`/`)&&(l||u)&&(c.pathname+=`/`),c}var vC=e=>e.join(`/`).replace(/\/\/+/g,`/`),Gae=e=>e.replace(/\/+$/,``).replace(/^\/*/,`/`),Kae=e=>!e||e===`?`?``:e.startsWith(`?`)?e:`?`+e,qae=e=>!e||e===`#`?``:e.startsWith(`#`)?e:`#`+e;function Jae(e){return e!=null&&typeof e.status==`number`&&typeof e.statusText==`string`&&typeof e.internal==`boolean`&&`data`in e}var yC=N.createContext(null);yC.displayName=`DataRouter`;var bC=N.createContext(null);bC.displayName=`DataRouterState`,N.createContext(!1);var xC=N.createContext({isTransitioning:!1});xC.displayName=`ViewTransition`;var Yae=N.createContext(new Map);Yae.displayName=`Fetchers`;var Xae=N.createContext(null);Xae.displayName=`Await`;var SC=N.createContext(null);SC.displayName=`Navigation`;var CC=N.createContext(null);CC.displayName=`Location`;var wC=N.createContext({outlet:null,matches:[],isDataRoute:!1});wC.displayName=`Route`;var TC=N.createContext(null);TC.displayName=`RouteError`;function Zae(e,{relative:t}={}){rC(EC(),`useHref() may be used only in the context of a <Router> component.`);let{basename:n,navigator:r}=N.useContext(SC),{hash:i,pathname:a,search:o}=jC(e,{relative:t}),s=a;return n!==`/`&&(s=a===`/`?n:vC([n,a])),r.createHref({pathname:s,search:o,hash:i})}function EC(){return N.useContext(CC)!=null}function DC(){return rC(EC(),`useLocation() may be used only in the context of a <Router> component.`),N.useContext(CC).location}var OC=`You should call navigate() in a React.useEffect(), not when your component is first rendered.`;function kC(e){N.useContext(SC).static||N.useLayoutEffect(e)}function AC(){let{isDataRoute:e}=N.useContext(wC);return e?doe():Qae()}function Qae(){rC(EC(),`useNavigate() may be used only in the context of a <Router> component.`);let e=N.useContext(yC),{basename:t,navigator:n}=N.useContext(SC),{matches:r}=N.useContext(wC),{pathname:i}=DC(),a=JSON.stringify(gC(r)),o=N.useRef(!1);return kC(()=>{o.current=!0}),N.useCallback((r,s={})=>{if(iC(o.current,OC),!o.current)return;if(typeof r==`number`){n.go(r);return}let c=_C(r,JSON.parse(a),i,s.relative===`path`);e==null&&t!==`/`&&(c.pathname=c.pathname===`/`?t:vC([t,c.pathname])),(s.replace?n.replace:n.push)(c,s.state,s)},[t,n,a,i,e])}N.createContext(null);function $ae(){let{matches:e}=N.useContext(wC),t=e[e.length-1];return t?t.params:{}}function jC(e,{relative:t}={}){let{matches:n}=N.useContext(wC),{pathname:r}=DC(),i=JSON.stringify(gC(n));return N.useMemo(()=>_C(e,JSON.parse(i),r,t===`path`),[e,i,r,t])}function eoe(e,t){return MC(e,t)}function MC(e,t,n,r,i){rC(EC(),`useRoutes() may be used only in the context of a <Router> component.`);let{navigator:a}=N.useContext(SC),{matches:o}=N.useContext(wC),s=o[o.length-1],c=s?s.params:{},l=s?s.pathname:`/`,u=s?s.pathnameBase:`/`,d=s&&s.route;{let e=d&&d.path||``;RC(l,!d||e.endsWith(`*`)||e.endsWith(`*?`),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${e}"> to <Route path="${e===`/`?`*`:`${e}/*`}">.`)}let f=DC(),p;if(t){let e=typeof t==`string`?cC(t):t;rC(u===`/`||e.pathname?.startsWith(u),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${e.pathname}" was given in the \`location\` prop.`),p=e}else p=f;let m=p.pathname||`/`,h=m;if(u!==`/`){let e=u.replace(/^\//,``).split(`/`);h=`/`+m.replace(/^\//,``).split(`/`).slice(e.length).join(`/`)}let g=lC(e,{pathname:h});iC(d||g!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),iC(g==null||g[g.length-1].route.element!==void 0||g[g.length-1].route.Component!==void 0||g[g.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let _=aoe(g&&g.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:vC([u,a.encodeLocation?a.encodeLocation(e.pathname.replace(/\?/g,`%3F`).replace(/#/g,`%23`)).pathname:e.pathname]),pathnameBase:e.pathnameBase===`/`?u:vC([u,a.encodeLocation?a.encodeLocation(e.pathnameBase.replace(/\?/g,`%3F`).replace(/#/g,`%23`)).pathname:e.pathnameBase])})),o,n,r,i);return t&&_?N.createElement(CC.Provider,{value:{location:{pathname:`/`,search:``,hash:``,state:null,key:`default`,...p},navigationType:`POP`}},_):_}function toe(){let e=uoe(),t=Jae(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r=`rgba(200,200,200, 0.5)`,i={padding:`0.5rem`,backgroundColor:r},a={padding:`2px 4px`,backgroundColor:r},o=null;return console.error(`Error handled by React Router default ErrorBoundary:`,e),o=N.createElement(N.Fragment,null,N.createElement(`p`,null,` Hey developer `),N.createElement(`p`,null,`You can provide a way better UX than this when your app throws errors by providing your own `,N.createElement(`code`,{style:a},`ErrorBoundary`),` or`,` `,N.createElement(`code`,{style:a},`errorElement`),` prop on your route.`)),N.createElement(N.Fragment,null,N.createElement(`h2`,null,`Unexpected Application Error!`),N.createElement(`h3`,{style:{fontStyle:`italic`}},t),n?N.createElement(`pre`,{style:i},n):null,o)}var noe=N.createElement(toe,null),roe=class extends N.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!==`idle`&&e.revalidation===`idle`?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error===void 0?t.error:e.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error(`React Router caught the following error during render`,e)}render(){return this.state.error===void 0?this.props.children:N.createElement(wC.Provider,{value:this.props.routeContext},N.createElement(TC.Provider,{value:this.state.error,children:this.props.component}))}};function ioe({routeContext:e,match:t,children:n}){let r=N.useContext(yC);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),N.createElement(wC.Provider,{value:e},n)}function aoe(e,t=[],n=null,r=null,i=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,o=n?.errors;if(o!=null){let e=a.findIndex(e=>e.route.id&&o?.[e.route.id]!==void 0);rC(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(`,`)}`),a=a.slice(0,Math.min(a.length,e+1))}let s=!1,c=-1;if(n)for(let e=0;e<a.length;e++){let t=a[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(c=e),t.route.id){let{loaderData:e,errors:r}=n,i=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!r||r[t.route.id]===void 0);if(t.route.lazy||i){s=!0,a=c>=0?a.slice(0,c+1):[a[0]];break}}}return a.reduceRight((e,i,l)=>{let u,d=!1,f=null,p=null;n&&(u=o&&i.route.id?o[i.route.id]:void 0,f=i.route.errorElement||noe,s&&(c<0&&l===0?(RC(`route-fallback`,!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,p=null):c===l&&(d=!0,p=i.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,l+1)),h=()=>{let t;return t=u?f:d?p:i.route.Component?N.createElement(i.route.Component,null):i.route.element?i.route.element:e,N.createElement(ioe,{match:i,routeContext:{outlet:e,matches:m,isDataRoute:n!=null},children:t})};return n&&(i.route.ErrorBoundary||i.route.errorElement||l===0)?N.createElement(roe,{location:n.location,revalidation:n.revalidation,component:f,error:u,children:h(),routeContext:{outlet:null,matches:m,isDataRoute:!0},unstable_onError:r}):h()},null)}function NC(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ooe(e){let t=N.useContext(yC);return rC(t,NC(e)),t}function PC(e){let t=N.useContext(bC);return rC(t,NC(e)),t}function soe(e){let t=N.useContext(wC);return rC(t,NC(e)),t}function FC(e){let t=soe(e),n=t.matches[t.matches.length-1];return rC(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function coe(){return FC(`useRouteId`)}function loe(){return PC(`useNavigation`).navigation}function IC(){let{matches:e,loaderData:t}=PC(`useMatches`);return N.useMemo(()=>e.map(e=>kae(e,t)),[e,t])}function uoe(){let e=N.useContext(TC),t=PC(`useRouteError`),n=FC(`useRouteError`);return e===void 0?t.errors?.[n]:e}function doe(){let{router:e}=ooe(`useNavigate`),t=FC(`useNavigate`),n=N.useRef(!1);return kC(()=>{n.current=!0}),N.useCallback(async(r,i={})=>{iC(n.current,OC),n.current&&(typeof r==`number`?e.navigate(r):await e.navigate(r,{fromRouteId:t,...i}))},[e,t])}var LC={};function RC(e,t,n){!t&&!LC[e]&&(LC[e]=!0,iC(!1,n))}N.memo(foe);function foe({routes:e,future:t,state:n,unstable_onError:r}){return MC(e,void 0,n,r,t)}function poe({to:e,replace:t,state:n,relative:r}){rC(EC(),`<Navigate> may be used only in the context of a <Router> component.`);let{static:i}=N.useContext(SC);iC(!i,`<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.`);let{matches:a}=N.useContext(wC),{pathname:o}=DC(),s=AC(),c=_C(e,gC(a),o,r===`path`),l=JSON.stringify(c);return N.useEffect(()=>{s(JSON.parse(l),{replace:t,state:n,relative:r})},[s,l,r,t,n]),null}function zC(e){rC(!1,`A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.`)}function BC({basename:e=`/`,children:t=null,location:n,navigationType:r=`POP`,navigator:i,static:a=!1}){rC(!EC(),`You cannot render a <Router> inside another <Router>. You should never have more than one in your app.`);let o=e.replace(/^\/*/,`/`),s=N.useMemo(()=>({basename:o,navigator:i,static:a,future:{}}),[o,i,a]);typeof n==`string`&&(n=cC(n));let{pathname:c=`/`,search:l=``,hash:u=``,state:d=null,key:f=`default`}=n,p=N.useMemo(()=>{let e=mC(c,o);return e==null?null:{location:{pathname:e,search:l,hash:u,state:d,key:f},navigationType:r}},[o,c,l,u,d,f,r]);return iC(p!=null,`<Router basename="${o}"> is not able to match the URL "${c}${l}${u}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:N.createElement(SC.Provider,{value:s},N.createElement(CC.Provider,{children:t,value:p}))}function moe({children:e,location:t}){return eoe(VC(e),t)}function VC(e,t=[]){let n=[];return N.Children.forEach(e,(e,r)=>{if(!N.isValidElement(e))return;let i=[...t,r];if(e.type===N.Fragment){n.push.apply(n,VC(e.props.children,i));return}rC(e.type===zC,`[${typeof e.type==`string`?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),rC(!e.props.index||!e.props.children,`An index route cannot have child routes.`);let a={id:e.props.id||i.join(`-`),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:e.props.hasErrorBoundary===!0||e.props.ErrorBoundary!=null||e.props.errorElement!=null,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=VC(e.props.children,i)),n.push(a)}),n}var HC=`get`,UC=`application/x-www-form-urlencoded`;function WC(e){return e!=null&&typeof e.tagName==`string`}function hoe(e){return WC(e)&&e.tagName.toLowerCase()===`button`}function goe(e){return WC(e)&&e.tagName.toLowerCase()===`form`}function _oe(e){return WC(e)&&e.tagName.toLowerCase()===`input`}function voe(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function yoe(e,t){return e.button===0&&(!t||t===`_self`)&&!voe(e)}var GC=null;function boe(){if(GC===null)try{new FormData(document.createElement(`form`),0),GC=!1}catch{GC=!0}return GC}var xoe=new Set([`application/x-www-form-urlencoded`,`multipart/form-data`,`text/plain`]);function KC(e){return e!=null&&!xoe.has(e)?(iC(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${UC}"`),null):e}function Soe(e,t){let n,r,i,a,o;if(goe(e)){let o=e.getAttribute(`action`);r=o?mC(o,t):null,n=e.getAttribute(`method`)||HC,i=KC(e.getAttribute(`enctype`))||UC,a=new FormData(e)}else if(hoe(e)||_oe(e)&&(e.type===`submit`||e.type===`image`)){let o=e.form;if(o==null)throw Error(`Cannot submit a <button> or <input type="submit"> without a <form>`);let s=e.getAttribute(`formaction`)||o.getAttribute(`action`);if(r=s?mC(s,t):null,n=e.getAttribute(`formmethod`)||o.getAttribute(`method`)||HC,i=KC(e.getAttribute(`formenctype`))||KC(o.getAttribute(`enctype`))||UC,a=new FormData(o,e),!boe()){let{name:t,type:n,value:r}=e;if(n===`image`){let e=t?`${t}.`:``;a.append(`${e}x`,`0`),a.append(`${e}y`,`0`)}else t&&a.append(t,r)}}else if(WC(e))throw Error(`Cannot submit element that is not <form>, <button>, or <input type="submit|image">`);else n=HC,r=null,i=UC,o=e;return a&&i===`text/plain`&&(o=a,a=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join(`\0`);function qC(e,t){if(e===!1||e==null)throw Error(t)}function Coe(e,t,n){let r=typeof e==`string`?new URL(e,typeof window>`u`?`server://singlefetch/`:window.location.origin):e;return r.pathname===`/`?r.pathname=`_root.${n}`:t&&mC(r.pathname,t)===`/`?r.pathname=`${t.replace(/\/$/,``)}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,``)}.${n}`,r}async function woe(e,t){if(e.id in t)return t[e.id];try{let n=await Cae(()=>import(e.module),[]);return t[e.id]=n,n}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Toe(e){return e!=null&&typeof e.page==`string`}function Eoe(e){return e==null?!1:e.href==null?e.rel===`preload`&&typeof e.imageSrcSet==`string`&&typeof e.imageSizes==`string`:typeof e.rel==`string`&&typeof e.href==`string`}async function Doe(e,t,n){let r=await Promise.all(e.map(async e=>{let r=t.routes[e.route.id];if(r){let e=await woe(r,n);return e.links?e.links():[]}return[]}));return joe(r.flat(1).filter(Eoe).filter(e=>e.rel===`stylesheet`||e.rel===`preload`).map(e=>e.rel===`stylesheet`?{...e,rel:`prefetch`,as:`style`}:{...e,rel:`prefetch`}))}function JC(e,t,n,r,i,a){let o=(e,t)=>n[t]?e.route.id!==n[t].route.id:!0,s=(e,t)=>n[t].pathname!==e.pathname||n[t].route.path?.endsWith(`*`)&&n[t].params[`*`]!==e.params[`*`];return a===`assets`?t.filter((e,t)=>o(e,t)||s(e,t)):a===`data`?t.filter((t,a)=>{let c=r.routes[t.route.id];if(!c||!c.hasLoader)return!1;if(o(t,a)||s(t,a))return!0;if(t.route.shouldRevalidate){let r=t.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if(typeof r==`boolean`)return r}return!0}):[]}function Ooe(e,t,{includeHydrateFallback:n}={}){return koe(e.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let i=[r.module];return r.clientActionModule&&(i=i.concat(r.clientActionModule)),r.clientLoaderModule&&(i=i.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(i=i.concat(r.hydrateFallbackModule)),r.imports&&(i=i.concat(r.imports)),i}).flat(1))}function koe(e){return[...new Set(e)]}function Aoe(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function joe(e,t){let n=new Set,r=new Set(t);return e.reduce((e,i)=>{if(t&&!Toe(i)&&i.as===`script`&&i.href&&r.has(i.href))return e;let a=JSON.stringify(Aoe(i));return n.has(a)||(n.add(a),e.push({key:a,link:i})),e},[])}function YC(){let e=N.useContext(yC);return qC(e,`You must render this element inside a <DataRouterContext.Provider> element`),e}function Moe(){let e=N.useContext(bC);return qC(e,`You must render this element inside a <DataRouterStateContext.Provider> element`),e}var XC=N.createContext(void 0);XC.displayName=`FrameworkContext`;function ZC(){let e=N.useContext(XC);return qC(e,`You must render this element inside a <HydratedRouter> element`),e}function Noe(e,t){let n=N.useContext(XC),[r,i]=N.useState(!1),[a,o]=N.useState(!1),{onFocus:s,onBlur:c,onMouseEnter:l,onMouseLeave:u,onTouchStart:d}=t,f=N.useRef(null);N.useEffect(()=>{if(e===`render`&&o(!0),e===`viewport`){let e=new IntersectionObserver(e=>{e.forEach(e=>{o(e.isIntersecting)})},{threshold:.5});return f.current&&e.observe(f.current),()=>{e.disconnect()}}},[e]),N.useEffect(()=>{if(r){let e=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(e)}}},[r]);let p=()=>{i(!0)},m=()=>{i(!1),o(!1)};return n?e===`intent`?[a,f,{onFocus:QC(s,p),onBlur:QC(c,m),onMouseEnter:QC(l,p),onMouseLeave:QC(u,m),onTouchStart:QC(d,p)}]:[a,f,{}]:[!1,f,{}]}function QC(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function Poe({page:e,...t}){let{router:n}=YC(),r=N.useMemo(()=>lC(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?N.createElement(Ioe,{page:e,matches:r,...t}):null}function Foe(e){let{manifest:t,routeModules:n}=ZC(),[r,i]=N.useState([]);return N.useEffect(()=>{let r=!1;return Doe(e,t,n).then(e=>{r||i(e)}),()=>{r=!0}},[e,t,n]),r}function Ioe({page:e,matches:t,...n}){let r=DC(),{manifest:i,routeModules:a}=ZC(),{basename:o}=YC(),{loaderData:s,matches:c}=Moe(),l=N.useMemo(()=>JC(e,t,c,i,r,`data`),[e,t,c,i,r]),u=N.useMemo(()=>JC(e,t,c,i,r,`assets`),[e,t,c,i,r]),d=N.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let n=new Set,c=!1;if(t.forEach(e=>{let t=i.routes[e.route.id];!t||!t.hasLoader||(!l.some(t=>t.route.id===e.route.id)&&e.route.id in s&&a[e.route.id]?.shouldRevalidate||t.hasClientLoader?c=!0:n.add(e.route.id))}),n.size===0)return[];let u=Coe(e,o,`data`);return c&&n.size>0&&u.searchParams.set(`_routes`,t.filter(e=>n.has(e.route.id)).map(e=>e.route.id).join(`,`)),[u.pathname+u.search]},[o,s,r,i,l,t,e,a]),f=N.useMemo(()=>Ooe(u,i),[u,i]),p=Foe(u);return N.createElement(N.Fragment,null,d.map(e=>N.createElement(`link`,{key:e,rel:`prefetch`,as:`fetch`,href:e,...n})),f.map(e=>N.createElement(`link`,{key:e,rel:`modulepreload`,href:e,...n})),p.map(({key:e,link:t})=>N.createElement(`link`,{key:e,nonce:n.nonce,...t})))}function Loe(...e){return t=>{e.forEach(e=>{typeof e==`function`?e(t):e!=null&&(e.current=t)})}}var $C=typeof window<`u`&&window.document!==void 0&&window.document.createElement!==void 0;try{$C&&(window.__reactRouterVersion=`7.9.4`)}catch{}function Roe({basename:e,children:t,window:n}){let r=N.useRef();r.current??=wae({window:n,v5Compat:!0});let i=r.current,[a,o]=N.useState({action:i.action,location:i.location}),s=N.useCallback(e=>{N.startTransition(()=>o(e))},[o]);return N.useLayoutEffect(()=>i.listen(s),[i,s]),N.createElement(BC,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:i})}function zoe({basename:e,children:t,history:n}){let[r,i]=N.useState({action:n.action,location:n.location}),a=N.useCallback(e=>{N.startTransition(()=>i(e))},[i]);return N.useLayoutEffect(()=>n.listen(a),[n,a]),N.createElement(BC,{basename:e,children:t,location:r.location,navigationType:r.action,navigator:n})}zoe.displayName=`unstable_HistoryRouter`;var ew=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,tw=N.forwardRef(function({onClick:e,discover:t=`render`,prefetch:n=`none`,relative:r,reloadDocument:i,replace:a,state:o,target:s,to:c,preventScrollReset:l,viewTransition:u,...d},f){let{basename:p}=N.useContext(SC),m=typeof c==`string`&&ew.test(c),h,g=!1;if(typeof c==`string`&&m&&(h=c,$C))try{let e=new URL(window.location.href),t=c.startsWith(`//`)?new URL(e.protocol+c):new URL(c),n=mC(t.pathname,p);t.origin===e.origin&&n!=null?c=n+t.search+t.hash:g=!0}catch{iC(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=Zae(c,{relative:r}),[v,y,b]=Noe(n,d),x=Woe(c,{replace:a,state:o,target:s,preventScrollReset:l,relative:r,viewTransition:u});function S(t){e&&e(t),t.defaultPrevented||x(t)}let C=N.createElement(`a`,{...d,...b,href:h||_,onClick:g||i?e:S,ref:Loe(f,y),target:s,"data-discover":!m&&t===`render`?`true`:void 0});return v&&!m?N.createElement(N.Fragment,null,C,N.createElement(Poe,{page:_})):C});tw.displayName=`Link`;var Boe=N.forwardRef(function({"aria-current":e=`page`,caseSensitive:t=!1,className:n=``,end:r=!1,style:i,to:a,viewTransition:o,children:s,...c},l){let u=jC(a,{relative:c.relative}),d=DC(),f=N.useContext(bC),{navigator:p,basename:m}=N.useContext(SC),h=f!=null&&Zoe(u)&&o===!0,g=p.encodeLocation?p.encodeLocation(u).pathname:u.pathname,_=d.pathname,v=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;t||(_=_.toLowerCase(),v=v?v.toLowerCase():null,g=g.toLowerCase()),v&&m&&(v=mC(v,m)||v);let y=g!==`/`&&g.endsWith(`/`)?g.length-1:g.length,b=_===g||!r&&_.startsWith(g)&&_.charAt(y)===`/`,x=v!=null&&(v===g||!r&&v.startsWith(g)&&v.charAt(g.length)===`/`),S={isActive:b,isPending:x,isTransitioning:h},C=b?e:void 0,w;w=typeof n==`function`?n(S):[n,b?`active`:null,x?`pending`:null,h?`transitioning`:null].filter(Boolean).join(` `);let T=typeof i==`function`?i(S):i;return N.createElement(tw,{...c,"aria-current":C,className:w,ref:l,style:T,to:a,viewTransition:o},typeof s==`function`?s(S):s)});Boe.displayName=`NavLink`;var Voe=N.forwardRef(({discover:e=`render`,fetcherKey:t,navigate:n,reloadDocument:r,replace:i,state:a,method:o=HC,action:s,onSubmit:c,relative:l,preventScrollReset:u,viewTransition:d,...f},p)=>{let m=qoe(),h=Joe(s,{relative:l}),g=o.toLowerCase()===`get`?`get`:`post`,_=typeof s==`string`&&ew.test(s);return N.createElement(`form`,{ref:p,method:g,action:h,onSubmit:r?c:e=>{if(c&&c(e),e.defaultPrevented)return;e.preventDefault();let r=e.nativeEvent.submitter,s=r?.getAttribute(`formmethod`)||o;m(r||e.currentTarget,{fetcherKey:t,method:s,navigate:n,replace:i,state:a,relative:l,preventScrollReset:u,viewTransition:d})},...f,"data-discover":!_&&e===`render`?`true`:void 0})});Voe.displayName=`Form`;function Hoe({getKey:e,storageKey:t,...n}){let r=N.useContext(XC),{basename:i}=N.useContext(SC),a=DC(),o=IC();Yoe({getKey:e,storageKey:t});let s=N.useMemo(()=>{if(!r||!e)return null;let t=ow(a,o,i,e);return t===a.key?null:t},[]);if(!r||r.isSpaMode)return null;let c=((e,t)=>{if(!window.history.state||!window.history.state.key){let e=Math.random().toString(32).slice(2);window.history.replaceState({key:e},``)}try{let n=JSON.parse(sessionStorage.getItem(e)||`{}`)[t||window.history.state.key];typeof n==`number`&&window.scrollTo(0,n)}catch(t){console.error(t),sessionStorage.removeItem(e)}}).toString();return N.createElement(`script`,{...n,suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:`(${c})(${JSON.stringify(t||iw)}, ${JSON.stringify(s)})`}})}Hoe.displayName=`ScrollRestoration`;function nw(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function rw(e){let t=N.useContext(yC);return rC(t,nw(e)),t}function Uoe(e){let t=N.useContext(bC);return rC(t,nw(e)),t}function Woe(e,{target:t,replace:n,state:r,preventScrollReset:i,relative:a,viewTransition:o}={}){let s=AC(),c=DC(),l=jC(e,{relative:a});return N.useCallback(u=>{if(yoe(u,t)){u.preventDefault();let t=n===void 0?sC(c)===sC(l):n;s(e,{replace:t,state:r,preventScrollReset:i,relative:a,viewTransition:o})}},[c,s,l,n,r,t,e,i,a,o])}var Goe=0,Koe=()=>`__${String(++Goe)}__`;function qoe(){let{router:e}=rw(`useSubmit`),{basename:t}=N.useContext(SC),n=coe();return N.useCallback(async(r,i={})=>{let{action:a,method:o,encType:s,formData:c,body:l}=Soe(r,t);if(i.navigate===!1){let t=i.fetcherKey||Koe();await e.fetch(t,n,i.action||a,{preventScrollReset:i.preventScrollReset,formData:c,body:l,formMethod:i.method||o,formEncType:i.encType||s,flushSync:i.flushSync})}else await e.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:c,body:l,formMethod:i.method||o,formEncType:i.encType||s,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[e,t,n])}function Joe(e,{relative:t}={}){let{basename:n}=N.useContext(SC),r=N.useContext(wC);rC(r,`useFormAction must be used inside a RouteContext`);let[i]=r.matches.slice(-1),a={...jC(e||`.`,{relative:t})},o=DC();if(e==null){a.search=o.search;let e=new URLSearchParams(a.search),t=e.getAll(`index`);if(t.some(e=>e===``)){e.delete(`index`),t.filter(e=>e).forEach(t=>e.append(`index`,t));let n=e.toString();a.search=n?`?${n}`:``}}return(!e||e===`.`)&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,`?index&`):`?index`),n!==`/`&&(a.pathname=a.pathname===`/`?n:vC([n,a.pathname])),sC(a)}var iw=`react-router-scroll-positions`,aw={};function ow(e,t,n,r){let i=null;return r&&(i=r(n===`/`?e:{...e,pathname:mC(e.pathname,n)||e.pathname},t)),i??=e.key,i}function Yoe({getKey:e,storageKey:t}={}){let{router:n}=rw(`useScrollRestoration`),{restoreScrollPosition:r,preventScrollReset:i}=Uoe(`useScrollRestoration`),{basename:a}=N.useContext(SC),o=DC(),s=IC(),c=loe();N.useEffect(()=>(window.history.scrollRestoration=`manual`,()=>{window.history.scrollRestoration=`auto`}),[]),Xoe(N.useCallback(()=>{if(c.state===`idle`){let t=ow(o,s,a,e);aw[t]=window.scrollY}try{sessionStorage.setItem(t||iw,JSON.stringify(aw))}catch(e){iC(!1,`Failed to save scroll positions in sessionStorage, <ScrollRestoration /> will not work properly (${e}).`)}window.history.scrollRestoration=`auto`},[c.state,e,a,o,s,t])),typeof document<`u`&&(N.useLayoutEffect(()=>{try{let e=sessionStorage.getItem(t||iw);e&&(aw=JSON.parse(e))}catch{}},[t]),N.useLayoutEffect(()=>{let t=n?.enableScrollRestoration(aw,()=>window.scrollY,e?(t,n)=>ow(t,n,a,e):void 0);return()=>t&&t()},[n,a,e]),N.useLayoutEffect(()=>{if(r!==!1){if(typeof r==`number`){window.scrollTo(0,r);return}try{if(o.hash){let e=document.getElementById(decodeURIComponent(o.hash.slice(1)));if(e){e.scrollIntoView();return}}}catch{iC(!1,`"${o.hash.slice(1)}" is not a decodable element ID. The view will not scroll to it.`)}i!==!0&&window.scrollTo(0,0)}},[o,r,i]))}function Xoe(e,t){let{capture:n}=t||{};N.useEffect(()=>{let t=n==null?void 0:{capture:n};return window.addEventListener(`pagehide`,e,t),()=>{window.removeEventListener(`pagehide`,e,t)}},[e,n])}function Zoe(e,{relative:t}={}){let n=N.useContext(xC);rC(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=rw(`useViewTransitionState`),i=jC(e,{relative:t});if(!n.isTransitioning)return!1;let a=mC(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=mC(n.nextLocation.pathname,r)||n.nextLocation.pathname;return pC(i.pathname,o)!=null||pC(i.pathname,a)!=null}function Qoe(){let[e,t]=(0,N.useState)(``),[n,r]=(0,N.useState)(``),[i,a]=(0,N.useState)(null),[o,s]=(0,N.useState)(!1);function c(e){return{"auth/email-already-in-use":`Este correo ya est registrado.`,"auth/invalid-email":`Correo invlido.`,"auth/operation-not-allowed":`Habilita Email/Password en Firebase.`,"auth/weak-password":`La contrasea debe tener al menos 6 caracteres.`,"auth/network-request-failed":`Fallo de red. Verifica tu conexin.`,"auth/popup-blocked":`El navegador bloque la ventana emergente.`,"auth/popup-closed-by-user":`Cerraste el popup antes de terminar.`}[e??``]??`Error: ${e??`desconocido`}`}async function l(t){t.preventDefault(),a(null),s(!0);try{await Wp(YS,e,n),window.location.href=`/`}catch(e){console.error(`Auth login error:`,e?.code,e?.message),a(c(e?.code))}finally{s(!1)}}async function u(){a(null),s(!0);try{await Up(YS,e,n),window.location.href=`/`}catch(e){console.error(`Auth signup error:`,e?.code,e?.message),a(c(e?.code))}finally{s(!1)}}async function d(){a(null),s(!0);try{await pee(YS,pae),window.location.href=`/`}catch(e){console.error(`Google popup error:`,e?.code,e?.message),a(c(e?.code))}finally{s(!1)}}return(0,I.jsx)(`div`,{className:`container py-5`,children:(0,I.jsxs)(`div`,{className:`mx-auto`,style:{maxWidth:420},children:[(0,I.jsx)(`h1`,{className:`mb-3`,children:`Iniciar sesin`}),i&&(0,I.jsx)(`div`,{className:`alert alert-danger`,children:i}),(0,I.jsxs)(`form`,{className:`vstack gap-3`,onSubmit:l,children:[(0,I.jsx)(`input`,{className:`form-control`,placeholder:`Email`,value:e,onChange:e=>t(e.target.value)}),(0,I.jsx)(`input`,{className:`form-control`,type:`password`,placeholder:`Contrasea`,value:n,onChange:e=>r(e.target.value)}),(0,I.jsx)(`button`,{className:`btn btn-primary w-100`,disabled:o,type:`submit`,children:o?`Entrando`:`Entrar`}),(0,I.jsx)(`button`,{className:`btn btn-outline-secondary w-100`,type:`button`,onClick:u,disabled:o,children:`Crear cuenta`}),(0,I.jsxs)(`button`,{className:`btn btn-outline-dark w-100`,type:`button`,onClick:d,disabled:o,children:[(0,I.jsx)(`i`,{className:`bi bi-google me-2`}),` Entrar con Google`]})]})]})})}function $oe(){return(0,I.jsx)(`div`,{className:`app-shell`,children:(0,I.jsx)(`nav`,{className:`navbar navbar-expand bg-white`,children:(0,I.jsxs)(`div`,{className:`container-xxl`,children:[(0,I.jsxs)(`a`,{className:`navbar-brand fw-semibold`,href:`/`,children:[`MindTrack `,(0,I.jsx)(`span`,{className:`text-primary`,children:`Campus`})]}),(0,I.jsxs)(`div`,{className:`ms-auto d-flex gap-2`,children:[(0,I.jsx)(`a`,{className:`btn btn-outline-primary btn-sm btn-pill`,href:`/evaluate/dass21`,children:`DASS-21`}),(0,I.jsx)(`a`,{className:`btn btn-primary btn-sm btn-pill`,href:`/evaluate/pss10`,children:`PSS-10`})]})]})})})}function sw(e){var t,n,r=``;if(typeof e==`string`||typeof e==`number`)r+=e;else if(typeof e==`object`)if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(n=sw(e[t]))&&(r&&(r+=` `),r+=n)}else for(n in e)e[n]&&(r&&(r+=` `),r+=n);return r}function cw(){for(var e,t,n=0,r=``,i=arguments.length;n<i;n++)(e=arguments[n])&&(t=sw(e))&&(r&&(r+=` `),r+=t);return r}var ese=`dangerouslySetInnerHTML.onCopy.onCopyCapture.onCut.onCutCapture.onPaste.onPasteCapture.onCompositionEnd.onCompositionEndCapture.onCompositionStart.onCompositionStartCapture.onCompositionUpdate.onCompositionUpdateCapture.onFocus.onFocusCapture.onBlur.onBlurCapture.onChange.onChangeCapture.onBeforeInput.onBeforeInputCapture.onInput.onInputCapture.onReset.onResetCapture.onSubmit.onSubmitCapture.onInvalid.onInvalidCapture.onLoad.onLoadCapture.onError.onErrorCapture.onKeyDown.onKeyDownCapture.onKeyPress.onKeyPressCapture.onKeyUp.onKeyUpCapture.onAbort.onAbortCapture.onCanPlay.onCanPlayCapture.onCanPlayThrough.onCanPlayThroughCapture.onDurationChange.onDurationChangeCapture.onEmptied.onEmptiedCapture.onEncrypted.onEncryptedCapture.onEnded.onEndedCapture.onLoadedData.onLoadedDataCapture.onLoadedMetadata.onLoadedMetadataCapture.onLoadStart.onLoadStartCapture.onPause.onPauseCapture.onPlay.onPlayCapture.onPlaying.onPlayingCapture.onProgress.onProgressCapture.onRateChange.onRateChangeCapture.onSeeked.onSeekedCapture.onSeeking.onSeekingCapture.onStalled.onStalledCapture.onSuspend.onSuspendCapture.onTimeUpdate.onTimeUpdateCapture.onVolumeChange.onVolumeChangeCapture.onWaiting.onWaitingCapture.onAuxClick.onAuxClickCapture.onClick.onClickCapture.onContextMenu.onContextMenuCapture.onDoubleClick.onDoubleClickCapture.onDrag.onDragCapture.onDragEnd.onDragEndCapture.onDragEnter.onDragEnterCapture.onDragExit.onDragExitCapture.onDragLeave.onDragLeaveCapture.onDragOver.onDragOverCapture.onDragStart.onDragStartCapture.onDrop.onDropCapture.onMouseDown.onMouseDownCapture.onMouseEnter.onMouseLeave.onMouseMove.onMouseMoveCapture.onMouseOut.onMouseOutCapture.onMouseOver.onMouseOverCapture.onMouseUp.onMouseUpCapture.onSelect.onSelectCapture.onTouchCancel.onTouchCancelCapture.onTouchEnd.onTouchEndCapture.onTouchMove.onTouchMoveCapture.onTouchStart.onTouchStartCapture.onPointerDown.onPointerDownCapture.onPointerMove.onPointerMoveCapture.onPointerUp.onPointerUpCapture.onPointerCancel.onPointerCancelCapture.onPointerEnter.onPointerEnterCapture.onPointerLeave.onPointerLeaveCapture.onPointerOver.onPointerOverCapture.onPointerOut.onPointerOutCapture.onGotPointerCapture.onGotPointerCaptureCapture.onLostPointerCapture.onLostPointerCaptureCapture.onScroll.onScrollCapture.onWheel.onWheelCapture.onAnimationStart.onAnimationStartCapture.onAnimationEnd.onAnimationEndCapture.onAnimationIteration.onAnimationIterationCapture.onTransitionEnd.onTransitionEndCapture`.split(`.`);function lw(e){return typeof e==`string`?ese.includes(e):!1}var tse=`aria-activedescendant.aria-atomic.aria-autocomplete.aria-busy.aria-checked.aria-colcount.aria-colindex.aria-colspan.aria-controls.aria-current.aria-describedby.aria-details.aria-disabled.aria-errormessage.aria-expanded.aria-flowto.aria-haspopup.aria-hidden.aria-invalid.aria-keyshortcuts.aria-label.aria-labelledby.aria-level.aria-live.aria-modal.aria-multiline.aria-multiselectable.aria-orientation.aria-owns.aria-placeholder.aria-posinset.aria-pressed.aria-readonly.aria-relevant.aria-required.aria-roledescription.aria-rowcount.aria-rowindex.aria-rowspan.aria-selected.aria-setsize.aria-sort.aria-valuemax.aria-valuemin.aria-valuenow.aria-valuetext.className.color.height.id.lang.max.media.method.min.name.style.target.width.role.tabIndex.accentHeight.accumulate.additive.alignmentBaseline.allowReorder.alphabetic.amplitude.arabicForm.ascent.attributeName.attributeType.autoReverse.azimuth.baseFrequency.baselineShift.baseProfile.bbox.begin.bias.by.calcMode.capHeight.clip.clipPath.clipPathUnits.clipRule.colorInterpolation.colorInterpolationFilters.colorProfile.colorRendering.contentScriptType.contentStyleType.cursor.cx.cy.d.decelerate.descent.diffuseConstant.direction.display.divisor.dominantBaseline.dur.dx.dy.edgeMode.elevation.enableBackground.end.exponent.externalResourcesRequired.fill.fillOpacity.fillRule.filter.filterRes.filterUnits.floodColor.floodOpacity.focusable.fontFamily.fontSize.fontSizeAdjust.fontStretch.fontStyle.fontVariant.fontWeight.format.from.fx.fy.g1.g2.glyphName.glyphOrientationHorizontal.glyphOrientationVertical.glyphRef.gradientTransform.gradientUnits.hanging.horizAdvX.horizOriginX.href.ideographic.imageRendering.in2.in.intercept.k1.k2.k3.k4.k.kernelMatrix.kernelUnitLength.kerning.keyPoints.keySplines.keyTimes.lengthAdjust.letterSpacing.lightingColor.limitingConeAngle.local.markerEnd.markerHeight.markerMid.markerStart.markerUnits.markerWidth.mask.maskContentUnits.maskUnits.mathematical.mode.numOctaves.offset.opacity.operator.order.orient.orientation.origin.overflow.overlinePosition.overlineThickness.paintOrder.panose1.pathLength.patternContentUnits.patternTransform.patternUnits.pointerEvents.pointsAtX.pointsAtY.pointsAtZ.preserveAlpha.preserveAspectRatio.primitiveUnits.r.radius.refX.refY.renderingIntent.repeatCount.repeatDur.requiredExtensions.requiredFeatures.restart.result.rotate.rx.ry.seed.shapeRendering.slope.spacing.specularConstant.specularExponent.speed.spreadMethod.startOffset.stdDeviation.stemh.stemv.stitchTiles.stopColor.stopOpacity.strikethroughPosition.strikethroughThickness.string.stroke.strokeDasharray.strokeDashoffset.strokeLinecap.strokeLinejoin.strokeMiterlimit.strokeOpacity.strokeWidth.surfaceScale.systemLanguage.tableValues.targetX.targetY.textAnchor.textDecoration.textLength.textRendering.to.transform.u1.u2.underlinePosition.underlineThickness.unicode.unicodeBidi.unicodeRange.unitsPerEm.vAlphabetic.values.vectorEffect.version.vertAdvY.vertOriginX.vertOriginY.vHanging.vIdeographic.viewTarget.visibility.vMathematical.widths.wordSpacing.writingMode.x1.x2.x.xChannelSelector.xHeight.xlinkActuate.xlinkArcrole.xlinkHref.xlinkRole.xlinkShow.xlinkTitle.xlinkType.xmlBase.xmlLang.xmlns.xmlnsXlink.xmlSpace.y1.y2.y.yChannelSelector.z.zoomAndPan.ref.key.angle`.split(`.`);function uw(e){return typeof e==`string`?tse.includes(e):!1}function dw(e){return typeof e==`string`&&e.startsWith(`data-`)}function fw(e){var t=Object.entries(e).filter(e=>{var[t]=e;return uw(t)||dw(t)});return Object.fromEntries(t)}function pw(e){if(e==null)return null;if((0,N.isValidElement)(e)&&typeof e.props==`object`&&e.props!==null){var t=e.props;return fw(t)}return typeof e==`object`&&!Array.isArray(e)?fw(e):null}function mw(e){var t=Object.entries(e).filter(e=>{var[t]=e;return uw(t)||dw(t)||lw(t)});return Object.fromEntries(t)}function nse(e){return e==null?null:(0,N.isValidElement)(e)?mw(e.props):typeof e==`object`&&!Array.isArray(e)?mw(e):null}var rse=[`children`,`width`,`height`,`viewBox`,`className`,`style`,`title`,`desc`];function hw(){return hw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hw.apply(null,arguments)}function ise(e,t){if(e==null)return{};var n,r,i=ase(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function ase(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var gw=(0,N.forwardRef)((e,t)=>{var{children:n,width:r,height:i,viewBox:a,className:o,style:s,title:c,desc:l}=e,u=ise(e,rse),d=a||{width:r,height:i,x:0,y:0},f=cw(`recharts-surface`,o);return N.createElement(`svg`,hw({},mw(u),{className:f,width:r,height:i,style:s,viewBox:`${d.x} ${d.y} ${d.width} ${d.height}`,ref:t}),N.createElement(`title`,null,c),N.createElement(`desc`,null,l),n)}),ose=[`children`,`className`];function _w(){return _w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_w.apply(null,arguments)}function sse(e,t){if(e==null)return{};var n,r,i=cse(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function cse(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var vw=N.forwardRef((e,t)=>{var{children:n,className:r}=e,i=sse(e,ose),a=cw(`recharts-layer`,r);return N.createElement(`g`,_w({className:a},mw(i),{ref:t}),n)}),yw=(0,N.createContext)(null),lse=()=>(0,N.useContext)(yw);function bw(e){return function(){return e}}const xw=Math.cos,Sw=Math.sin,Cw=Math.sqrt,ww=Math.PI;ww/2;const Tw=2*ww;var Ew=Math.PI,Dw=2*Ew,Ow=1e-6,use=Dw-Ow;function kw(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function dse(e){let t=Math.floor(e);if(!(t>=0))throw Error(`invalid digits: ${e}`);if(t>15)return kw;let n=10**t;return function(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}var Aw=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._=``,this._append=e==null?kw:dse(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,n,r){this._append`Q${+e},${+t},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(e,t,n,r,i,a){this._append`C${+e},${+t},${+n},${+r},${this._x1=+i},${this._y1=+a}`}arcTo(e,t,n,r,i){if(e=+e,t=+t,n=+n,r=+r,i=+i,i<0)throw Error(`negative radius: ${i}`);let a=this._x1,o=this._y1,s=n-e,c=r-t,l=a-e,u=o-t,d=l*l+u*u;if(this._x1===null)this._append`M${this._x1=e},${this._y1=t}`;else if(d>Ow)if(!(Math.abs(u*s-c*l)>Ow)||!i)this._append`L${this._x1=e},${this._y1=t}`;else{let f=n-a,p=r-o,m=s*s+c*c,h=f*f+p*p,g=Math.sqrt(m),_=Math.sqrt(d),v=i*Math.tan((Ew-Math.acos((m+d-h)/(2*g*_)))/2),y=v/_,b=v/g;Math.abs(y-1)>Ow&&this._append`L${e+y*l},${t+y*u}`,this._append`A${i},${i},0,0,${+(u*f>l*p)},${this._x1=e+b*s},${this._y1=t+b*c}`}}arc(e,t,n,r,i,a){if(e=+e,t=+t,n=+n,a=!!a,n<0)throw Error(`negative radius: ${n}`);let o=n*Math.cos(r),s=n*Math.sin(r),c=e+o,l=t+s,u=1^a,d=a?r-i:i-r;this._x1===null?this._append`M${c},${l}`:(Math.abs(this._x1-c)>Ow||Math.abs(this._y1-l)>Ow)&&this._append`L${c},${l}`,n&&(d<0&&(d=d%Dw+Dw),d>use?this._append`A${n},${n},0,1,${u},${e-o},${t-s}A${n},${n},0,1,${u},${this._x1=c},${this._y1=l}`:d>Ow&&this._append`A${n},${n},0,${+(d>=Ew)},${u},${this._x1=e+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(e,t,n,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}};function fse(){return new Aw}fse.prototype=Aw.prototype;function jw(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{let e=Math.floor(n);if(!(e>=0))throw RangeError(`invalid digits: ${n}`);t=e}return e},()=>new Aw(t)}Array.prototype.slice;function Mw(e){return typeof e==`object`&&`length`in e?e:Array.from(e)}function Nw(e){this._context=e}Nw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Pw(e){return new Nw(e)}function Fw(e){return e[0]}function Iw(e){return e[1]}function Lw(e,t){var n=bw(!0),r=null,i=Pw,a=null,o=jw(s);e=typeof e==`function`?e:e===void 0?Fw:bw(e),t=typeof t==`function`?t:t===void 0?Iw:bw(t);function s(s){var c,l=(s=Mw(s)).length,u,d=!1,f;for(r??(a=i(f=o())),c=0;c<=l;++c)!(c<l&&n(u=s[c],c,s))===d&&((d=!d)?a.lineStart():a.lineEnd()),d&&a.point(+e(u,c,s),+t(u,c,s));if(f)return a=null,f+``||null}return s.x=function(t){return arguments.length?(e=typeof t==`function`?t:bw(+t),s):e},s.y=function(e){return arguments.length?(t=typeof e==`function`?e:bw(+e),s):t},s.defined=function(e){return arguments.length?(n=typeof e==`function`?e:bw(!!e),s):n},s.curve=function(e){return arguments.length?(i=e,r!=null&&(a=i(r)),s):i},s.context=function(e){return arguments.length?(e==null?r=a=null:a=i(r=e),s):r},s}function Rw(e,t,n){var r=null,i=bw(!0),a=null,o=Pw,s=null,c=jw(l);e=typeof e==`function`?e:e===void 0?Fw:bw(+e),t=typeof t==`function`?t:bw(t===void 0?0:+t),n=typeof n==`function`?n:n===void 0?Iw:bw(+n);function l(l){var u,d,f,p=(l=Mw(l)).length,m,h=!1,g,_=Array(p),v=Array(p);for(a??(s=o(g=c())),u=0;u<=p;++u){if(!(u<p&&i(m=l[u],u,l))===h)if(h=!h)d=u,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),f=u-1;f>=d;--f)s.point(_[f],v[f]);s.lineEnd(),s.areaEnd()}h&&(_[u]=+e(m,u,l),v[u]=+t(m,u,l),s.point(r?+r(m,u,l):_[u],n?+n(m,u,l):v[u]))}if(g)return s=null,g+``||null}function u(){return Lw().defined(i).curve(o).context(a)}return l.x=function(t){return arguments.length?(e=typeof t==`function`?t:bw(+t),r=null,l):e},l.x0=function(t){return arguments.length?(e=typeof t==`function`?t:bw(+t),l):e},l.x1=function(e){return arguments.length?(r=e==null?null:typeof e==`function`?e:bw(+e),l):r},l.y=function(e){return arguments.length?(t=typeof e==`function`?e:bw(+e),n=null,l):t},l.y0=function(e){return arguments.length?(t=typeof e==`function`?e:bw(+e),l):t},l.y1=function(e){return arguments.length?(n=e==null?null:typeof e==`function`?e:bw(+e),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(r).y(t)},l.defined=function(e){return arguments.length?(i=typeof e==`function`?e:bw(!!e),l):i},l.curve=function(e){return arguments.length?(o=e,a!=null&&(s=o(a)),l):o},l.context=function(e){return arguments.length?(e==null?a=s=null:s=o(a=e),l):a},l}var zw=class{constructor(e,t){this._context=e,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t);break}this._x0=e,this._y0=t}};function pse(e){return new zw(e,!0)}function mse(e){return new zw(e,!1)}var Bw={draw(e,t){let n=Cw(t/ww);e.moveTo(n,0),e.arc(0,0,n,0,Tw)}},hse={draw(e,t){let n=Cw(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},Vw=Cw(1/3),gse=Vw*2,_se={draw(e,t){let n=Cw(t/gse),r=n*Vw;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},vse={draw(e,t){let n=Cw(t),r=-n/2;e.rect(r,r,n,n)}},yse=.8908130915292852,Hw=Sw(ww/10)/Sw(7*ww/10),bse=Sw(Tw/10)*Hw,xse=-xw(Tw/10)*Hw,Sse={draw(e,t){let n=Cw(t*yse),r=bse*n,i=xse*n;e.moveTo(0,-n),e.lineTo(r,i);for(let t=1;t<5;++t){let a=Tw*t/5,o=xw(a),s=Sw(a);e.lineTo(s*n,-o*n),e.lineTo(o*r-s*i,s*r+o*i)}e.closePath()}},Uw=Cw(3),Cse={draw(e,t){let n=-Cw(t/(Uw*3));e.moveTo(0,n*2),e.lineTo(-Uw*n,-n),e.lineTo(Uw*n,-n),e.closePath()}},Ww=-.5,Gw=Cw(3)/2,Kw=1/Cw(12),wse=(Kw/2+1)*3,Tse={draw(e,t){let n=Cw(t/wse),r=n/2,i=n*Kw,a=r,o=n*Kw+n,s=-a,c=o;e.moveTo(r,i),e.lineTo(a,o),e.lineTo(s,c),e.lineTo(Ww*r-Gw*i,Gw*r+Ww*i),e.lineTo(Ww*a-Gw*o,Gw*a+Ww*o),e.lineTo(Ww*s-Gw*c,Gw*s+Ww*c),e.lineTo(Ww*r+Gw*i,Ww*i-Gw*r),e.lineTo(Ww*a+Gw*o,Ww*o-Gw*a),e.lineTo(Ww*s+Gw*c,Ww*c-Gw*s),e.closePath()}};function Ese(e,t){let n=null,r=jw(i);e=typeof e==`function`?e:bw(e||Bw),t=typeof t==`function`?t:bw(t===void 0?64:+t);function i(){let i;if(n||=i=r(),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+``||null}return i.type=function(t){return arguments.length?(e=typeof t==`function`?t:bw(t),i):e},i.size=function(e){return arguments.length?(t=typeof e==`function`?e:bw(+e),i):t},i.context=function(e){return arguments.length?(n=e??null,i):n},i}function qw(){}function Jw(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Yw(e){this._context=e}Yw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Jw(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Jw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Dse(e){return new Yw(e)}function Xw(e){this._context=e}Xw.prototype={areaStart:qw,areaEnd:qw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Jw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Ose(e){return new Xw(e)}function Zw(e){this._context=e}Zw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Jw(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function kse(e){return new Zw(e)}function Qw(e){this._context=e}Qw.prototype={areaStart:qw,areaEnd:qw,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Ase(e){return new Qw(e)}function $w(e){return e<0?-1:1}function eT(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return($w(a)+$w(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function tT(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function nT(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,i+s*t,a-s,o-s*n,a,o)}function rT(e){this._context=e}rT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:nT(this,this._t0,tT(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,nT(this,tT(this,n=eT(this,e,t)),n);break;default:nT(this,this._t0,n=eT(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function iT(e){this._context=new aT(e)}(iT.prototype=Object.create(rT.prototype)).point=function(e,t){rT.prototype.point.call(this,t,e)};function aT(e){this._context=e}aT.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}};function jse(e){return new rT(e)}function Mse(e){return new iT(e)}function oT(e){this._context=e}oT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=sT(e),i=sT(t),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function sT(e){var t,n=e.length-1,r,i=Array(n),a=Array(n),o=Array(n);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,a[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/a[t-1],a[t]-=r,o[t]-=r*o[t-1];for(i[n-1]=o[n-1]/a[n-1],t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function Nse(e){return new oT(e)}function cT(e,t){this._context=e,this._t=t}cT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}this._x=e,this._y=t}};function Pse(e){return new cT(e,.5)}function Fse(e){return new cT(e,0)}function Ise(e){return new cT(e,1)}function lT(e,t){if((o=e.length)>1)for(var n=1,r,i,a=e[t[0]],o,s=a.length;n<o;++n)for(i=a,a=e[t[n]],r=0;r<s;++r)a[r][1]+=a[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}function uT(e){for(var t=e.length,n=Array(t);--t>=0;)n[t]=t;return n}function Lse(e,t){return e[t]}function Rse(e){let t=[];return t.key=e,t}function zse(){var e=bw([]),t=uT,n=lT,r=Lse;function i(i){var a=Array.from(e.apply(this,arguments),Rse),o,s=a.length,c=-1,l;for(let e of i)for(o=0,++c;o<s;++o)(a[o][c]=[0,+r(e,a[o].key,c,i)]).data=e;for(o=0,l=Mw(t(a));o<s;++o)a[l[o]].index=o;return n(a,l),a}return i.keys=function(t){return arguments.length?(e=typeof t==`function`?t:bw(Array.from(t)),i):e},i.value=function(e){return arguments.length?(r=typeof e==`function`?e:bw(+e),i):r},i.order=function(e){return arguments.length?(t=e==null?uT:typeof e==`function`?e:bw(Array.from(e)),i):t},i.offset=function(e){return arguments.length?(n=e??lT,i):n},i}function Bse(e,t){if((r=e.length)>0){for(var n,r,i=0,a=e[0].length,o;i<a;++i){for(o=n=0;n<r;++n)o+=e[n][i][1]||0;if(o)for(n=0;n<r;++n)e[n][i][1]/=o}lT(e,t)}}function Vse(e,t){if((i=e.length)>0){for(var n=0,r=e[t[0]],i,a=r.length;n<a;++n){for(var o=0,s=0;o<i;++o)s+=e[o][n][1]||0;r[n][1]+=r[n][0]=-s/2}lT(e,t)}}function Hse(e,t){if(!(!((o=e.length)>0)||!((a=(i=e[t[0]]).length)>0))){for(var n=0,r=1,i,a,o;r<a;++r){for(var s=0,c=0,l=0;s<o;++s){for(var u=e[t[s]],d=u[r][1]||0,f=u[r-1][1]||0,p=(d-f)/2,m=0;m<s;++m){var h=e[t[m]],g=h[r][1]||0,_=h[r-1][1]||0;p+=g-_}c+=d,l+=p*d}i[r-1][1]+=i[r-1][0]=n,c&&(n-=l/c)}i[r-1][1]+=i[r-1][0]=n,lT(e,t)}}var Use=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){return e===`__proto__`}e.isUnsafeProperty=t})),dT=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){switch(typeof e){case`number`:case`symbol`:return!1;case`string`:return e.includes(`.`)||e.includes(`[`)||e.includes(`]`)}}e.isDeepKey=t})),fT=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){return typeof e==`string`||typeof e==`symbol`?e:Object.is(e?.valueOf?.(),-0)?`-0`:String(e)}e.toKey=t})),Wse=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){if(e==null)return``;if(typeof e==`string`)return e;if(Array.isArray(e))return e.map(t).join(`,`);let n=String(e);return n===`0`&&Object.is(Number(e),-0)?`-0`:n}e.toString=t})),pT=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=Wse(),n=fT();function r(e){if(Array.isArray(e))return e.map(n.toKey);if(typeof e==`symbol`)return[e];e=t.toString(e);let r=[],i=e.length;if(i===0)return r;let a=0,o=``,s=``,c=!1;for(e.charCodeAt(0)===46&&(r.push(``),a++);a<i;){let t=e[a];s?t===`\\`&&a+1<i?(a++,o+=e[a]):t===s?s=``:o+=t:c?t===`"`||t===`'`?s=t:t===`]`?(c=!1,r.push(o),o=``):o+=t:t===`[`?(c=!0,o&&=(r.push(o),``)):t===`.`?o&&=(r.push(o),``):o+=t,a++}return o&&r.push(o),r}e.toPath=r})),mT=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=Use(),n=dT(),r=fT(),i=pT();function a(e,s,c){if(e==null)return c;switch(typeof s){case`string`:{if(t.isUnsafeProperty(s))return c;let r=e[s];return r===void 0?n.isDeepKey(s)?a(e,i.toPath(s),c):c:r}case`number`:case`symbol`:{typeof s==`number`&&(s=r.toKey(s));let t=e[s];return t===void 0?c:t}default:{if(Array.isArray(s))return o(e,s,c);if(s=Object.is(s?.valueOf(),-0)?`-0`:String(s),t.isUnsafeProperty(s))return c;let n=e[s];return n===void 0?c:n}}}function o(e,n,r){if(n.length===0)return r;let i=e;for(let e=0;e<n.length;e++){if(i==null||t.isUnsafeProperty(n[e]))return r;i=i[n[e]]}return i===void 0?r:i}e.get=a})),hT=o(((e,t)=>{t.exports=mT().get})),Gse=l(hT()),gT=e=>e===0?0:e>0?1:-1,_T=e=>typeof e==`number`&&e!=+e,vT=e=>typeof e==`string`&&e.indexOf(`%`)===e.length-1,yT=e=>(typeof e==`number`||e instanceof Number)&&!_T(e),bT=e=>yT(e)||typeof e==`string`,Kse=0,xT=e=>{var t=++Kse;return`${e||``}${t}`},ST=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!yT(e)&&typeof e!=`string`)return n;var i;if(vT(e)){if(t==null)return n;var a=e.indexOf(`%`);i=t*parseFloat(e.slice(0,a))/100}else i=+e;return _T(i)&&(i=n),r&&t!=null&&i>t&&(i=t),i},CT=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,n={},r=0;r<t;r++)if(!n[e[r]])n[e[r]]=!0;else return!0;return!1};function wT(e,t,n){return yT(e)&&yT(t)?e+n*(t-e):t}function TT(e,t,n){if(!(!e||!e.length))return e.find(e=>e&&(typeof t==`function`?t(e):(0,Gse.default)(e,t))===n)}var ET=e=>e==null,DT=e=>ET(e)?e:`${e.charAt(0).toUpperCase()}${e.slice(1)}`,qse=[`type`,`size`,`sizeType`];function OT(){return OT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},OT.apply(null,arguments)}function kT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function AT(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?kT(Object(n),!0).forEach(function(t){Jse(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kT(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Jse(e,t,n){return(t=Yse(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Yse(e){var t=Xse(e,`string`);return typeof t==`symbol`?t:t+``}function Xse(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function Zse(e,t){if(e==null)return{};var n,r,i=Qse(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Qse(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var jT={symbolCircle:Bw,symbolCross:hse,symbolDiamond:_se,symbolSquare:vse,symbolStar:Sse,symbolTriangle:Cse,symbolWye:Tse},$se=Math.PI/180,ece=e=>{var t=`symbol${DT(e)}`;return jT[t]||Bw},tce=(e,t,n)=>{if(t===`area`)return e;switch(n){case`cross`:return 5*e*e/9;case`diamond`:return .5*e*e/Math.sqrt(3);case`square`:return e*e;case`star`:var r=18*$se;return 1.25*e*e*(Math.tan(r)-Math.tan(r*2)*Math.tan(r)**2);case`triangle`:return Math.sqrt(3)*e*e/4;case`wye`:return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},nce=(e,t)=>{jT[`symbol${DT(e)}`]=t},MT=e=>{var{type:t=`circle`,size:n=64,sizeType:r=`area`}=e,i=Zse(e,qse),a=AT(AT({},i),{},{type:t,size:n,sizeType:r}),o=`circle`;typeof t==`string`&&(o=t);var s=()=>{var e=ece(o),t=Ese().type(e).size(tce(n,r,o))();if(t!==null)return t},{className:c,cx:l,cy:u}=a,d=mw(a);return l===+l&&u===+u&&n===+n?N.createElement(`path`,OT({},d,{className:cw(`recharts-symbols`,c),transform:`translate(${l}, ${u})`,d:s()})):null};MT.registerSymbol=nce;var NT=(e,t)=>{if(!e||typeof e==`function`||typeof e==`boolean`)return null;var n=e;if((0,N.isValidElement)(e)&&(n=e.props),typeof n!=`object`&&typeof n!=`function`)return null;var r={};return Object.keys(n).forEach(e=>{lw(e)&&(r[e]=t||(t=>n[e](n,t)))}),r},rce=(e,t,n)=>r=>(e(t,n,r),null),PT=(e,t,n)=>{if(e===null||typeof e!=`object`&&typeof e!=`function`)return null;var r=null;return Object.keys(e).forEach(i=>{var a=e[i];lw(i)&&typeof a==`function`&&(r||={},r[i]=rce(a,t,n))}),r};function FT(){return FT=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},FT.apply(null,arguments)}function IT(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ice(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?IT(Object(n),!0).forEach(function(t){LT(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IT(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function LT(e,t,n){return(t=ace(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ace(e){var t=oce(e,`string`);return typeof t==`symbol`?t:t+``}function oce(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var RT=32,zT=class extends N.PureComponent{renderIcon(e,t){var{inactiveColor:n}=this.props,r=RT/2,i=RT/6,a=RT/3,o=e.inactive?n:e.color,s=t??e.type;if(s===`none`)return null;if(s===`plainline`)return N.createElement(`line`,{strokeWidth:4,fill:`none`,stroke:o,strokeDasharray:e.payload.strokeDasharray,x1:0,y1:r,x2:RT,y2:r,className:`recharts-legend-icon`});if(s===`line`)return N.createElement(`path`,{strokeWidth:4,fill:`none`,stroke:o,d:`M0,${r}h${a}
            A${i},${i},0,1,1,${2*a},${r}
            H${RT}M${2*a},${r}
            A${i},${i},0,1,1,${a},${r}`,className:`recharts-legend-icon`});if(s===`rect`)return N.createElement(`path`,{stroke:`none`,fill:o,d:`M0,${RT/8}h${RT}v${RT*3/4}h${-RT}z`,className:`recharts-legend-icon`});if(N.isValidElement(e.legendIcon)){var c=ice({},e);return delete c.legendIcon,N.cloneElement(e.legendIcon,c)}return N.createElement(MT,{fill:o,cx:r,cy:r,size:RT,sizeType:`diameter`,type:s})}renderItems(){var{payload:e,iconSize:t,layout:n,formatter:r,inactiveColor:i,iconType:a}=this.props,o={x:0,y:0,width:RT,height:RT},s={display:n===`horizontal`?`inline-block`:`block`,marginRight:10},c={display:`inline-block`,verticalAlign:`middle`,marginRight:4};return e.map((e,n)=>{var l=e.formatter||r,u=cw({"recharts-legend-item":!0,[`legend-item-${n}`]:!0,inactive:e.inactive});if(e.type===`none`)return null;var d=e.inactive?i:e.color,f=l?l(e.value,e,n):e.value;return N.createElement(`li`,FT({className:u,style:s,key:`legend-item-${n}`},PT(this.props,e,n)),N.createElement(gw,{width:t,height:t,viewBox:o,style:c,"aria-label":`${f} legend icon`},this.renderIcon(e,a)),N.createElement(`span`,{className:`recharts-legend-item-text`,style:{color:d}},f))})}render(){var{payload:e,layout:t,align:n}=this.props;if(!e||!e.length)return null;var r={padding:0,margin:0,textAlign:t===`horizontal`?n:`left`};return N.createElement(`ul`,{className:`recharts-default-legend`,style:r},this.renderItems())}};LT(zT,`displayName`,`Legend`),LT(zT,`defaultProps`,{align:`center`,iconSize:14,inactiveColor:`#ccc`,layout:`horizontal`,verticalAlign:`middle`});var sce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e,t){let n=new Map;for(let r=0;r<e.length;r++){let i=e[r],a=t(i);n.has(a)||n.set(a,i)}return Array.from(n.values())}e.uniqBy=t})),BT=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){return e}e.identity=t})),cce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){return Number.isSafeInteger(e)&&e>=0}e.isLength=t})),VT=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=cce();function n(e){return e!=null&&typeof e!=`function`&&t.isLength(e.length)}e.isArrayLike=n})),lce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){return typeof e==`object`&&!!e}e.isObjectLike=t})),uce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=VT(),n=lce();function r(e){return n.isObjectLike(e)&&t.isArrayLike(e)}e.isArrayLikeObject=r})),dce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=mT();function n(e){return function(n){return t.get(n,e)}}e.property=n})),HT=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){return e!==null&&(typeof e==`object`||typeof e==`function`)}e.isObject=t})),UT=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){return e==null||typeof e!=`object`&&typeof e!=`function`}e.isPrimitive=t})),WT=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e,t){return e===t||Number.isNaN(e)&&Number.isNaN(t)}e.eq=t})),fce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=HT(),n=UT(),r=WT();function i(e,t,n){return typeof n==`function`?a(e,t,function e(t,r,i,o,s,c){let l=n(t,r,i,o,s,c);return l===void 0?a(t,r,e,c):!!l},new Map):i(e,t,()=>void 0)}function a(e,n,i,s){if(n===e)return!0;switch(typeof n){case`object`:return o(e,n,i,s);case`function`:return Object.keys(n).length>0?a(e,{...n},i,s):r.eq(e,n);default:return t.isObject(e)?typeof n==`string`?n===``:!0:r.eq(e,n)}}function o(e,t,r,i){if(t==null)return!0;if(Array.isArray(t))return c(e,t,r,i);if(t instanceof Map)return s(e,t,r,i);if(t instanceof Set)return l(e,t,r,i);let a=Object.keys(t);if(e==null)return a.length===0;if(a.length===0)return!0;if(i?.has(t))return i.get(t)===e;i?.set(t,e);try{for(let o=0;o<a.length;o++){let s=a[o];if(!n.isPrimitive(e)&&!(s in e)||t[s]===void 0&&e[s]!==void 0||t[s]===null&&e[s]!==null||!r(e[s],t[s],s,e,t,i))return!1}return!0}finally{i?.delete(t)}}function s(e,t,n,r){if(t.size===0)return!0;if(!(e instanceof Map))return!1;for(let[i,a]of t.entries()){let o=e.get(i);if(n(o,a,i,e,t,r)===!1)return!1}return!0}function c(e,t,n,r){if(t.length===0)return!0;if(!Array.isArray(e))return!1;let i=new Set;for(let a=0;a<t.length;a++){let o=t[a],s=!1;for(let c=0;c<e.length;c++){if(i.has(c))continue;let l=e[c],u=!1;if(n(l,o,a,e,t,r)&&(u=!0),u){i.add(c),s=!0;break}}if(!s)return!1}return!0}function l(e,t,n,r){return t.size===0?!0:e instanceof Set?c([...e],[...t],n,r):!1}e.isMatchWith=i,e.isSetMatch=l})),GT=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=fce();function n(e,n){return t.isMatchWith(e,n,()=>void 0)}e.isMatch=n})),pce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}e.getSymbols=t})),KT=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){return e==null?e===void 0?`[object Undefined]`:`[object Null]`:Object.prototype.toString.call(e)}e.getTag=t})),qT=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`}),e.argumentsTag=`[object Arguments]`,e.arrayBufferTag=`[object ArrayBuffer]`,e.arrayTag=`[object Array]`,e.bigInt64ArrayTag=`[object BigInt64Array]`,e.bigUint64ArrayTag=`[object BigUint64Array]`,e.booleanTag=`[object Boolean]`,e.dataViewTag=`[object DataView]`,e.dateTag=`[object Date]`,e.errorTag=`[object Error]`,e.float32ArrayTag=`[object Float32Array]`,e.float64ArrayTag=`[object Float64Array]`,e.functionTag=`[object Function]`,e.int16ArrayTag=`[object Int16Array]`,e.int32ArrayTag=`[object Int32Array]`,e.int8ArrayTag=`[object Int8Array]`,e.mapTag=`[object Map]`,e.numberTag=`[object Number]`,e.objectTag=`[object Object]`,e.regexpTag=`[object RegExp]`,e.setTag=`[object Set]`,e.stringTag=`[object String]`,e.symbolTag=`[object Symbol]`,e.uint16ArrayTag=`[object Uint16Array]`,e.uint32ArrayTag=`[object Uint32Array]`,e.uint8ArrayTag=`[object Uint8Array]`,e.uint8ClampedArrayTag=`[object Uint8ClampedArray]`})),mce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}e.isTypedArray=t})),JT=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=pce(),n=KT(),r=qT(),i=UT(),a=mce();function o(e,t){return s(e,void 0,e,new Map,t)}function s(e,t,n,r=new Map,o=void 0){let u=o?.(e,t,n,r);if(u!==void 0)return u;if(i.isPrimitive(e))return e;if(r.has(e))return r.get(e);if(Array.isArray(e)){let t=Array(e.length);r.set(e,t);for(let i=0;i<e.length;i++)t[i]=s(e[i],i,n,r,o);return Object.hasOwn(e,`index`)&&(t.index=e.index),Object.hasOwn(e,`input`)&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){let t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){let t=new Map;r.set(e,t);for(let[i,a]of e)t.set(i,s(a,i,n,r,o));return t}if(e instanceof Set){let t=new Set;r.set(e,t);for(let i of e)t.add(s(i,void 0,n,r,o));return t}if(typeof Buffer<`u`&&Buffer.isBuffer(e))return e.subarray();if(a.isTypedArray(e)){let t=new(Object.getPrototypeOf(e)).constructor(e.length);r.set(e,t);for(let i=0;i<e.length;i++)t[i]=s(e[i],i,n,r,o);return t}if(e instanceof ArrayBuffer||typeof SharedArrayBuffer<`u`&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){let t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return r.set(e,t),c(t,e,n,r,o),t}if(typeof File<`u`&&e instanceof File){let t=new File([e],e.name,{type:e.type});return r.set(e,t),c(t,e,n,r,o),t}if(typeof Blob<`u`&&e instanceof Blob){let t=new Blob([e],{type:e.type});return r.set(e,t),c(t,e,n,r,o),t}if(e instanceof Error){let t=new e.constructor;return r.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,c(t,e,n,r,o),t}if(e instanceof Boolean){let t=new Boolean(e.valueOf());return r.set(e,t),c(t,e,n,r,o),t}if(e instanceof Number){let t=new Number(e.valueOf());return r.set(e,t),c(t,e,n,r,o),t}if(e instanceof String){let t=new String(e.valueOf());return r.set(e,t),c(t,e,n,r,o),t}if(typeof e==`object`&&l(e)){let t=Object.create(Object.getPrototypeOf(e));return r.set(e,t),c(t,e,n,r,o),t}return e}function c(e,n,r=e,i,a){let o=[...Object.keys(n),...t.getSymbols(n)];for(let t=0;t<o.length;t++){let c=o[t],l=Object.getOwnPropertyDescriptor(e,c);(l==null||l.writable)&&(e[c]=s(n[c],c,r,i,a))}}function l(e){switch(n.getTag(e)){case r.argumentsTag:case r.arrayTag:case r.arrayBufferTag:case r.dataViewTag:case r.booleanTag:case r.dateTag:case r.float32ArrayTag:case r.float64ArrayTag:case r.int8ArrayTag:case r.int16ArrayTag:case r.int32ArrayTag:case r.mapTag:case r.numberTag:case r.objectTag:case r.regexpTag:case r.setTag:case r.stringTag:case r.symbolTag:case r.uint8ArrayTag:case r.uint8ClampedArrayTag:case r.uint16ArrayTag:case r.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=s,e.copyProperties=c})),hce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=JT();function n(e){return t.cloneDeepWithImpl(e,void 0,e,new Map,void 0)}e.cloneDeep=n})),gce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=GT(),n=hce();function r(e){return e=n.cloneDeep(e),n=>t.isMatch(n,e)}e.matches=r})),_ce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=JT(),n=qT();function r(e,r){return t.cloneDeepWith(e,(i,a,o,s)=>{let c=r?.(i,a,o,s);if(c!==void 0)return c;if(typeof e==`object`)switch(Object.prototype.toString.call(e)){case n.numberTag:case n.stringTag:case n.booleanTag:{let n=new e.constructor(e?.valueOf());return t.copyProperties(n,e),n}case n.argumentsTag:{let n={};return t.copyProperties(n,e),n.length=e.length,n[Symbol.iterator]=e[Symbol.iterator],n}default:return}})}e.cloneDeepWith=r})),vce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=_ce();function n(e){return t.cloneDeepWith(e)}e.cloneDeep=n})),YT=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=/^(?:0|[1-9]\d*)$/;function n(e,n=2**53-1){switch(typeof e){case`number`:return Number.isInteger(e)&&e>=0&&e<n;case`symbol`:return!1;case`string`:return t.test(e)}}e.isIndex=n})),yce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=KT();function n(e){return typeof e==`object`&&!!e&&t.getTag(e)===`[object Arguments]`}e.isArguments=n})),bce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=dT(),n=YT(),r=yce(),i=pT();function a(e,a){let o;if(o=Array.isArray(a)?a:typeof a==`string`&&t.isDeepKey(a)&&e?.[a]==null?i.toPath(a):[a],o.length===0)return!1;let s=e;for(let e=0;e<o.length;e++){let t=o[e];if((s==null||!Object.hasOwn(s,t))&&!((Array.isArray(s)||r.isArguments(s))&&n.isIndex(t)&&t<s.length))return!1;s=s[t]}return!0}e.has=a})),xce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=GT(),n=fT(),r=vce(),i=mT(),a=bce();function o(e,o){switch(typeof e){case`object`:Object.is(e?.valueOf(),-0)&&(e=`-0`);break;case`number`:e=n.toKey(e);break}return o=r.cloneDeep(o),function(n){let r=i.get(n,e);return r===void 0?a.has(n,e):o===void 0?r===void 0:t.isMatch(r,o)}}e.matchesProperty=o})),Sce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=BT(),n=dce(),r=gce(),i=xce();function a(e){if(e==null)return t.identity;switch(typeof e){case`function`:return e;case`object`:return Array.isArray(e)&&e.length===2?i.matchesProperty(e[0],e[1]):r.matches(e);case`string`:case`symbol`:case`number`:return n.property(e)}}e.iteratee=a})),Cce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=sce(),n=BT(),r=uce(),i=Sce();function a(e,a=n.identity){return r.isArrayLikeObject(e)?t.uniqBy(Array.from(e),i.iteratee(a)):[]}e.uniqBy=a})),XT=l(o(((e,t)=>{t.exports=Cce().uniqBy}))());function ZT(e,t,n){return t===!0?(0,XT.default)(e,n):typeof t==`function`?(0,XT.default)(e,t):e}var wce=o((e=>{var t=Zm();function n(e,t){return e===t&&(e!==0||1/e==1/t)||e!==e&&t!==t}var r=typeof Object.is==`function`?Object.is:n,i=t.useState,a=t.useEffect,o=t.useLayoutEffect,s=t.useDebugValue;function c(e,t){var n=t(),r=i({inst:{value:n,getSnapshot:t}}),c=r[0].inst,u=r[1];return o(function(){c.value=n,c.getSnapshot=t,l(c)&&u({inst:c})},[e,n,t]),a(function(){return l(c)&&u({inst:c}),e(function(){l(c)&&u({inst:c})})},[e]),s(n),n}function l(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!r(e,n)}catch{return!0}}function u(e,t){return t()}var d=typeof window>`u`||window.document===void 0||window.document.createElement===void 0?u:c;e.useSyncExternalStore=t.useSyncExternalStore===void 0?d:t.useSyncExternalStore})),Tce=o(((e,t)=>{t.exports=wce()})),Ece=o((e=>{var t=Zm(),n=Tce();function r(e,t){return e===t&&(e!==0||1/e==1/t)||e!==e&&t!==t}var i=typeof Object.is==`function`?Object.is:r,a=n.useSyncExternalStore,o=t.useRef,s=t.useEffect,c=t.useMemo,l=t.useDebugValue;e.useSyncExternalStoreWithSelector=function(e,t,n,r,u){var d=o(null);if(d.current===null){var f={hasValue:!1,value:null};d.current=f}else f=d.current;d=c(function(){function e(e){if(!a){if(a=!0,o=e,e=r(e),u!==void 0&&f.hasValue){var t=f.value;if(u(t,e))return s=t}return s=e}if(t=s,i(o,e))return t;var n=r(e);return u!==void 0&&u(t,n)?(o=e,t):(o=e,s=n)}var a=!1,o,s,c=n===void 0?null:n;return[function(){return e(t())},c===null?void 0:function(){return e(c())}]},[t,n,r,u]);var p=a(e,d[0],d[1]);return s(function(){f.hasValue=!0,f.value=p},[p]),l(p),p}})),Dce=o(((e,t)=>{t.exports=Ece()})),QT=(0,N.createContext)(null),Oce=l(Dce()),kce=e=>e,$T=()=>{var e=(0,N.useContext)(QT);return e?e.store.dispatch:kce},eE=()=>{},Ace=()=>eE,jce=(e,t)=>e===t;function tE(e){var t=(0,N.useContext)(QT);return(0,Oce.useSyncExternalStoreWithSelector)(t?t.subscription.addNestedSub:Ace,t?t.store.getState:eE,t?t.store.getState:eE,t?e:eE,jce)}function Mce(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!=`function`)throw TypeError(t)}function Nce(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!=`object`)throw TypeError(t)}function Pce(e,t=`expected all items to be functions, instead received the following types: `){if(!e.every(e=>typeof e==`function`)){let n=e.map(e=>typeof e==`function`?`function ${e.name||`unnamed`}()`:typeof e).join(`, `);throw TypeError(`${t}[${n}]`)}}var nE=e=>Array.isArray(e)?e:[e];function Fce(e){let t=Array.isArray(e[0])?e[0]:e;return Pce(t,`createSelector expects all input-selectors to be functions, but received the following types: `),t}function Ice(e,t){let n=[],{length:r}=e;for(let i=0;i<r;i++)n.push(e[i].apply(null,t));return n}var Lce=class{constructor(e){this.value=e}deref(){return this.value}},Rce=typeof WeakRef<`u`?WeakRef:Lce,zce=0,rE=1;function iE(){return{s:zce,v:void 0,o:null,p:null}}function aE(e,t={}){let n=iE(),{resultEqualityCheck:r}=t,i,a=0;function o(){let t=n,{length:o}=arguments;for(let e=0,n=o;e<n;e++){let n=arguments[e];if(typeof n==`function`||typeof n==`object`&&n){let e=t.o;e===null&&(t.o=e=new WeakMap);let r=e.get(n);r===void 0?(t=iE(),e.set(n,t)):t=r}else{let e=t.p;e===null&&(t.p=e=new Map);let r=e.get(n);r===void 0?(t=iE(),e.set(n,t)):t=r}}let s=t,c;if(t.s===rE)c=t.v;else if(c=e.apply(null,arguments),a++,r){let e=i?.deref?.()??i;e!=null&&r(e,c)&&(c=e,a!==0&&a--),i=typeof c==`object`&&c||typeof c==`function`?new Rce(c):c}return s.s=rE,s.v=c,c}return o.clearCache=()=>{n=iE(),o.resetResultsCount()},o.resultsCount=()=>a,o.resetResultsCount=()=>{a=0},o}function Bce(e,...t){let n=typeof e==`function`?{memoize:e,memoizeOptions:t}:e,r=(...e)=>{let t=0,r=0,i,a={},o=e.pop();typeof o==`object`&&(a=o,o=e.pop()),Mce(o,`createSelector expects an output function after the inputs, but received: [${typeof o}]`);let{memoize:s,memoizeOptions:c=[],argsMemoize:l=aE,argsMemoizeOptions:u=[],devModeChecks:d={}}={...n,...a},f=nE(c),p=nE(u),m=Fce(e),h=s(function(){return t++,o.apply(null,arguments)},...f),g=l(function(){r++;let e=Ice(m,arguments);return i=h.apply(null,e),i},...p);return Object.assign(g,{resultFunc:o,memoizedResultFunc:h,dependencies:m,dependencyRecomputations:()=>r,resetDependencyRecomputations:()=>{r=0},lastResult:()=>i,recomputations:()=>t,resetRecomputations:()=>{t=0},memoize:s,argsMemoize:l})};return Object.assign(r,{withTypes:()=>r}),r}var L=Bce(aE),Vce=Object.assign((e,t=L)=>{Nce(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);let n=Object.keys(e),r=n.map(t=>e[t]);return t(r,(...e)=>e.reduce((e,t,r)=>(e[n[r]]=t,e),{}))},{withTypes:()=>Vce}),Hce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){return typeof e==`symbol`?1:e===null?2:e===void 0?3:e===e?0:4}e.compareValues=(e,n,r)=>{if(e!==n){let i=t(e),a=t(n);if(i===a&&i===0){if(e<n)return r===`desc`?1:-1;if(e>n)return r===`desc`?-1:1}return r===`desc`?a-i:i-a}return 0}})),oE=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){return typeof e==`symbol`||e instanceof Symbol}e.isSymbol=t})),Uce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=oE(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function i(e,i){return Array.isArray(e)?!1:typeof e==`number`||typeof e==`boolean`||e==null||t.isSymbol(e)?!0:typeof e==`string`&&(r.test(e)||!n.test(e))||i!=null&&Object.hasOwn(i,e)}e.isKey=i})),Wce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=Hce(),n=Uce(),r=pT();function i(e,i,a,o){if(e==null)return[];a=o?void 0:a,Array.isArray(e)||(e=Object.values(e)),Array.isArray(i)||(i=i==null?[null]:[i]),i.length===0&&(i=[null]),Array.isArray(a)||(a=a==null?[]:[a]),a=a.map(e=>String(e));let s=(e,t)=>{let n=e;for(let e=0;e<t.length&&n!=null;++e)n=n[t[e]];return n},c=(e,t)=>t==null||e==null?t:typeof e==`object`&&`key`in e?Object.hasOwn(t,e.key)?t[e.key]:s(t,e.path):typeof e==`function`?e(t):Array.isArray(e)?s(t,e):typeof t==`object`?t[e]:t,l=i.map(e=>(Array.isArray(e)&&e.length===1&&(e=e[0]),e==null||typeof e==`function`||Array.isArray(e)||n.isKey(e)?e:{key:e,path:r.toPath(e)}));return e.map(e=>({original:e,criteria:l.map(t=>c(t,e))})).slice().sort((e,n)=>{for(let r=0;r<l.length;r++){let i=t.compareValues(e.criteria[r],n.criteria[r],a[r]);if(i!==0)return i}return 0}).map(e=>e.original)}e.orderBy=i})),Gce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e,t=1){let n=[],r=Math.floor(t),i=(e,t)=>{for(let a=0;a<e.length;a++){let o=e[a];Array.isArray(o)&&t<r?i(o,t+1):n.push(o)}};return i(e,0),n}e.flatten=t})),sE=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=YT(),n=VT(),r=HT(),i=WT();function a(e,a,o){return r.isObject(o)&&(typeof a==`number`&&n.isArrayLike(o)&&t.isIndex(a)&&a<o.length||typeof a==`string`&&a in o)?i.eq(o[a],e):!1}e.isIterateeCall=a})),Kce=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=Wce(),n=Gce(),r=sE();function i(e,...i){let a=i.length;return a>1&&r.isIterateeCall(e,i[0],i[1])?i=[]:a>2&&r.isIterateeCall(i[0],i[1],i[2])&&(i=[i[0]]),t.orderBy(e,n.flatten(i),[`asc`])}e.sortBy=i})),cE=o(((e,t)=>{t.exports=Kce().sortBy})),qce=l(cE()),lE=e=>e.legend.settings,Jce=e=>e.legend.size,Yce=L([e=>e.legend.payload,lE],(e,t)=>{var{itemSorter:n}=t,r=e.flat(1);return n?(0,qce.default)(r,n):r});function Xce(){return tE(Yce)}var uE=1;function dE(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,n]=(0,N.useState)({height:0,left:0,top:0,width:0}),r=(0,N.useCallback)(e=>{if(e!=null){var r=e.getBoundingClientRect(),i={height:r.height,left:r.left,top:r.top,width:r.width};(Math.abs(i.height-t.height)>uE||Math.abs(i.left-t.left)>uE||Math.abs(i.top-t.top)>uE||Math.abs(i.width-t.width)>uE)&&n({height:i.height,left:i.left,top:i.top,width:i.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,r]}function fE(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var pE=(()=>typeof Symbol==`function`&&Symbol.observable||`@@observable`)(),mE=()=>Math.random().toString(36).substring(7).split(``).join(`.`),hE={INIT:`@@redux/INIT${mE()}`,REPLACE:`@@redux/REPLACE${mE()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${mE()}`};function gE(e){if(typeof e!=`object`||!e)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function _E(e,t,n){if(typeof e!=`function`)throw Error(fE(2));if(typeof t==`function`&&typeof n==`function`||typeof n==`function`&&typeof arguments[3]==`function`)throw Error(fE(0));if(typeof t==`function`&&n===void 0&&(n=t,t=void 0),n!==void 0){if(typeof n!=`function`)throw Error(fE(1));return n(_E)(e,t)}let r=e,i=t,a=new Map,o=a,s=0,c=!1;function l(){o===a&&(o=new Map,a.forEach((e,t)=>{o.set(t,e)}))}function u(){if(c)throw Error(fE(3));return i}function d(e){if(typeof e!=`function`)throw Error(fE(4));if(c)throw Error(fE(5));let t=!0;l();let n=s++;return o.set(n,e),function(){if(t){if(c)throw Error(fE(6));t=!1,l(),o.delete(n),a=null}}}function f(e){if(!gE(e))throw Error(fE(7));if(e.type===void 0)throw Error(fE(8));if(typeof e.type!=`string`)throw Error(fE(17));if(c)throw Error(fE(9));try{c=!0,i=r(i,e)}finally{c=!1}return(a=o).forEach(e=>{e()}),e}function p(e){if(typeof e!=`function`)throw Error(fE(10));r=e,f({type:hE.REPLACE})}function m(){let e=d;return{subscribe(t){if(typeof t!=`object`||!t)throw Error(fE(11));function n(){let e=t;e.next&&e.next(u())}return n(),{unsubscribe:e(n)}},[pE](){return this}}}return f({type:hE.INIT}),{dispatch:f,subscribe:d,getState:u,replaceReducer:p,[pE]:m}}function Zce(e){Object.keys(e).forEach(t=>{let n=e[t];if(n(void 0,{type:hE.INIT})===void 0)throw Error(fE(12));if(n(void 0,{type:hE.PROBE_UNKNOWN_ACTION()})===void 0)throw Error(fE(13))})}function vE(e){let t=Object.keys(e),n={};for(let r=0;r<t.length;r++){let i=t[r];typeof e[i]==`function`&&(n[i]=e[i])}let r=Object.keys(n),i;try{Zce(n)}catch(e){i=e}return function(e={},t){if(i)throw i;let a=!1,o={};for(let i=0;i<r.length;i++){let s=r[i],c=n[s],l=e[s],u=c(l,t);if(u===void 0)throw t&&t.type,Error(fE(14));o[s]=u,a||=u!==l}return a||=r.length!==Object.keys(e).length,a?o:e}}function yE(...e){return e.length===0?e=>e:e.length===1?e[0]:e.reduce((e,t)=>(...n)=>e(t(...n)))}function Qce(...e){return t=>(n,r)=>{let i=t(n,r),a=()=>{throw Error(fE(15))},o={getState:i.getState,dispatch:(e,...t)=>a(e,...t)},s=e.map(e=>e(o));return a=yE(...s)(i.dispatch),{...i,dispatch:a}}}function bE(e){return gE(e)&&`type`in e&&typeof e.type==`string`}var xE=Symbol.for(`immer-nothing`),SE=Symbol.for(`immer-draftable`),CE=Symbol.for(`immer-state`);function wE(e,...t){throw Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var TE=Object.getPrototypeOf;function EE(e){return!!e&&!!e[CE]}function DE(e){return e?kE(e)||Array.isArray(e)||!!e[SE]||!!e.constructor?.[SE]||PE(e)||FE(e):!1}var $ce=Object.prototype.constructor.toString(),OE=new WeakMap;function kE(e){if(!e||typeof e!=`object`)return!1;let t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;let n=Object.hasOwnProperty.call(t,`constructor`)&&t.constructor;if(n===Object)return!0;if(typeof n!=`function`)return!1;let r=OE.get(n);return r===void 0&&(r=Function.toString.call(n),OE.set(n,r)),r===$ce}function AE(e,t,n=!0){jE(e)===0?(n?Reflect.ownKeys(e):Object.keys(e)).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function jE(e){let t=e[CE];return t?t.type_:Array.isArray(e)?1:PE(e)?2:FE(e)?3:0}function ME(e,t){return jE(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function NE(e,t,n){let r=jE(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function ele(e,t){return e===t?e!==0||1/e==1/t:e!==e&&t!==t}function PE(e){return e instanceof Map}function FE(e){return e instanceof Set}function IE(e){return e.copy_||e.base_}function LE(e,t){if(PE(e))return new Map(e);if(FE(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);let n=kE(e);if(t===!0||t===`class_only`&&!n){let t=Object.getOwnPropertyDescriptors(e);delete t[CE];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){let i=n[r],a=t[i];a.writable===!1&&(a.writable=!0,a.configurable=!0),(a.get||a.set)&&(t[i]={configurable:!0,writable:!0,enumerable:a.enumerable,value:e[i]})}return Object.create(TE(e),t)}else{let t=TE(e);if(t!==null&&n)return{...e};let r=Object.create(t);return Object.assign(r,e)}}function RE(e,t=!1){return BE(e)||EE(e)||!DE(e)?e:(jE(e)>1&&Object.defineProperties(e,{set:zE,add:zE,clear:zE,delete:zE}),Object.freeze(e),t&&Object.values(e).forEach(e=>RE(e,!0)),e)}function tle(){wE(2)}var zE={value:tle};function BE(e){return typeof e!=`object`||!e?!0:Object.isFrozen(e)}var nle={};function VE(e){let t=nle[e];return t||wE(0,e),t}var HE;function UE(){return HE}function rle(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function WE(e,t){t&&(VE(`Patches`),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function GE(e){KE(e),e.drafts_.forEach(ile),e.drafts_=null}function KE(e){e===HE&&(HE=e.parent_)}function qE(e){return HE=rle(HE,e)}function ile(e){let t=e[CE];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function JE(e,t){t.unfinalizedDrafts_=t.drafts_.length;let n=t.drafts_[0];return e!==void 0&&e!==n?(n[CE].modified_&&(GE(t),wE(4)),DE(e)&&(e=YE(t,e),t.parent_||ZE(t,e)),t.patches_&&VE(`Patches`).generateReplacementPatches_(n[CE].base_,e,t.patches_,t.inversePatches_)):e=YE(t,n,[]),GE(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e===xE?void 0:e}function YE(e,t,n){if(BE(t))return t;let r=e.immer_.shouldUseStrictIteration(),i=t[CE];if(!i)return AE(t,(r,a)=>XE(e,i,t,r,a,n),r),t;if(i.scope_!==e)return t;if(!i.modified_)return ZE(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;let t=i.copy_,a=t,o=!1;i.type_===3&&(a=new Set(t),t.clear(),o=!0),AE(a,(r,a)=>XE(e,i,t,r,a,n,o),r),ZE(e,t,!1),n&&e.patches_&&VE(`Patches`).generatePatches_(i,n,e.patches_,e.inversePatches_)}return i.copy_}function XE(e,t,n,r,i,a,o){if(i==null||typeof i!=`object`&&!o)return;let s=BE(i);if(!(s&&!o)){if(EE(i)){let o=a&&t&&t.type_!==3&&!ME(t.assigned_,r)?a.concat(r):void 0,s=YE(e,i,o);if(NE(n,r,s),EE(s))e.canAutoFreeze_=!1;else return}else o&&n.add(i);if(DE(i)&&!s){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[r]===i&&s)return;YE(e,i),(!t||!t.scope_.parent_)&&typeof r!=`symbol`&&(PE(n)?n.has(r):Object.prototype.propertyIsEnumerable.call(n,r))&&ZE(e,i)}}}function ZE(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&RE(t,n)}function ale(e,t){let n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:UE(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},i=r,a=QE;n&&(i=[r],a=$E);let{revoke:o,proxy:s}=Proxy.revocable(i,a);return r.draft_=s,r.revoke_=o,s}var QE={get(e,t){if(t===CE)return e;let n=IE(e);if(!ME(n,t))return ole(e,n,t);let r=n[t];return e.finalized_||!DE(r)?r:r===eD(e.base_,t)?(rD(e),e.copy_[t]=iD(r,e)):r},has(e,t){return t in IE(e)},ownKeys(e){return Reflect.ownKeys(IE(e))},set(e,t,n){let r=tD(IE(e),t);if(r?.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){let r=eD(IE(e),t),i=r?.[CE];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(ele(n,r)&&(n!==void 0||ME(e.base_,t)))return!0;rD(e),nD(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])?!0:(e.copy_[t]=n,e.assigned_[t]=!0,!0)},deleteProperty(e,t){return eD(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,rD(e),nD(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){let n=IE(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!==`length`,enumerable:r.enumerable,value:n[t]}},defineProperty(){wE(11)},getPrototypeOf(e){return TE(e.base_)},setPrototypeOf(){wE(12)}},$E={};AE(QE,(e,t)=>{$E[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),$E.deleteProperty=function(e,t){return $E.set.call(this,e,t,void 0)},$E.set=function(e,t,n){return QE.set.call(this,e[0],t,n,e[0])};function eD(e,t){let n=e[CE];return(n?IE(n):e)[t]}function ole(e,t,n){let r=tD(t,n);return r?`value`in r?r.value:r.get?.call(e.draft_):void 0}function tD(e,t){if(!(t in e))return;let n=TE(e);for(;n;){let e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=TE(n)}}function nD(e){e.modified_||(e.modified_=!0,e.parent_&&nD(e.parent_))}function rD(e){e.copy_||=LE(e.base_,e.scope_.immer_.useStrictShallowCopy_)}var sle=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(e,t,n)=>{if(typeof e==`function`&&typeof t!=`function`){let n=t;t=e;let r=this;return function(e=n,...i){return r.produce(e,e=>t.call(this,e,...i))}}typeof t!=`function`&&wE(6),n!==void 0&&typeof n!=`function`&&wE(7);let r;if(DE(e)){let i=qE(this),a=iD(e,void 0),o=!0;try{r=t(a),o=!1}finally{o?GE(i):KE(i)}return WE(i,n),JE(r,i)}else if(!e||typeof e!=`object`){if(r=t(e),r===void 0&&(r=e),r===xE&&(r=void 0),this.autoFreeze_&&RE(r,!0),n){let t=[],i=[];VE(`Patches`).generateReplacementPatches_(e,r,t,i),n(t,i)}return r}else wE(1,e)},this.produceWithPatches=(e,t)=>{if(typeof e==`function`)return(t,...n)=>this.produceWithPatches(t,t=>e(t,...n));let n,r;return[this.produce(e,t,(e,t)=>{n=e,r=t}),n,r]},typeof e?.autoFreeze==`boolean`&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy==`boolean`&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof e?.useStrictIteration==`boolean`&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){DE(e)||wE(8),EE(e)&&(e=aD(e));let t=qE(this),n=iD(e,void 0);return n[CE].isManual_=!0,KE(t),n}finishDraft(e,t){let n=e&&e[CE];(!n||!n.isManual_)&&wE(9);let{scope_:r}=n;return WE(r,t),JE(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){let r=t[n];if(r.path.length===0&&r.op===`replace`){e=r.value;break}}n>-1&&(t=t.slice(n+1));let r=VE(`Patches`).applyPatches_;return EE(e)?r(e,t):this.produce(e,e=>r(e,t))}};function iD(e,t){let n=PE(e)?VE(`MapSet`).proxyMap_(e,t):FE(e)?VE(`MapSet`).proxySet_(e,t):ale(e,t);return(t?t.scope_:UE()).drafts_.push(n),n}function aD(e){return EE(e)||wE(10,e),oD(e)}function oD(e){if(!DE(e)||BE(e))return e;let t=e[CE],n,r=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=LE(e,t.scope_.immer_.useStrictShallowCopy_),r=t.scope_.immer_.shouldUseStrictIteration()}else n=LE(e,!0);return AE(n,(e,t)=>{NE(n,e,oD(t))},r),t&&(t.finalized_=!1),n}var sD=new sle().produce;function cD(e){return e}function lD(e){return({dispatch:t,getState:n})=>r=>i=>typeof i==`function`?i(t,n,e):r(i)}var cle=lD(),lle=lD,ule=typeof window<`u`&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]==`object`?yE:yE.apply(null,arguments)};typeof window<`u`&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;function uD(e,t){function n(...n){if(t){let r=t(...n);if(!r)throw Error(YD(0));return{type:e,payload:r.payload,...`meta`in r&&{meta:r.meta},...`error`in r&&{error:r.error}}}return{type:e,payload:n[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=t=>bE(t)&&t.type===e,n}var dD=class e extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(...e){return super.concat.apply(this,e)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new e(...t[0].concat(this)):new e(...t.concat(this))}};function fD(e){return DE(e)?sD(e,()=>{}):e}function pD(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}function dle(e){return typeof e==`boolean`}var fle=()=>function(e){let{thunk:t=!0,immutableCheck:n=!0,serializableCheck:r=!0,actionCreatorCheck:i=!0}=e??{},a=new dD;return t&&(dle(t)?a.push(cle):a.push(lle(t.extraArgument))),a},mD=`RTK_autoBatch`,hD=()=>e=>({payload:e,meta:{[mD]:!0}}),gD=e=>t=>{setTimeout(t,e)},_D=(e={type:`raf`})=>t=>(...n)=>{let r=t(...n),i=!0,a=!1,o=!1,s=new Set,c=e.type===`tick`?queueMicrotask:e.type===`raf`?typeof window<`u`&&window.requestAnimationFrame?window.requestAnimationFrame:gD(10):e.type===`callback`?e.queueNotification:gD(e.timeout),l=()=>{o=!1,a&&(a=!1,s.forEach(e=>e()))};return Object.assign({},r,{subscribe(e){let t=r.subscribe(()=>i&&e());return s.add(e),()=>{t(),s.delete(e)}},dispatch(e){try{return i=!e?.meta?.[mD],a=!i,a&&(o||(o=!0,c(l))),r.dispatch(e)}finally{i=!0}}})},ple=e=>function(t){let{autoBatch:n=!0}=t??{},r=new dD(e);return n&&r.push(_D(typeof n==`object`?n:void 0)),r};function mle(e){let t=fle(),{reducer:n=void 0,middleware:r,devTools:i=!0,duplicateMiddlewareCheck:a=!0,preloadedState:o=void 0,enhancers:s=void 0}=e||{},c;if(typeof n==`function`)c=n;else if(gE(n))c=vE(n);else throw Error(YD(1));let l;l=typeof r==`function`?r(t):t();let u=yE;i&&(u=ule({trace:!1,...typeof i==`object`&&i}));let d=Qce(...l),f=ple(d),p=typeof s==`function`?s(f):f(),m=u(...p);return _E(c,o,m)}function vD(e){let t={},n=[],r,i={addCase(e,n){let r=typeof e==`string`?e:e.type;if(!r)throw Error(YD(28));if(r in t)throw Error(YD(29));return t[r]=n,i},addAsyncThunk(e,r){return r.pending&&(t[e.pending.type]=r.pending),r.rejected&&(t[e.rejected.type]=r.rejected),r.fulfilled&&(t[e.fulfilled.type]=r.fulfilled),r.settled&&n.push({matcher:e.settled,reducer:r.settled}),i},addMatcher(e,t){return n.push({matcher:e,reducer:t}),i},addDefaultCase(e){return r=e,i}};return e(i),[t,n,r]}function hle(e){return typeof e==`function`}function gle(e,t){let[n,r,i]=vD(t),a;if(hle(e))a=()=>fD(e());else{let t=fD(e);a=()=>t}function o(e=a(),t){let o=[n[t.type],...r.filter(({matcher:e})=>e(t)).map(({reducer:e})=>e)];return o.filter(e=>!!e).length===0&&(o=[i]),o.reduce((e,n)=>{if(n)if(EE(e)){let r=n(e,t);return r===void 0?e:r}else if(DE(e))return sD(e,e=>n(e,t));else{let r=n(e,t);if(r===void 0){if(e===null)return e;throw Error(`A case reducer on a non-draftable value must not return undefined`)}return r}return e},e)}return o.getInitialState=a,o}var _le=`ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW`,vle=(e=21)=>{let t=``,n=e;for(;n--;)t+=_le[Math.random()*64|0];return t},yle=Symbol.for(`rtk-slice-createasyncthunk`);function ble(e,t){return`${e}/${t}`}function xle({creators:e}={}){let t=e?.asyncThunk?.[yle];return function(e){let{name:n,reducerPath:r=n}=e;if(!n)throw Error(YD(11));let i=(typeof e.reducers==`function`?e.reducers(Cle()):e.reducers)||{},a=Object.keys(i),o={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},s={addCase(e,t){let n=typeof e==`string`?e:e.type;if(!n)throw Error(YD(12));if(n in o.sliceCaseReducersByType)throw Error(YD(13));return o.sliceCaseReducersByType[n]=t,s},addMatcher(e,t){return o.sliceMatchers.push({matcher:e,reducer:t}),s},exposeAction(e,t){return o.actionCreators[e]=t,s},exposeCaseReducer(e,t){return o.sliceCaseReducersByName[e]=t,s}};a.forEach(r=>{let a=i[r],o={reducerName:r,type:ble(n,r),createNotation:typeof e.reducers==`function`};Tle(a)?Dle(o,a,s,t):wle(o,a,s)});function c(){let[t={},n=[],r=void 0]=typeof e.extraReducers==`function`?vD(e.extraReducers):[e.extraReducers],i={...t,...o.sliceCaseReducersByType};return gle(e.initialState,e=>{for(let t in i)e.addCase(t,i[t]);for(let t of o.sliceMatchers)e.addMatcher(t.matcher,t.reducer);for(let t of n)e.addMatcher(t.matcher,t.reducer);r&&e.addDefaultCase(r)})}let l=e=>e,u=new Map,d=new WeakMap,f;function p(e,t){return f||=c(),f(e,t)}function m(){return f||=c(),f.getInitialState()}function h(t,n=!1){function r(e){let i=e[t];return i===void 0&&n&&(i=pD(d,r,m)),i}function i(t=l){let r=pD(u,n,()=>new WeakMap);return pD(r,t,()=>{let r={};for(let[i,a]of Object.entries(e.selectors??{}))r[i]=Sle(a,t,()=>pD(d,t,m),n);return r})}return{reducerPath:t,getSelectors:i,get selectors(){return i(r)},selectSlice:r}}let g={name:n,reducer:p,actions:o.actionCreators,caseReducers:o.sliceCaseReducersByName,getInitialState:m,...h(r),injectInto(e,{reducerPath:t,...n}={}){let i=t??r;return e.inject({reducerPath:i,reducer:p},n),{...g,...h(i,!0)}}};return g}}function Sle(e,t,n,r){function i(i,...a){let o=t(i);return o===void 0&&r&&(o=n()),e(o,...a)}return i.unwrapped=e,i}var yD=xle();function Cle(){function e(e,t){return{_reducerDefinitionType:`asyncThunk`,payloadCreator:e,...t}}return e.withTypes=()=>e,{reducer(e){return Object.assign({[e.name](...t){return e(...t)}}[e.name],{_reducerDefinitionType:`reducer`})},preparedReducer(e,t){return{_reducerDefinitionType:`reducerWithPrepare`,prepare:e,reducer:t}},asyncThunk:e}}function wle({type:e,reducerName:t,createNotation:n},r,i){let a,o;if(`reducer`in r){if(n&&!Ele(r))throw Error(YD(17));a=r.reducer,o=r.prepare}else a=r;i.addCase(e,a).exposeCaseReducer(t,a).exposeAction(t,o?uD(e,o):uD(e))}function Tle(e){return e._reducerDefinitionType===`asyncThunk`}function Ele(e){return e._reducerDefinitionType===`reducerWithPrepare`}function Dle({type:e,reducerName:t},n,r,i){if(!i)throw Error(YD(18));let{payloadCreator:a,fulfilled:o,pending:s,rejected:c,settled:l,options:u}=n,d=i(e,a,u);r.exposeAction(t,d),o&&r.addCase(d.fulfilled,o),s&&r.addCase(d.pending,s),c&&r.addCase(d.rejected,c),l&&r.addMatcher(d.settled,l),r.exposeCaseReducer(t,{fulfilled:o||bD,pending:s||bD,rejected:c||bD,settled:l||bD})}function bD(){}var Ole=`task`,xD=`listener`,SD=`completed`,CD=`cancelled`,kle=`task-${CD}`,Ale=`task-${SD}`,wD=`${xD}-${CD}`,jle=`${xD}-${SD}`,TD=class{constructor(e){this.code=e,this.message=`${Ole} ${CD} (reason: ${e})`}name=`TaskAbortError`;message},ED=(e,t)=>{if(typeof e!=`function`)throw TypeError(YD(32))},DD=()=>{},OD=(e,t=DD)=>(e.catch(t),e),kD=(e,t)=>(e.addEventListener(`abort`,t,{once:!0}),()=>e.removeEventListener(`abort`,t)),AD=(e,t)=>{let n=e.signal;n.aborted||(`reason`in n||Object.defineProperty(n,`reason`,{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},jD=e=>{if(e.aborted){let{reason:t}=e;throw new TD(t)}};function MD(e,t){let n=DD;return new Promise((r,i)=>{let a=()=>i(new TD(e.reason));if(e.aborted){a();return}n=kD(e,a),t.finally(()=>n()).then(r,i)}).finally(()=>{n=DD})}var Mle=async(e,t)=>{try{return await Promise.resolve(),{status:`ok`,value:await e()}}catch(e){return{status:e instanceof TD?`cancelled`:`rejected`,error:e}}finally{t?.()}},ND=e=>t=>OD(MD(e,t).then(t=>(jD(e),t))),PD=e=>{let t=ND(e);return e=>t(new Promise(t=>setTimeout(t,e)))},{assign:FD}=Object,ID={},LD=`listenerMiddleware`,Nle=(e,t)=>{let n=t=>kD(e,()=>AD(t,e.reason));return(r,i)=>{ED(r,`taskExecutor`);let a=new AbortController;n(a);let o=Mle(async()=>{jD(e),jD(a.signal);let t=await r({pause:ND(a.signal),delay:PD(a.signal),signal:a.signal});return jD(a.signal),t},()=>AD(a,Ale));return i?.autoJoin&&t.push(o.catch(DD)),{result:ND(e)(o),cancel(){AD(a,kle)}}}},Ple=(e,t)=>{let n=async(n,r)=>{jD(t);let i=()=>{},a=[new Promise((t,r)=>{let a=e({predicate:n,effect:(e,n)=>{n.unsubscribe(),t([e,n.getState(),n.getOriginalState()])}});i=()=>{a(),r()}})];r!=null&&a.push(new Promise(e=>setTimeout(e,r,null)));try{let e=await MD(t,Promise.race(a));return jD(t),e}finally{i()}};return(e,t)=>OD(n(e,t))},RD=e=>{let{type:t,actionCreator:n,matcher:r,predicate:i,effect:a}=e;if(t)i=uD(t).match;else if(n)t=n.type,i=n.match;else if(r)i=r;else if(!i)throw Error(YD(21));return ED(a,`options.listener`),{predicate:i,type:t,effect:a}},zD=FD(e=>{let{type:t,predicate:n,effect:r}=RD(e);return{id:vle(),effect:r,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw Error(YD(22))}}},{withTypes:()=>zD}),BD=(e,t)=>{let{type:n,effect:r,predicate:i}=RD(t);return Array.from(e.values()).find(e=>(typeof n==`string`?e.type===n:e.predicate===i)&&e.effect===r)},VD=e=>{e.pending.forEach(e=>{AD(e,wD)})},HD=(e,t)=>()=>{for(let e of t.keys())VD(e);e.clear()},UD=(e,t,n)=>{try{e(t,n)}catch(e){setTimeout(()=>{throw e},0)}},WD=FD(uD(`${LD}/add`),{withTypes:()=>WD}),GD=uD(`${LD}/removeAll`),KD=FD(uD(`${LD}/remove`),{withTypes:()=>KD}),qD=(...e)=>{console.error(`${LD}/error`,...e)},JD=(e={})=>{let t=new Map,n=new Map,r=e=>{let t=n.get(e)??0;n.set(e,t+1)},i=e=>{let t=n.get(e)??1;t===1?n.delete(e):n.set(e,t-1)},{extra:a,onError:o=qD}=e;ED(o,`onError`);let s=e=>(e.unsubscribe=()=>t.delete(e.id),t.set(e.id,e),t=>{e.unsubscribe(),t?.cancelActive&&VD(e)}),c=e=>{let n=BD(t,e)??zD(e);return s(n)};FD(c,{withTypes:()=>c});let l=e=>{let n=BD(t,e);return n&&(n.unsubscribe(),e.cancelActive&&VD(n)),!!n};FD(l,{withTypes:()=>l});let u=async(e,n,s,l)=>{let u=new AbortController,d=Ple(c,u.signal),f=[];try{e.pending.add(u),r(e),await Promise.resolve(e.effect(n,FD({},s,{getOriginalState:l,condition:(e,t)=>d(e,t).then(Boolean),take:d,delay:PD(u.signal),pause:ND(u.signal),extra:a,signal:u.signal,fork:Nle(u.signal,f),unsubscribe:e.unsubscribe,subscribe:()=>{t.set(e.id,e)},cancelActiveListeners:()=>{e.pending.forEach((e,t,n)=>{e!==u&&(AD(e,wD),n.delete(e))})},cancel:()=>{AD(u,wD),e.pending.delete(u)},throwIfCancelled:()=>{jD(u.signal)}})))}catch(e){e instanceof TD||UD(o,e,{raisedBy:`effect`})}finally{await Promise.all(f),AD(u,jle),i(e),e.pending.delete(u)}},d=HD(t,n);return{middleware:e=>n=>r=>{if(!bE(r))return n(r);if(WD.match(r))return c(r.payload);if(GD.match(r)){d();return}if(KD.match(r))return l(r.payload);let i=e.getState(),a=()=>{if(i===ID)throw Error(YD(23));return i},s;try{if(s=n(r),t.size>0){let n=e.getState(),s=Array.from(t.values());for(let t of s){let s=!1;try{s=t.predicate(r,n,i)}catch(e){s=!1,UD(o,e,{raisedBy:`predicate`})}s&&u(t,r,e,a)}}}finally{i=ID}return s},startListening:c,stopListening:l,clearListeners:d}};function YD(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var XD=yD({name:`chartLayout`,initialState:{layoutType:`horizontal`,width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){e.margin.top=t.payload.top??0,e.margin.right=t.payload.right??0,e.margin.bottom=t.payload.bottom??0,e.margin.left=t.payload.left??0},setScale(e,t){e.scale=t.payload}}}),{setMargin:ZD,setLayout:QD,setChartSize:$D,setScale:eO}=XD.actions,tO=XD.reducer;function nO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function rO(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?nO(Object(n),!0).forEach(function(t){iO(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function iO(e,t,n){return(t=aO(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aO(e){var t=oO(e,`string`);return typeof t==`symbol`?t:t+``}function oO(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var sO=Math.PI/180,cO=e=>e*180/Math.PI,lO=(e,t,n,r)=>({x:e+Math.cos(-sO*r)*n,y:t+Math.sin(-sO*r)*n}),uO=function(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0,width:0,height:0,brushBottom:0};return Math.min(Math.abs(e-(n.left||0)-(n.right||0)),Math.abs(t-(n.top||0)-(n.bottom||0)))/2},dO=(e,t)=>{var{x:n,y:r}=e,{x:i,y:a}=t;return Math.sqrt((n-i)**2+(r-a)**2)},fO=(e,t)=>{var{x:n,y:r}=e,{cx:i,cy:a}=t,o=dO({x:n,y:r},{x:i,y:a});if(o<=0)return{radius:o,angle:0};var s=(n-i)/o,c=Math.acos(s);return r>a&&(c=2*Math.PI-c),{radius:o,angle:cO(c),angleInRadian:c}},pO=e=>{var{startAngle:t,endAngle:n}=e,r=Math.floor(t/360),i=Math.floor(n/360),a=Math.min(r,i);return{startAngle:t-a*360,endAngle:n-a*360}},mO=(e,t)=>{var{startAngle:n,endAngle:r}=t,i=Math.floor(n/360),a=Math.floor(r/360);return e+Math.min(i,a)*360},hO=(e,t)=>{var{x:n,y:r}=e,{radius:i,angle:a}=fO({x:n,y:r},t),{innerRadius:o,outerRadius:s}=t;if(i<o||i>s||i===0)return null;var{startAngle:c,endAngle:l}=pO(t),u=a,d;if(c<=l){for(;u>l;)u-=360;for(;u<c;)u+=360;d=u>=c&&u<=l}else{for(;u>c;)u-=360;for(;u<l;)u+=360;d=u>=l&&u<=c}return d?rO(rO({},t),{},{radius:i,angle:mO(u,t)}):null};function gO(e,t,n){return Array.isArray(e)&&e&&t+n!==0?e.slice(t,n+1):e}var _O=l(cE()),vO=l(hT());function yO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function bO(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?yO(Object(n),!0).forEach(function(t){xO(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function xO(e,t,n){return(t=SO(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SO(e){var t=CO(e,`string`);return typeof t==`symbol`?t:t+``}function CO(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function wO(e,t,n){return ET(e)||ET(t)?n:bT(t)?(0,vO.default)(e,t,n):typeof t==`function`?t(e):n}var TO=(e,t,n,r,i)=>{var a=-1,o=t?.length??0;if(o<=1||e==null)return 0;if(r===`angleAxis`&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var s=0;s<o;s++){var c=s>0?n[s-1].coordinate:n[o-1].coordinate,l=n[s].coordinate,u=s>=o-1?n[0].coordinate:n[s+1].coordinate,d=void 0;if(gT(l-c)!==gT(u-l)){var f=[];if(gT(u-l)===gT(i[1]-i[0])){d=u;var p=l+i[1]-i[0];f[0]=Math.min(p,(p+c)/2),f[1]=Math.max(p,(p+c)/2)}else{d=c;var m=u+i[1]-i[0];f[0]=Math.min(l,(m+l)/2),f[1]=Math.max(l,(m+l)/2)}var h=[Math.min(l,(d+l)/2),Math.max(l,(d+l)/2)];if(e>h[0]&&e<=h[1]||e>=f[0]&&e<=f[1]){({index:a}=n[s]);break}}else{var g=Math.min(c,u),_=Math.max(c,u);if(e>(g+l)/2&&e<=(_+l)/2){({index:a}=n[s]);break}}}else if(t){for(var v=0;v<o;v++)if(v===0&&e<=(t[v].coordinate+t[v+1].coordinate)/2||v>0&&v<o-1&&e>(t[v].coordinate+t[v-1].coordinate)/2&&e<=(t[v].coordinate+t[v+1].coordinate)/2||v===o-1&&e>(t[v].coordinate+t[v-1].coordinate)/2){({index:a}=t[v]);break}}return a},EO=(e,t,n)=>{if(t&&n){var{width:r,height:i}=n,{align:a,verticalAlign:o,layout:s}=t;if((s===`vertical`||s===`horizontal`&&o===`middle`)&&a!==`center`&&yT(e[a]))return bO(bO({},e),{},{[a]:e[a]+(r||0)});if((s===`horizontal`||s===`vertical`&&a===`center`)&&o!==`middle`&&yT(e[o]))return bO(bO({},e),{},{[o]:e[o]+(i||0)})}return e},DO=(e,t)=>e===`horizontal`&&t===`xAxis`||e===`vertical`&&t===`yAxis`||e===`centric`&&t===`angleAxis`||e===`radial`&&t===`radiusAxis`,OO=(e,t,n,r)=>{if(r)return e.map(e=>e.coordinate);var i,a,o=e.map(e=>(e.coordinate===t&&(i=!0),e.coordinate===n&&(a=!0),e.coordinate));return i||o.push(t),a||o.push(n),o},kO=(e,t,n)=>{if(!e)return null;var{duplicateDomain:r,type:i,range:a,scale:o,realScaleType:s,isCategorical:c,categoricalDomain:l,tickCount:u,ticks:d,niceTicks:f,axisType:p}=e;if(!o)return null;var m=s===`scaleBand`&&o.bandwidth?o.bandwidth()/2:2,h=(t||n)&&i===`category`&&o.bandwidth?o.bandwidth()/m:0;return h=p===`angleAxis`&&a&&a.length>=2?gT(a[0]-a[1])*2*h:h,t&&(d||f)?(d||f||[]).map((e,t)=>{var n=r?r.indexOf(e):e;return{coordinate:o(n)+h,value:e,offset:h,index:t}}).filter(e=>!_T(e.coordinate)):c&&l?l.map((e,t)=>({coordinate:o(e)+h,value:e,index:t,offset:h})):o.ticks&&!n&&u!=null?o.ticks(u).map((e,t)=>({coordinate:o(e)+h,value:e,offset:h,index:t})):o.domain().map((e,t)=>({coordinate:o(e)+h,value:r?r[e]:e,index:t,offset:h}))},AO=1e-4,jO=e=>{var t=e.domain();if(!(!t||t.length<=2)){var n=t.length,r=e.range(),i=Math.min(r[0],r[1])-AO,a=Math.max(r[0],r[1])+AO,o=e(t[0]),s=e(t[n-1]);(o<i||o>a||s<i||s>a)&&e.domain([t[0],t[n-1]])}},MO=(e,t)=>{if(!t||t.length!==2||!yT(t[0])||!yT(t[1]))return e;var n=Math.min(t[0],t[1]),r=Math.max(t[0],t[1]),i=[e[0],e[1]];return(!yT(e[0])||e[0]<n)&&(i[0]=n),(!yT(e[1])||e[1]>r)&&(i[1]=r),i[0]>r&&(i[0]=r),i[1]<n&&(i[1]=n),i},NO={sign:e=>{var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var i=0,a=0,o=0;o<t;++o){var s=_T(e[o][n][1])?e[o][n][0]:e[o][n][1];s>=0?(e[o][n][0]=i,e[o][n][1]=i+s,i=e[o][n][1]):(e[o][n][0]=a,e[o][n][1]=a+s,a=e[o][n][1])}},expand:Bse,none:lT,silhouette:Vse,wiggle:Hse,positive:e=>{var t=e.length;if(!(t<=0))for(var n=0,r=e[0].length;n<r;++n)for(var i=0,a=0;a<t;++a){var o=_T(e[a][n][1])?e[a][n][0]:e[a][n][1];o>=0?(e[a][n][0]=i,e[a][n][1]=i+o,i=e[a][n][1]):(e[a][n][0]=0,e[a][n][1]=0)}}},PO=(e,t,n)=>{var r=NO[n];return zse().keys(t).value((e,t)=>+wO(e,t,0)).order(uT).offset(r)(e)};function FO(e){return e==null?void 0:String(e)}function IO(e){var{axis:t,ticks:n,bandSize:r,entry:i,index:a,dataKey:o}=e;if(t.type===`category`){if(!t.allowDuplicatedCategory&&t.dataKey&&!ET(i[t.dataKey])){var s=TT(n,`value`,i[t.dataKey]);if(s)return s.coordinate+r/2}return n[a]?n[a].coordinate+r/2:null}var c=wO(i,ET(o)?t.dataKey:o);return ET(c)?null:t.scale(c)}var LO=e=>{var{axis:t,ticks:n,offset:r,bandSize:i,entry:a,index:o}=e;if(t.type===`category`)return n[o]?n[o].coordinate+r:null;var s=wO(a,t.dataKey,t.scale.domain()[o]);return ET(s)?null:t.scale(s)-i/2+r},RO=e=>{var{numericAxis:t}=e,n=t.scale.domain();if(t.type===`number`){var r=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]);return r<=0&&i>=0?0:i<0?i:r}return n[0]},zO=e=>{var t=e.flat(2).filter(yT);return[Math.min(...t),Math.max(...t)]},BO=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],VO=(e,t,n)=>{if(e!=null)return BO(Object.keys(e).reduce((r,i)=>{var{stackedData:a}=e[i],o=a.reduce((e,r)=>{var i=gO(r,t,n),a=zO(i);return[Math.min(e[0],a[0]),Math.max(e[1],a[1])]},[1/0,-1/0]);return[Math.min(o[0],r[0]),Math.max(o[1],r[1])]},[1/0,-1/0]))},HO=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,UO=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,WO=(e,t,n)=>{if(e&&e.scale&&e.scale.bandwidth){var r=e.scale.bandwidth();if(!n||r>0)return r}if(e&&t&&t.length>=2){for(var i=(0,_O.default)(t,e=>e.coordinate),a=1/0,o=1,s=i.length;o<s;o++){var c=i[o],l=i[o-1];a=Math.min((c.coordinate||0)-(l.coordinate||0),a)}return a===1/0?0:a}return n?void 0:0};function GO(e){var{tooltipEntrySettings:t,dataKey:n,payload:r,value:i,name:a}=e;return bO(bO({},t),{},{dataKey:n,payload:r,value:i,name:a})}function KO(e,t){if(e)return String(e);if(typeof t==`string`)return t}function qO(e,t,n,r,i){return n===`horizontal`||n===`vertical`?e>=i.left&&e<=i.left+i.width&&t>=i.top&&t<=i.top+i.height?{x:e,y:t}:null:r?hO({x:e,y:t},r):null}var JO=(e,t,n,r)=>{var i=t.find(e=>e&&e.index===n);if(i){if(e===`horizontal`)return{x:i.coordinate,y:r.y};if(e===`vertical`)return{x:r.x,y:i.coordinate};if(e===`centric`){var a=i.coordinate,{radius:o}=r;return bO(bO(bO({},r),lO(r.cx,r.cy,o,a)),{},{angle:a,radius:o})}var s=i.coordinate,{angle:c}=r;return bO(bO(bO({},r),lO(r.cx,r.cy,s,c)),{},{angle:c,radius:s})}return{x:0,y:0}},YO=(e,t)=>t===`horizontal`?e.x:t===`vertical`?e.y:t===`centric`?e.angle:e.radius,XO=e=>e.layout.width,ZO=e=>e.layout.height,QO=e=>e.layout.scale,$O=e=>e.layout.margin,ek=L(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),tk=L(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),nk=`data-recharts-item-index`;function rk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ik(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?rk(Object(n),!0).forEach(function(t){ak(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ak(e,t,n){return(t=ok(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ok(e){var t=sk(e,`string`);return typeof t==`symbol`?t:t+``}function sk(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var ck=e=>e.brush.height;function lk(e){return tk(e).reduce((e,t)=>{if(t.orientation===`left`&&!t.mirror&&!t.hide){var n=typeof t.width==`number`?t.width:60;return e+n}return e},0)}function uk(e){return tk(e).reduce((e,t)=>{if(t.orientation===`right`&&!t.mirror&&!t.hide){var n=typeof t.width==`number`?t.width:60;return e+n}return e},0)}function dk(e){return ek(e).reduce((e,t)=>t.orientation===`top`&&!t.mirror&&!t.hide?e+t.height:e,0)}function fk(e){return ek(e).reduce((e,t)=>t.orientation===`bottom`&&!t.mirror&&!t.hide?e+t.height:e,0)}var pk=L([XO,ZO,$O,ck,lk,uk,dk,fk,lE,Jce],(e,t,n,r,i,a,o,s,c,l)=>{var u={left:(n.left||0)+i,right:(n.right||0)+a},d={top:(n.top||0)+o,bottom:(n.bottom||0)+s},f=ik(ik({},d),u),p=f.bottom;f.bottom+=r,f=EO(f,c,l);var m=e-f.left-f.right,h=t-f.top-f.bottom;return ik(ik({brushBottom:p},f),{},{width:Math.max(m,0),height:Math.max(h,0)})}),mk=L(pk,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),hk=L(XO,ZO,(e,t)=>({x:0,y:0,width:e,height:t})),gk=(0,N.createContext)(null),_k=()=>(0,N.useContext)(gk)!=null,vk=e=>e.brush,yk=L([vk,pk,$O],(e,t,n)=>({height:e.height,x:yT(e.x)?e.x:t.left,y:yT(e.y)?e.y:t.top+t.height+t.brushBottom-(n?.bottom||0),width:yT(e.width)?e.width:t.width})),bk=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e,t,{signal:n,edges:r}={}){let i,a=null,o=r!=null&&r.includes(`leading`),s=r==null||r.includes(`trailing`),c=()=>{a!==null&&(e.apply(i,a),i=void 0,a=null)},l=()=>{s&&c(),p()},u=null,d=()=>{u!=null&&clearTimeout(u),u=setTimeout(()=>{u=null,l()},t)},f=()=>{u!==null&&(clearTimeout(u),u=null)},p=()=>{f(),i=void 0,a=null},m=()=>{c()},h=function(...e){if(n?.aborted)return;i=this,a=e;let t=u==null;d(),o&&t&&c()};return h.schedule=d,h.cancel=p,h.flush=m,n?.addEventListener(`abort`,p,{once:!0}),h}e.debounce=t})),xk=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=bk();function n(e,n=0,r={}){typeof r!=`object`&&(r={});let{leading:i=!1,trailing:a=!0,maxWait:o}=r,s=[,,];i&&(s[0]=`leading`),a&&(s[1]=`trailing`);let c,l=null,u=t.debounce(function(...t){c=e.apply(this,t),l=null},n,{edges:s}),d=function(...t){return o!=null&&(l===null&&(l=Date.now()),Date.now()-l>=o)?(c=e.apply(this,t),l=Date.now(),u.cancel(),u.schedule(),c):(u.apply(this,t),c)};return d.cancel=u.cancel,d.flush=()=>(u.flush(),c),d}e.debounce=n})),Sk=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=xk();function n(e,n=0,r={}){let{leading:i=!0,trailing:a=!0}=r;return t.debounce(e,n,{leading:i,maxWait:n,trailing:a})}e.throttle=n})),Ck=o(((e,t)=>{t.exports=Sk().throttle})),wk=!1,Tk=function(e,t){var n=[...arguments].slice(2);if(wk&&typeof console<`u`&&console.warn&&(t===void 0&&console.warn(`LogUtils requires an error message argument`),!e))if(t===void 0)console.warn(`Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.`);else{var r=0;console.warn(t.replace(/%s/g,()=>n[r++]))}},Ek=(e,t,n)=>{var{width:r=`100%`,height:i=`100%`,aspect:a,maxHeight:o}=n,s=vT(r)?e:Number(r),c=vT(i)?t:Number(i);return a&&a>0&&(s?c=s/a:c&&(s=c*a),o&&c>o&&(c=o)),{calculatedWidth:s,calculatedHeight:c}},Dk={width:0,height:0,overflow:`visible`},Ok={width:0,overflowX:`visible`},kk={height:0,overflowY:`visible`},Ak={},jk=e=>{var{width:t,height:n}=e,r=vT(t),i=vT(n);return r&&i?Dk:r?Ok:i?kk:Ak};function Mk(e){var{width:t,height:n,aspect:r}=e,i=t,a=n;return i===void 0&&a===void 0?(i=`100%`,a=`100%`):i===void 0?i=r&&r>0?void 0:`100%`:a===void 0&&(a=r&&r>0?void 0:`100%`),{width:i,height:a}}function Nk(e){return Number.isFinite(e)}function Pk(e){return typeof e==`number`&&e>0&&Number.isFinite(e)}var Fk=l(Ck());function Ik(){return Ik=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ik.apply(null,arguments)}function Lk(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Rk(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?Lk(Object(n),!0).forEach(function(t){zk(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lk(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function zk(e,t,n){return(t=Bk(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bk(e){var t=Fle(e,`string`);return typeof t==`symbol`?t:t+``}function Fle(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var Vk=(0,N.createContext)({width:-1,height:-1});function Hk(e){var{children:t,width:n,height:r}=e,i=(0,N.useMemo)(()=>({width:n,height:r}),[n,r]);return n<=0||r<=0?null:N.createElement(Vk.Provider,{value:i},t)}var Uk=()=>(0,N.useContext)(Vk),Ile=(0,N.forwardRef)((e,t)=>{var{aspect:n,initialDimension:r={width:-1,height:-1},width:i,height:a,minWidth:o=0,minHeight:s,maxHeight:c,children:l,debounce:u=0,id:d,className:f,onResize:p,style:m={}}=e,h=(0,N.useRef)(null),g=(0,N.useRef)();g.current=p,(0,N.useImperativeHandle)(t,()=>h.current);var[_,v]=(0,N.useState)({containerWidth:r.width,containerHeight:r.height}),y=(0,N.useCallback)((e,t)=>{v(n=>{var r=Math.round(e),i=Math.round(t);return n.containerWidth===r&&n.containerHeight===i?n:{containerWidth:r,containerHeight:i}})},[]);(0,N.useEffect)(()=>{var e=e=>{var t,{width:n,height:r}=e[0].contentRect;y(n,r),(t=g.current)==null||t.call(g,n,r)};u>0&&(e=(0,Fk.default)(e,u,{trailing:!0,leading:!1}));var t=new ResizeObserver(e),{width:n,height:r}=h.current.getBoundingClientRect();return y(n,r),t.observe(h.current),()=>{t.disconnect()}},[y,u]);var{containerWidth:b,containerHeight:x}=_;Tk(!n||n>0,`The aspect(%s) must be greater than zero.`,n);var{calculatedWidth:S,calculatedHeight:C}=Ek(b,x,{width:i,height:a,aspect:n,maxHeight:c});return Tk(S>0||C>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,S,C,i,a,o,s,n),N.createElement(`div`,{id:d?`${d}`:void 0,className:cw(`recharts-responsive-container`,f),style:Rk(Rk({},m),{},{width:i,height:a,minWidth:o,minHeight:s,maxHeight:c}),ref:h},N.createElement(`div`,{style:jk({width:i,height:a})},N.createElement(Hk,{width:S,height:C},l)))}),Wk=(0,N.forwardRef)((e,t)=>{var n=Uk();if(Pk(n.width)&&Pk(n.height))return e.children;var{width:r,height:i}=Mk({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:a,calculatedHeight:o}=Ek(void 0,void 0,{width:r,height:i,aspect:e.aspect,maxHeight:e.maxHeight});return yT(a)&&yT(o)?N.createElement(Hk,{width:a,height:o},e.children):N.createElement(Ile,Ik({},e,{width:r,height:i,ref:t}))}),Gk=()=>{var e=_k(),t=tE(mk),n=tE(yk),r=tE(vk)?.padding;return!e||!n||!r?t:{width:n.width-r.left-r.right,height:n.height-r.top-r.bottom,x:r.left,y:r.top}},Lle={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Kk=()=>tE(pk)??Lle,qk=()=>tE(XO),Jk=()=>tE(ZO),Rle=()=>tE(e=>e.layout.margin),Yk=e=>e.layout.layoutType,Xk=()=>tE(Yk),Zk=e=>{var t=$T(),n=_k(),{width:r,height:i}=e,a=Uk(),o=r,s=i;return a&&(o=a.width>0?a.width:r,s=a.height>0?a.height:i),(0,N.useEffect)(()=>{!n&&Pk(o)&&Pk(s)&&t($D({width:o,height:s}))},[t,n,o,s]),null},Qk=yD({name:`legend`,initialState:{settings:{layout:`horizontal`,align:`center`,verticalAlign:`middle`,itemSorter:`value`},size:{width:0,height:0},payload:[]},reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(cD(t.payload))},prepare:hD()},removeLegendPayload:{reducer(e,t){var n=aD(e).payload.indexOf(cD(t.payload));n>-1&&e.payload.splice(n,1)},prepare:hD()}}}),{setLegendSize:$k,setLegendSettings:zle,addLegendPayload:Ble,removeLegendPayload:Vle}=Qk.actions,Hle=Qk.reducer,Ule=l(eC()),Wle=[`contextPayload`];function eA(){return eA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eA.apply(null,arguments)}function tA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function nA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?tA(Object(n),!0).forEach(function(t){rA(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function rA(e,t,n){return(t=Gle(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gle(e){var t=Kle(e,`string`);return typeof t==`symbol`?t:t+``}function Kle(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function qle(e,t){if(e==null)return{};var n,r,i=Jle(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Jle(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function Yle(e){return e.value}function Xle(e){var{contextPayload:t}=e,n=qle(e,Wle),r=ZT(t,e.payloadUniqBy,Yle),i=nA(nA({},n),{},{payload:r});return N.isValidElement(e.content)?N.cloneElement(e.content,i):typeof e.content==`function`?N.createElement(e.content,i):N.createElement(zT,i)}function Zle(e,t,n,r,i,a){var{layout:o,align:s,verticalAlign:c}=t,l,u;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(l=s===`center`&&o===`vertical`?{left:((r||0)-a.width)/2}:s===`right`?{right:n&&n.right||0}:{left:n&&n.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(u=c===`middle`?{top:((i||0)-a.height)/2}:c===`bottom`?{bottom:n&&n.bottom||0}:{top:n&&n.top||0}),nA(nA({},l),u)}function Qle(e){var t=$T();return(0,N.useEffect)(()=>{t(zle(e))},[t,e]),null}function $le(e){var t=$T();return(0,N.useEffect)(()=>(t($k(e)),()=>{t($k({width:0,height:0}))}),[t,e]),null}function eue(e){var t=Xce(),n=lse(),r=Rle(),{width:i,height:a,wrapperStyle:o,portal:s}=e,[c,l]=dE([t]),u=qk(),d=Jk();if(u==null||d==null)return null;var f=u-(r.left||0)-(r.right||0),p=iA.getWidthOrHeight(e.layout,a,i,f),m=s?o:nA(nA({position:`absolute`,width:p?.width||i||`auto`,height:p?.height||a||`auto`},Zle(o,e,r,u,d,c)),o),h=s??n;if(h==null)return null;var g=N.createElement(`div`,{className:`recharts-legend-wrapper`,style:m,ref:l},N.createElement(Qle,{layout:e.layout,align:e.align,verticalAlign:e.verticalAlign,itemSorter:e.itemSorter}),N.createElement($le,{width:c.width,height:c.height}),N.createElement(Xle,eA({},e,p,{margin:r,chartWidth:u,chartHeight:d,contextPayload:t})));return(0,Ule.createPortal)(g,h)}var iA=class extends N.PureComponent{static getWidthOrHeight(e,t,n,r){return e===`vertical`&&yT(t)?{height:t}:e===`horizontal`?{width:n||r}:null}render(){return N.createElement(eue,this.props)}};rA(iA,`displayName`,`Legend`),rA(iA,`defaultProps`,{align:`center`,iconSize:14,itemSorter:`value`,layout:`horizontal`,verticalAlign:`bottom`});var tue=l(cE());function aA(){return aA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},aA.apply(null,arguments)}function oA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function sA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?oA(Object(n),!0).forEach(function(t){nue(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function nue(e,t,n){return(t=rue(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rue(e){var t=iue(e,`string`);return typeof t==`symbol`?t:t+``}function iue(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function aue(e){return Array.isArray(e)&&bT(e[0])&&bT(e[1])?e.join(` ~ `):e}var oue=e=>{var{separator:t=` : `,contentStyle:n={},itemStyle:r={},labelStyle:i={},payload:a,formatter:o,itemSorter:s,wrapperClassName:c,labelClassName:l,label:u,labelFormatter:d,accessibilityLayer:f=!1}=e,p=()=>{if(a&&a.length){var e={padding:0,margin:0},n=(s?(0,tue.default)(a,s):a).map((e,n)=>{if(e.type===`none`)return null;var i=e.formatter||o||aue,{value:s,name:c}=e,l=s,u=c;if(i){var d=i(s,c,e,n,a);if(Array.isArray(d))[l,u]=d;else if(d!=null)l=d;else return null}var f=sA({display:`block`,paddingTop:4,paddingBottom:4,color:e.color||`#000`},r);return N.createElement(`li`,{className:`recharts-tooltip-item`,key:`tooltip-item-${n}`,style:f},bT(u)?N.createElement(`span`,{className:`recharts-tooltip-item-name`},u):null,bT(u)?N.createElement(`span`,{className:`recharts-tooltip-item-separator`},t):null,N.createElement(`span`,{className:`recharts-tooltip-item-value`},l),N.createElement(`span`,{className:`recharts-tooltip-item-unit`},e.unit||``))});return N.createElement(`ul`,{className:`recharts-tooltip-item-list`,style:e},n)}return null},m=sA({margin:0,padding:10,backgroundColor:`#fff`,border:`1px solid #ccc`,whiteSpace:`nowrap`},n),h=sA({margin:0},i),g=!ET(u),_=g?u:``,v=cw(`recharts-default-tooltip`,c),y=cw(`recharts-tooltip-label`,l);g&&d&&a!=null&&(_=d(u,a));var b=f?{role:`status`,"aria-live":`assertive`}:{};return N.createElement(`div`,aA({className:v,style:m},b),N.createElement(`p`,{className:y,style:h},N.isValidElement(_)?_:`${_}`),p())},cA=`recharts-tooltip-wrapper`,sue={visibility:`hidden`};function cue(e){var{coordinate:t,translateX:n,translateY:r}=e;return cw(cA,{[`${cA}-right`]:yT(n)&&t&&yT(t.x)&&n>=t.x,[`${cA}-left`]:yT(n)&&t&&yT(t.x)&&n<t.x,[`${cA}-bottom`]:yT(r)&&t&&yT(t.y)&&r>=t.y,[`${cA}-top`]:yT(r)&&t&&yT(t.y)&&r<t.y})}function lA(e){var{allowEscapeViewBox:t,coordinate:n,key:r,offsetTopLeft:i,position:a,reverseDirection:o,tooltipDimension:s,viewBox:c,viewBoxDimension:l}=e;if(a&&yT(a[r]))return a[r];var u=n[r]-s-(i>0?i:0),d=n[r]+i;if(t[r])return o[r]?u:d;var f=c[r];if(f==null)return 0;if(o[r])return u<f?Math.max(d,f):Math.max(u,f);if(l==null)return 0;var p=d+s,m=f+l;return p>m?Math.max(u,f):Math.max(d,f)}function lue(e){var{translateX:t,translateY:n,useTranslate3d:r}=e;return{transform:r?`translate3d(${t}px, ${n}px, 0)`:`translate(${t}px, ${n}px)`}}function uue(e){var{allowEscapeViewBox:t,coordinate:n,offsetTopLeft:r,position:i,reverseDirection:a,tooltipBox:o,useTranslate3d:s,viewBox:c}=e,l,u,d;return o.height>0&&o.width>0&&n?(u=lA({allowEscapeViewBox:t,coordinate:n,key:`x`,offsetTopLeft:r,position:i,reverseDirection:a,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),d=lA({allowEscapeViewBox:t,coordinate:n,key:`y`,offsetTopLeft:r,position:i,reverseDirection:a,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),l=lue({translateX:u,translateY:d,useTranslate3d:s})):l=sue,{cssProperties:l,cssClasses:cue({translateX:u,translateY:d,coordinate:n})}}function uA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function dA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?uA(Object(n),!0).forEach(function(t){fA(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function fA(e,t,n){return(t=due(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function due(e){var t=fue(e,`string`);return typeof t==`symbol`?t:t+``}function fue(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var pue=class extends N.PureComponent{constructor(){super(...arguments),fA(this,`state`,{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),fA(this,`handleKeyDown`,e=>{e.key===`Escape`&&this.setState({dismissed:!0,dismissedAtCoordinate:{x:this.props.coordinate?.x??0,y:this.props.coordinate?.y??0}})})}componentDidMount(){document.addEventListener(`keydown`,this.handleKeyDown)}componentWillUnmount(){document.removeEventListener(`keydown`,this.handleKeyDown)}componentDidUpdate(){this.state.dismissed&&(this.props.coordinate?.x!==this.state.dismissedAtCoordinate.x||this.props.coordinate?.y!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:t,animationDuration:n,animationEasing:r,children:i,coordinate:a,hasPayload:o,isAnimationActive:s,offset:c,position:l,reverseDirection:u,useTranslate3d:d,viewBox:f,wrapperStyle:p,lastBoundingBox:m,innerRef:h,hasPortalFromProps:g}=this.props,{cssClasses:_,cssProperties:v}=uue({allowEscapeViewBox:t,coordinate:a,offsetTopLeft:c,position:l,reverseDirection:u,tooltipBox:{height:m.height,width:m.width},useTranslate3d:d,viewBox:f}),y=g?{}:dA(dA({transition:s&&e?`transform ${n}ms ${r}`:void 0},v),{},{pointerEvents:`none`,visibility:!this.state.dismissed&&e&&o?`visible`:`hidden`,position:`absolute`,top:0,left:0}),b=dA(dA({},y),{},{visibility:!this.state.dismissed&&e&&o?`visible`:`hidden`},p);return N.createElement(`div`,{xmlns:`http://www.w3.org/1999/xhtml`,tabIndex:-1,className:_,style:b,ref:h},i)}},pA={devToolsEnabled:!1,isSsr:(()=>!(typeof window<`u`&&window.document&&window.document.createElement&&window.setTimeout))()},mA=()=>tE(e=>e.rootProps.accessibilityLayer);function hA(){return hA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},hA.apply(null,arguments)}function gA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _A(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?gA(Object(n),!0).forEach(function(t){mue(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function mue(e,t,n){return(t=hue(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hue(e){var t=gue(e,`string`);return typeof t==`symbol`?t:t+``}function gue(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var vA={curveBasisClosed:Ose,curveBasisOpen:kse,curveBasis:Dse,curveBumpX:pse,curveBumpY:mse,curveLinearClosed:Ase,curveLinear:Pw,curveMonotoneX:jse,curveMonotoneY:Mse,curveNatural:Nse,curveStep:Pse,curveStepAfter:Ise,curveStepBefore:Fse},yA=e=>Nk(e.x)&&Nk(e.y),bA=e=>e.x,xA=e=>e.y,_ue=(e,t)=>{if(typeof e==`function`)return e;var n=`curve${DT(e)}`;return(n===`curveMonotone`||n===`curveBump`)&&t?vA[`${n}${t===`vertical`?`Y`:`X`}`]:vA[n]||Pw},vue=e=>{var{type:t=`linear`,points:n=[],baseLine:r,layout:i,connectNulls:a=!1}=e,o=_ue(t,i),s=a?n.filter(yA):n,c;if(Array.isArray(r)){var l=a?r.filter(e=>yA(e)):r,u=s.map((e,t)=>_A(_A({},e),{},{base:l[t]}));return c=i===`vertical`?Rw().y(xA).x1(bA).x0(e=>e.base.x):Rw().x(bA).y1(xA).y0(e=>e.base.y),c.defined(yA).curve(o),c(u)}return c=i===`vertical`&&yT(r)?Rw().y(xA).x1(bA).x0(r):yT(r)?Rw().x(bA).y1(xA).y0(r):Lw().x(bA).y(xA),c.defined(yA).curve(o),c(s)},SA=e=>{var{className:t,points:n,path:r,pathRef:i}=e;if((!n||!n.length)&&!r)return null;var a=n&&n.length?vue(e):r;return N.createElement(`path`,hA({},fw(e),NT(e),{className:cw(`recharts-curve`,t),d:a===null?void 0:a,ref:i}))},yue=[`x`,`y`,`top`,`left`,`width`,`height`,`className`];function CA(){return CA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},CA.apply(null,arguments)}function wA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function bue(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?wA(Object(n),!0).forEach(function(t){xue(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function xue(e,t,n){return(t=Sue(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sue(e){var t=Cue(e,`string`);return typeof t==`symbol`?t:t+``}function Cue(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function wue(e,t){if(e==null)return{};var n,r,i=Tue(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Tue(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var Eue=(e,t,n,r,i,a)=>`M${e},${i}v${r}M${a},${t}h${n}`,Due=e=>{var{x:t=0,y:n=0,top:r=0,left:i=0,width:a=0,height:o=0,className:s}=e,c=wue(e,yue),l=bue({x:t,y:n,top:r,left:i,width:a,height:o},c);return!yT(t)||!yT(n)||!yT(a)||!yT(o)||!yT(r)||!yT(i)?null:N.createElement(`path`,CA({},mw(l),{className:cw(`recharts-cross`,s),d:Eue(t,n,a,o,r,i)}))};function Oue(e,t,n,r){var i=r/2;return{stroke:`none`,fill:`#ccc`,x:e===`horizontal`?t.x-i:n.left+.5,y:e===`horizontal`?n.top+.5:t.y-i,width:e===`horizontal`?r:n.width-1,height:e===`horizontal`?n.height-1:r}}function TA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function kue(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?TA(Object(n),!0).forEach(function(t){Aue(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Aue(e,t,n){return(t=jue(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jue(e){var t=Mue(e,`string`);return typeof t==`symbol`?t:t+``}function Mue(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function EA(e,t){var n=kue({},e),r=t;return Object.keys(t).reduce((e,t)=>(e[t]===void 0&&r[t]!==void 0&&(e[t]=r[t]),e),n)}function Nue(){}function Pue(e){return e!=null}function DA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function OA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?DA(Object(n),!0).forEach(function(t){Fue(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Fue(e,t,n){return(t=Iue(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Iue(e){var t=Lue(e,`string`);return typeof t==`symbol`?t:t+``}function Lue(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var Rue=e=>e.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`),kA=(e,t,n)=>e.map(e=>`${Rue(e)} ${t}ms ${n}`).join(`,`),zue=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((e,t)=>e.filter(e=>t.includes(e))),AA=(e,t)=>Object.keys(t).reduce((n,r)=>OA(OA({},n),{},{[r]:e(r,t[r])}),{});function jA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function MA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?jA(Object(n),!0).forEach(function(t){Bue(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Bue(e,t,n){return(t=Vue(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vue(e){var t=Hue(e,`string`);return typeof t==`symbol`?t:t+``}function Hue(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var NA=(e,t,n)=>e+(t-e)*n,PA=e=>{var{from:t,to:n}=e;return t!==n},FA=(e,t,n)=>{var r=AA((t,n)=>{if(PA(n)){var[r,i]=e(n.from,n.to,n.velocity);return MA(MA({},n),{},{from:r,velocity:i})}return n},t);return n<1?AA((e,t)=>PA(t)?MA(MA({},t),{},{velocity:NA(t.velocity,r[e].velocity,n),from:NA(t.from,r[e].from,n)}):t,t):FA(e,r,n-1)};function Uue(e,t,n,r,i,a){var o,s=r.reduce((n,r)=>MA(MA({},n),{},{[r]:{from:e[r],velocity:0,to:t[r]}}),{}),c=()=>AA((e,t)=>t.from,s),l=()=>!Object.values(s).filter(PA).length,u=null,d=r=>{o||=r;var f=(r-o)/n.dt;s=FA(n,s,f),i(MA(MA(MA({},e),t),c())),o=r,l()||(u=a.setTimeout(d))};return()=>(u=a.setTimeout(d),()=>{u()})}function Wue(e,t,n,r,i,a,o){var s=null,c=i.reduce((n,r)=>MA(MA({},n),{},{[r]:[e[r],t[r]]}),{}),l,u=i=>{l||=i;var d=(i-l)/r,f=AA((e,t)=>NA(...t,n(d)),c);if(a(MA(MA(MA({},e),t),f)),d<1)s=o.setTimeout(u);else{var p=AA((e,t)=>NA(...t,n(1)),c);a(MA(MA(MA({},e),t),p))}};return()=>(s=o.setTimeout(u),()=>{s()})}var Gue=(e,t,n,r,i,a)=>{var o=zue(e,t);return n.isStepper===!0?Uue(e,t,n,o,i,a):Wue(e,t,n,r,o,i,a)},IA=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],LA=(e,t)=>e.map((e,n)=>e*t**n).reduce((e,t)=>e+t),RA=(e,t)=>n=>{var r=IA(e,t);return LA(r,n)},Kue=(e,t)=>n=>{var r=[...IA(e,t).map((e,t)=>e*t).slice(1),0];return LA(r,n)},zA=function(){var e,t,n,r,i=[...arguments];if(i.length===1)switch(i[0]){case`linear`:[e,n,t,r]=[0,0,1,1];break;case`ease`:[e,n,t,r]=[.25,.1,.25,1];break;case`ease-in`:[e,n,t,r]=[.42,0,1,1];break;case`ease-out`:[e,n,t,r]=[.42,0,.58,1];break;case`ease-in-out`:[e,n,t,r]=[0,0,.58,1];break;default:var a=i[0].split(`(`);a[0]===`cubic-bezier`&&a[1].split(`)`)[0].split(`,`).length===4&&([e,n,t,r]=a[1].split(`)`)[0].split(`,`).map(e=>parseFloat(e)))}else i.length===4&&([e,n,t,r]=i);var o=RA(e,t),s=RA(n,r),c=Kue(e,t),l=e=>e>1?1:e<0?0:e,u=e=>{for(var t=e>1?1:e,n=t,r=0;r<8;++r){var i=o(n)-t,a=c(n);if(Math.abs(i-t)<1e-4||a<1e-4)return s(n);n=l(n-i/a)}return s(n)};return u.isStepper=!1,u},que=function(){var{stiff:e=100,damping:t=8,dt:n=17}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=(r,i,a)=>{var o=-(r-i)*e,s=a*t,c=a+(o-s)*n/1e3,l=a*n/1e3+r;return Math.abs(l-i)<1e-4&&Math.abs(c)<1e-4?[i,0]:[l,c]};return r.isStepper=!0,r.dt=n,r},Jue=e=>{if(typeof e==`string`)switch(e){case`ease`:case`ease-in-out`:case`ease-out`:case`ease-in`:case`linear`:return zA(e);case`spring`:return que();default:if(e.split(`(`)[0]===`cubic-bezier`)return zA(e)}return typeof e==`function`?e:null};function Yue(e){var t,n=()=>null,r=!1,i=null,a=o=>{if(!r){if(Array.isArray(o)){if(!o.length)return;var[s,...c]=o;if(typeof s==`number`){i=e.setTimeout(a.bind(null,c),s);return}a(s),i=e.setTimeout(a.bind(null,c));return}typeof o==`string`&&(t=o,n(t)),typeof o==`object`&&(t=o,n(t)),typeof o==`function`&&o()}};return{stop:()=>{r=!0},start:e=>{r=!1,i&&=(i(),null),a(e)},subscribe:e=>(n=e,()=>{n=()=>null}),getTimeoutController:()=>e}}var Xue=class{setTimeout(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),r=null,i=a=>{a-n>=t?e(a):typeof requestAnimationFrame==`function`&&(r=requestAnimationFrame(i))};return r=requestAnimationFrame(i),()=>{cancelAnimationFrame(r)}}};function Zue(){return Yue(new Xue)}var Que=(0,N.createContext)(Zue);function $ue(e,t){var n=(0,N.useContext)(Que);return(0,N.useMemo)(()=>t??n(e),[e,t,n])}var ede={begin:0,duration:1e3,easing:`ease`,isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},BA={t:0},VA={t:1};function HA(e){var t=EA(e,ede),{isActive:n,canBegin:r,duration:i,easing:a,begin:o,onAnimationEnd:s,onAnimationStart:c,children:l}=t,u=$ue(t.animationId,t.animationManager),[d,f]=(0,N.useState)(n?BA:VA),p=(0,N.useRef)(null);return(0,N.useEffect)(()=>{n||f(VA)},[n]),(0,N.useEffect)(()=>{if(!n||!r)return Nue;var e=Gue(BA,VA,Jue(a),i,f,u.getTimeoutController());return u.start([c,o,()=>{p.current=e()},i,s]),()=>{u.stop(),p.current&&p.current(),s()}},[n,r,i,a,o,c,s,u]),l(d.t)}function UA(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:`animation-`,n=(0,N.useRef)(xT(t)),r=(0,N.useRef)(e);return r.current!==e&&(n.current=xT(t),r.current=e),n.current}var tde=[`radius`],nde=[`radius`];function WA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function GA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?WA(Object(n),!0).forEach(function(t){rde(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WA(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function rde(e,t,n){return(t=ide(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ide(e){var t=ade(e,`string`);return typeof t==`symbol`?t:t+``}function ade(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function KA(){return KA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},KA.apply(null,arguments)}function qA(e,t){if(e==null)return{};var n,r,i=ode(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function ode(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var JA=(e,t,n,r,i)=>{var a=Math.min(Math.abs(n)/2,Math.abs(r)/2),o=r>=0?1:-1,s=n>=0?1:-1,c=r>=0&&n>=0||r<0&&n<0?1:0,l;if(a>0&&i instanceof Array){for(var u=[0,0,0,0],d=0,f=4;d<f;d++)u[d]=i[d]>a?a:i[d];l=`M${e},${t+o*u[0]}`,u[0]>0&&(l+=`A ${u[0]},${u[0]},0,0,${c},${e+s*u[0]},${t}`),l+=`L ${e+n-s*u[1]},${t}`,u[1]>0&&(l+=`A ${u[1]},${u[1]},0,0,${c},
        ${e+n},${t+o*u[1]}`),l+=`L ${e+n},${t+r-o*u[2]}`,u[2]>0&&(l+=`A ${u[2]},${u[2]},0,0,${c},
        ${e+n-s*u[2]},${t+r}`),l+=`L ${e+s*u[3]},${t+r}`,u[3]>0&&(l+=`A ${u[3]},${u[3]},0,0,${c},
        ${e},${t+r-o*u[3]}`),l+=`Z`}else if(a>0&&i===+i&&i>0){var p=Math.min(a,i);l=`M ${e},${t+o*p}
            A ${p},${p},0,0,${c},${e+s*p},${t}
            L ${e+n-s*p},${t}
            A ${p},${p},0,0,${c},${e+n},${t+o*p}
            L ${e+n},${t+r-o*p}
            A ${p},${p},0,0,${c},${e+n-s*p},${t+r}
            L ${e+s*p},${t+r}
            A ${p},${p},0,0,${c},${e},${t+r-o*p} Z`}else l=`M ${e},${t} h ${n} v ${r} h ${-n} Z`;return l},sde={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:`ease`},YA=e=>{var t=EA(e,sde),n=(0,N.useRef)(null),[r,i]=(0,N.useState)(-1);(0,N.useEffect)(()=>{if(n.current&&n.current.getTotalLength)try{var e=n.current.getTotalLength();e&&i(e)}catch{}},[]);var{x:a,y:o,width:s,height:c,radius:l,className:u}=t,{animationEasing:d,animationDuration:f,animationBegin:p,isAnimationActive:m,isUpdateAnimationActive:h}=t,g=(0,N.useRef)(s),_=(0,N.useRef)(c),v=(0,N.useRef)(a),y=(0,N.useRef)(o),b=(0,N.useMemo)(()=>({x:a,y:o,width:s,height:c,radius:l}),[a,o,s,c,l]),x=UA(b,`rectangle-`);if(a!==+a||o!==+o||s!==+s||c!==+c||s===0||c===0)return null;var S=cw(`recharts-rectangle`,u);if(!h){var C=mw(t),{radius:w}=C,T=qA(C,tde);return N.createElement(`path`,KA({},T,{radius:typeof l==`number`?l:void 0,className:S,d:JA(a,o,s,c,l)}))}var E=g.current,D=_.current,O=v.current,k=y.current,ee=`0px ${r===-1?1:r}px`,te=`${r}px 0px`,ne=kA([`strokeDasharray`],f,typeof d==`string`?d:void 0);return N.createElement(HA,{animationId:x,key:x,canBegin:r>0,duration:f,easing:d,isActive:h,begin:p},e=>{var r=wT(E,s,e),i=wT(D,c,e),u=wT(O,a,e),d=wT(k,o,e);n.current&&(g.current=r,_.current=i,v.current=u,y.current=d);var f=m?e>0?{transition:ne,strokeDasharray:te}:{strokeDasharray:ee}:{strokeDasharray:te},p=mw(t),{radius:h}=p,b=qA(p,nde);return N.createElement(`path`,KA({},b,{radius:typeof l==`number`?l:void 0,className:S,d:JA(u,d,r,i,l),ref:n,style:GA(GA({},f),t.style)}))})};function XA(e){var{cx:t,cy:n,radius:r,startAngle:i,endAngle:a}=e,o=lO(t,n,r,i),s=lO(t,n,r,a);return{points:[o,s],cx:t,cy:n,radius:r,startAngle:i,endAngle:a}}function ZA(){return ZA=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ZA.apply(null,arguments)}var cde=(e,t)=>{var n=gT(t-e),r=Math.min(Math.abs(t-e),359.999);return n*r},QA=e=>{var{cx:t,cy:n,radius:r,angle:i,sign:a,isExternal:o,cornerRadius:s,cornerIsExternal:c}=e,l=s*(o?1:-1)+r,u=Math.asin(s/l)/sO,d=c?i:i+a*u,f=lO(t,n,l,d),p=lO(t,n,r,d),m=c?i-a*u:i,h=lO(t,n,l*Math.cos(u*sO),m);return{center:f,circleTangency:p,lineTangency:h,theta:u}},$A=e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:i,startAngle:a,endAngle:o}=e,s=cde(a,o),c=a+s,l=lO(t,n,i,a),u=lO(t,n,i,c),d=`M ${l.x},${l.y}
    A ${i},${i},0,
    ${+(Math.abs(s)>180)},${+(a>c)},
    ${u.x},${u.y}
  `;if(r>0){var f=lO(t,n,r,a),p=lO(t,n,r,c);d+=`L ${p.x},${p.y}
            A ${r},${r},0,
            ${+(Math.abs(s)>180)},${+(a<=c)},
            ${f.x},${f.y} Z`}else d+=`L ${t},${n} Z`;return d},lde=e=>{var{cx:t,cy:n,innerRadius:r,outerRadius:i,cornerRadius:a,forceCornerRadius:o,cornerIsExternal:s,startAngle:c,endAngle:l}=e,u=gT(l-c),{circleTangency:d,lineTangency:f,theta:p}=QA({cx:t,cy:n,radius:i,angle:c,sign:u,cornerRadius:a,cornerIsExternal:s}),{circleTangency:m,lineTangency:h,theta:g}=QA({cx:t,cy:n,radius:i,angle:l,sign:-u,cornerRadius:a,cornerIsExternal:s}),_=s?Math.abs(c-l):Math.abs(c-l)-p-g;if(_<0)return o?`M ${f.x},${f.y}
        a${a},${a},0,0,1,${a*2},0
        a${a},${a},0,0,1,${-a*2},0
      `:$A({cx:t,cy:n,innerRadius:r,outerRadius:i,startAngle:c,endAngle:l});var v=`M ${f.x},${f.y}
    A${a},${a},0,0,${+(u<0)},${d.x},${d.y}
    A${i},${i},0,${+(_>180)},${+(u<0)},${m.x},${m.y}
    A${a},${a},0,0,${+(u<0)},${h.x},${h.y}
  `;if(r>0){var{circleTangency:y,lineTangency:b,theta:x}=QA({cx:t,cy:n,radius:r,angle:c,sign:u,isExternal:!0,cornerRadius:a,cornerIsExternal:s}),{circleTangency:S,lineTangency:C,theta:w}=QA({cx:t,cy:n,radius:r,angle:l,sign:-u,isExternal:!0,cornerRadius:a,cornerIsExternal:s}),T=s?Math.abs(c-l):Math.abs(c-l)-x-w;if(T<0&&a===0)return`${v}L${t},${n}Z`;v+=`L${C.x},${C.y}
      A${a},${a},0,0,${+(u<0)},${S.x},${S.y}
      A${r},${r},0,${+(T>180)},${+(u>0)},${y.x},${y.y}
      A${a},${a},0,0,${+(u<0)},${b.x},${b.y}Z`}else v+=`L${t},${n}Z`;return v},ude={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},ej=e=>{var t=EA(e,ude),{cx:n,cy:r,innerRadius:i,outerRadius:a,cornerRadius:o,forceCornerRadius:s,cornerIsExternal:c,startAngle:l,endAngle:u,className:d}=t;if(a<i||l===u)return null;var f=cw(`recharts-sector`,d),p=a-i,m=ST(o,p,0,!0),h=m>0&&Math.abs(l-u)<360?lde({cx:n,cy:r,innerRadius:i,outerRadius:a,cornerRadius:Math.min(m,p/2),forceCornerRadius:s,cornerIsExternal:c,startAngle:l,endAngle:u}):$A({cx:n,cy:r,innerRadius:i,outerRadius:a,startAngle:l,endAngle:u});return N.createElement(`path`,ZA({},mw(t),{className:f,d:h}))};function dde(e,t,n){var r,i,a,o;if(e===`horizontal`)r=t.x,a=r,i=n.top,o=n.top+n.height;else if(e===`vertical`)i=t.y,o=i,r=n.left,a=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e===`centric`){var{cx:s,cy:c,innerRadius:l,outerRadius:u,angle:d}=t,f=lO(s,c,l,d),p=lO(s,c,u,d);r=f.x,i=f.y,a=p.x,o=p.y}else return XA(t);return[{x:r,y:i},{x:a,y:o}]}var fde=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=oE();function n(e){return t.isSymbol(e)?NaN:Number(e)}e.toNumber=n})),pde=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=fde();function n(e){return e?(e=t.toNumber(e),e===1/0||e===-1/0?(e<0?-1:1)*Number.MAX_VALUE:e===e?e:0):e===0?e:0}e.toFinite=n})),mde=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=sE(),n=pde();function r(e,r,i){i&&typeof i!=`number`&&t.isIterateeCall(e,r,i)&&(r=i=void 0),e=n.toFinite(e),r===void 0?(r=e,e=0):r=n.toFinite(r),i=i===void 0?e<r?1:-1:n.toFinite(i);let a=Math.max(Math.ceil((r-e)/(i||1)),0),o=Array(a);for(let t=0;t<a;t++)o[t]=e,e+=i;return o}e.range=r})),hde=o(((e,t)=>{t.exports=mde().range}));function tj(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function gde(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function nj(e){let t,n,r;e.length===2?(t=e===tj||e===gde?e:_de,n=e,r=e):(t=tj,n=(t,n)=>tj(e(t),n),r=(t,n)=>e(t)-n);function i(e,r,i=0,a=e.length){if(i<a){if(t(r,r)!==0)return a;do{let t=i+a>>>1;n(e[t],r)<0?i=t+1:a=t}while(i<a)}return i}function a(e,r,i=0,a=e.length){if(i<a){if(t(r,r)!==0)return a;do{let t=i+a>>>1;n(e[t],r)<=0?i=t+1:a=t}while(i<a)}return i}function o(e,t,n=0,a=e.length){let o=i(e,t,n,a-1);return o>n&&r(e[o-1],t)>-r(e[o],t)?o-1:o}return{left:i,center:o,right:a}}function _de(){return 0}function rj(e){return e===null?NaN:+e}function*vde(e,t){if(t===void 0)for(let t of e)t!=null&&(t=+t)>=t&&(yield t);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}var ij=nj(tj);const yde=ij.right;ij.left,nj(rj).center;var aj=yde,oj=class extends Map{constructor(e,t=Sde){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),e!=null)for(let[t,n]of e)this.set(t,n)}get(e){return super.get(sj(this,e))}has(e){return super.has(sj(this,e))}set(e,t){return super.set(bde(this,e),t)}delete(e){return super.delete(xde(this,e))}};function sj({_intern:e,_key:t},n){let r=t(n);return e.has(r)?e.get(r):n}function bde({_intern:e,_key:t},n){let r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function xde({_intern:e,_key:t},n){let r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function Sde(e){return typeof e==`object`&&e?e.valueOf():e}function Cde(e=tj){if(e===tj)return cj;if(typeof e!=`function`)throw TypeError(`compare is not a function`);return(t,n)=>{let r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function cj(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}var wde=Math.sqrt(50),Tde=Math.sqrt(10),Ede=Math.sqrt(2);function lj(e,t,n){let r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),a=r/10**i,o=a>=wde?10:a>=Tde?5:a>=Ede?2:1,s,c,l;return i<0?(l=10**-i/o,s=Math.round(e*l),c=Math.round(t*l),s/l<e&&++s,c/l>t&&--c,l=-l):(l=10**i*o,s=Math.round(e/l),c=Math.round(t/l),s*l<e&&++s,c*l>t&&--c),c<s&&.5<=n&&n<2?lj(e,t,n*2):[s,c,l]}function uj(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];let r=t<e,[i,a,o]=r?lj(t,e,n):lj(e,t,n);if(!(a>=i))return[];let s=a-i+1,c=Array(s);if(r)if(o<0)for(let e=0;e<s;++e)c[e]=(a-e)/-o;else for(let e=0;e<s;++e)c[e]=(a-e)*o;else if(o<0)for(let e=0;e<s;++e)c[e]=(i+e)/-o;else for(let e=0;e<s;++e)c[e]=(i+e)*o;return c}function dj(e,t,n){return t=+t,e=+e,n=+n,lj(e,t,n)[2]}function fj(e,t,n){t=+t,e=+e,n=+n;let r=t<e,i=r?dj(t,e,n):dj(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function pj(e,t){let n;if(t===void 0)for(let t of e)t!=null&&(n<t||n===void 0&&t>=t)&&(n=t);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function mj(e,t){let n;if(t===void 0)for(let t of e)t!=null&&(n>t||n===void 0&&t>=t)&&(n=t);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function hj(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?cj:Cde(i);r>n;){if(r-n>600){let a=r-n+1,o=t-n+1,s=Math.log(a),c=.5*Math.exp(2*s/3),l=.5*Math.sqrt(s*c*(a-c)/a)*(o-a/2<0?-1:1),u=Math.max(n,Math.floor(t-o*c/a+l)),d=Math.min(r,Math.floor(t+(a-o)*c/a+l));hj(e,t,u,d,i)}let a=e[t],o=n,s=r;for(gj(e,n,t),i(e[r],a)>0&&gj(e,n,r);o<s;){for(gj(e,o,s),++o,--s;i(e[o],a)<0;)++o;for(;i(e[s],a)>0;)--s}i(e[n],a)===0?gj(e,n,s):(++s,gj(e,s,r)),s<=t&&(n=s+1),t<=s&&(r=s-1)}return e}function gj(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function Dde(e,t,n){if(e=Float64Array.from(vde(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return mj(e);if(t>=1)return pj(e);var r,i=(r-1)*t,a=Math.floor(i),o=pj(hj(e,a).subarray(0,a+1)),s=mj(e.subarray(a+1));return o+(s-o)*(i-a)}}function Ode(e,t,n=rj){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),o=+n(e[a],a,e),s=+n(e[a+1],a+1,e);return o+(s-o)*(i-a)}}function kde(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,a=Array(i);++r<i;)a[r]=e+r*n;return a}function _j(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function vj(e,t){switch(arguments.length){case 0:break;case 1:typeof e==`function`?this.interpolator(e):this.range(e);break;default:this.domain(e),typeof t==`function`?this.interpolator(t):this.range(t);break}return this}const yj=Symbol(`implicit`);function bj(){var e=new oj,t=[],n=[],r=yj;function i(i){let a=e.get(i);if(a===void 0){if(r!==yj)return r;e.set(i,a=t.push(i)-1)}return n[a%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new oj;for(let r of n)e.has(r)||e.set(r,t.push(r)-1);return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return bj(t,n).unknown(r)},_j.apply(i,arguments),i}function xj(){var e=bj().unknown(void 0),t=e.domain,n=e.range,r=0,i=1,a,o,s=!1,c=0,l=0,u=.5;delete e.unknown;function d(){var e=t().length,d=i<r,f=d?i:r,p=d?r:i;a=(p-f)/Math.max(1,e-c+l*2),s&&(a=Math.floor(a)),f+=(p-f-a*(e-c))*u,o=a*(1-c),s&&(f=Math.round(f),o=Math.round(o));var m=kde(e).map(function(e){return f+a*e});return n(d?m.reverse():m)}return e.domain=function(e){return arguments.length?(t(e),d()):t()},e.range=function(e){return arguments.length?([r,i]=e,r=+r,i=+i,d()):[r,i]},e.rangeRound=function(e){return[r,i]=e,r=+r,i=+i,s=!0,d()},e.bandwidth=function(){return o},e.step=function(){return a},e.round=function(e){return arguments.length?(s=!!e,d()):s},e.padding=function(e){return arguments.length?(c=Math.min(1,l=+e),d()):c},e.paddingInner=function(e){return arguments.length?(c=Math.min(1,e),d()):c},e.paddingOuter=function(e){return arguments.length?(l=+e,d()):l},e.align=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),d()):u},e.copy=function(){return xj(t(),[r,i]).round(s).paddingInner(c).paddingOuter(l).align(u)},_j.apply(d(),arguments)}function Sj(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return Sj(t())},e}function Ade(){return Sj(xj.apply(null,arguments).paddingInner(1))}function Cj(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function wj(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Tj(){}var Ej=.7,Dj=1/Ej,Oj=`\\s*([+-]?\\d+)\\s*`,kj=`\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*`,Aj=`\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*`,jde=/^#([0-9a-f]{3,8})$/,Mde=RegExp(`^rgb\\(${Oj},${Oj},${Oj}\\)$`),Nde=RegExp(`^rgb\\(${Aj},${Aj},${Aj}\\)$`),Pde=RegExp(`^rgba\\(${Oj},${Oj},${Oj},${kj}\\)$`),Fde=RegExp(`^rgba\\(${Aj},${Aj},${Aj},${kj}\\)$`),Ide=RegExp(`^hsl\\(${kj},${Aj},${Aj}\\)$`),Lde=RegExp(`^hsla\\(${kj},${Aj},${Aj},${kj}\\)$`),jj={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Cj(Tj,Pj,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Mj,formatHex:Mj,formatHex8:Rde,formatHsl:zde,formatRgb:Nj,toString:Nj});function Mj(){return this.rgb().formatHex()}function Rde(){return this.rgb().formatHex8()}function zde(){return Gj(this).formatHsl()}function Nj(){return this.rgb().formatRgb()}function Pj(e){var t,n;return e=(e+``).trim().toLowerCase(),(t=jde.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Fj(t):n===3?new Rj(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Ij(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Ij(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Mde.exec(e))?new Rj(t[1],t[2],t[3],1):(t=Nde.exec(e))?new Rj(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Pde.exec(e))?Ij(t[1],t[2],t[3],t[4]):(t=Fde.exec(e))?Ij(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Ide.exec(e))?Wj(t[1],t[2]/100,t[3]/100,1):(t=Lde.exec(e))?Wj(t[1],t[2]/100,t[3]/100,t[4]):jj.hasOwnProperty(e)?Fj(jj[e]):e===`transparent`?new Rj(NaN,NaN,NaN,0):null}function Fj(e){return new Rj(e>>16&255,e>>8&255,e&255,1)}function Ij(e,t,n,r){return r<=0&&(e=t=n=NaN),new Rj(e,t,n,r)}function Bde(e){return e instanceof Tj||(e=Pj(e)),e?(e=e.rgb(),new Rj(e.r,e.g,e.b,e.opacity)):new Rj}function Lj(e,t,n,r){return arguments.length===1?Bde(e):new Rj(e,t,n,r??1)}function Rj(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Cj(Rj,Lj,wj(Tj,{brighter(e){return e=e==null?Dj:Dj**+e,new Rj(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Ej:Ej**+e,new Rj(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Rj(Hj(this.r),Hj(this.g),Hj(this.b),Vj(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zj,formatHex:zj,formatHex8:Vde,formatRgb:Bj,toString:Bj}));function zj(){return`#${Uj(this.r)}${Uj(this.g)}${Uj(this.b)}`}function Vde(){return`#${Uj(this.r)}${Uj(this.g)}${Uj(this.b)}${Uj((isNaN(this.opacity)?1:this.opacity)*255)}`}function Bj(){let e=Vj(this.opacity);return`${e===1?`rgb(`:`rgba(`}${Hj(this.r)}, ${Hj(this.g)}, ${Hj(this.b)}${e===1?`)`:`, ${e})`}`}function Vj(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Hj(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Uj(e){return e=Hj(e),(e<16?`0`:``)+e.toString(16)}function Wj(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Kj(e,t,n,r)}function Gj(e){if(e instanceof Kj)return new Kj(e.h,e.s,e.l,e.opacity);if(e instanceof Tj||(e=Pj(e)),!e)return new Kj;if(e instanceof Kj)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=t===a?(n-r)/s+(n<r)*6:n===a?(r-t)/s+2:(t-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new Kj(o,s,c,e.opacity)}function Hde(e,t,n,r){return arguments.length===1?Gj(e):new Kj(e,t,n,r??1)}function Kj(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Cj(Kj,Hde,wj(Tj,{brighter(e){return e=e==null?Dj:Dj**+e,new Kj(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Ej:Ej**+e,new Kj(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Rj(Yj(e>=240?e-240:e+120,i,r),Yj(e,i,r),Yj(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Kj(qj(this.h),Jj(this.s),Jj(this.l),Vj(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=Vj(this.opacity);return`${e===1?`hsl(`:`hsla(`}${qj(this.h)}, ${Jj(this.s)*100}%, ${Jj(this.l)*100}%${e===1?`)`:`, ${e})`}`}}));function qj(e){return e=(e||0)%360,e<0?e+360:e}function Jj(e){return Math.max(0,Math.min(1,e||0))}function Yj(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}var Xj=e=>()=>e;function Ude(e,t){return function(n){return e+n*t}}function Wde(e,t,n){return e**=+n,t=t**+n-e,n=1/n,function(r){return(e+r*t)**+n}}function Gde(e){return(e=+e)==1?Zj:function(t,n){return n-t?Wde(t,n,e):Xj(isNaN(t)?n:t)}}function Zj(e,t){var n=t-e;return n?Ude(e,n):Xj(isNaN(e)?t:e)}var Qj=(function e(t){var n=Gde(t);function r(e,t){var r=n((e=Lj(e)).r,(t=Lj(t)).r),i=n(e.g,t.g),a=n(e.b,t.b),o=Zj(e.opacity,t.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+``}}return r.gamma=e,r})(1);function Kde(e,t){t||=[];var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=e[i]*(1-a)+t[i]*a;return r}}function qde(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Jde(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=Array(r),a=Array(n),o;for(o=0;o<r;++o)i[o]=nM(e[o],t[o]);for(;o<n;++o)a[o]=t[o];return function(e){for(o=0;o<r;++o)a[o]=i[o](e);return a}}function Yde(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function $j(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Xde(e,t){var n={},r={},i;for(i in(typeof e!=`object`||!e)&&(e={}),(typeof t!=`object`||!t)&&(t={}),t)i in e?n[i]=nM(e[i],t[i]):r[i]=t[i];return function(e){for(i in n)r[i]=n[i](e);return r}}var eM=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,tM=new RegExp(eM.source,`g`);function Zde(e){return function(){return e}}function Qde(e){return function(t){return e(t)+``}}function $de(e,t){var n=eM.lastIndex=tM.lastIndex=0,r,i,a,o=-1,s=[],c=[];for(e+=``,t+=``;(r=eM.exec(e))&&(i=tM.exec(t));)(a=i.index)>n&&(a=t.slice(n,a),s[o]?s[o]+=a:s[++o]=a),(r=r[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,c.push({i:o,x:$j(r,i)})),n=tM.lastIndex;return n<t.length&&(a=t.slice(n),s[o]?s[o]+=a:s[++o]=a),s.length<2?c[0]?Qde(c[0].x):Zde(t):(t=c.length,function(e){for(var n=0,r;n<t;++n)s[(r=c[n]).i]=r.x(e);return s.join(``)})}function nM(e,t){var n=typeof t,r;return t==null||n===`boolean`?Xj(t):(n===`number`?$j:n===`string`?(r=Pj(t))?(t=r,Qj):$de:t instanceof Pj?Qj:t instanceof Date?Yde:qde(t)?Kde:Array.isArray(t)?Jde:typeof t.valueOf!=`function`&&typeof t.toString!=`function`||isNaN(t)?Xde:$j)(e,t)}function rM(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function efe(e,t){t===void 0&&(t=e,e=nM);for(var n=0,r=t.length-1,i=t[0],a=Array(r<0?0:r);n<r;)a[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return a[t](e-t)}}function tfe(e){return function(){return e}}function iM(e){return+e}var aM=[0,1];function oM(e){return e}function sM(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:tfe(isNaN(t)?NaN:.5)}function nfe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(n){return Math.max(e,Math.min(t,n))}}function rfe(e,t,n){var r=e[0],i=e[1],a=t[0],o=t[1];return i<r?(r=sM(i,r),a=n(o,a)):(r=sM(r,i),a=n(a,o)),function(e){return a(r(e))}}function ife(e,t,n){var r=Math.min(e.length,t.length)-1,i=Array(r),a=Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)i[o]=sM(e[o],e[o+1]),a[o]=n(t[o],t[o+1]);return function(t){var n=aj(e,t,1,r)-1;return a[n](i[n](t))}}function cM(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function lM(){var e=aM,t=aM,n=nM,r,i,a,o=oM,s,c,l;function u(){var n=Math.min(e.length,t.length);return o!==oM&&(o=nfe(e[0],e[n-1])),s=n>2?ife:rfe,c=l=null,d}function d(i){return i==null||isNaN(i=+i)?a:(c||=s(e.map(r),t,n))(r(o(i)))}return d.invert=function(n){return o(i((l||=s(t,e.map(r),$j))(n)))},d.domain=function(t){return arguments.length?(e=Array.from(t,iM),u()):e.slice()},d.range=function(e){return arguments.length?(t=Array.from(e),u()):t.slice()},d.rangeRound=function(e){return t=Array.from(e),n=rM,u()},d.clamp=function(e){return arguments.length?(o=e?!0:oM,u()):o!==oM},d.interpolate=function(e){return arguments.length?(n=e,u()):n},d.unknown=function(e){return arguments.length?(a=e,d):a},function(e,t){return r=e,i=t,u()}}function uM(){return lM()(oM,oM)}function afe(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString(`en`).replace(/,/g,``):e.toString(10)}function dM(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf(`e`))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function fM(e){return e=dM(Math.abs(e)),e?e[1]:NaN}function ofe(e,t){return function(n,r){for(var i=n.length,a=[],o=0,s=e[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(n.substring(i-=s,i+s)),!((c+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}function sfe(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}var cfe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function pM(e){if(!(t=cfe.exec(e)))throw Error(`invalid format: `+e);var t;return new mM({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}pM.prototype=mM.prototype;function mM(e){this.fill=e.fill===void 0?` `:e.fill+``,this.align=e.align===void 0?`>`:e.align+``,this.sign=e.sign===void 0?`-`:e.sign+``,this.symbol=e.symbol===void 0?``:e.symbol+``,this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?``:e.type+``}mM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?`0`:``)+(this.width===void 0?``:Math.max(1,this.width|0))+(this.comma?`,`:``)+(this.precision===void 0?``:`.`+Math.max(0,this.precision|0))+(this.trim?`~`:``)+this.type};function lfe(e){out:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case`.`:r=i=n;break;case`0`:r===0&&(r=n),i=n;break;default:if(!+e[n])break out;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var hM;function ufe(e,t){var n=dM(e,t);if(!n)return e+``;var r=n[0],i=n[1],a=i-(hM=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+Array(a-o+1).join(`0`):a>0?r.slice(0,a)+`.`+r.slice(a):`0.`+Array(1-a).join(`0`)+dM(e,Math.max(0,t+a-1))[0]}function gM(e,t){var n=dM(e,t);if(!n)return e+``;var r=n[0],i=n[1];return i<0?`0.`+Array(-i).join(`0`)+r:r.length>i+1?r.slice(0,i+1)+`.`+r.slice(i+1):r+Array(i-r.length+2).join(`0`)}var _M={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+``,d:afe,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>gM(e*100,t),r:gM,s:ufe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function vM(e){return e}var yM=Array.prototype.map,bM=[`y`,`z`,`a`,`f`,`p`,`n`,``,`m`,``,`k`,`M`,`G`,`T`,`P`,`E`,`Z`,`Y`];function dfe(e){var t=e.grouping===void 0||e.thousands===void 0?vM:ofe(yM.call(e.grouping,Number),e.thousands+``),n=e.currency===void 0?``:e.currency[0]+``,r=e.currency===void 0?``:e.currency[1]+``,i=e.decimal===void 0?`.`:e.decimal+``,a=e.numerals===void 0?vM:sfe(yM.call(e.numerals,String)),o=e.percent===void 0?`%`:e.percent+``,s=e.minus===void 0?``:e.minus+``,c=e.nan===void 0?`NaN`:e.nan+``;function l(e){e=pM(e);var l=e.fill,u=e.align,d=e.sign,f=e.symbol,p=e.zero,m=e.width,h=e.comma,g=e.precision,_=e.trim,v=e.type;v===`n`?(h=!0,v=`g`):_M[v]||(g===void 0&&(g=12),_=!0,v=`g`),(p||l===`0`&&u===`=`)&&(p=!0,l=`0`,u=`=`);var y=f===`$`?n:f===`#`&&/[boxX]/.test(v)?`0`+v.toLowerCase():``,b=f===`$`?r:/[%p]/.test(v)?o:``,x=_M[v],S=/[defgprs%]/.test(v);g=g===void 0?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g));function C(e){var n=y,r=b,o,f,C;if(v===`c`)r=x(e)+r,e=``;else{e=+e;var w=e<0||1/e<0;if(e=isNaN(e)?c:x(Math.abs(e),g),_&&(e=lfe(e)),w&&+e==0&&d!==`+`&&(w=!1),n=(w?d===`(`?d:s:d===`-`||d===`(`?``:d)+n,r=(v===`s`?bM[8+hM/3]:``)+r+(w&&d===`(`?`)`:``),S){for(o=-1,f=e.length;++o<f;)if(C=e.charCodeAt(o),48>C||C>57){r=(C===46?i+e.slice(o+1):e.slice(o))+r,e=e.slice(0,o);break}}}h&&!p&&(e=t(e,1/0));var T=n.length+e.length+r.length,E=T<m?Array(m-T+1).join(l):``;switch(h&&p&&(e=t(E+e,E.length?m-r.length:1/0),E=``),u){case`<`:e=n+e+r+E;break;case`=`:e=n+E+e+r;break;case`^`:e=E.slice(0,T=E.length>>1)+n+e+r+E.slice(T);break;default:e=E+n+e+r;break}return a(e)}return C.toString=function(){return e+``},C}function u(e,t){var n=l((e=pM(e),e.type=`f`,e)),r=Math.max(-8,Math.min(8,Math.floor(fM(t)/3)))*3,i=10**-r,a=bM[8+r/3];return function(e){return n(i*e)+a}}return{format:l,formatPrefix:u}}var xM,SM,CM;ffe({thousands:`,`,grouping:[3],currency:[`$`,``]});function ffe(e){return xM=dfe(e),SM=xM.format,CM=xM.formatPrefix,xM}function pfe(e){return Math.max(0,-fM(Math.abs(e)))}function mfe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(fM(t)/3)))*3-fM(Math.abs(e)))}function hfe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,fM(t)-fM(e))+1}function wM(e,t,n,r){var i=fj(e,t,n),a;switch(r=pM(r??`,f`),r.type){case`s`:var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(a=mfe(i,o))&&(r.precision=a),CM(r,o);case``:case`e`:case`g`:case`p`:case`r`:r.precision==null&&!isNaN(a=hfe(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=a-(r.type===`e`));break;case`f`:case`%`:r.precision==null&&!isNaN(a=pfe(i))&&(r.precision=a-(r.type===`%`)*2);break}return SM(r)}function TM(e){var t=e.domain;return e.ticks=function(e){var n=t();return uj(n[0],n[n.length-1],e??10)},e.tickFormat=function(e,n){var r=t();return wM(r[0],r[r.length-1],e??10,n)},e.nice=function(n){n??=10;var r=t(),i=0,a=r.length-1,o=r[i],s=r[a],c,l,u=10;for(s<o&&(l=o,o=s,s=l,l=i,i=a,a=l);u-- >0;){if(l=dj(o,s,n),l===c)return r[i]=o,r[a]=s,t(r);if(l>0)o=Math.floor(o/l)*l,s=Math.ceil(s/l)*l;else if(l<0)o=Math.ceil(o*l)/l,s=Math.floor(s*l)/l;else break;c=l}return e},e}function EM(){var e=uM();return e.copy=function(){return cM(e,EM())},_j.apply(e,arguments),TM(e)}function DM(e){var t;function n(e){return e==null||isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,iM),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return DM(e).unknown(t)},e=arguments.length?Array.from(e,iM):[0,1],TM(n)}function OM(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],a=e[r],o;return a<i&&(o=n,n=r,r=o,o=i,i=a,a=o),e[n]=t.floor(i),e[r]=t.ceil(a),e}function kM(e){return Math.log(e)}function AM(e){return Math.exp(e)}function gfe(e){return-Math.log(-e)}function _fe(e){return-Math.exp(-e)}function vfe(e){return isFinite(e)?+(`1e`+e):e<0?0:e}function yfe(e){return e===10?vfe:e===Math.E?Math.exp:t=>e**+t}function bfe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function jM(e){return(t,n)=>-e(-t,n)}function MM(e){let t=e(kM,AM),n=t.domain,r=10,i,a;function o(){return i=bfe(r),a=yfe(r),n()[0]<0?(i=jM(i),a=jM(a),e(gfe,_fe)):e(kM,AM),t}return t.base=function(e){return arguments.length?(r=+e,o()):r},t.domain=function(e){return arguments.length?(n(e),o()):n()},t.ticks=e=>{let t=n(),o=t[0],s=t[t.length-1],c=s<o;c&&([o,s]=[s,o]);let l=i(o),u=i(s),d,f,p=e==null?10:+e,m=[];if(!(r%1)&&u-l<p){if(l=Math.floor(l),u=Math.ceil(u),o>0){for(;l<=u;++l)for(d=1;d<r;++d)if(f=l<0?d/a(-l):d*a(l),!(f<o)){if(f>s)break;m.push(f)}}else for(;l<=u;++l)for(d=r-1;d>=1;--d)if(f=l>0?d/a(-l):d*a(l),!(f<o)){if(f>s)break;m.push(f)}m.length*2<p&&(m=uj(o,s,p))}else m=uj(l,u,Math.min(u-l,p)).map(a);return c?m.reverse():m},t.tickFormat=(e,n)=>{if(e??=10,n??=r===10?`s`:`,`,typeof n!=`function`&&(!(r%1)&&(n=pM(n)).precision==null&&(n.trim=!0),n=SM(n)),e===1/0)return n;let o=Math.max(1,r*e/t.ticks().length);return e=>{let t=e/a(Math.round(i(e)));return t*r<r-.5&&(t*=r),t<=o?n(e):``}},t.nice=()=>n(OM(n(),{floor:e=>a(Math.floor(i(e))),ceil:e=>a(Math.ceil(i(e)))})),t}function NM(){let e=MM(lM()).domain([1,10]);return e.copy=()=>cM(e,NM()).base(e.base()),_j.apply(e,arguments),e}function PM(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function FM(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function IM(e){var t=1,n=e(PM(t),FM(t));return n.constant=function(n){return arguments.length?e(PM(t=+n),FM(t)):t},TM(n)}function LM(){var e=IM(lM());return e.copy=function(){return cM(e,LM()).constant(e.constant())},_j.apply(e,arguments)}function RM(e){return function(t){return t<0?-((-t)**+e):t**+e}}function xfe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Sfe(e){return e<0?-e*e:e*e}function zM(e){var t=e(oM,oM),n=1;function r(){return n===1?e(oM,oM):n===.5?e(xfe,Sfe):e(RM(n),RM(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,r()):n},TM(t)}function BM(){var e=zM(lM());return e.copy=function(){return cM(e,BM()).exponent(e.exponent())},_j.apply(e,arguments),e}function Cfe(){return BM.apply(null,arguments).exponent(.5)}function VM(e){return Math.sign(e)*e*e}function wfe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function HM(){var e=uM(),t=[0,1],n=!1,r;function i(t){var i=wfe(e(t));return isNaN(i)?r:n?Math.round(i):i}return i.invert=function(t){return e.invert(VM(t))},i.domain=function(t){return arguments.length?(e.domain(t),i):e.domain()},i.range=function(n){return arguments.length?(e.range((t=Array.from(n,iM)).map(VM)),i):t.slice()},i.rangeRound=function(e){return i.range(e).round(!0)},i.round=function(e){return arguments.length?(n=!!e,i):n},i.clamp=function(t){return arguments.length?(e.clamp(t),i):e.clamp()},i.unknown=function(e){return arguments.length?(r=e,i):r},i.copy=function(){return HM(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},_j.apply(i,arguments),TM(i)}function UM(){var e=[],t=[],n=[],r;function i(){var r=0,i=Math.max(1,t.length);for(n=Array(i-1);++r<i;)n[r-1]=Ode(e,r/i);return a}function a(e){return e==null||isNaN(e=+e)?r:t[aj(n,e)]}return a.invertExtent=function(r){var i=t.indexOf(r);return i<0?[NaN,NaN]:[i>0?n[i-1]:e[0],i<n.length?n[i]:e[e.length-1]]},a.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)n!=null&&!isNaN(n=+n)&&e.push(n);return e.sort(tj),i()},a.range=function(e){return arguments.length?(t=Array.from(e),i()):t.slice()},a.unknown=function(e){return arguments.length?(r=e,a):r},a.quantiles=function(){return n.slice()},a.copy=function(){return UM().domain(e).range(t).unknown(r)},_j.apply(a,arguments)}function WM(){var e=0,t=1,n=1,r=[.5],i=[0,1],a;function o(e){return e!=null&&e<=e?i[aj(r,e,0,n)]:a}function s(){var i=-1;for(r=Array(n);++i<n;)r[i]=((i+1)*t-(i-n)*e)/(n+1);return o}return o.domain=function(n){return arguments.length?([e,t]=n,e=+e,t=+t,s()):[e,t]},o.range=function(e){return arguments.length?(n=(i=Array.from(e)).length-1,s()):i.slice()},o.invertExtent=function(a){var o=i.indexOf(a);return o<0?[NaN,NaN]:o<1?[e,r[0]]:o>=n?[r[n-1],t]:[r[o-1],r[o]]},o.unknown=function(e){return arguments.length&&(a=e),o},o.thresholds=function(){return r.slice()},o.copy=function(){return WM().domain([e,t]).range(i).unknown(a)},_j.apply(TM(o),arguments)}function GM(){var e=[.5],t=[0,1],n,r=1;function i(i){return i!=null&&i<=i?t[aj(e,i,0,r)]:n}return i.domain=function(n){return arguments.length?(e=Array.from(n),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(n){return arguments.length?(t=Array.from(n),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(n){var r=t.indexOf(n);return[e[r-1],e[r]]},i.unknown=function(e){return arguments.length?(n=e,i):n},i.copy=function(){return GM().domain(e).range(t).unknown(n)},_j.apply(i,arguments)}var KM=new Date,qM=new Date;function JM(e,t,n,r){function i(t){return e(t=arguments.length===0?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{let t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),n==null?1:Math.floor(n)),e),i.range=(n,r,a)=>{let o=[];if(n=i.ceil(n),a=a==null?1:Math.floor(a),!(n<r)||!(a>0))return o;let s;do o.push(s=new Date(+n)),t(n,a),e(n);while(s<n&&n<r);return o},i.filter=n=>JM(t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},(e,r)=>{if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}),n&&(i.count=(t,r)=>(KM.setTime(+t),qM.setTime(+r),e(KM),e(qM),Math.floor(n(KM,qM))),i.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?i.filter(r?t=>r(t)%e===0:t=>i.count(0,t)%e===0):i)),i}const YM=JM(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);YM.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?JM(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):YM),YM.range;const XM=1e3,ZM=XM*60,QM=ZM*60,$M=QM*24,eN=$M*7,tN=$M*30,nN=$M*365,rN=JM(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*XM)},(e,t)=>(t-e)/XM,e=>e.getUTCSeconds());rN.range;const iN=JM(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*XM)},(e,t)=>{e.setTime(+e+t*ZM)},(e,t)=>(t-e)/ZM,e=>e.getMinutes());iN.range;const aN=JM(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ZM)},(e,t)=>(t-e)/ZM,e=>e.getUTCMinutes());aN.range;const oN=JM(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*XM-e.getMinutes()*ZM)},(e,t)=>{e.setTime(+e+t*QM)},(e,t)=>(t-e)/QM,e=>e.getHours());oN.range;const sN=JM(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*QM)},(e,t)=>(t-e)/QM,e=>e.getUTCHours());sN.range;const cN=JM(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ZM)/$M,e=>e.getDate()-1);cN.range;const lN=JM(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/$M,e=>e.getUTCDate()-1);lN.range;const uN=JM(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/$M,e=>Math.floor(e/$M));uN.range;function dN(e){return JM(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+t*7)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ZM)/eN)}const fN=dN(0),pN=dN(1),Tfe=dN(2),Efe=dN(3),mN=dN(4),Dfe=dN(5),Ofe=dN(6);fN.range,pN.range,Tfe.range,Efe.range,mN.range,Dfe.range,Ofe.range;function hN(e){return JM(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t*7)},(e,t)=>(t-e)/eN)}const gN=hN(0),_N=hN(1),kfe=hN(2),Afe=hN(3),vN=hN(4),jfe=hN(5),Mfe=hN(6);gN.range,_N.range,kfe.range,Afe.range,vN.range,jfe.range,Mfe.range;const yN=JM(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());yN.range;const bN=JM(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());bN.range;const xN=JM(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());xN.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:JM(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}),xN.range;const SN=JM(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());SN.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:JM(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}),SN.range;function CN(e,t,n,r,i,a){let o=[[rN,1,XM],[rN,5,5*XM],[rN,15,15*XM],[rN,30,30*XM],[a,1,ZM],[a,5,5*ZM],[a,15,15*ZM],[a,30,30*ZM],[i,1,QM],[i,3,3*QM],[i,6,6*QM],[i,12,12*QM],[r,1,$M],[r,2,2*$M],[n,1,eN],[t,1,tN],[t,3,3*tN],[e,1,nN]];function s(e,t,n){let r=t<e;r&&([e,t]=[t,e]);let i=n&&typeof n.range==`function`?n:c(e,t,n),a=i?i.range(e,+t+1):[];return r?a.reverse():a}function c(t,n,r){let i=Math.abs(n-t)/r,a=nj(([,,e])=>e).right(o,i);if(a===o.length)return e.every(fj(t/nN,n/nN,r));if(a===0)return YM.every(Math.max(fj(t,n,r),1));let[s,c]=o[i/o[a-1][2]<o[a][2]/i?a-1:a];return s.every(c)}return[s,c]}var[Nfe,Pfe]=CN(SN,bN,gN,uN,sN,aN),[Ffe,Ife]=CN(xN,yN,fN,cN,oN,iN);function wN(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function TN(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function EN(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function Lfe(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,o=e.shortDays,s=e.months,c=e.shortMonths,l=AN(i),u=jN(i),d=AN(a),f=jN(a),p=AN(o),m=jN(o),h=AN(s),g=jN(s),_=AN(c),v=jN(c),y={a:A,A:j,b:re,B:ie,c:null,d:IN,e:IN,f:ope,g:gpe,G:vpe,H:rpe,I:ipe,j:ape,L:LN,m:spe,M:cpe,p:ae,q:oe,Q:UN,s:WN,S:lpe,u:upe,U:dpe,V:fpe,w:ppe,W:mpe,x:null,X:null,y:hpe,Y:_pe,Z:ype,"%":HN},b={a:se,A:ce,b:le,B:ue,c:null,d:zN,e:zN,f:Cpe,g:Npe,G:Fpe,H:bpe,I:xpe,j:Spe,L:BN,m:wpe,M:Tpe,p:de,q:fe,Q:UN,s:WN,S:Epe,u:Dpe,U:Ope,V:kpe,w:Ape,W:jpe,x:null,X:null,y:Mpe,Y:Ppe,Z:Ipe,"%":HN},x={a:E,A:D,b:O,B:k,c:ee,d:PN,e:PN,f:$fe,g:NN,G:MN,H:FN,I:FN,j:Yfe,L:Qfe,m:Jfe,M:Xfe,p:T,q:qfe,Q:tpe,s:npe,S:Zfe,u:Hfe,U:Ufe,V:Wfe,w:Vfe,W:Gfe,x:te,X:ne,y:NN,Y:MN,Z:Kfe,"%":epe};y.x=S(n,y),y.X=S(r,y),y.c=S(t,y),b.x=S(n,b),b.X=S(r,b),b.c=S(t,b);function S(e,t){return function(n){var r=[],i=-1,a=0,o=e.length,s,c,l;for(n instanceof Date||(n=new Date(+n));++i<o;)e.charCodeAt(i)===37&&(r.push(e.slice(a,i)),(c=DN[s=e.charAt(++i)])==null?c=s===`e`?` `:`0`:s=e.charAt(++i),(l=t[s])&&(s=l(n,c)),r.push(s),a=i+1);return r.push(e.slice(a,i)),r.join(``)}}function C(e,t){return function(n){var r=EN(1900,void 0,1),i=w(r,e,n+=``,0),a,o;if(i!=n.length)return null;if(`Q`in r)return new Date(r.Q);if(`s`in r)return new Date(r.s*1e3+(`L`in r?r.L:0));if(t&&!(`Z`in r)&&(r.Z=0),`p`in r&&(r.H=r.H%12+r.p*12),r.m===void 0&&(r.m=`q`in r?r.q:0),`V`in r){if(r.V<1||r.V>53)return null;`w`in r||(r.w=1),`Z`in r?(a=TN(EN(r.y,0,1)),o=a.getUTCDay(),a=o>4||o===0?_N.ceil(a):_N(a),a=lN.offset(a,(r.V-1)*7),r.y=a.getUTCFullYear(),r.m=a.getUTCMonth(),r.d=a.getUTCDate()+(r.w+6)%7):(a=wN(EN(r.y,0,1)),o=a.getDay(),a=o>4||o===0?pN.ceil(a):pN(a),a=cN.offset(a,(r.V-1)*7),r.y=a.getFullYear(),r.m=a.getMonth(),r.d=a.getDate()+(r.w+6)%7)}else (`W`in r||`U`in r)&&(`w`in r||(r.w=`u`in r?r.u%7:`W`in r?1:0),o=`Z`in r?TN(EN(r.y,0,1)).getUTCDay():wN(EN(r.y,0,1)).getDay(),r.m=0,r.d=`W`in r?(r.w+6)%7+r.W*7-(o+5)%7:r.w+r.U*7-(o+6)%7);return`Z`in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,TN(r)):wN(r)}}function w(e,t,n,r){for(var i=0,a=t.length,o=n.length,s,c;i<a;){if(r>=o)return-1;if(s=t.charCodeAt(i++),s===37){if(s=t.charAt(i++),c=x[s in DN?t.charAt(i++):s],!c||(r=c(e,n,r))<0)return-1}else if(s!=n.charCodeAt(r++))return-1}return r}function T(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=u.get(r[0].toLowerCase()),n+r[0].length):-1}function E(e,t,n){var r=p.exec(t.slice(n));return r?(e.w=m.get(r[0].toLowerCase()),n+r[0].length):-1}function D(e,t,n){var r=d.exec(t.slice(n));return r?(e.w=f.get(r[0].toLowerCase()),n+r[0].length):-1}function O(e,t,n){var r=_.exec(t.slice(n));return r?(e.m=v.get(r[0].toLowerCase()),n+r[0].length):-1}function k(e,t,n){var r=h.exec(t.slice(n));return r?(e.m=g.get(r[0].toLowerCase()),n+r[0].length):-1}function ee(e,n,r){return w(e,t,n,r)}function te(e,t,r){return w(e,n,t,r)}function ne(e,t,n){return w(e,r,t,n)}function A(e){return o[e.getDay()]}function j(e){return a[e.getDay()]}function re(e){return c[e.getMonth()]}function ie(e){return s[e.getMonth()]}function ae(e){return i[+(e.getHours()>=12)]}function oe(e){return 1+~~(e.getMonth()/3)}function se(e){return o[e.getUTCDay()]}function ce(e){return a[e.getUTCDay()]}function le(e){return c[e.getUTCMonth()]}function ue(e){return s[e.getUTCMonth()]}function de(e){return i[+(e.getUTCHours()>=12)]}function fe(e){return 1+~~(e.getUTCMonth()/3)}return{format:function(e){var t=S(e+=``,y);return t.toString=function(){return e},t},parse:function(e){var t=C(e+=``,!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=S(e+=``,b);return t.toString=function(){return e},t},utcParse:function(e){var t=C(e+=``,!0);return t.toString=function(){return e},t}}}var DN={"-":``,_:` `,0:`0`},ON=/^\s*\d+/,Rfe=/^%/,zfe=/[\\^$*+?|[\]().{}]/g;function kN(e,t,n){var r=e<0?`-`:``,i=(r?-e:e)+``,a=i.length;return r+(a<n?Array(n-a+1).join(t)+i:i)}function Bfe(e){return e.replace(zfe,`\\$&`)}function AN(e){return RegExp(`^(?:`+e.map(Bfe).join(`|`)+`)`,`i`)}function jN(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function Vfe(e,t,n){var r=ON.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Hfe(e,t,n){var r=ON.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Ufe(e,t,n){var r=ON.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Wfe(e,t,n){var r=ON.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Gfe(e,t,n){var r=ON.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function MN(e,t,n){var r=ON.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function NN(e,t,n){var r=ON.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Kfe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||`00`)),n+r[0].length):-1}function qfe(e,t,n){var r=ON.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function Jfe(e,t,n){var r=ON.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function PN(e,t,n){var r=ON.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Yfe(e,t,n){var r=ON.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function FN(e,t,n){var r=ON.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Xfe(e,t,n){var r=ON.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Zfe(e,t,n){var r=ON.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function Qfe(e,t,n){var r=ON.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function $fe(e,t,n){var r=ON.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function epe(e,t,n){var r=Rfe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function tpe(e,t,n){var r=ON.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function npe(e,t,n){var r=ON.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function IN(e,t){return kN(e.getDate(),t,2)}function rpe(e,t){return kN(e.getHours(),t,2)}function ipe(e,t){return kN(e.getHours()%12||12,t,2)}function ape(e,t){return kN(1+cN.count(xN(e),e),t,3)}function LN(e,t){return kN(e.getMilliseconds(),t,3)}function ope(e,t){return LN(e,t)+`000`}function spe(e,t){return kN(e.getMonth()+1,t,2)}function cpe(e,t){return kN(e.getMinutes(),t,2)}function lpe(e,t){return kN(e.getSeconds(),t,2)}function upe(e){var t=e.getDay();return t===0?7:t}function dpe(e,t){return kN(fN.count(xN(e)-1,e),t,2)}function RN(e){var t=e.getDay();return t>=4||t===0?mN(e):mN.ceil(e)}function fpe(e,t){return e=RN(e),kN(mN.count(xN(e),e)+(xN(e).getDay()===4),t,2)}function ppe(e){return e.getDay()}function mpe(e,t){return kN(pN.count(xN(e)-1,e),t,2)}function hpe(e,t){return kN(e.getFullYear()%100,t,2)}function gpe(e,t){return e=RN(e),kN(e.getFullYear()%100,t,2)}function _pe(e,t){return kN(e.getFullYear()%1e4,t,4)}function vpe(e,t){var n=e.getDay();return e=n>=4||n===0?mN(e):mN.ceil(e),kN(e.getFullYear()%1e4,t,4)}function ype(e){var t=e.getTimezoneOffset();return(t>0?`-`:(t*=-1,`+`))+kN(t/60|0,`0`,2)+kN(t%60,`0`,2)}function zN(e,t){return kN(e.getUTCDate(),t,2)}function bpe(e,t){return kN(e.getUTCHours(),t,2)}function xpe(e,t){return kN(e.getUTCHours()%12||12,t,2)}function Spe(e,t){return kN(1+lN.count(SN(e),e),t,3)}function BN(e,t){return kN(e.getUTCMilliseconds(),t,3)}function Cpe(e,t){return BN(e,t)+`000`}function wpe(e,t){return kN(e.getUTCMonth()+1,t,2)}function Tpe(e,t){return kN(e.getUTCMinutes(),t,2)}function Epe(e,t){return kN(e.getUTCSeconds(),t,2)}function Dpe(e){var t=e.getUTCDay();return t===0?7:t}function Ope(e,t){return kN(gN.count(SN(e)-1,e),t,2)}function VN(e){var t=e.getUTCDay();return t>=4||t===0?vN(e):vN.ceil(e)}function kpe(e,t){return e=VN(e),kN(vN.count(SN(e),e)+(SN(e).getUTCDay()===4),t,2)}function Ape(e){return e.getUTCDay()}function jpe(e,t){return kN(_N.count(SN(e)-1,e),t,2)}function Mpe(e,t){return kN(e.getUTCFullYear()%100,t,2)}function Npe(e,t){return e=VN(e),kN(e.getUTCFullYear()%100,t,2)}function Ppe(e,t){return kN(e.getUTCFullYear()%1e4,t,4)}function Fpe(e,t){var n=e.getUTCDay();return e=n>=4||n===0?vN(e):vN.ceil(e),kN(e.getUTCFullYear()%1e4,t,4)}function Ipe(){return`+0000`}function HN(){return`%`}function UN(e){return+e}function WN(e){return Math.floor(e/1e3)}var GN,KN,qN;Lpe({dateTime:`%x, %X`,date:`%-m/%-d/%Y`,time:`%-I:%M:%S %p`,periods:[`AM`,`PM`],days:[`Sunday`,`Monday`,`Tuesday`,`Wednesday`,`Thursday`,`Friday`,`Saturday`],shortDays:[`Sun`,`Mon`,`Tue`,`Wed`,`Thu`,`Fri`,`Sat`],months:[`January`,`February`,`March`,`April`,`May`,`June`,`July`,`August`,`September`,`October`,`November`,`December`],shortMonths:[`Jan`,`Feb`,`Mar`,`Apr`,`May`,`Jun`,`Jul`,`Aug`,`Sep`,`Oct`,`Nov`,`Dec`]});function Lpe(e){return GN=Lfe(e),KN=GN.format,GN.parse,qN=GN.utcFormat,GN.utcParse,GN}function Rpe(e){return new Date(e)}function zpe(e){return e instanceof Date?+e:+new Date(+e)}function JN(e,t,n,r,i,a,o,s,c,l){var u=uM(),d=u.invert,f=u.domain,p=l(`.%L`),m=l(`:%S`),h=l(`%I:%M`),g=l(`%I %p`),_=l(`%a %d`),v=l(`%b %d`),y=l(`%B`),b=l(`%Y`);function x(e){return(c(e)<e?p:s(e)<e?m:o(e)<e?h:a(e)<e?g:r(e)<e?i(e)<e?_:v:n(e)<e?y:b)(e)}return u.invert=function(e){return new Date(d(e))},u.domain=function(e){return arguments.length?f(Array.from(e,zpe)):f().map(Rpe)},u.ticks=function(t){var n=f();return e(n[0],n[n.length-1],t??10)},u.tickFormat=function(e,t){return t==null?x:l(t)},u.nice=function(e){var n=f();return(!e||typeof e.range!=`function`)&&(e=t(n[0],n[n.length-1],e??10)),e?f(OM(n,e)):u},u.copy=function(){return cM(u,JN(e,t,n,r,i,a,o,s,c,l))},u}function Bpe(){return _j.apply(JN(Ffe,Ife,xN,yN,fN,cN,oN,iN,rN,KN).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Vpe(){return _j.apply(JN(Nfe,Pfe,SN,bN,gN,lN,sN,aN,rN,qN).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function YN(){var e=0,t=1,n,r,i,a,o=oM,s=!1,c;function l(e){return e==null||isNaN(e=+e)?c:o(i===0?.5:(e=(a(e)-n)*i,s?Math.max(0,Math.min(1,e)):e))}l.domain=function(o){return arguments.length?([e,t]=o,n=a(e=+e),r=a(t=+t),i=n===r?0:1/(r-n),l):[e,t]},l.clamp=function(e){return arguments.length?(s=!!e,l):s},l.interpolator=function(e){return arguments.length?(o=e,l):o};function u(e){return function(t){var n,r;return arguments.length?([n,r]=t,o=e(n,r),l):[o(0),o(1)]}}return l.range=u(nM),l.rangeRound=u(rM),l.unknown=function(e){return arguments.length?(c=e,l):c},function(o){return a=o,n=o(e),r=o(t),i=n===r?0:1/(r-n),l}}function XN(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function ZN(){var e=TM(YN()(oM));return e.copy=function(){return XN(e,ZN())},vj.apply(e,arguments)}function QN(){var e=MM(YN()).domain([1,10]);return e.copy=function(){return XN(e,QN()).base(e.base())},vj.apply(e,arguments)}function $N(){var e=IM(YN());return e.copy=function(){return XN(e,$N()).constant(e.constant())},vj.apply(e,arguments)}function eP(){var e=zM(YN());return e.copy=function(){return XN(e,eP()).exponent(e.exponent())},vj.apply(e,arguments)}function Hpe(){return eP.apply(null,arguments).exponent(.5)}function tP(){var e=[],t=oM;function n(n){if(n!=null&&!isNaN(n=+n))return t((aj(e,n,1)-1)/(e.length-1))}return n.domain=function(t){if(!arguments.length)return e.slice();e=[];for(let n of t)n!=null&&!isNaN(n=+n)&&e.push(n);return e.sort(tj),n},n.interpolator=function(e){return arguments.length?(t=e,n):t},n.range=function(){return e.map((n,r)=>t(r/(e.length-1)))},n.quantiles=function(t){return Array.from({length:t+1},(n,r)=>Dde(e,r/t))},n.copy=function(){return tP(t).domain(e)},vj.apply(n,arguments)}function nP(){var e=0,t=.5,n=1,r=1,i,a,o,s,c,l=oM,u,d=!1,f;function p(e){return isNaN(e=+e)?f:(e=.5+((e=+u(e))-a)*(r*e<r*a?s:c),l(d?Math.max(0,Math.min(1,e)):e))}p.domain=function(l){return arguments.length?([e,t,n]=l,i=u(e=+e),a=u(t=+t),o=u(n=+n),s=i===a?0:.5/(a-i),c=a===o?0:.5/(o-a),r=a<i?-1:1,p):[e,t,n]},p.clamp=function(e){return arguments.length?(d=!!e,p):d},p.interpolator=function(e){return arguments.length?(l=e,p):l};function m(e){return function(t){var n,r,i;return arguments.length?([n,r,i]=t,l=efe(e,[n,r,i]),p):[l(0),l(.5),l(1)]}}return p.range=m(nM),p.rangeRound=m(rM),p.unknown=function(e){return arguments.length?(f=e,p):f},function(l){return u=l,i=l(e),a=l(t),o=l(n),s=i===a?0:.5/(a-i),c=a===o?0:.5/(o-a),r=a<i?-1:1,p}}function rP(){var e=TM(nP()(oM));return e.copy=function(){return XN(e,rP())},vj.apply(e,arguments)}function iP(){var e=MM(nP()).domain([.1,1,10]);return e.copy=function(){return XN(e,iP()).base(e.base())},vj.apply(e,arguments)}function aP(){var e=IM(nP());return e.copy=function(){return XN(e,aP()).constant(e.constant())},vj.apply(e,arguments)}function oP(){var e=zM(nP());return e.copy=function(){return XN(e,oP()).exponent(e.exponent())},vj.apply(e,arguments)}function Upe(){return oP.apply(null,arguments).exponent(.5)}var sP=s({scaleBand:()=>xj,scaleDiverging:()=>rP,scaleDivergingLog:()=>iP,scaleDivergingPow:()=>oP,scaleDivergingSqrt:()=>Upe,scaleDivergingSymlog:()=>aP,scaleIdentity:()=>DM,scaleImplicit:()=>yj,scaleLinear:()=>EM,scaleLog:()=>NM,scaleOrdinal:()=>bj,scalePoint:()=>Ade,scalePow:()=>BM,scaleQuantile:()=>UM,scaleQuantize:()=>WM,scaleRadial:()=>HM,scaleSequential:()=>ZN,scaleSequentialLog:()=>QN,scaleSequentialPow:()=>eP,scaleSequentialQuantile:()=>tP,scaleSequentialSqrt:()=>Hpe,scaleSequentialSymlog:()=>$N,scaleSqrt:()=>Cfe,scaleSymlog:()=>LM,scaleThreshold:()=>GM,scaleTime:()=>Bpe,scaleUtc:()=>Vpe,tickFormat:()=>wM}),cP=e=>e.chartData,Wpe=L([cP],e=>{var t=e.chartData==null?0:e.chartData.length-1;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),lP=(e,t,n,r)=>r?Wpe(e):cP(e);function uP(e){if(Array.isArray(e)&&e.length===2){var[t,n]=e;if(Nk(t)&&Nk(n))return!0}return!1}function dP(e,t,n){return n?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function fP(e,t){if(t&&typeof e!=`function`&&Array.isArray(e)&&e.length===2){var[n,r]=e,i,a;if(Nk(n))i=n;else if(typeof n==`function`)return;if(Nk(r))a=r;else if(typeof r==`function`)return;var o=[i,a];if(uP(o))return o}}function Gpe(e,t,n){if(!(!n&&t==null)){if(typeof e==`function`&&t!=null)try{var r=e(t,n);if(uP(r))return dP(r,t,n)}catch{}if(Array.isArray(e)&&e.length===2){var[i,a]=e,o,s;if(i===`auto`)t!=null&&(o=Math.min(...t));else if(yT(i))o=i;else if(typeof i==`function`)try{t!=null&&(o=i(t?.[0]))}catch{}else if(typeof i==`string`&&HO.test(i)){var c=HO.exec(i);if(c==null||t==null)o=void 0;else{var l=+c[1];o=t[0]-l}}else o=t?.[0];if(a===`auto`)t!=null&&(s=Math.max(...t));else if(yT(a))s=a;else if(typeof a==`function`)try{t!=null&&(s=a(t?.[1]))}catch{}else if(typeof a==`string`&&UO.test(a)){var u=UO.exec(a);if(u==null||t==null)s=void 0;else{var d=+u[1];s=t[1]+d}}else s=t?.[1];var f=[o,s];if(uP(f))return t==null?f:dP(f,t,n)}}}var pP=o(((e,t)=>{(function(e){var n=1e9,r={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:`2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286`},i=!0,a=`[DecimalError] `,o=a+`Invalid argument: `,s=a+`Exponent out of range: `,c=Math.floor,l=Math.pow,u=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,d,f=1e7,p=7,m=9007199254740991,h=c(m/p),g={};g.absoluteValue=g.abs=function(){var e=new this.constructor(this);return e.s&&=1,e},g.comparedTo=g.cmp=function(e){var t,n,r,i,a=this;if(e=new a.constructor(e),a.s!==e.s)return a.s||-e.s;if(a.e!==e.e)return a.e>e.e^a.s<0?1:-1;for(r=a.d.length,i=e.d.length,t=0,n=r<i?r:i;t<n;++t)if(a.d[t]!==e.d[t])return a.d[t]>e.d[t]^a.s<0?1:-1;return r===i?0:r>i^a.s<0?1:-1},g.decimalPlaces=g.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*p;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n},g.dividedBy=g.div=function(e){return b(this,new this.constructor(e))},g.dividedToIntegerBy=g.idiv=function(e){var t=this,n=t.constructor;return D(b(t,new n(e),0,1),n.precision)},g.equals=g.eq=function(e){return!this.cmp(e)},g.exponent=function(){return S(this)},g.greaterThan=g.gt=function(e){return this.cmp(e)>0},g.greaterThanOrEqualTo=g.gte=function(e){return this.cmp(e)>=0},g.isInteger=g.isint=function(){return this.e>this.d.length-2},g.isNegative=g.isneg=function(){return this.s<0},g.isPositive=g.ispos=function(){return this.s>0},g.isZero=function(){return this.s===0},g.lessThan=g.lt=function(e){return this.cmp(e)<0},g.lessThanOrEqualTo=g.lte=function(e){return this.cmp(e)<1},g.logarithm=g.log=function(e){var t,n=this,r=n.constructor,o=r.precision,s=o+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(d))throw Error(a+`NaN`);if(n.s<1)throw Error(a+(n.s?`NaN`:`-Infinity`));return n.eq(d)?new r(0):(i=!1,t=b(T(n,s),T(e,s),s),i=!0,D(t,o))},g.minus=g.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?O(t,e):_(t,(e.s=-e.s,e))},g.modulo=g.mod=function(e){var t,n=this,r=n.constructor,o=r.precision;if(e=new r(e),!e.s)throw Error(a+`NaN`);return n.s?(i=!1,t=b(n,e,0,1).times(e),i=!0,n.minus(t)):D(new r(n),o)},g.naturalExponential=g.exp=function(){return x(this)},g.naturalLogarithm=g.ln=function(){return T(this)},g.negated=g.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e},g.plus=g.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?_(t,e):O(t,(e.s=-e.s,e))},g.precision=g.sd=function(e){var t,n,r,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(o+e);if(t=S(i)+1,r=i.d.length-1,n=r*p+1,r=i.d[r],r){for(;r%10==0;r/=10)n--;for(r=i.d[0];r>=10;r/=10)n++}return e&&t>n?t:n},g.squareRoot=g.sqrt=function(){var e,t,n,r,o,s,l,u=this,d=u.constructor;if(u.s<1){if(!u.s)return new d(0);throw Error(a+`NaN`)}for(e=S(u),i=!1,o=Math.sqrt(+u),o==0||o==1/0?(t=y(u.d),(t.length+e)%2==0&&(t+=`0`),o=Math.sqrt(t),e=c((e+1)/2)-(e<0||e%2),o==1/0?t=`5e`+e:(t=o.toExponential(),t=t.slice(0,t.indexOf(`e`)+1)+e),r=new d(t)):r=new d(o.toString()),n=d.precision,o=l=n+3;;)if(s=r,r=s.plus(b(u,s,l+2)).times(.5),y(s.d).slice(0,l)===(t=y(r.d)).slice(0,l)){if(t=t.slice(l-3,l+1),o==l&&t==`4999`){if(D(s,n+1,0),s.times(s).eq(u)){r=s;break}}else if(t!=`9999`)break;l+=4}return i=!0,D(r,n)},g.times=g.mul=function(e){var t,n,r,a,o,s,c,l,u,d=this,p=d.constructor,m=d.d,h=(e=new p(e)).d;if(!d.s||!e.s)return new p(0);for(e.s*=d.s,n=d.e+e.e,l=m.length,u=h.length,l<u&&(o=m,m=h,h=o,s=l,l=u,u=s),o=[],s=l+u,r=s;r--;)o.push(0);for(r=u;--r>=0;){for(t=0,a=l+r;a>r;)c=o[a]+h[r]*m[a-r-1]+t,o[a--]=c%f|0,t=c/f|0;o[a]=(o[a]+t)%f|0}for(;!o[--s];)o.pop();return t?++n:o.shift(),e.d=o,e.e=n,i?D(e,p.precision):e},g.toDecimalPlaces=g.todp=function(e,t){var r=this,i=r.constructor;return r=new i(r),e===void 0?r:(v(e,0,n),t===void 0?t=i.rounding:v(t,0,8),D(r,e+S(r)+1,t))},g.toExponential=function(e,t){var r,i=this,a=i.constructor;return e===void 0?r=k(i,!0):(v(e,0,n),t===void 0?t=a.rounding:v(t,0,8),i=D(new a(i),e+1,t),r=k(i,!0,e+1)),r},g.toFixed=function(e,t){var r,i,a=this,o=a.constructor;return e===void 0?k(a):(v(e,0,n),t===void 0?t=o.rounding:v(t,0,8),i=D(new o(a),e+S(a)+1,t),r=k(i.abs(),!1,e+S(i)+1),a.isneg()&&!a.isZero()?`-`+r:r)},g.toInteger=g.toint=function(){var e=this,t=e.constructor;return D(new t(e),S(e)+1,t.rounding)},g.toNumber=function(){return+this},g.toPower=g.pow=function(e){var t,n,r,o,s,l,u=this,f=u.constructor,h=12,g=+(e=new f(e));if(!e.s)return new f(d);if(u=new f(u),!u.s){if(e.s<1)throw Error(a+`Infinity`);return u}if(u.eq(d))return u;if(r=f.precision,e.eq(d))return D(u,r);if(t=e.e,n=e.d.length-1,l=t>=n,s=u.s,l){if((n=g<0?-g:g)<=m){for(o=new f(d),t=Math.ceil(r/p+4),i=!1;n%2&&(o=o.times(u),ee(o.d,t)),n=c(n/2),n!==0;)u=u.times(u),ee(u.d,t);return i=!0,e.s<0?new f(d).div(o):D(o,r)}}else if(s<0)throw Error(a+`NaN`);return s=s<0&&e.d[Math.max(t,n)]&1?-1:1,u.s=1,i=!1,o=e.times(T(u,r+h)),i=!0,o=x(o),o.s=s,o},g.toPrecision=function(e,t){var r,i,a=this,o=a.constructor;return e===void 0?(r=S(a),i=k(a,r<=o.toExpNeg||r>=o.toExpPos)):(v(e,1,n),t===void 0?t=o.rounding:v(t,0,8),a=D(new o(a),e,t),r=S(a),i=k(a,e<=r||r<=o.toExpNeg,e)),i},g.toSignificantDigits=g.tosd=function(e,t){var r=this,i=r.constructor;return e===void 0?(e=i.precision,t=i.rounding):(v(e,1,n),t===void 0?t=i.rounding:v(t,0,8)),D(new i(r),e,t)},g.toString=g.valueOf=g.val=g.toJSON=function(){var e=this,t=S(e),n=e.constructor;return k(e,t<=n.toExpNeg||t>=n.toExpPos)};function _(e,t){var n,r,a,o,s,c,l,u,d=e.constructor,m=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),i?D(t,m):t;if(l=e.d,u=t.d,s=e.e,a=t.e,l=l.slice(),o=s-a,o){for(o<0?(r=l,o=-o,c=u.length):(r=u,a=s,c=l.length),s=Math.ceil(m/p),c=s>c?s+1:c+1,o>c&&(o=c,r.length=1),r.reverse();o--;)r.push(0);r.reverse()}for(c=l.length,o=u.length,c-o<0&&(o=c,r=u,u=l,l=r),n=0;o;)n=(l[--o]=l[o]+u[o]+n)/f|0,l[o]%=f;for(n&&(l.unshift(n),++a),c=l.length;l[--c]==0;)l.pop();return t.d=l,t.e=a,i?D(t,m):t}function v(e,t,n){if(e!==~~e||e<t||e>n)throw Error(o+e)}function y(e){var t,n,r,i=e.length-1,a=``,o=e[0];if(i>0){for(a+=o,t=1;t<i;t++)r=e[t]+``,n=p-r.length,n&&(a+=w(n)),a+=r;o=e[t],r=o+``,n=p-r.length,n&&(a+=w(n))}else if(o===0)return`0`;for(;o%10==0;)o/=10;return a+o}var b=(function(){function e(e,t){var n,r=0,i=e.length;for(e=e.slice();i--;)n=e[i]*t+r,e[i]=n%f|0,r=n/f|0;return r&&e.unshift(r),e}function t(e,t,n,r){var i,a;if(n!=r)a=n>r?1:-1;else for(i=a=0;i<n;i++)if(e[i]!=t[i]){a=e[i]>t[i]?1:-1;break}return a}function n(e,t,n){for(var r=0;n--;)e[n]-=r,r=e[n]<t[n]?1:0,e[n]=r*f+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,i,o,s){var c,l,u,d,m,h,g,_,v,y,b,x,C,w,T,E,O,k,ee=r.constructor,te=r.s==i.s?1:-1,ne=r.d,A=i.d;if(!r.s)return new ee(r);if(!i.s)throw Error(a+`Division by zero`);for(l=r.e-i.e,O=A.length,T=ne.length,g=new ee(te),_=g.d=[],u=0;A[u]==(ne[u]||0);)++u;if(A[u]>(ne[u]||0)&&--l,x=o==null?o=ee.precision:s?o+(S(r)-S(i))+1:o,x<0)return new ee(0);if(x=x/p+2|0,u=0,O==1)for(d=0,A=A[0],x++;(u<T||d)&&x--;u++)C=d*f+(ne[u]||0),_[u]=C/A|0,d=C%A|0;else{for(d=f/(A[0]+1)|0,d>1&&(A=e(A,d),ne=e(ne,d),O=A.length,T=ne.length),w=O,v=ne.slice(0,O),y=v.length;y<O;)v[y++]=0;k=A.slice(),k.unshift(0),E=A[0],A[1]>=f/2&&++E;do d=0,c=t(A,v,O,y),c<0?(b=v[0],O!=y&&(b=b*f+(v[1]||0)),d=b/E|0,d>1?(d>=f&&(d=f-1),m=e(A,d),h=m.length,y=v.length,c=t(m,v,h,y),c==1&&(d--,n(m,O<h?k:A,h))):(d==0&&(c=d=1),m=A.slice()),h=m.length,h<y&&m.unshift(0),n(v,m,y),c==-1&&(y=v.length,c=t(A,v,O,y),c<1&&(d++,n(v,O<y?k:A,y))),y=v.length):c===0&&(d++,v=[0]),_[u++]=d,c&&v[0]?v[y++]=ne[w]||0:(v=[ne[w]],y=1);while((w++<T||v[0]!==void 0)&&x--)}return _[0]||_.shift(),g.e=l,D(g,s?o+S(g)+1:o)}})();function x(e,t){var n,r,a,o,c,u,f=0,p=0,m=e.constructor,h=m.precision;if(S(e)>16)throw Error(s+S(e));if(!e.s)return new m(d);for(t==null?(i=!1,u=h):u=t,c=new m(.03125);e.abs().gte(.1);)e=e.times(c),p+=5;for(r=Math.log(l(2,p))/Math.LN10*2+5|0,u+=r,n=a=o=new m(d),m.precision=u;;){if(a=D(a.times(e),u),n=n.times(++f),c=o.plus(b(a,n,u)),y(c.d).slice(0,u)===y(o.d).slice(0,u)){for(;p--;)o=D(o.times(o),u);return m.precision=h,t==null?(i=!0,D(o,h)):o}o=c}}function S(e){for(var t=e.e*p,n=e.d[0];n>=10;n/=10)t++;return t}function C(e,t,n){if(t>e.LN10.sd())throw i=!0,n&&(e.precision=n),Error(a+`LN10 precision limit exceeded`);return D(new e(e.LN10),t)}function w(e){for(var t=``;e--;)t+=`0`;return t}function T(e,t){var n,r,o,s,c,l,u,f,p,m=1,h=10,g=e,_=g.d,v=g.constructor,x=v.precision;if(g.s<1)throw Error(a+(g.s?`NaN`:`-Infinity`));if(g.eq(d))return new v(0);if(t==null?(i=!1,f=x):f=t,g.eq(10))return t??(i=!0),C(v,f);if(f+=h,v.precision=f,n=y(_),r=n.charAt(0),s=S(g),Math.abs(s)<0x5543df729c000){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)g=g.times(e),n=y(g.d),r=n.charAt(0),m++;s=S(g),r>1?(g=new v(`0.`+n),s++):g=new v(r+`.`+n.slice(1))}else return u=C(v,f+2,x).times(s+``),g=T(new v(r+`.`+n.slice(1)),f-h).plus(u),v.precision=x,t==null?(i=!0,D(g,x)):g;for(l=c=g=b(g.minus(d),g.plus(d),f),p=D(g.times(g),f),o=3;;){if(c=D(c.times(p),f),u=l.plus(b(c,new v(o),f)),y(u.d).slice(0,f)===y(l.d).slice(0,f))return l=l.times(2),s!==0&&(l=l.plus(C(v,f+2,x).times(s+``))),l=b(l,new v(m),f),v.precision=x,t==null?(i=!0,D(l,x)):l;l=u,o+=2}}function E(e,t){var n,r,a;for((n=t.indexOf(`.`))>-1&&(t=t.replace(`.`,``)),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(r,a),t){if(a-=r,n=n-r-1,e.e=c(n/p),e.d=[],r=(n+1)%p,n<0&&(r+=p),r<a){for(r&&e.d.push(+t.slice(0,r)),a-=p;r<a;)e.d.push(+t.slice(r,r+=p));t=t.slice(r),r=p-t.length}else r-=a;for(;r--;)t+=`0`;if(e.d.push(+t),i&&(e.e>h||e.e<-h))throw Error(s+n)}else e.s=0,e.e=0,e.d=[0];return e}function D(e,t,n){var r,a,o,u,d,m,g,_,v=e.d;for(u=1,o=v[0];o>=10;o/=10)u++;if(r=t-u,r<0)r+=p,a=t,g=v[_=0];else{if(_=Math.ceil((r+1)/p),o=v.length,_>=o)return e;for(g=o=v[_],u=1;o>=10;o/=10)u++;r%=p,a=r-p+u}if(n!==void 0&&(o=l(10,u-a-1),d=g/o%10|0,m=t<0||v[_+1]!==void 0||g%o,m=n<4?(d||m)&&(n==0||n==(e.s<0?3:2)):d>5||d==5&&(n==4||m||n==6&&(r>0?a>0?g/l(10,u-a):0:v[_-1])%10&1||n==(e.s<0?8:7))),t<1||!v[0])return m?(o=S(e),v.length=1,t=t-o-1,v[0]=l(10,(p-t%p)%p),e.e=c(-t/p)||0):(v.length=1,v[0]=e.e=e.s=0),e;if(r==0?(v.length=_,o=1,_--):(v.length=_+1,o=l(10,p-r),v[_]=a>0?(g/l(10,u-a)%l(10,a)|0)*o:0),m)for(;;)if(_==0){(v[0]+=o)==f&&(v[0]=1,++e.e);break}else{if(v[_]+=o,v[_]!=f)break;v[_--]=0,o=1}for(r=v.length;v[--r]===0;)v.pop();if(i&&(e.e>h||e.e<-h))throw Error(s+S(e));return e}function O(e,t){var n,r,a,o,s,c,l,u,d,m,h=e.constructor,g=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),i?D(t,g):t;if(l=e.d,m=t.d,r=t.e,u=e.e,l=l.slice(),s=u-r,s){for(d=s<0,d?(n=l,s=-s,c=m.length):(n=m,r=u,c=l.length),a=Math.max(Math.ceil(g/p),c)+2,s>a&&(s=a,n.length=1),n.reverse(),a=s;a--;)n.push(0);n.reverse()}else{for(a=l.length,c=m.length,d=a<c,d&&(c=a),a=0;a<c;a++)if(l[a]!=m[a]){d=l[a]<m[a];break}s=0}for(d&&(n=l,l=m,m=n,t.s=-t.s),c=l.length,a=m.length-c;a>0;--a)l[c++]=0;for(a=m.length;a>s;){if(l[--a]<m[a]){for(o=a;o&&l[--o]===0;)l[o]=f-1;--l[o],l[a]+=f}l[a]-=m[a]}for(;l[--c]===0;)l.pop();for(;l[0]===0;l.shift())--r;return l[0]?(t.d=l,t.e=r,i?D(t,g):t):new h(0)}function k(e,t,n){var r,i=S(e),a=y(e.d),o=a.length;return t?(n&&(r=n-o)>0?a=a.charAt(0)+`.`+a.slice(1)+w(r):o>1&&(a=a.charAt(0)+`.`+a.slice(1)),a=a+(i<0?`e`:`e+`)+i):i<0?(a=`0.`+w(-i-1)+a,n&&(r=n-o)>0&&(a+=w(r))):i>=o?(a+=w(i+1-o),n&&(r=n-i-1)>0&&(a=a+`.`+w(r))):((r=i+1)<o&&(a=a.slice(0,r)+`.`+a.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(a+=`.`),a+=w(r))),e.s<0?`-`+a:a}function ee(e,t){if(e.length>t)return e.length=t,!0}function te(e){var t,n,r;function i(e){var t=this;if(!(t instanceof i))return new i(e);if(t.constructor=i,e instanceof i){t.s=e.s,t.e=e.e,t.d=(e=e.d)?e.slice():e;return}if(typeof e==`number`){if(e*0!=0)throw Error(o+e);if(e>0)t.s=1;else if(e<0)e=-e,t.s=-1;else{t.s=0,t.e=0,t.d=[0];return}if(e===~~e&&e<1e7){t.e=0,t.d=[e];return}return E(t,e.toString())}else if(typeof e!=`string`)throw Error(o+e);if(e.charCodeAt(0)===45?(e=e.slice(1),t.s=-1):t.s=1,u.test(e))E(t,e);else throw Error(o+e)}if(i.prototype=g,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=te,i.config=i.set=ne,e===void 0&&(e={}),e)for(r=[`precision`,`rounding`,`toExpNeg`,`toExpPos`,`LN10`],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return i.config(e),i}function ne(e){if(!e||typeof e!=`object`)throw Error(a+`Object expected`);var t,r,i,s=[`precision`,1,n,`rounding`,0,8,`toExpNeg`,-1/0,0,`toExpPos`,0,1/0];for(t=0;t<s.length;t+=3)if((i=e[r=s[t]])!==void 0)if(c(i)===i&&i>=s[t+1]&&i<=s[t+2])this[r]=i;else throw Error(o+r+`: `+i);if((i=e[r=`LN10`])!==void 0)if(i==Math.LN10)this[r]=new this(i);else throw Error(o+r+`: `+i);return this}r=te(r),r.default=r.Decimal=r,d=new r(1),typeof define==`function`&&define.amd?define(function(){return r}):t!==void 0&&t.exports?t.exports=r:(e||=typeof self<`u`&&self&&self.self==self?self:Function(`return this`)(),e.Decimal=r)})(e)})),Kpe=e=>e,mP={"@@functional/placeholder":!0},hP=e=>e===mP,gP=e=>function t(){return arguments.length===0||arguments.length===1&&hP(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},_P=(e,t)=>e===1?t:gP(function(){var n=[...arguments],r=n.filter(e=>e!==mP).length;return r>=e?t(...n):_P(e-r,gP(function(){var e=[...arguments],r=n.map(t=>hP(t)?e.shift():t);return t(...r,...e)}))}),vP=e=>_P(e.length,e),yP=(e,t)=>{for(var n=[],r=e;r<t;++r)n[r-e]=r;return n},qpe=vP((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(e=>t[e]).map(e)),Jpe=function(){var e=[...arguments];if(!e.length)return Kpe;var t=e.reverse(),n=t[0],r=t.slice(1);return function(){return r.reduce((e,t)=>t(e),n(...arguments))}},bP=e=>Array.isArray(e)?e.reverse():e.split(``).reverse().join(``),xP=e=>{var t=null,n=null;return function(){var r=[...arguments];return t&&r.every((e,n)=>e===t?.[n])?n:(t=r,n=e(...r),n)}},SP=l(pP());function CP(e){return e===0?1:Math.floor(new SP.default(e).abs().log(10).toNumber())+1}function wP(e,t,n){for(var r=new SP.default(e),i=0,a=[];r.lt(t)&&i<1e5;)a.push(r.toNumber()),r=r.add(n),i++;return a}vP((e,t,n)=>{var r=+e,i=+t;return r+n*(i-r)}),vP((e,t,n)=>{var r=t-+e;return r||=1/0,(n-e)/r}),vP((e,t,n)=>{var r=t-+e;return r||=1/0,Math.max(0,Math.min(1,(n-e)/r))});var TP=l(pP()),EP=e=>{var[t,n]=e,[r,i]=[t,n];return t>n&&([r,i]=[n,t]),[r,i]},DP=(e,t,n)=>{if(e.lte(0))return new TP.default(0);var r=CP(e.toNumber()),i=new TP.default(10).pow(r),a=e.div(i),o=r===1?.1:.05,s=new TP.default(Math.ceil(a.div(o).toNumber())).add(n).mul(o).mul(i);return t?new TP.default(s.toNumber()):new TP.default(Math.ceil(s.toNumber()))},Ype=(e,t,n)=>{var r=new TP.default(1),i=new TP.default(e);if(!i.isint()&&n){var a=Math.abs(e);a<1?(r=new TP.default(10).pow(CP(e)-1),i=new TP.default(Math.floor(i.div(r).toNumber())).mul(r)):a>1&&(i=new TP.default(Math.floor(e)))}else e===0?i=new TP.default(Math.floor((t-1)/2)):n||(i=new TP.default(Math.floor(e)));var o=Math.floor((t-1)/2);return Jpe(qpe(e=>i.add(new TP.default(e-o).mul(r)).toNumber()),yP)(0,t)},OP=function(e,t,n,r){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new TP.default(0),tickMin:new TP.default(0),tickMax:new TP.default(0)};var a=DP(new TP.default(t).sub(e).div(n-1),r,i),o;e<=0&&t>=0?o=new TP.default(0):(o=new TP.default(e).add(t).div(2),o=o.sub(new TP.default(o).mod(a)));var s=Math.ceil(o.sub(e).div(a).toNumber()),c=Math.ceil(new TP.default(t).sub(o).div(a).toNumber()),l=s+c+1;return l>n?OP(e,t,n,r,i+1):(l<n&&(c=t>0?c+(n-l):c,s=t>0?s:s+(n-l)),{step:a,tickMin:o.sub(new TP.default(s).mul(a)),tickMax:o.add(new TP.default(c).mul(a))})};function Xpe(e){var[t,n]=e,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(r,2),[o,s]=EP([t,n]);if(o===-1/0||s===1/0){var c=s===1/0?[o,...yP(0,r-1).map(()=>1/0)]:[...yP(0,r-1).map(()=>-1/0),s];return t>n?bP(c):c}if(o===s)return Ype(o,r,i);var{step:l,tickMin:u,tickMax:d}=OP(o,s,a,i,0),f=wP(u,d.add(new TP.default(.1).mul(l)),l);return t>n?bP(f):f}function Zpe(e,t){var[n,r]=e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[a,o]=EP([n,r]);if(a===-1/0||o===1/0)return[n,r];if(a===o)return[a];var s=Math.max(t,2),c=DP(new TP.default(o).sub(a).div(s-1),i,0),l=[...wP(new TP.default(a),new TP.default(o),c),o];return i===!1&&(l=l.map(e=>Math.round(e))),n>r?bP(l):l}var Qpe=xP(Xpe),$pe=xP(Zpe),kP=e=>e.rootProps.maxBarSize,eme=e=>e.rootProps.barGap,AP=e=>e.rootProps.barCategoryGap,tme=e=>e.rootProps.barSize,jP=e=>e.rootProps.stackOffset,MP=e=>e.options.chartName,NP=e=>e.rootProps.syncId,PP=e=>e.rootProps.syncMethod,FP=e=>e.options.eventEmitter,IP={allowDuplicatedCategory:!0,angleAxisId:0,axisLine:!0,cx:0,cy:0,orientation:`outer`,reversed:!1,scale:`auto`,tick:!0,tickLine:!0,tickSize:8,type:`category`},LP={allowDataOverflow:!1,allowDuplicatedCategory:!0,angle:0,axisLine:!0,cx:0,cy:0,orientation:`right`,radiusAxisId:0,scale:`auto`,stroke:`#ccc`,tick:!0,tickCount:5,type:`number`},RP=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},nme={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:IP.angleAxisId,includeHidden:!1,name:void 0,reversed:IP.reversed,scale:IP.scale,tick:IP.tick,tickCount:void 0,ticks:void 0,type:IP.type,unit:void 0},rme={allowDataOverflow:LP.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:LP.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:LP.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:LP.scale,tick:LP.tick,tickCount:LP.tickCount,ticks:void 0,type:LP.type,unit:void 0},ime={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:IP.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:IP.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:IP.scale,tick:IP.tick,tickCount:void 0,ticks:void 0,type:`number`,unit:void 0},ame={allowDataOverflow:LP.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:LP.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:LP.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:LP.scale,tick:LP.tick,tickCount:LP.tickCount,ticks:void 0,type:`category`,unit:void 0},zP=(e,t)=>e.polarAxis.angleAxis[t]==null?e.layout.layoutType===`radial`?ime:nme:e.polarAxis.angleAxis[t],BP=(e,t)=>e.polarAxis.radiusAxis[t]==null?e.layout.layoutType===`radial`?ame:rme:e.polarAxis.radiusAxis[t],VP=e=>e.polarOptions,HP=L([XO,ZO,pk],uO),UP=L([VP,HP],(e,t)=>{if(e!=null)return ST(e.innerRadius,t,0)}),WP=L([VP,HP],(e,t)=>{if(e!=null)return ST(e.outerRadius,t,t*.8)}),GP=L([VP],e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:n}=e;return[t,n]});L([zP,GP],RP);var KP=L([HP,UP,WP],(e,t,n)=>{if(!(e==null||t==null||n==null))return[t,n]});L([BP,KP],RP);var qP=L([Yk,VP,UP,WP,XO,ZO],(e,t,n,r,i,a)=>{if(!(e!==`centric`&&e!==`radial`||t==null||n==null||r==null)){var{cx:o,cy:s,startAngle:c,endAngle:l}=t;return{cx:ST(o,i,i/2),cy:ST(s,a,a/2),innerRadius:n,outerRadius:r,startAngle:c,endAngle:l,clockWise:!1}}}),JP=(e,t)=>t,YP=(e,t,n)=>n;function XP(e){return e?.id}var ZP=e=>{var t=Yk(e);return t===`horizontal`?`xAxis`:t===`vertical`?`yAxis`:t===`centric`?`angleAxis`:`radiusAxis`},QP=e=>e.tooltip.settings.axisId,$P=e=>{var t=ZP(e),n=QP(e);return _F(e,t,n)},eF=L([$P],e=>e?.dataKey);function tF(e,t,n){var{chartData:r=[]}=t,{allowDuplicatedCategory:i,dataKey:a}=n,o=new Map;return e.forEach(e=>{var t=e.data??r;if(!(t==null||t.length===0)){var n=XP(e);t.forEach((t,r)=>{var s=a==null||i?r:String(wO(t,a,null)),c=wO(t,e.dataKey,0),l=o.has(s)?o.get(s):{};Object.assign(l,{[n]:c}),o.set(s,l)})}}),Array.from(o.values())}function nF(e){return e.stackId!=null&&e.dataKey!=null}var rF=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function iF(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}var aF=l(hde());function oF(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function sF(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?oF(Object(n),!0).forEach(function(t){ome(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oF(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ome(e,t,n){return(t=sme(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sme(e){var t=cme(e,`string`);return typeof t==`symbol`?t:t+``}function cme(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var cF=[0,`auto`],lF={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:`preserveEnd`,minTickGap:5,mirror:!1,name:void 0,orientation:`bottom`,padding:{left:0,right:0},reversed:!1,scale:`auto`,tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:`category`,unit:void 0},uF=(e,t)=>e.cartesianAxis.xAxis[t],dF=(e,t)=>uF(e,t)??lF,fF={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:cF,hide:!0,id:0,includeHidden:!1,interval:`preserveEnd`,minTickGap:5,mirror:!1,name:void 0,orientation:`left`,padding:{top:0,bottom:0},reversed:!1,scale:`auto`,tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:`number`,unit:void 0,width:60},pF=(e,t)=>e.cartesianAxis.yAxis[t],mF=(e,t)=>pF(e,t)??fF,lme={domain:[0,`auto`],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:``,range:[64,64],scale:`auto`,type:`number`,unit:``},hF=(e,t)=>e.cartesianAxis.zAxis[t]??lme,gF=(e,t,n)=>{switch(t){case`xAxis`:return dF(e,n);case`yAxis`:return mF(e,n);case`zAxis`:return hF(e,n);case`angleAxis`:return zP(e,n);case`radiusAxis`:return BP(e,n);default:throw Error(`Unexpected axis type: ${t}`)}},ume=(e,t,n)=>{switch(t){case`xAxis`:return dF(e,n);case`yAxis`:return mF(e,n);default:throw Error(`Unexpected axis type: ${t}`)}},_F=(e,t,n)=>{switch(t){case`xAxis`:return dF(e,n);case`yAxis`:return mF(e,n);case`angleAxis`:return zP(e,n);case`radiusAxis`:return BP(e,n);default:throw Error(`Unexpected axis type: ${t}`)}},vF=e=>e.graphicalItems.cartesianItems.some(e=>e.type===`bar`)||e.graphicalItems.polarItems.some(e=>e.type===`radialBar`);function yF(e,t){return n=>{switch(e){case`xAxis`:return`xAxisId`in n&&n.xAxisId===t;case`yAxis`:return`yAxisId`in n&&n.yAxisId===t;case`zAxis`:return`zAxisId`in n&&n.zAxisId===t;case`angleAxis`:return`angleAxisId`in n&&n.angleAxisId===t;case`radiusAxis`:return`radiusAxisId`in n&&n.radiusAxisId===t;default:return!1}}}var bF=e=>e.graphicalItems.cartesianItems,dme=L([JP,YP],yF),xF=(e,t,n)=>e.filter(n).filter(e=>t?.includeHidden===!0?!0:!e.hide),SF=L([bF,gF,dme],xF,{memoizeOptions:{resultEqualityCheck:iF}}),CF=L([SF],e=>e.filter(e=>e.type===`area`||e.type===`bar`).filter(nF)),wF=e=>e.filter(e=>!(`stackId`in e)||e.stackId===void 0),fme=L([SF],wF),TF=e=>e.map(e=>e.data).filter(Boolean).flat(1),pme=L([SF],TF,{memoizeOptions:{resultEqualityCheck:iF}}),EF=(e,t)=>{var{chartData:n=[],dataStartIndex:r,dataEndIndex:i}=t;return e.length>0?e:n.slice(r,i+1)},DF=L([pme,lP],EF),OF=(e,t,n)=>t?.dataKey==null?n.length>0?n.map(e=>e.dataKey).flatMap(t=>e.map(e=>({value:wO(e,t)}))):e.map(e=>({value:e})):e.map(e=>({value:wO(e,t.dataKey)})),kF=L([DF,gF,SF],OF);function AF(e,t){switch(e){case`xAxis`:return t.direction===`x`;case`yAxis`:return t.direction===`y`;default:return!1}}function jF(e){if(bT(e)||e instanceof Date){var t=Number(e);if(Nk(t))return t}}function MF(e){if(Array.isArray(e)){var t=[jF(e[0]),jF(e[1])];return uP(t)?t:void 0}var n=jF(e);if(n!=null)return[n,n]}function NF(e){return e.map(jF).filter(Pue)}function mme(e,t,n){return!n||typeof t!=`number`||_T(t)||!n.length?[]:NF(n.flatMap(n=>{var r=wO(e,n.dataKey),i,a;if(Array.isArray(r)?[i,a]=r:i=a=r,!(!Nk(i)||!Nk(a)))return[t-i,t+a]}))}var hme=L([CF,lP,$P],tF),PF=(e,t,n)=>{var r=t.reduce((e,t)=>t.stackId==null?e:(e[t.stackId]??(e[t.stackId]=[]),e[t.stackId].push(t),e),{});return Object.fromEntries(Object.entries(r).map(t=>{var[r,i]=t,a=i.map(XP);return[r,{stackedData:PO(e,a,n),graphicalItems:i}]}))},FF=L([hme,CF,jP],PF),IF=(e,t,n,r)=>{var{dataStartIndex:i,dataEndIndex:a}=t;if(r==null&&n!==`zAxis`){var o=VO(e,i,a);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},gme=L([gF],e=>e.allowDataOverflow),LF=e=>{if(e==null||!(`domain`in e))return cF;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type===`number`){var t=NF(e.ticks);return[Math.min(...t),Math.max(...t)]}if(e.type===`category`)return e.ticks.map(String)}return e?.domain??cF},RF=L([gF],LF),zF=L([RF,gme],fP),_me=L([FF,cP,JP,zF],IF,{memoizeOptions:{resultEqualityCheck:rF}}),BF=e=>e.errorBars,vme=(e,t,n)=>e.flatMap(e=>t[e.id]).filter(Boolean).filter(e=>AF(n,e)),VF=function(){var e=[...arguments].filter(Boolean);if(e.length!==0){var t=e.flat(),n=Math.min(...t),r=Math.max(...t);return[n,r]}},HF=(e,t,n,r,i)=>{var a,o;if(n.length>0&&e.forEach(e=>{n.forEach(n=>{var s=r[n.id]?.filter(e=>AF(i,e)),c=wO(e,t.dataKey??n.dataKey),l=mme(e,c,s);if(l.length>=2){var u=Math.min(...l),d=Math.max(...l);(a==null||u<a)&&(a=u),(o==null||d>o)&&(o=d)}var f=MF(c);f!=null&&(a=a==null?f[0]:Math.min(a,f[0]),o=o==null?f[1]:Math.max(o,f[1]))})}),t?.dataKey!=null&&e.forEach(e=>{var n=MF(wO(e,t.dataKey));n!=null&&(a=a==null?n[0]:Math.min(a,n[0]),o=o==null?n[1]:Math.max(o,n[1]))}),Nk(a)&&Nk(o))return[a,o]},yme=L([DF,gF,fme,BF,JP],HF,{memoizeOptions:{resultEqualityCheck:rF}});function bme(e){var{value:t}=e;if(bT(t)||t instanceof Date)return t}var xme=(e,t,n)=>{var r=e.map(bme).filter(e=>e!=null);return n&&(t.dataKey==null||t.allowDuplicatedCategory&&CT(r))?(0,aF.default)(0,e.length):t.allowDuplicatedCategory?r:Array.from(new Set(r))},UF=e=>e.referenceElements.dots,WF=(e,t,n)=>e.filter(e=>e.ifOverflow===`extendDomain`).filter(e=>t===`xAxis`?e.xAxisId===n:e.yAxisId===n),Sme=L([UF,JP,YP],WF),GF=e=>e.referenceElements.areas,Cme=L([GF,JP,YP],WF),KF=e=>e.referenceElements.lines,wme=L([KF,JP,YP],WF),qF=(e,t)=>{var n=NF(e.map(e=>t===`xAxis`?e.x:e.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},Tme=L(Sme,JP,qF),JF=(e,t)=>{var n=NF(e.flatMap(e=>[t===`xAxis`?e.x1:e.y1,t===`xAxis`?e.x2:e.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},Eme=L([Cme,JP],JF),YF=(e,t)=>{var n=NF(e.map(e=>t===`xAxis`?e.x:e.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},Dme=L(wme,JP,YF),Ome=L(Tme,Dme,Eme,(e,t,n)=>VF(e,n,t)),XF=(e,t,n,r,i,a,o,s)=>{if(n!=null)return n;var c=o===`vertical`&&s===`xAxis`||o===`horizontal`&&s===`yAxis`?VF(r,a,i):VF(a,i);return Gpe(t,c,e.allowDataOverflow)},kme=L([gF,RF,zF,_me,yme,Ome,Yk,JP],XF,{memoizeOptions:{resultEqualityCheck:rF}}),Ame=[0,1],ZF=(e,t,n,r,i,a,o)=>{if(!((e==null||n==null||n.length===0)&&o===void 0)){var{dataKey:s,type:c}=e,l=DO(t,a);return l&&s==null?(0,aF.default)(0,n.length):c===`category`?xme(r,e,l):i===`expand`?Ame:o}},QF=L([gF,Yk,DF,kF,jP,JP,kme],ZF),$F=(e,t,n,r,i)=>{if(e!=null){var{scale:a,type:o}=e;if(a===`auto`)return t===`radial`&&i===`radiusAxis`?`band`:t===`radial`&&i===`angleAxis`?`linear`:o===`category`&&r&&(r.indexOf(`LineChart`)>=0||r.indexOf(`AreaChart`)>=0||r.indexOf(`ComposedChart`)>=0&&!n)?`point`:o===`category`?`band`:`linear`;if(typeof a==`string`){var s=`scale${DT(a)}`;return s in sP?s:`point`}}},eI=L([gF,Yk,vF,MP,JP],$F);function jme(e){if(e!=null){if(e in sP)return sP[e]();var t=`scale${DT(e)}`;if(t in sP)return sP[t]()}}function tI(e,t,n,r){if(!(n==null||r==null)){if(typeof e.scale==`function`)return e.scale.copy().domain(n).range(r);var i=jme(t);if(i!=null){var a=i.domain(n).range(r);return jO(a),a}}}var nI=(e,t,n)=>{var r=LF(t);if(!(n!==`auto`&&n!==`linear`)){if(t!=null&&t.tickCount&&Array.isArray(r)&&(r[0]===`auto`||r[1]===`auto`)&&uP(e))return Qpe(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type===`number`&&uP(e))return $pe(e,t.tickCount,t.allowDecimals)}},rI=L([QF,_F,eI],nI),iI=(e,t,n,r)=>{if(r!==`angleAxis`&&e?.type===`number`&&uP(t)&&Array.isArray(n)&&n.length>0){var i=t[0],a=n[0],o=t[1],s=n[n.length-1];return[Math.min(i,a),Math.max(o,s)]}return t},Mme=L([gF,QF,rI,JP],iI),Nme=L(kF,gF,(e,t)=>{if(!(!t||t.type!==`number`)){var n=1/0,r=Array.from(NF(e.map(e=>e.value))).sort((e,t)=>e-t);if(r.length<2)return 1/0;var i=r[r.length-1]-r[0];if(i===0)return 1/0;for(var a=0;a<r.length-1;a++){var o=r[a+1]-r[a];n=Math.min(n,o)}return n/i}}),aI=L(Nme,Yk,AP,pk,(e,t,n,r)=>r,(e,t,n,r,i)=>{if(!Nk(e))return 0;var a=t===`vertical`?r.height:r.width;if(i===`gap`)return e*a/2;if(i===`no-gap`){var o=ST(n,e*a),s=e*a/2;return s-o-(s-o)/a*o}return 0}),Pme=(e,t)=>{var n=dF(e,t);return n==null||typeof n.padding!=`string`?0:aI(e,`xAxis`,t,n.padding)},Fme=(e,t)=>{var n=mF(e,t);return n==null||typeof n.padding!=`string`?0:aI(e,`yAxis`,t,n.padding)},Ime=L(dF,Pme,(e,t)=>{if(e==null)return{left:0,right:0};var{padding:n}=e;return typeof n==`string`?{left:t,right:t}:{left:(n.left??0)+t,right:(n.right??0)+t}}),Lme=L(mF,Fme,(e,t)=>{if(e==null)return{top:0,bottom:0};var{padding:n}=e;return typeof n==`string`?{top:t,bottom:t}:{top:(n.top??0)+t,bottom:(n.bottom??0)+t}}),Rme=L([pk,Ime,yk,vk,(e,t,n)=>n],(e,t,n,r,i)=>{var{padding:a}=r;return i?[a.left,n.width-a.right]:[e.left+t.left,e.left+e.width-t.right]}),zme=L([pk,Yk,Lme,yk,vk,(e,t,n)=>n],(e,t,n,r,i,a)=>{var{padding:o}=i;return a?[r.height-o.bottom,o.top]:t===`horizontal`?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]}),oI=(e,t,n,r)=>{switch(t){case`xAxis`:return Rme(e,n,r);case`yAxis`:return zme(e,n,r);case`zAxis`:return hF(e,n)?.range;case`angleAxis`:return GP(e);case`radiusAxis`:return KP(e,n);default:return}},sI=L([gF,oI],RP),cI=L([gF,eI,Mme,sI],tI);L([SF,BF,JP],vme);function lI(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var uI=(e,t)=>t,dI=(e,t,n)=>n,Bme=L(ek,uI,dI,(e,t,n)=>e.filter(e=>e.orientation===t).filter(e=>e.mirror===n).sort(lI)),Vme=L(tk,uI,dI,(e,t,n)=>e.filter(e=>e.orientation===t).filter(e=>e.mirror===n).sort(lI)),fI=(e,t)=>({width:e.width,height:t.height}),Hme=(e,t)=>({width:typeof t.width==`number`?t.width:60,height:e.height}),pI=L(pk,dF,fI),Ume=(e,t,n)=>{switch(t){case`top`:return e.top;case`bottom`:return n-e.bottom;default:return 0}},Wme=(e,t,n)=>{switch(t){case`left`:return e.left;case`right`:return n-e.right;default:return 0}},Gme=L(ZO,pk,Bme,uI,dI,(e,t,n,r,i)=>{var a={},o;return n.forEach(n=>{var s=fI(t,n);o??=Ume(t,r,e);var c=r===`top`&&!i||r===`bottom`&&i;a[n.id]=o-Number(c)*s.height,o+=(c?-1:1)*s.height}),a}),Kme=L(XO,pk,Vme,uI,dI,(e,t,n,r,i)=>{var a={},o;return n.forEach(n=>{var s=Hme(t,n);o??=Wme(t,r,e);var c=r===`left`&&!i||r===`right`&&i;a[n.id]=o-Number(c)*s.width,o+=(c?-1:1)*s.width}),a}),qme=L([pk,dF,(e,t)=>{var n=dF(e,t);if(n!=null)return Gme(e,n.orientation,n.mirror)},(e,t)=>t],(e,t,n,r)=>{if(t!=null){var i=n?.[r];return i==null?{x:e.left,y:0}:{x:e.left,y:i}}}),Jme=L([pk,mF,(e,t)=>{var n=mF(e,t);if(n!=null)return Kme(e,n.orientation,n.mirror)},(e,t)=>t],(e,t,n,r)=>{if(t!=null){var i=n?.[r];return i==null?{x:0,y:e.top}:{x:i,y:e.top}}}),mI=L(pk,mF,(e,t)=>({width:typeof t.width==`number`?t.width:60,height:e.height})),hI=(e,t,n)=>{switch(t){case`xAxis`:return pI(e,n).width;case`yAxis`:return mI(e,n).height;default:return}},gI=(e,t,n,r)=>{if(n!=null){var{allowDuplicatedCategory:i,type:a,dataKey:o}=n,s=DO(e,r),c=t.map(e=>e.value);if(o&&s&&a===`category`&&i&&CT(c))return c}},_I=L([Yk,kF,gF,JP],gI),vI=(e,t,n,r)=>{if(!(n==null||n.dataKey==null)){var{type:i,scale:a}=n;if(DO(e,r)&&(i===`number`||a!==`auto`))return t.map(e=>e.value)}},yI=L([Yk,kF,_F,JP],vI),bI=L([Yk,ume,eI,cI,_I,yI,oI,rI,JP],(e,t,n,r,i,a,o,s,c)=>{if(t==null)return null;var l=DO(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:a,duplicateDomain:i,isCategorical:l,niceTicks:s,range:o,realScaleType:n,scale:r}}),xI=L([Yk,_F,eI,cI,rI,oI,_I,yI,JP],(e,t,n,r,i,a,o,s,c)=>{if(!(t==null||r==null)){var l=DO(e,c),{type:u,ticks:d,tickCount:f}=t,p=n===`scaleBand`&&typeof r.bandwidth==`function`?r.bandwidth()/2:2,m=u===`category`&&r.bandwidth?r.bandwidth()/p:0;m=c===`angleAxis`&&a!=null&&a.length>=2?gT(a[0]-a[1])*2*m:m;var h=d||i;return h?h.map((e,t)=>{var n=o?o.indexOf(e):e;return{index:t,coordinate:r(n)+m,value:e,offset:m}}).filter(e=>!_T(e.coordinate)):l&&s?s.map((e,t)=>({coordinate:r(e)+m,value:e,index:t,offset:m})):r.ticks?r.ticks(f).map(e=>({coordinate:r(e)+m,value:e,offset:m})):r.domain().map((e,t)=>({coordinate:r(e)+m,value:o?o[e]:e,index:t,offset:m}))}}),SI=L([Yk,_F,cI,oI,_I,yI,JP],(e,t,n,r,i,a,o)=>{if(!(t==null||n==null||r==null||r[0]===r[1])){var s=DO(e,o),{tickCount:c}=t,l=0;return l=o===`angleAxis`&&r?.length>=2?gT(r[0]-r[1])*2*l:l,s&&a?a.map((e,t)=>({coordinate:n(e)+l,value:e,index:t,offset:l})):n.ticks?n.ticks(c).map(e=>({coordinate:n(e)+l,value:e,offset:l})):n.domain().map((e,t)=>({coordinate:n(e)+l,value:i?i[e]:e,index:t,offset:l}))}}),CI=L(gF,cI,(e,t)=>{if(!(e==null||t==null))return sF(sF({},e),{},{scale:t})}),Yme=L([gF,eI,QF,sI],tI);L((e,t,n)=>hF(e,n),Yme,(e,t)=>{if(!(e==null||t==null))return sF(sF({},e),{},{scale:t})});var Xme=L([Yk,ek,tk],(e,t,n)=>{switch(e){case`horizontal`:return t.some(e=>e.reversed)?`right-to-left`:`left-to-right`;case`vertical`:return n.some(e=>e.reversed)?`bottom-to-top`:`top-to-bottom`;case`centric`:case`radial`:return`left-to-right`;default:return}}),wI=e=>e.options.defaultTooltipEventType,TI=e=>e.options.validateTooltipEventTypes;function EI(e,t,n){if(e==null)return t;var r=e?`axis`:`item`;return n==null?t:n.includes(r)?r:t}function DI(e,t){var n=wI(e),r=TI(e);return EI(t,n,r)}function Zme(e){return tE(t=>DI(t,e))}var OI=(e,t)=>{var n,r=Number(t);if(!(_T(r)||t==null))return r>=0?e==null||(n=e[r])==null?void 0:n.value:void 0},Qme=e=>e.tooltip.settings,kI={active:!1,index:null,dataKey:void 0,coordinate:void 0},AI=yD({name:`tooltip`,initialState:{itemInteraction:{click:kI,hover:kI},axisInteraction:{click:kI,hover:kI},keyboardInteraction:kI,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:`hover`,axisId:0,active:!1,defaultIndex:void 0}},reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(cD(t.payload))},prepare:hD()},removeTooltipEntrySettings:{reducer(e,t){var n=aD(e).tooltipItemPayloads.indexOf(cD(t.payload));n>-1&&e.tooltipItemPayloads.splice(n,1)},prepare:hD()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:$me,removeTooltipEntrySettings:ehe,setTooltipSettingsState:the,setActiveMouseOverItemIndex:jI,mouseLeaveItem:nhe,mouseLeaveChart:MI,setActiveClickItemIndex:rhe,setMouseOverAxisIndex:NI,setMouseClickAxisIndex:ihe,setSyncInteraction:PI,setKeyboardInteraction:FI}=AI.actions,ahe=AI.reducer;function II(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function LI(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?II(Object(n),!0).forEach(function(t){ohe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):II(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ohe(e,t,n){return(t=she(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function she(e){var t=che(e,`string`);return typeof t==`symbol`?t:t+``}function che(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function lhe(e,t,n){return t===`axis`?n===`click`?e.axisInteraction.click:e.axisInteraction.hover:n===`click`?e.itemInteraction.click:e.itemInteraction.hover}function uhe(e){return e.index!=null}var RI=(e,t,n,r)=>{if(t==null)return kI;var i=lhe(e,t,n);if(i==null)return kI;if(i.active)return i;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var a=e.settings.active===!0;if(uhe(i)){if(a)return LI(LI({},i),{},{active:!0})}else if(r!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:r};return LI(LI({},kI),{},{coordinate:i.coordinate})},zI=(e,t)=>{var n=e?.index;if(n==null)return null;var r=Number(n);if(!Nk(r))return n;var i=0,a=1/0;return t.length>0&&(a=t.length-1),String(Math.max(i,Math.min(r,a)))},BI=(e,t,n,r,i,a,o,s)=>{if(!(a==null||s==null)){var c=o[0],l=c==null?void 0:s(c.positions,a);if(l!=null)return l;var u=i?.[Number(a)];if(u)switch(n){case`horizontal`:return{x:u.coordinate,y:(r.top+t)/2};default:return{x:(r.left+e)/2,y:u.coordinate}}}},VI=(e,t,n,r)=>{if(t===`axis`)return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var i=n===`hover`?e.itemInteraction.hover.dataKey:e.itemInteraction.click.dataKey;return i==null&&r!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(e=>e.settings?.dataKey===i)},HI=e=>e.options.tooltipPayloadSearcher,UI=e=>e.tooltip;function WI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function GI(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?WI(Object(n),!0).forEach(function(t){dhe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WI(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function dhe(e,t,n){return(t=fhe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fhe(e){var t=phe(e,`string`);return typeof t==`symbol`?t:t+``}function phe(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function mhe(e,t){return e??t}var KI=(e,t,n,r,i,a,o)=>{if(!(t==null||a==null)){var{chartData:s,computedData:c,dataStartIndex:l,dataEndIndex:u}=n;return e.reduce((e,n)=>{var{dataDefinedOnItem:d,settings:f}=n,p=mhe(d,s),m=Array.isArray(p)?gO(p,l,u):p,h=f?.dataKey??r,g=f?.nameKey,_=r&&Array.isArray(m)&&!Array.isArray(m[0])&&o===`axis`?TT(m,r,i):a(m,t,c,g);return Array.isArray(_)?_.forEach(t=>{var n=GI(GI({},f),{},{name:t.name,unit:t.unit,color:void 0,fill:void 0});e.push(GO({tooltipEntrySettings:n,dataKey:t.dataKey,payload:t.payload,value:wO(t.payload,t.dataKey),name:t.name}))}):e.push(GO({tooltipEntrySettings:f,dataKey:h,payload:_,value:wO(_,h),name:wO(_,g)??f?.name})),e},[])}},qI=L([$P,Yk,vF,MP,ZP],$F),hhe=L([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),ghe=L([ZP,QP],yF),JI=L([hhe,$P,ghe],xF,{memoizeOptions:{resultEqualityCheck:iF}}),_he=L([JI],e=>e.filter(nF)),vhe=L([JI],TF,{memoizeOptions:{resultEqualityCheck:iF}}),YI=L([vhe,cP],EF),yhe=L([_he,cP,$P],tF),XI=L([YI,$P,JI],OF),ZI=L([$P],LF),bhe=L([$P],e=>e.allowDataOverflow),QI=L([ZI,bhe],fP),xhe=L([JI],e=>e.filter(nF)),She=L([yhe,xhe,jP],PF),Che=L([She,cP,ZP,QI],IF),whe=L([JI],wF),The=L([YI,$P,whe,BF,ZP],HF,{memoizeOptions:{resultEqualityCheck:rF}}),Ehe=L([UF,ZP,QP],WF),Dhe=L([Ehe,ZP],qF),Ohe=L([GF,ZP,QP],WF),khe=L([Ohe,ZP],JF),Ahe=L([KF,ZP,QP],WF),jhe=L([Ahe,ZP],YF),Mhe=L([Dhe,jhe,khe],VF),Nhe=L([$P,ZI,QI,Che,The,Mhe,Yk,ZP],XF),$I=L([$P,Yk,YI,XI,jP,ZP,Nhe],ZF),Phe=L([$I,$P,qI],nI),Fhe=L([$P,$I,Phe,ZP],iI),eL=e=>{var t=ZP(e),n=QP(e);return oI(e,t,n,!1)},tL=L([$P,eL],RP),nL=L([$P,qI,Fhe,tL],tI),Ihe=L([Yk,XI,$P,ZP],gI),Lhe=L([Yk,XI,$P,ZP],vI),rL=L([Yk,$P,qI,nL,eL,Ihe,Lhe,ZP],(e,t,n,r,i,a,o,s)=>{if(t){var{type:c}=t,l=DO(e,s);if(r){var u=n===`scaleBand`&&r.bandwidth?r.bandwidth()/2:2,d=c===`category`&&r.bandwidth?r.bandwidth()/u:0;return d=s===`angleAxis`&&i!=null&&i?.length>=2?gT(i[0]-i[1])*2*d:d,l&&o?o.map((e,t)=>({coordinate:r(e)+d,value:e,index:t,offset:d})):r.domain().map((e,t)=>({coordinate:r(e)+d,value:a?a[e]:e,index:t,offset:d}))}}}),iL=L([wI,TI,Qme],(e,t,n)=>EI(n.shared,e,t)),aL=e=>e.tooltip.settings.trigger,oL=e=>e.tooltip.settings.defaultIndex,sL=L([UI,iL,aL,oL],RI),cL=L([sL,YI],zI),lL=L([rL,cL],OI),uL=L([sL],e=>{if(e)return e.dataKey}),dL=L([UI,iL,aL,oL],VI),Rhe=L([XO,ZO,Yk,pk,rL,oL,dL,HI],BI),zhe=L([sL,Rhe],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Bhe=L([sL],e=>e.active),Vhe=L([dL,cL,cP,eF,lL,HI,iL],KI),Hhe=L([Vhe],e=>{if(e!=null){var t=e.map(e=>e.payload).filter(e=>e!=null);return Array.from(new Set(t))}});function fL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function pL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?fL(Object(n),!0).forEach(function(t){Uhe(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fL(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Uhe(e,t,n){return(t=Whe(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Whe(e){var t=Ghe(e,`string`);return typeof t==`symbol`?t:t+``}function Ghe(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var Khe=()=>tE($P),qhe=()=>{var e=Khe(),t=tE(rL),n=tE(nL);return WO(pL(pL({},e),{},{scale:n}),t)},Jhe=l(cE()),Yhe=()=>tE(MP),mL=(e,t)=>t,hL=(e,t,n)=>n,gL=(e,t,n,r)=>r,Xhe=L(rL,e=>(0,Jhe.default)(e,e=>e.coordinate)),_L=L([UI,mL,hL,gL],RI),vL=L([_L,YI],zI),Zhe=(e,t,n)=>{if(t!=null){var r=UI(e);return t===`axis`?n===`hover`?r.axisInteraction.hover.dataKey:r.axisInteraction.click.dataKey:n===`hover`?r.itemInteraction.hover.dataKey:r.itemInteraction.click.dataKey}},yL=L([UI,mL,hL,gL],VI),bL=L([XO,ZO,Yk,pk,rL,gL,yL,HI],BI),Qhe=L([_L,bL],(e,t)=>e.coordinate??t),xL=L(rL,vL,OI),$he=L([yL,vL,cP,eF,xL,HI,mL],KI),ege=L([_L],e=>({isActive:e.active,activeIndex:e.index})),tge=(e,t,n,r,i,a,o,s)=>{if(!(!e||!t||!r||!i||!a)){var c=qO(e.chartX,e.chartY,t,n,s);if(c){var l=YO(c,t),u=TO(l,o,a,r,i),d=JO(t,a,u,c);return{activeIndex:String(u),activeCoordinate:d}}}};function SL(){return SL=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},SL.apply(null,arguments)}function CL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function wL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?CL(Object(n),!0).forEach(function(t){nge(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CL(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function nge(e,t,n){return(t=rge(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rge(e){var t=ige(e,`string`);return typeof t==`symbol`?t:t+``}function ige(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function age(e){var{coordinate:t,payload:n,index:r,offset:i,tooltipAxisBandSize:a,layout:o,cursor:s,tooltipEventType:c,chartName:l}=e,u=t,d=n,f=r;if(!s||!u||l!==`ScatterChart`&&c!==`axis`)return null;var p,m;if(l===`ScatterChart`)p=u,m=Due;else if(l===`BarChart`)p=Oue(o,u,i,a),m=YA;else if(o===`radial`){var{cx:h,cy:g,radius:_,startAngle:v,endAngle:y}=XA(u);p={cx:h,cy:g,startAngle:v,endAngle:y,innerRadius:_,outerRadius:_},m=ej}else p={points:dde(o,u,i)},m=SA;var b=typeof s==`object`&&`className`in s?s.className:void 0,x=wL(wL(wL(wL({stroke:`#ccc`,pointerEvents:`none`},i),p),pw(s)),{},{payload:d,payloadIndex:f,className:cw(`recharts-tooltip-cursor`,b)});return(0,N.isValidElement)(s)?(0,N.cloneElement)(s,x):(0,N.createElement)(m,x)}function oge(e){var t=qhe(),n=Kk(),r=Xk(),i=Yhe();return N.createElement(age,SL({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:n,layout:r,tooltipAxisBandSize:t,chartName:i}))}var TL=(0,N.createContext)(null),sge=()=>(0,N.useContext)(TL),cge=l(o(((e,t)=>{var n=Object.prototype.hasOwnProperty,r=`~`;function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(r=!1));function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,n,i,o){if(typeof n!=`function`)throw TypeError(`The listener must be a function`);var s=new a(n,i||e,o),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],s]:e._events[c].push(s):(e._events[c]=s,e._eventsCount++),e}function s(e,t){--e._eventsCount===0?e._events=new i:delete e._events[t]}function c(){this._events=new i,this._eventsCount=0}c.prototype.eventNames=function(){var e=[],t,i;if(this._eventsCount===0)return e;for(i in t=this._events)n.call(t,i)&&e.push(r?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e},c.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,a=n.length,o=Array(a);i<a;i++)o[i]=n[i].fn;return o},c.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},c.prototype.emit=function(e,t,n,i,a,o){var s=r?r+e:e;if(!this._events[s])return!1;var c=this._events[s],l=arguments.length,u,d;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,a),!0;case 6:return c.fn.call(c.context,t,n,i,a,o),!0}for(d=1,u=Array(l-1);d<l;d++)u[d-1]=arguments[d];c.fn.apply(c.context,u)}else{var f=c.length,p;for(d=0;d<f;d++)switch(c[d].once&&this.removeListener(e,c[d].fn,void 0,!0),l){case 1:c[d].fn.call(c[d].context);break;case 2:c[d].fn.call(c[d].context,t);break;case 3:c[d].fn.call(c[d].context,t,n);break;case 4:c[d].fn.call(c[d].context,t,n,i);break;default:if(!u)for(p=1,u=Array(l-1);p<l;p++)u[p-1]=arguments[p];c[d].fn.apply(c[d].context,u)}}return!0},c.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},c.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},c.prototype.removeListener=function(e,t,n,i){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return s(this,a),this;var o=this._events[a];if(o.fn)o.fn===t&&(!i||o.once)&&(!n||o.context===n)&&s(this,a);else{for(var c=0,l=[],u=o.length;c<u;c++)(o[c].fn!==t||i&&!o[c].once||n&&o[c].context!==n)&&l.push(o[c]);l.length?this._events[a]=l.length===1?l[0]:l:s(this,a)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,t!==void 0&&(t.exports=c)}))(),1).default,EL=new cge,DL=`recharts.syncEvent.tooltip`,OL=`recharts.syncEvent.brush`;function kL(e,t){if(t){var n=Number.parseInt(t,10);if(!_T(n))return e?.[n]}}var AL=yD({name:`options`,initialState:{chartName:``,tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:`axis`},reducers:{createEventEmitter:e=>{e.eventEmitter??=Symbol(`rechartsEventEmitter`)}}}),lge=AL.reducer,{createEventEmitter:uge}=AL.actions;function dge(e){return e.tooltip.syncInteraction}var jL=yD({name:`chartData`,initialState:{chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:n,endIndex:r}=t.payload;n!=null&&(e.dataStartIndex=n),r!=null&&(e.dataEndIndex=r)}}}),{setChartData:ML,setDataStartEndIndexes:fge,setComputedData:pge}=jL.actions,mge=jL.reducer,hge=[`x`,`y`];function NL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function PL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?NL(Object(n),!0).forEach(function(t){gge(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):NL(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function gge(e,t,n){return(t=_ge(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _ge(e){var t=vge(e,`string`);return typeof t==`symbol`?t:t+``}function vge(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function yge(e,t){if(e==null)return{};var n,r,i=bge(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function bge(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var FL=()=>{};function xge(){var e=tE(NP),t=tE(FP),n=$T(),r=tE(PP),i=tE(rL),a=Xk(),o=Gk(),s=tE(e=>e.rootProps.className);(0,N.useEffect)(()=>{if(e==null)return FL;var s=(s,c,l)=>{if(t!==l&&e===s){if(r===`index`){var u;if(o&&c!=null&&(u=c.payload)!=null&&u.coordinate&&c.payload.sourceViewBox){var d=c.payload.coordinate,{x:f,y:p}=d,m=yge(d,hge),{x:h,y:g,width:_,height:v}=c.payload.sourceViewBox,y=PL(PL({},m),{},{x:o.x+(_?(f-h)/_:0)*o.width,y:o.y+(v?(p-g)/v:0)*o.height});n(PL(PL({},c),{},{payload:PL(PL({},c.payload),{},{coordinate:y})}))}else n(c);return}if(i!=null){var b;if(typeof r==`function`){var x={activeTooltipIndex:c.payload.index==null?void 0:Number(c.payload.index),isTooltipActive:c.payload.active,activeIndex:c.payload.index==null?void 0:Number(c.payload.index),activeLabel:c.payload.label,activeDataKey:c.payload.dataKey,activeCoordinate:c.payload.coordinate},S=r(i,x);b=i[S]}else r===`value`&&(b=i.find(e=>String(e.value)===c.payload.label));var{coordinate:C}=c.payload;if(b==null||c.payload.active===!1||C==null||o==null){n(PI({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:w,y:T}=C,E=Math.min(w,o.x+o.width),D=Math.min(T,o.y+o.height),O={x:a===`horizontal`?b.coordinate:E,y:a===`horizontal`?D:b.coordinate},k=PI({active:c.payload.active,coordinate:O,dataKey:c.payload.dataKey,index:String(b.index),label:c.payload.label,sourceViewBox:c.payload.sourceViewBox});n(k)}}};return EL.on(DL,s),()=>{EL.off(DL,s)}},[s,n,t,e,r,i,a,o])}function Sge(){var e=tE(NP),t=tE(FP),n=$T();(0,N.useEffect)(()=>{if(e==null)return FL;var r=(r,i,a)=>{t!==a&&e===r&&n(fge(i))};return EL.on(OL,r),()=>{EL.off(OL,r)}},[n,t,e])}function Cge(){var e=$T();(0,N.useEffect)(()=>{e(uge())},[e]),xge(),Sge()}function wge(e,t,n,r,i,a){var o=tE(n=>Zhe(n,e,t)),s=tE(FP),c=tE(NP),l=tE(PP),u=tE(dge)?.active,d=Gk();(0,N.useEffect)(()=>{if(!u&&c!=null&&s!=null){var e=PI({active:a,coordinate:n,dataKey:o,index:i,label:typeof r==`number`?String(r):r,sourceViewBox:d});EL.emit(DL,c,e,s)}},[u,n,o,i,r,s,c,l,a,d])}var Tge=l(eC());function IL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function LL(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?IL(Object(n),!0).forEach(function(t){Ege(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IL(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Ege(e,t,n){return(t=Dge(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dge(e){var t=Oge(e,`string`);return typeof t==`symbol`?t:t+``}function Oge(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function kge(e){return e.dataKey}function Age(e,t){return N.isValidElement(e)?N.cloneElement(e,t):typeof e==`function`?N.createElement(e,t):N.createElement(oue,t)}var RL=[],jge={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:`ease`,axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!pA.isSsr,itemSorter:`name`,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:` : `,trigger:`hover`,useTranslate3d:!1,wrapperStyle:{}};function zL(e){var t=EA(e,jge),{active:n,allowEscapeViewBox:r,animationDuration:i,animationEasing:a,content:o,filterNull:s,isAnimationActive:c,offset:l,payloadUniqBy:u,position:d,reverseDirection:f,useTranslate3d:p,wrapperStyle:m,cursor:h,shared:g,trigger:_,defaultIndex:v,portal:y,axisId:b}=t,x=$T(),S=typeof v==`number`?String(v):v;(0,N.useEffect)(()=>{x(the({shared:g,trigger:_,axisId:b,active:n,defaultIndex:S}))},[x,g,_,b,n,S]);var C=Gk(),w=mA(),T=Zme(g),{activeIndex:E,isActive:D}=tE(e=>ege(e,T,_,S)),O=tE(e=>$he(e,T,_,S)),k=tE(e=>xL(e,T,_,S)),ee=tE(e=>Qhe(e,T,_,S)),te=O,ne=sge(),A=n??D,[j,re]=dE([te,A]),ie=T===`axis`?k:void 0;wge(T,_,ee,ie,E,A);var ae=y??ne;if(ae==null)return null;var oe=te??RL;A||(oe=RL),s&&oe.length&&(oe=ZT(te.filter(e=>e.value!=null&&(e.hide!==!0||t.includeHidden)),u,kge));var se=oe.length>0,ce=N.createElement(pue,{allowEscapeViewBox:r,animationDuration:i,animationEasing:a,isAnimationActive:c,active:A,coordinate:ee,hasPayload:se,offset:l,position:d,reverseDirection:f,useTranslate3d:p,viewBox:C,wrapperStyle:m,lastBoundingBox:j,innerRef:re,hasPortalFromProps:!!y},Age(o,LL(LL({},t),{},{payload:oe,label:ie,active:A,coordinate:ee,accessibilityLayer:w})));return N.createElement(N.Fragment,null,(0,Tge.createPortal)(ce,ae),A&&N.createElement(oge,{cursor:h,tooltipEventType:T,coordinate:ee,payload:te,index:E}))}var BL=e=>null;BL.displayName=`Cell`;function Mge(e,t,n){return(t=Nge(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nge(e){var t=Pge(e,`string`);return typeof t==`symbol`?t:t+``}function Pge(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var Fge=class{constructor(e){Mge(this,`cache`,new Map),this.maxSize=e}get(e){var t=this.cache.get(e);return t!==void 0&&(this.cache.delete(e),this.cache.set(e,t)),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}clear(){this.cache.clear()}size(){return this.cache.size}};function VL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ige(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?VL(Object(n),!0).forEach(function(t){Lge(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VL(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Lge(e,t,n){return(t=Rge(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Rge(e){var t=zge(e,`string`);return typeof t==`symbol`?t:t+``}function zge(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var HL=Ige({},{cacheSize:2e3,enableCache:!0}),UL=new Fge(HL.cacheSize),Bge={position:`absolute`,top:`-20000px`,left:0,padding:0,margin:0,border:`none`,whiteSpace:`pre`},WL=`recharts_measurement_span`;function Vge(e,t){var n=t.fontSize||``,r=t.fontFamily||``,i=t.fontWeight||``,a=t.fontStyle||``,o=t.letterSpacing||``,s=t.textTransform||``;return`${e}|${n}|${r}|${i}|${a}|${o}|${s}`}var GL=(e,t)=>{try{var n=document.getElementById(WL);n||(n=document.createElement(`span`),n.setAttribute(`id`,WL),n.setAttribute(`aria-hidden`,`true`),document.body.appendChild(n)),Object.assign(n.style,Bge,t),n.textContent=`${e}`;var r=n.getBoundingClientRect();return{width:r.width,height:r.height}}catch{return{width:0,height:0}}},KL=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||pA.isSsr)return{width:0,height:0};if(!HL.enableCache)return GL(e,t);var n=Vge(e,t),r=UL.get(n);if(r)return r;var i=GL(e,t);return UL.set(n,i),i},qL=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,JL=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Hge=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Uge=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,YL={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Wge=Object.keys(YL),XL=`NaN`;function Gge(e,t){return e*YL[t]}var ZL=class e{static parse(t){var[,n,r]=Uge.exec(t)??[];return new e(parseFloat(n),r??``)}constructor(e,t){this.num=e,this.unit=t,this.num=e,this.unit=t,_T(e)&&(this.unit=``),t!==``&&!Hge.test(t)&&(this.num=NaN,this.unit=``),Wge.includes(t)&&(this.num=Gge(e,t),this.unit=`px`)}add(t){return this.unit===t.unit?new e(this.num+t.num,this.unit):new e(NaN,``)}subtract(t){return this.unit===t.unit?new e(this.num-t.num,this.unit):new e(NaN,``)}multiply(t){return this.unit!==``&&t.unit!==``&&this.unit!==t.unit?new e(NaN,``):new e(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==``&&t.unit!==``&&this.unit!==t.unit?new e(NaN,``):new e(this.num/t.num,this.unit||t.unit)}toString(){return`${this.num}${this.unit}`}isNaN(){return _T(this.num)}};function QL(e){if(e.includes(XL))return XL;for(var t=e;t.includes(`*`)||t.includes(`/`);){var[,n,r,i]=qL.exec(t)??[],a=ZL.parse(n??``),o=ZL.parse(i??``),s=r===`*`?a.multiply(o):a.divide(o);if(s.isNaN())return XL;t=t.replace(qL,s.toString())}for(;t.includes(`+`)||/.-\d+(?:\.\d+)?/.test(t);){var[,c,l,u]=JL.exec(t)??[],d=ZL.parse(c??``),f=ZL.parse(u??``),p=l===`+`?d.add(f):d.subtract(f);if(p.isNaN())return XL;t=t.replace(JL,p.toString())}return t}var $L=/\(([^()]*)\)/;function Kge(e){for(var t=e,n;(n=$L.exec(t))!=null;){var[,r]=n;t=t.replace($L,QL(r))}return t}function qge(e){var t=e.replace(/\s+/g,``);return t=Kge(t),t=QL(t),t}function Jge(e){try{return qge(e)}catch{return XL}}function eR(e){var t=Jge(e.slice(5,-1));return t===XL?``:t}var Yge=[`x`,`y`,`lineHeight`,`capHeight`,`scaleToFit`,`textAnchor`,`verticalAnchor`,`fill`],Xge=[`dx`,`dy`,`angle`,`className`,`breakAll`];function tR(){return tR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},tR.apply(null,arguments)}function nR(e,t){if(e==null)return{};var n,r,i=Zge(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Zge(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var rR=/[ \f\n\r\t\v\u2028\u2029]+/,iR=e=>{var{children:t,breakAll:n,style:r}=e;try{var i=[];ET(t)||(i=n?t.toString().split(``):t.toString().split(rR));var a=i.map(e=>({word:e,width:KL(e,r).width})),o=n?0:KL(`\xA0`,r).width;return{wordsWithComputedWidth:a,spaceWidth:o}}catch{return null}},Qge=(e,t,n,r,i)=>{var{maxLines:a,children:o,style:s,breakAll:c}=e,l=yT(a),u=o,d=function(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).reduce((e,t)=>{var{word:a,width:o}=t,s=e[e.length-1];if(s&&(r==null||i||s.width+o+n<Number(r)))s.words.push(a),s.width+=o+n;else{var c={words:[a],width:o};e.push(c)}return e},[])},f=d(t),p=e=>e.reduce((e,t)=>e.width>t.width?e:t);if(!l||i||!(f.length>a||p(f).width>Number(r)))return f;for(var m=``,h=e=>{var t=u.slice(0,e),n=iR({breakAll:c,style:s,children:t+m}).wordsWithComputedWidth,i=d(n);return[i.length>a||p(i).width>Number(r),i]},g=0,_=u.length-1,v=0,y;g<=_&&v<=u.length-1;){var b=Math.floor((g+_)/2),x=b-1,[S,C]=h(x),[w]=h(b);if(!S&&!w&&(g=b+1),S&&w&&(_=b-1),!S&&w){y=C;break}v++}return y||f},aR=e=>[{words:ET(e)?[]:e.toString().split(rR)}],$ge=e=>{var{width:t,scaleToFit:n,children:r,style:i,breakAll:a,maxLines:o}=e;if((t||n)&&!pA.isSsr){var s,c,l=iR({breakAll:a,children:r,style:i});if(l){var{wordsWithComputedWidth:u,spaceWidth:d}=l;s=u,c=d}else return aR(r);return Qge({breakAll:a,children:r,maxLines:o,style:i},s,c,t,n)}return aR(r)},oR=`#808080`,sR=(0,N.forwardRef)((e,t)=>{var{x:n=0,y:r=0,lineHeight:i=`1em`,capHeight:a=`0.71em`,scaleToFit:o=!1,textAnchor:s=`start`,verticalAnchor:c=`end`,fill:l=oR}=e,u=nR(e,Yge),d=(0,N.useMemo)(()=>$ge({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:o,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,o,u.style,u.width]),{dx:f,dy:p,angle:m,className:h,breakAll:g}=u,_=nR(u,Xge);if(!bT(n)||!bT(r)||d.length===0)return null;var v=n+(yT(f)?f:0),y=r+(yT(p)?p:0),b;switch(c){case`start`:b=eR(`calc(${a})`);break;case`middle`:b=eR(`calc(${(d.length-1)/2} * -${i} + (${a} / 2))`);break;default:b=eR(`calc(${d.length-1} * -${i})`);break}var x=[];if(o){var S=d[0].width,{width:C}=u;x.push(`scale(${yT(C)?C/S:1})`)}return m&&x.push(`rotate(${m}, ${v}, ${y})`),x.length&&(_.transform=x.join(` `)),N.createElement(`text`,tR({},mw(_),{ref:t,x:v,y,className:cw(`recharts-text`,h),textAnchor:s,fill:l.includes(`url`)?oR:l}),d.map((e,t)=>{var n=e.words.join(g?``:` `);return N.createElement(`tspan`,{x:v,dy:t===0?b:i,key:`${n}-${t}`},n)}))});sR.displayName=`Text`;var e_e=[`labelRef`];function t_e(e,t){if(e==null)return{};var n,r,i=n_e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function n_e(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function cR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function lR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?cR(Object(n),!0).forEach(function(t){r_e(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cR(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function r_e(e,t,n){return(t=i_e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i_e(e){var t=a_e(e,`string`);return typeof t==`symbol`?t:t+``}function a_e(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function uR(){return uR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},uR.apply(null,arguments)}var dR=(0,N.createContext)(null),o_e=e=>{var{x:t,y:n,width:r,height:i,children:a}=e,o=(0,N.useMemo)(()=>({x:t,y:n,width:r,height:i}),[t,n,r,i]);return N.createElement(dR.Provider,{value:o},a)},fR=()=>{var e=(0,N.useContext)(dR),t=Gk();return e||t},s_e=(0,N.createContext)(null),c_e=()=>{var e=(0,N.useContext)(s_e),t=tE(qP);return e||t},l_e=e=>{var{value:t,formatter:n}=e,r=ET(e.children)?t:e.children;return typeof n==`function`?n(r):r},pR=e=>e!=null&&typeof e==`function`,u_e=(e,t)=>{var n=gT(t-e),r=Math.min(Math.abs(t-e),360);return n*r},d_e=(e,t,n,r,i)=>{var{offset:a,className:o}=e,{cx:s,cy:c,innerRadius:l,outerRadius:u,startAngle:d,endAngle:f,clockWise:p}=i,m=(l+u)/2,h=u_e(d,f),g=h>=0?1:-1,_,v;switch(t){case`insideStart`:_=d+g*a,v=p;break;case`insideEnd`:_=f-g*a,v=!p;break;case`end`:_=f+g*a,v=p;break;default:throw Error(`Unsupported position ${t}`)}v=h<=0?v:!v;var y=lO(s,c,m,_),b=lO(s,c,m,_+(v?1:-1)*359),x=`M${y.x},${y.y}
    A${m},${m},0,1,${v?0:1},
    ${b.x},${b.y}`,S=ET(e.id)?xT(`recharts-radial-line-`):e.id;return N.createElement(`text`,uR({},r,{dominantBaseline:`central`,className:cw(`recharts-radial-bar-label`,o)}),N.createElement(`defs`,null,N.createElement(`path`,{id:S,d:x})),N.createElement(`textPath`,{xlinkHref:`#${S}`},n))},f_e=(e,t,n)=>{var{cx:r,cy:i,innerRadius:a,outerRadius:o,startAngle:s,endAngle:c}=e,l=(s+c)/2;if(n===`outside`){var{x:u,y:d}=lO(r,i,o+t,l);return{x:u,y:d,textAnchor:u>=r?`start`:`end`,verticalAnchor:`middle`}}if(n===`center`)return{x:r,y:i,textAnchor:`middle`,verticalAnchor:`middle`};if(n===`centerTop`)return{x:r,y:i,textAnchor:`middle`,verticalAnchor:`start`};if(n===`centerBottom`)return{x:r,y:i,textAnchor:`middle`,verticalAnchor:`end`};var f=(a+o)/2,{x:p,y:m}=lO(r,i,f,l);return{x:p,y:m,textAnchor:`middle`,verticalAnchor:`middle`}},mR=e=>`cx`in e&&yT(e.cx),p_e=(e,t)=>{var{parentViewBox:n,offset:r,position:i}=e,a;n!=null&&!mR(n)&&(a=n);var{x:o,y:s,width:c,height:l}=t,u=l>=0?1:-1,d=u*r,f=u>0?`end`:`start`,p=u>0?`start`:`end`,m=c>=0?1:-1,h=m*r,g=m>0?`end`:`start`,_=m>0?`start`:`end`;if(i===`top`){var v={x:o+c/2,y:s-u*r,textAnchor:`middle`,verticalAnchor:f};return lR(lR({},v),a?{height:Math.max(s-a.y,0),width:c}:{})}if(i===`bottom`){var y={x:o+c/2,y:s+l+d,textAnchor:`middle`,verticalAnchor:p};return lR(lR({},y),a?{height:Math.max(a.y+a.height-(s+l),0),width:c}:{})}if(i===`left`){var b={x:o-h,y:s+l/2,textAnchor:g,verticalAnchor:`middle`};return lR(lR({},b),a?{width:Math.max(b.x-a.x,0),height:l}:{})}if(i===`right`){var x={x:o+c+h,y:s+l/2,textAnchor:_,verticalAnchor:`middle`};return lR(lR({},x),a?{width:Math.max(a.x+a.width-x.x,0),height:l}:{})}var S=a?{width:c,height:l}:{};return i===`insideLeft`?lR({x:o+h,y:s+l/2,textAnchor:_,verticalAnchor:`middle`},S):i===`insideRight`?lR({x:o+c-h,y:s+l/2,textAnchor:g,verticalAnchor:`middle`},S):i===`insideTop`?lR({x:o+c/2,y:s+d,textAnchor:`middle`,verticalAnchor:p},S):i===`insideBottom`?lR({x:o+c/2,y:s+l-d,textAnchor:`middle`,verticalAnchor:f},S):i===`insideTopLeft`?lR({x:o+h,y:s+d,textAnchor:_,verticalAnchor:p},S):i===`insideTopRight`?lR({x:o+c-h,y:s+d,textAnchor:g,verticalAnchor:p},S):i===`insideBottomLeft`?lR({x:o+h,y:s+l-d,textAnchor:_,verticalAnchor:f},S):i===`insideBottomRight`?lR({x:o+c-h,y:s+l-d,textAnchor:g,verticalAnchor:f},S):i&&typeof i==`object`&&(yT(i.x)||vT(i.x))&&(yT(i.y)||vT(i.y))?lR({x:o+ST(i.x,c),y:s+ST(i.y,l),textAnchor:`end`,verticalAnchor:`end`},S):lR({x:o+c/2,y:s+l/2,textAnchor:`middle`,verticalAnchor:`middle`},S)},m_e={offset:5};function hR(e){var t=EA(e,m_e),{viewBox:n,position:r,value:i,children:a,content:o,className:s=``,textBreakAll:c,labelRef:l}=t,u=c_e(),d=fR(),f=n||(r===`center`?d:u??d);if(!f||ET(i)&&ET(a)&&!(0,N.isValidElement)(o)&&typeof o!=`function`)return null;var p=lR(lR({},t),{},{viewBox:f});if((0,N.isValidElement)(o)){var{labelRef:m}=p,h=t_e(p,e_e);return(0,N.cloneElement)(o,h)}var g;if(typeof o==`function`){if(g=(0,N.createElement)(o,p),(0,N.isValidElement)(g))return g}else g=l_e(t);var _=mR(f),v=mw(t);if(_&&(r===`insideStart`||r===`insideEnd`||r===`end`))return d_e(t,r,g,v,f);var y=_?f_e(f,t.offset,t.position):p_e(t,f);return N.createElement(sR,uR({ref:l,className:cw(`recharts-label`,s)},v,y,{breakAll:c}),g)}hR.displayName=`Label`;var h_e=(e,t,n)=>{if(!e)return null;var r={viewBox:t,labelRef:n};return e===!0?N.createElement(hR,uR({key:`label-implicit`},r)):bT(e)?N.createElement(hR,uR({key:`label-implicit`,value:e},r)):(0,N.isValidElement)(e)?e.type===hR?(0,N.cloneElement)(e,lR({key:`label-implicit`},r)):N.createElement(hR,uR({key:`label-implicit`,content:e},r)):pR(e)?N.createElement(hR,uR({key:`label-implicit`,content:e},r)):e&&typeof e==`object`?N.createElement(hR,uR({},e,{key:`label-implicit`},r)):null};function g_e(e){var{label:t,labelRef:n}=e,r=fR();return h_e(t,r,n)||null}var __e=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){return e[e.length-1]}e.last=t})),v_e=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){return Array.isArray(e)?e:Array.from(e)}e.toArray=t})),y_e=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});var t=__e(),n=v_e(),r=VT();function i(e){if(r.isArrayLike(e))return t.last(n.toArray(e))}e.last=i})),b_e=l(o(((e,t)=>{t.exports=y_e().last}))()),x_e=[`valueAccessor`],S_e=[`dataKey`,`clockWise`,`id`,`textBreakAll`];function gR(){return gR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gR.apply(null,arguments)}function _R(e,t){if(e==null)return{};var n,r,i=C_e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function C_e(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var w_e=e=>Array.isArray(e.value)?(0,b_e.default)(e.value):e.value,vR=(0,N.createContext)(void 0),yR=vR.Provider,bR=(0,N.createContext)(void 0);bR.Provider;function T_e(){return(0,N.useContext)(vR)}function E_e(){return(0,N.useContext)(bR)}function xR(e){var{valueAccessor:t=w_e}=e,n=_R(e,x_e),{dataKey:r,clockWise:i,id:a,textBreakAll:o}=n,s=_R(n,S_e),c=T_e(),l=E_e(),u=c||l;return!u||!u.length?null:N.createElement(vw,{className:`recharts-label-list`},u.map((e,i)=>{var c=ET(r)?t(e,i):wO(e&&e.payload,r),l=ET(a)?{}:{id:`${a}-${i}`};return N.createElement(hR,gR({key:`label-${i}`},mw(e),s,l,{fill:n.fill??e.fill,parentViewBox:e.parentViewBox,value:c,textBreakAll:o,viewBox:e.viewBox,index:i}))}))}xR.displayName=`LabelList`;function SR(e){var{label:t}=e;return t?t===!0?N.createElement(xR,{key:`labelList-implicit`}):N.isValidElement(t)||pR(t)?N.createElement(xR,{key:`labelList-implicit`,content:t}):typeof t==`object`?N.createElement(xR,gR({key:`labelList-implicit`},t,{type:String(t.type)})):null:null}function CR(){return CR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},CR.apply(null,arguments)}var wR=e=>{var{cx:t,cy:n,r,className:i}=e,a=cw(`recharts-dot`,i);return t===+t&&n===+n&&r===+r?N.createElement(`circle`,CR({},fw(e),NT(e),{className:a,cx:t,cy:n,r})):null},TR=yD({name:`polarAxis`,initialState:{radiusAxis:{},angleAxis:{}},reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=cD(t.payload)},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=cD(t.payload)},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:D_e,removeRadiusAxis:O_e,addAngleAxis:k_e,removeAngleAxis:A_e}=TR.actions,j_e=TR.reducer,M_e=o((e=>{var t=Symbol.for(`react.transitional.element`),n=Symbol.for(`react.portal`),r=Symbol.for(`react.fragment`),i=Symbol.for(`react.strict_mode`),a=Symbol.for(`react.profiler`),o=Symbol.for(`react.consumer`),s=Symbol.for(`react.context`),c=Symbol.for(`react.forward_ref`),l=Symbol.for(`react.suspense`),u=Symbol.for(`react.suspense_list`),d=Symbol.for(`react.memo`),f=Symbol.for(`react.lazy`),p=Symbol.for(`react.view_transition`);function m(e){if(typeof e==`object`&&e){var m=e.$$typeof;switch(m){case t:switch(e=e.type,e){case r:case a:case i:case l:case u:case p:return e;default:switch(e&&=e.$$typeof,e){case s:case c:case f:case d:return e;case o:return e;default:return m}}case n:return m}}}e.isFragment=function(e){return m(e)===r}})),N_e=o(((e,t)=>{t.exports=M_e()})),ER=l(hT()),P_e=l(N_e()),DR=e=>typeof e==`string`?e:e?e.displayName||e.name||`Component`:``,OR=null,kR=null,AR=e=>{if(e===OR&&Array.isArray(kR))return kR;var t=[];return N.Children.forEach(e,e=>{ET(e)||((0,P_e.isFragment)(e)?t=t.concat(AR(e.props.children)):t.push(e))}),kR=t,OR=e,t};function F_e(e,t){var n=[],r=[];return r=Array.isArray(t)?t.map(e=>DR(e)):[DR(t)],AR(e).forEach(e=>{var t=(0,ER.default)(e,`type.displayName`)||(0,ER.default)(e,`type.name`);r.indexOf(t)!==-1&&n.push(e)}),n}var jR=e=>e&&typeof e==`object`&&`clipDot`in e?!!e.clipDot:!0,I_e=o((e=>{Object.defineProperty(e,Symbol.toStringTag,{value:`Module`});function t(e){if(typeof e!=`object`||!e)return!1;if(Object.getPrototypeOf(e)===null)return!0;if(Object.prototype.toString.call(e)!==`[object Object]`){let t=e[Symbol.toStringTag];return t==null||!Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable?!1:e.toString()===`[object ${t}]`}let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}e.isPlainObject=t})),L_e=o(((e,t)=>{t.exports=I_e().isPlainObject}));function MR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function NR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?MR(Object(n),!0).forEach(function(t){R_e(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):MR(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function R_e(e,t,n){return(t=z_e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z_e(e){var t=B_e(e,`string`);return typeof t==`symbol`?t:t+``}function B_e(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function PR(){return PR=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},PR.apply(null,arguments)}var FR=(e,t,n,r,i)=>{var a=n-r,o=`M ${e},${t}`;return o+=`L ${e+n},${t}`,o+=`L ${e+n-a/2},${t+i}`,o+=`L ${e+n-a/2-r},${t+i}`,o+=`L ${e},${t} Z`,o},V_e={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:`ease`},H_e=e=>{var t=EA(e,V_e),{x:n,y:r,upperWidth:i,lowerWidth:a,height:o,className:s}=t,{animationEasing:c,animationDuration:l,animationBegin:u,isUpdateAnimationActive:d}=t,f=(0,N.useRef)(null),[p,m]=(0,N.useState)(-1),h=(0,N.useRef)(i),g=(0,N.useRef)(a),_=(0,N.useRef)(o),v=(0,N.useRef)(n),y=(0,N.useRef)(r),b=UA(e,`trapezoid-`);if((0,N.useEffect)(()=>{if(f.current&&f.current.getTotalLength)try{var e=f.current.getTotalLength();e&&m(e)}catch{}},[]),n!==+n||r!==+r||i!==+i||a!==+a||o!==+o||i===0&&a===0||o===0)return null;var x=cw(`recharts-trapezoid`,s);if(!d)return N.createElement(`g`,null,N.createElement(`path`,PR({},mw(t),{className:x,d:FR(n,r,i,a,o)})));var S=h.current,C=g.current,w=_.current,T=v.current,E=y.current,D=`0px ${p===-1?1:p}px`,O=`${p}px 0px`,k=kA([`strokeDasharray`],l,c);return N.createElement(HA,{animationId:b,key:b,canBegin:p>0,duration:l,easing:c,isActive:d,begin:u},e=>{var s=wT(S,i,e),c=wT(C,a,e),l=wT(w,o,e),u=wT(T,n,e),d=wT(E,r,e);f.current&&(h.current=s,g.current=c,_.current=l,v.current=u,y.current=d);var p=e>0?{transition:k,strokeDasharray:O}:{strokeDasharray:D};return N.createElement(`path`,PR({},mw(t),{className:x,d:FR(u,d,s,c,l),ref:f,style:NR(NR({},p),t.style)}))})},U_e=l(L_e()),W_e=[`option`,`shapeType`,`propTransformer`,`activeClassName`,`isActive`];function G_e(e,t){if(e==null)return{};var n,r,i=K_e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function K_e(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function IR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function LR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?IR(Object(n),!0).forEach(function(t){q_e(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IR(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function q_e(e,t,n){return(t=J_e(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J_e(e){var t=Y_e(e,`string`);return typeof t==`symbol`?t:t+``}function Y_e(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function X_e(e,t){return LR(LR({},t),e)}function Z_e(e,t){return e===`symbols`}function RR(e){var{shapeType:t,elementProps:n}=e;switch(t){case`rectangle`:return N.createElement(YA,n);case`trapezoid`:return N.createElement(H_e,n);case`sector`:return N.createElement(ej,n);case`symbols`:if(Z_e(t,n))return N.createElement(MT,n);break;default:return null}}function Q_e(e){return(0,N.isValidElement)(e)?e.props:e}function $_e(e){var{option:t,shapeType:n,propTransformer:r=X_e,activeClassName:i=`recharts-active-shape`,isActive:a}=e,o=G_e(e,W_e),s;if((0,N.isValidElement)(t))s=(0,N.cloneElement)(t,LR(LR({},o),Q_e(t)));else if(typeof t==`function`)s=t(o);else if((0,U_e.default)(t)&&typeof t!=`boolean`){var c=r(t,o);s=N.createElement(RR,{shapeType:n,elementProps:c})}else{var l=o;s=N.createElement(RR,{shapeType:n,elementProps:l})}return a?N.createElement(vw,{className:i},s):s}var zR=(e,t)=>{var n=$T();return(r,i)=>a=>{e?.(r,i,a),n(jI({activeIndex:String(i),activeDataKey:t,activeCoordinate:r.tooltipPosition}))}},BR=e=>{var t=$T();return(n,r)=>i=>{e?.(n,r,i),t(nhe())}},VR=(e,t)=>{var n=$T();return(r,i)=>a=>{e?.(r,i,a),n(rhe({activeIndex:String(i),activeDataKey:t,activeCoordinate:r.tooltipPosition}))}};function HR(e){var{fn:t,args:n}=e,r=$T(),i=_k();return(0,N.useLayoutEffect)(()=>{if(!i){var e=t(n);return r($me(e)),()=>{r(ehe(e))}}},[t,n,r,i]),null}var eve=()=>{};function UR(e){var{legendPayload:t}=e,n=$T(),r=_k();return(0,N.useLayoutEffect)(()=>r?eve:(n(Ble(t)),()=>{n(Vle(t))}),[n,r,t]),null}var tve=N.useId??(()=>{var[e]=N.useState(()=>xT(`uid-`));return e});function nve(e,t){var n=tve();return t||(e?`${e}-${n}`:n)}var rve=(0,N.createContext)(void 0),WR=e=>{var{id:t,type:n,children:r}=e,i=nve(`recharts-${n}`,t);return N.createElement(rve.Provider,{value:i},r(i))},GR=yD({name:`graphicalItems`,initialState:{cartesianItems:[],polarItems:[]},reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(cD(t.payload))},prepare:hD()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:n,next:r}=t.payload,i=aD(e).cartesianItems.indexOf(cD(n));i>-1&&(e.cartesianItems[i]=cD(r))},prepare:hD()},removeCartesianGraphicalItem:{reducer(e,t){var n=aD(e).cartesianItems.indexOf(cD(t.payload));n>-1&&e.cartesianItems.splice(n,1)},prepare:hD()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(cD(t.payload))},prepare:hD()},removePolarGraphicalItem:{reducer(e,t){var n=aD(e).polarItems.indexOf(cD(t.payload));n>-1&&e.polarItems.splice(n,1)},prepare:hD()}}}),{addCartesianGraphicalItem:ive,replaceCartesianGraphicalItem:ave,removeCartesianGraphicalItem:ove,addPolarGraphicalItem:sve,removePolarGraphicalItem:cve}=GR.actions,lve=GR.reducer;function KR(e){var t=$T(),n=(0,N.useRef)(null);return(0,N.useLayoutEffect)(()=>{n.current===null?t(ive(e)):n.current!==e&&t(ave({prev:n.current,next:e})),n.current=e},[t,e]),(0,N.useLayoutEffect)(()=>()=>{n.current&&=(t(ove(n.current)),null)},[t]),null}function qR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function JR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?qR(Object(n),!0).forEach(function(t){uve(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qR(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function uve(e,t,n){return(t=dve(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dve(e){var t=fve(e,`string`);return typeof t==`symbol`?t:t+``}function fve(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var YR=yD({name:`cartesianAxis`,initialState:{xAxis:{},yAxis:{},zAxis:{}},reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=cD(t.payload)},prepare:hD()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:hD()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=cD(t.payload)},prepare:hD()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:hD()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=cD(t.payload)},prepare:hD()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:hD()},updateYAxisWidth(e,t){var{id:n,width:r}=t.payload,i=e.yAxis[n];if(i){var a=i.widthHistory||[];if(a.length===3&&a[0]===a[2]&&r===a[1]&&r!==i.width&&Math.abs(r-a[0])<=1)return;var o=[...a,r].slice(-3);e.yAxis[n]=JR(JR({},e.yAxis[n]),{},{width:r,widthHistory:o})}}}}),{addXAxis:pve,removeXAxis:mve,addYAxis:hve,removeYAxis:gve,addZAxis:_ve,removeZAxis:vve,updateYAxisWidth:yve}=YR.actions,bve=YR.reducer,xve=L([pk],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),Sve=L([xve,XO,ZO],(e,t,n)=>{if(!(!e||t==null||n==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}}),XR=()=>tE(Sve),Cve=()=>tE(Hhe);function ZR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function QR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?ZR(Object(n),!0).forEach(function(t){wve(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ZR(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function wve(e,t,n){return(t=Tve(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tve(e){var t=Eve(e,`string`);return typeof t==`symbol`?t:t+``}function Eve(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var Dve=e=>{var{point:t,childIndex:n,mainColor:r,activeDot:i,dataKey:a}=e;if(i===!1||t.x==null||t.y==null)return null;var o=QR(QR({index:n,dataKey:a,cx:t.x,cy:t.y,r:4,fill:r??`none`,strokeWidth:2,stroke:`#fff`,payload:t.payload,value:t.value},pw(i)),NT(i)),s=(0,N.isValidElement)(i)?(0,N.cloneElement)(i,o):typeof i==`function`?i(o):N.createElement(wR,o);return N.createElement(vw,{className:`recharts-active-dot`},s)};function Ove(e){var{points:t,mainColor:n,activeDot:r,itemDataKey:i}=e,a=tE(cL),o=Cve();if(t==null||o==null)return null;var s=t.find(e=>o.includes(e.payload));return ET(s)?null:Dve({point:s,childIndex:Number(a),mainColor:n,dataKey:i,activeDot:r})}var kve=!0,$R=`Invariant failed`;function Ave(e,t){if(!e){if(kve)throw Error($R);var n=typeof t==`function`?t():t,r=n?`${$R}: ${n}`:$R;throw Error(r)}}var jve=[`x`,`y`];function ez(){return ez=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ez.apply(null,arguments)}function tz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function nz(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?tz(Object(n),!0).forEach(function(t){Mve(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tz(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Mve(e,t,n){return(t=Nve(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Nve(e){var t=Pve(e,`string`);return typeof t==`symbol`?t:t+``}function Pve(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function Fve(e,t){if(e==null)return{};var n,r,i=Ive(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Ive(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function Lve(e,t){var{x:n,y:r}=e,i=Fve(e,jve),a=`${n}`,o=parseInt(a,10),s=`${r}`,c=parseInt(s,10),l=`${t.height||i.height}`,u=parseInt(l,10),d=`${t.width||i.width}`,f=parseInt(d,10);return nz(nz(nz(nz(nz({},t),i),o?{x:o}:{}),c?{y:c}:{}),{},{height:u,width:f,name:t.name,radius:t.radius})}function rz(e){return N.createElement($_e,ez({shapeType:`rectangle`,propTransformer:Lve,activeClassName:`recharts-active-bar`},e))}var Rve=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,r)=>{if(yT(e))return e;var i=yT(n)||ET(n);return i?e(n,r):(!i&&Ave(!1),t)}},iz=yD({name:`errorBars`,initialState:{},reducers:{addErrorBar:(e,t)=>{var{itemId:n,errorBar:r}=t.payload;e[n]||(e[n]=[]),e[n].push(r)},replaceErrorBar:(e,t)=>{var{itemId:n,prev:r,next:i}=t.payload;e[n]&&(e[n]=e[n].map(e=>e.dataKey===r.dataKey&&e.direction===r.direction?i:e))},removeErrorBar:(e,t)=>{var{itemId:n,errorBar:r}=t.payload;e[n]&&(e[n]=e[n].filter(e=>e.dataKey!==r.dataKey||e.direction!==r.direction))}}}),{addErrorBar:zve,replaceErrorBar:Bve,removeErrorBar:Vve}=iz.actions,Hve=iz.reducer,Uve=[`children`];function Wve(e,t){if(e==null)return{};var n,r,i=Gve(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Gve(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var Kve=(0,N.createContext)({data:[],xAxisId:`xAxis-0`,yAxisId:`yAxis-0`,dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0});function az(e){var{children:t}=e,n=Wve(e,Uve);return N.createElement(Kve.Provider,{value:n},t)}function oz(e,t){var n=tE(t=>dF(t,e)),r=tE(e=>mF(e,t)),i=n?.allowDataOverflow??lF.allowDataOverflow,a=r?.allowDataOverflow??fF.allowDataOverflow;return{needClip:i||a,needClipX:i,needClipY:a}}function sz(e){var{xAxisId:t,yAxisId:n,clipPathId:r}=e,i=XR(),{needClipX:a,needClipY:o,needClip:s}=oz(t,n);if(!s)return null;var{x:c,y:l,width:u,height:d}=i;return N.createElement(`clipPath`,{id:`clipPath-${r}`},N.createElement(`rect`,{x:a?c:c-u/2,y:o?l:l-d/2,width:a?u:u*2,height:o?d:d*2}))}var qve=[`onMouseEnter`,`onMouseLeave`,`onClick`],Jve=[`value`,`background`,`tooltipPosition`],Yve=[`id`],Xve=[`onMouseEnter`,`onClick`,`onMouseLeave`];function cz(){return cz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cz.apply(null,arguments)}function lz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function uz(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?lz(Object(n),!0).forEach(function(t){Zve(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lz(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Zve(e,t,n){return(t=Qve(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qve(e){var t=$ve(e,`string`);return typeof t==`symbol`?t:t+``}function $ve(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function dz(e,t){if(e==null)return{};var n,r,i=eye(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function eye(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var tye=e=>{var{dataKey:t,name:n,fill:r,legendType:i,hide:a}=e;return[{inactive:a,dataKey:t,type:i,color:r,value:KO(n,t),payload:e}]};function nye(e){var{dataKey:t,stroke:n,strokeWidth:r,fill:i,name:a,hide:o,unit:s}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:n,strokeWidth:r,fill:i,dataKey:t,nameKey:void 0,name:KO(a,t),hide:o,type:e.tooltipType,color:e.fill,unit:s}}}function rye(e){var t=tE(cL),{data:n,dataKey:r,background:i,allOtherBarProps:a}=e,{onMouseEnter:o,onMouseLeave:s,onClick:c}=a,l=dz(a,qve),u=zR(o,r),d=BR(s),f=VR(c,r);if(!i||n==null)return null;var p=pw(i);return N.createElement(N.Fragment,null,n.map((e,n)=>{var{value:a,background:o,tooltipPosition:s}=e,c=dz(e,Jve);if(!o)return null;var m=u(e,n),h=d(e,n),g=f(e,n),_=uz(uz(uz(uz(uz({option:i,isActive:String(n)===t},c),{},{fill:`#eee`},o),p),PT(l,e,n)),{},{onMouseEnter:m,onMouseLeave:h,onClick:g,dataKey:r,index:n,className:`recharts-bar-background-rectangle`});return N.createElement(rz,cz({key:`background-bar-${n}`},_))}))}function iye(e){var{showLabels:t,children:n,rects:r}=e,i=r?.map(e=>{var t={x:e.x,y:e.y,width:e.width,height:e.height};return uz(uz({},t),{},{value:e.value,payload:e.payload,parentViewBox:e.parentViewBox,viewBox:t,fill:e.fill})});return N.createElement(yR,{value:t?i:void 0},n)}function aye(e){var{shape:t,activeBar:n,baseProps:r,entry:i,index:a,dataKey:o}=e,s=tE(cL),c=tE(uL),l=n&&String(a)===s&&(c==null||o===c),u=l?n:t;return N.createElement(rz,cz({},r,{name:String(r.name)},i,{isActive:l,option:u,index:a,dataKey:o}))}function oye(e){var{shape:t,baseProps:n,entry:r,index:i,dataKey:a}=e;return N.createElement(rz,cz({},n,{name:String(n.name)},r,{isActive:!1,option:t,index:i,dataKey:a}))}function sye(e){var{data:t,props:n}=e,r=fw(n),{id:i}=r,a=dz(r,Yve),{shape:o,dataKey:s,activeBar:c}=n,{onMouseEnter:l,onClick:u,onMouseLeave:d}=n,f=dz(n,Xve),p=zR(l,s),m=BR(d),h=VR(u,s);return t?N.createElement(N.Fragment,null,t.map((e,t)=>N.createElement(vw,cz({key:`rectangle-${e?.x}-${e?.y}-${e?.value}-${t}`,className:`recharts-bar-rectangle`},PT(f,e,t),{onMouseEnter:p(e,t),onMouseLeave:m(e,t),onClick:h(e,t)}),c?N.createElement(aye,{shape:o,activeBar:c,baseProps:a,entry:e,index:t,dataKey:s}):N.createElement(oye,{shape:o,baseProps:a,entry:e,index:t,dataKey:s})))):null}function cye(e){var{props:t,previousRectanglesRef:n}=e,{data:r,layout:i,isAnimationActive:a,animationBegin:o,animationDuration:s,animationEasing:c,onAnimationEnd:l,onAnimationStart:u}=t,d=n.current,f=UA(t,`recharts-bar-`),[p,m]=(0,N.useState)(!1),h=!p,g=(0,N.useCallback)(()=>{typeof l==`function`&&l(),m(!1)},[l]),_=(0,N.useCallback)(()=>{typeof u==`function`&&u(),m(!0)},[u]);return N.createElement(iye,{showLabels:h,rects:r},N.createElement(HA,{animationId:f,begin:o,duration:s,isActive:a,easing:c,onAnimationEnd:g,onAnimationStart:_,key:f},e=>{var a=e===1?r:r?.map((t,n)=>{var r=d&&d[n];if(r)return uz(uz({},t),{},{x:wT(r.x,t.x,e),y:wT(r.y,t.y,e),width:wT(r.width,t.width,e),height:wT(r.height,t.height,e)});if(i===`horizontal`){var a=wT(0,t.height,e);return uz(uz({},t),{},{y:t.y+t.height-a,height:a})}var o=wT(0,t.width,e);return uz(uz({},t),{},{width:o})});return e>0&&(n.current=a??null),a==null?null:N.createElement(vw,null,N.createElement(sye,{props:t,data:a}))}),N.createElement(SR,{label:t.label}),t.children)}function lye(e){var t=(0,N.useRef)(null);return N.createElement(cye,{previousRectanglesRef:t,props:e})}var fz=0,uye=(e,t)=>{var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:wO(e,t)}},dye=class extends N.PureComponent{render(){var{hide:e,data:t,dataKey:n,className:r,xAxisId:i,yAxisId:a,needClip:o,background:s,id:c}=this.props;if(e||t==null)return null;var l=cw(`recharts-bar`,r),u=c;return N.createElement(vw,{className:l,id:c},o&&N.createElement(`defs`,null,N.createElement(sz,{clipPathId:u,xAxisId:i,yAxisId:a})),N.createElement(vw,{className:`recharts-bar-rectangles`,clipPath:o?`url(#clipPath-${u})`:void 0},N.createElement(rye,{data:t,dataKey:n,background:s,allOtherBarProps:this.props}),N.createElement(lye,this.props)))}},fye={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:`ease`,hide:!1,isAnimationActive:!pA.isSsr,legendType:`rect`,minPointSize:fz,xAxisId:0,yAxisId:0};function pye(e){var{xAxisId:t,yAxisId:n,hide:r,legendType:i,minPointSize:a,activeBar:o,animationBegin:s,animationDuration:c,animationEasing:l,isAnimationActive:u}=e,{needClip:d}=oz(t,n),f=Xk(),p=_k(),m=F_e(e.children,BL),h=tE(r=>Iye(r,t,n,p,e.id,m));if(f!==`vertical`&&f!==`horizontal`)return null;var g,_=h?.[0];return g=_==null||_.height==null||_.width==null?0:f===`vertical`?_.height/2:_.width/2,N.createElement(az,{xAxisId:t,yAxisId:n,data:h,dataPointFormatter:uye,errorBarOffset:g},N.createElement(dye,cz({},e,{layout:f,needClip:d,data:h,xAxisId:t,yAxisId:n,hide:r,legendType:i,minPointSize:a,activeBar:o,animationBegin:s,animationDuration:c,animationEasing:l,isAnimationActive:u})))}function mye(e){var{layout:t,barSettings:{dataKey:n,minPointSize:r},pos:i,bandSize:a,xAxis:o,yAxis:s,xAxisTicks:c,yAxisTicks:l,stackedData:u,displayedData:d,offset:f,cells:p,parentViewBox:m}=e,h=t===`horizontal`?s:o,g=u?h.scale.domain():null,_=RO({numericAxis:h});return d.map((e,d)=>{var h,v,y,b,x,S;u?h=MO(u[d],g):(h=wO(e,n),Array.isArray(h)||(h=[_,h]));var C=Rve(r,fz)(h[1],d);if(t===`horizontal`){var[w,T]=[s.scale(h[0]),s.scale(h[1])];v=LO({axis:o,ticks:c,bandSize:a,offset:i.offset,entry:e,index:d}),y=T??w??void 0,b=i.size;var E=w-T;if(x=_T(E)?0:E,S={x:v,y:f.top,width:b,height:f.height},Math.abs(C)>0&&Math.abs(x)<Math.abs(C)){var D=gT(x||C)*(Math.abs(C)-Math.abs(x));y-=D,x+=D}}else{var[O,k]=[o.scale(h[0]),o.scale(h[1])];if(v=O,y=LO({axis:s,ticks:l,bandSize:a,offset:i.offset,entry:e,index:d}),b=k-O,x=i.size,S={x:f.left,y,width:f.width,height:x},Math.abs(C)>0&&Math.abs(b)<Math.abs(C)){var ee=gT(b||C)*(Math.abs(C)-Math.abs(b));b+=ee}}return v==null||y==null||b==null||x==null?null:uz(uz({},e),{},{x:v,y,width:b,height:x,value:u?h:h[1],payload:e,background:S,tooltipPosition:{x:v+b/2,y:y+x/2},parentViewBox:m},p&&p[d]&&p[d].props)}).filter(Boolean)}function hye(e){var t=EA(e,fye),n=_k();return N.createElement(WR,{id:t.id,type:`bar`},e=>N.createElement(N.Fragment,null,N.createElement(UR,{legendPayload:tye(t)}),N.createElement(HR,{fn:nye,args:t}),N.createElement(KR,{type:`bar`,id:e,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:FO(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),N.createElement(pye,cz({},t,{id:e}))))}var pz=N.memo(hye);pz.displayName=`Bar`;function mz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function hz(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?mz(Object(n),!0).forEach(function(t){gye(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mz(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function gye(e,t,n){return(t=_ye(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _ye(e){var t=vye(e,`string`);return typeof t==`symbol`?t:t+``}function vye(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var yye=(e,t)=>t,bye=(e,t,n)=>n,xye=(e,t,n,r)=>r,gz=L([bF,(e,t,n,r,i)=>i],(e,t)=>e.filter(e=>e.type===`bar`).find(e=>e.id===t)),Sye=L([gz],e=>e?.maxBarSize),Cye=(e,t,n,r,i,a)=>a,_z=(e,t,n)=>{var r=n??e;if(!ET(r))return ST(r,t,0)},wye=L([Yk,bF,yye,bye,xye],(e,t,n,r,i)=>t.filter(t=>e===`horizontal`?t.xAxisId===n:t.yAxisId===r).filter(e=>e.isPanorama===i).filter(e=>e.hide===!1).filter(e=>e.type===`bar`)),Tye=(e,t,n,r)=>Yk(e)===`horizontal`?FF(e,`yAxis`,n,r):FF(e,`xAxis`,t,r),Eye=L([wye,tme,(e,t,n)=>Yk(e)===`horizontal`?hI(e,`xAxis`,t):hI(e,`yAxis`,n)],(e,t,n)=>{var r={},i=e.filter(nF),a=e.filter(e=>e.stackId==null),o=i.reduce((e,t)=>(e[t.stackId]||(e[t.stackId]=[]),e[t.stackId].push(t),e),r),s=Object.entries(o).map(e=>{var[r,i]=e,a=i.map(e=>e.dataKey),o=_z(t,n,i[0].barSize);return{stackId:r,dataKeys:a,barSize:o}}),c=a.map(e=>{var r=[e.dataKey].filter(e=>e!=null),i=_z(t,n,e.barSize);return{stackId:void 0,dataKeys:r,barSize:i}});return[...s,...c]}),Dye=(e,t,n,r,i)=>{var a=gz(e,t,n,r,i);if(a!=null){var o=Yk(e),s=kP(e),{maxBarSize:c}=a,l=ET(c)?s:c,u,d;return o===`horizontal`?(u=CI(e,`xAxis`,t,r),d=SI(e,`xAxis`,t,r)):(u=CI(e,`yAxis`,n,r),d=SI(e,`yAxis`,n,r)),WO(u,d,!0)??l??0}},vz=(e,t,n,r)=>{var i=Yk(e),a,o;return i===`horizontal`?(a=CI(e,`xAxis`,t,r),o=SI(e,`xAxis`,t,r)):(a=CI(e,`yAxis`,n,r),o=SI(e,`yAxis`,n,r)),WO(a,o)};function Oye(e,t,n,r,i){var a=r.length;if(!(a<1)){var o=ST(e,n,0,!0),s,c=[];if(Nk(r[0].barSize)){var l=!1,u=n/a,d=r.reduce((e,t)=>e+(t.barSize||0),0);d+=(a-1)*o,d>=n&&(d-=(a-1)*o,o=0),d>=n&&u>0&&(l=!0,u*=.9,d=a*u);var f={offset:((n-d)/2>>0)-o,size:0};s=r.reduce((e,t)=>{var n={stackId:t.stackId,dataKeys:t.dataKeys,position:{offset:f.offset+f.size+o,size:l?u:t.barSize??0}},r=[...e,n];return f=r[r.length-1].position,r},c)}else{var p=ST(t,n,0,!0);n-2*p-(a-1)*o<=0&&(o=0);var m=(n-2*p-(a-1)*o)/a;m>1&&(m>>=0);var h=Nk(i)?Math.min(m,i):m;s=r.reduce((e,t,n)=>[...e,{stackId:t.stackId,dataKeys:t.dataKeys,position:{offset:p+(m+o)*n+(m-h)/2,size:h}}],c)}return s}}var kye=L([Eye,kP,eme,AP,Dye,vz,Sye],(e,t,n,r,i,a,o)=>{var s=ET(o)?t:o,c=Oye(n,r,i===a?a:i,e,s);return i!==a&&c!=null&&(c=c.map(e=>hz(hz({},e),{},{position:hz(hz({},e.position),{},{offset:e.position.offset-i/2})}))),c}),Aye=(e,t,n,r)=>CI(e,`xAxis`,t,r),jye=(e,t,n,r)=>CI(e,`yAxis`,n,r),Mye=(e,t,n,r)=>SI(e,`xAxis`,t,r),Nye=(e,t,n,r)=>SI(e,`yAxis`,n,r),Pye=L([kye,gz],(e,t)=>{if(!(e==null||t==null)){var n=e.find(e=>e.stackId===t.stackId&&t.dataKey!=null&&e.dataKeys.includes(t.dataKey));if(n!=null)return n.position}}),Fye=L([Tye,gz],(e,t)=>{var n=XP(t);if(!(!e||n==null||t==null)){var{stackId:r}=t;if(r!=null){var i=e[r];if(i){var{stackedData:a}=i;if(a)return a.find(e=>e.key===n)}}}}),Iye=L([pk,hk,Aye,jye,Mye,Nye,Pye,Yk,lP,vz,Fye,gz,Cye],(e,t,n,r,i,a,o,s,c,l,u,d,f)=>{var{chartData:p,dataStartIndex:m,dataEndIndex:h}=c;if(!(d==null||o==null||t==null||s!==`horizontal`&&s!==`vertical`||n==null||r==null||i==null||a==null||l==null)){var{data:g}=d,_=g!=null&&g.length>0?g:p?.slice(m,h+1);if(_!=null)return mye({layout:s,barSettings:d,pos:o,parentViewBox:t,bandSize:l,xAxis:n,yAxis:r,xAxisTicks:i,yAxisTicks:a,stackedData:u,displayedData:_,offset:e,cells:f})}}),Lye=e=>{var{chartData:t}=e,n=$T(),r=_k();return(0,N.useEffect)(()=>r?()=>{}:(n(ML(t)),()=>{n(ML(void 0))}),[t,n,r]),null},yz={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},bz=yD({name:`brush`,initialState:yz,reducers:{setBrushSettings(e,t){return t.payload==null?yz:t.payload}}}),{setBrushSettings:Rye}=bz.actions,zye=bz.reducer;function Bye(e,t,n){return(t=Vye(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vye(e){var t=Hye(e,`string`);return typeof t==`symbol`?t:t+``}function Hye(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}Bye(class e{static create(t){return new e(t)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:t,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(n)switch(n){case`start`:return this.scale(e);case`middle`:var r=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+r;case`end`:var i=this.bandwidth?this.bandwidth():0;return this.scale(e)+i;default:return this.scale(e)}if(t){var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+a}return this.scale(e)}}isInRange(e){var t=this.range(),n=t[0],r=t[t.length-1];return n<=r?e>=n&&e<=r:e>=r&&e<=n}},`EPS`,1e-4);function Uye(e){return(e%180+180)%180}var Wye=function(e){var{width:t,height:n}=e,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=Uye(r)*Math.PI/180,a=Math.atan(n/t),o=i>a&&i<Math.PI-a?n/Math.sin(i):t/Math.cos(i);return Math.abs(o)},xz=yD({name:`referenceElements`,initialState:{dots:[],areas:[],lines:[]},reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var n=aD(e).dots.findIndex(e=>e===t.payload);n!==-1&&e.dots.splice(n,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var n=aD(e).areas.findIndex(e=>e===t.payload);n!==-1&&e.areas.splice(n,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var n=aD(e).lines.findIndex(e=>e===t.payload);n!==-1&&e.lines.splice(n,1)}}}),{addDot:Gye,removeDot:Kye,addArea:qye,removeArea:Jye,addLine:Yye,removeLine:Xye}=xz.actions,Sz=xz.reducer,Cz=(0,N.createContext)(void 0),wz=e=>{var{children:t}=e,[n]=(0,N.useState)(`${xT(`recharts`)}-clip`),r=XR();if(r==null)return null;var{x:i,y:a,width:o,height:s}=r;return N.createElement(Cz.Provider,{value:n},N.createElement(`defs`,null,N.createElement(`clipPath`,{id:n},N.createElement(`rect`,{x:i,y:a,height:s,width:o}))),t)};function Tz(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function Ez(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var r=[],i=0;i<e.length;i+=t)if(n===void 0||n(e[i])===!0)r.push(e[i]);else return;return r}function Dz(e,t,n){var r={width:e.width+t.width,height:e.height+t.height};return Wye(r,n)}function Oz(e,t,n){var r=n===`width`,{x:i,y:a,width:o,height:s}=e;return t===1?{start:r?i:a,end:r?i+o:a+s}:{start:r?i+o:a+s,end:r?i:a}}function kz(e,t,n,r,i){if(e*t<e*r||e*t>e*i)return!1;var a=n();return e*(t-e*a/2-r)>=0&&e*(t+e*a/2-i)<=0}function Az(e,t){return Ez(e,t+1)}function jz(e,t,n,r,i){for(var a=(r||[]).slice(),{start:o,end:s}=t,c=0,l=1,u=o,d=function(){var t=r?.[c];if(t===void 0)return{v:Ez(r,l)};var a=c,d,f=()=>(d===void 0&&(d=n(t,a)),d),p=t.coordinate,m=c===0||kz(e,p,f,u,s);m||(c=0,u=o,l+=1),m&&(u=p+e*(f()/2+i),c+=l)},f;l<=a.length;)if(f=d(),f)return f.v;return[]}function Mz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Nz(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?Mz(Object(n),!0).forEach(function(t){Pz(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mz(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Pz(e,t,n){return(t=Fz(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fz(e){var t=Iz(e,`string`);return typeof t==`symbol`?t:t+``}function Iz(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function Lz(e,t,n,r,i){for(var a=(r||[]).slice(),o=a.length,{start:s}=t,{end:c}=t,l=function(t){var r=a[t],l,u=()=>(l===void 0&&(l=n(r,t)),l);if(t===o-1){var d=e*(r.coordinate+e*u()/2-c);a[t]=r=Nz(Nz({},r),{},{tickCoord:d>0?r.coordinate-d*e:r.coordinate})}else a[t]=r=Nz(Nz({},r),{},{tickCoord:r.coordinate});kz(e,r.tickCoord,u,s,c)&&(c=r.tickCoord-e*(u()/2+i),a[t]=Nz(Nz({},r),{},{isShow:!0}))},u=o-1;u>=0;u--)l(u);return a}function Rz(e,t,n,r,i,a){var o=(r||[]).slice(),s=o.length,{start:c,end:l}=t;if(a){var u=r[s-1],d=n(u,s-1),f=e*(u.coordinate+e*d/2-l);o[s-1]=u=Nz(Nz({},u),{},{tickCoord:f>0?u.coordinate-f*e:u.coordinate}),kz(e,u.tickCoord,()=>d,c,l)&&(l=u.tickCoord-e*(d/2+i),o[s-1]=Nz(Nz({},u),{},{isShow:!0}))}for(var p=a?s-1:s,m=function(t){var r=o[t],a,s=()=>(a===void 0&&(a=n(r,t)),a);if(t===0){var u=e*(r.coordinate-e*s()/2-c);o[t]=r=Nz(Nz({},r),{},{tickCoord:u<0?r.coordinate-u*e:r.coordinate})}else o[t]=r=Nz(Nz({},r),{},{tickCoord:r.coordinate});kz(e,r.tickCoord,s,c,l)&&(c=r.tickCoord+e*(s()/2+i),o[t]=Nz(Nz({},r),{},{isShow:!0}))},h=0;h<p;h++)m(h);return o}function zz(e,t,n){var{tick:r,ticks:i,viewBox:a,minTickGap:o,orientation:s,interval:c,tickFormatter:l,unit:u,angle:d}=e;if(!i||!i.length||!r)return[];if(yT(c)||pA.isSsr)return Az(i,yT(c)?c:0)??[];var f=[],p=s===`top`||s===`bottom`?`width`:`height`,m=u&&p===`width`?KL(u,{fontSize:t,letterSpacing:n}):{width:0,height:0},h=(e,r)=>{var i=typeof l==`function`?l(e.value,r):e.value;return p===`width`?Dz(KL(i,{fontSize:t,letterSpacing:n}),m,d):KL(i,{fontSize:t,letterSpacing:n})[p]},g=i.length>=2?gT(i[1].coordinate-i[0].coordinate):1,_=Oz(a,g,p);return c===`equidistantPreserveStart`?jz(g,_,h,i,o):(f=c===`preserveStart`||c===`preserveStartEnd`?Rz(g,_,h,i,o,c===`preserveStartEnd`):Lz(g,_,h,i,o),f.filter(e=>e.isShow))}var Bz=e=>{var{ticks:t,label:n,labelGapWithTick:r=5,tickSize:i=0,tickMargin:a=0}=e,o=0;if(t){Array.from(t).forEach(e=>{if(e){var t=e.getBoundingClientRect();t.width>o&&(o=t.width)}});var s=n?n.getBoundingClientRect().width:0,c=i+a,l=o+c+s+(n?r:0);return Math.round(l)}return 0},Vz=l(hT()),Hz=[`axisLine`,`width`,`height`,`className`,`hide`,`ticks`],Uz=[`viewBox`],Wz=[`viewBox`];function Gz(e,t){if(e==null)return{};var n,r,i=Kz(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Kz(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function qz(){return qz=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qz.apply(null,arguments)}function Jz(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Yz(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?Jz(Object(n),!0).forEach(function(t){Xz(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jz(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Xz(e,t,n){return(t=Zz(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Zz(e){var t=Qz(e,`string`);return typeof t==`symbol`?t:t+``}function Qz(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}var $z={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:`bottom`,ticks:[],stroke:`#666`,tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:`preserveEnd`};function eB(e){var{x:t,y:n,width:r,height:i,orientation:a,mirror:o,axisLine:s,otherSvgProps:c}=e;if(!s)return null;var l=Yz(Yz(Yz({},c),fw(s)),{},{fill:`none`});if(a===`top`||a===`bottom`){var u=+(a===`top`&&!o||a===`bottom`&&o);l=Yz(Yz({},l),{},{x1:t,y1:n+u*i,x2:t+r,y2:n+u*i})}else{var d=+(a===`left`&&!o||a===`right`&&o);l=Yz(Yz({},l),{},{x1:t+d*r,y1:n,x2:t+d*r,y2:n+i})}return N.createElement(`line`,qz({},l,{className:cw(`recharts-cartesian-axis-line`,(0,Vz.default)(s,`className`))}))}function tB(e,t,n,r,i,a,o,s,c){var l,u,d,f,p,m,h=s?-1:1,g=e.tickSize||o,_=yT(e.tickCoord)?e.tickCoord:e.coordinate;switch(a){case`top`:l=u=e.coordinate,f=n+ +!s*i,d=f-h*g,m=d-h*c,p=_;break;case`left`:d=f=e.coordinate,u=t+ +!s*r,l=u-h*g,p=l-h*c,m=_;break;case`right`:d=f=e.coordinate,u=t+ +s*r,l=u+h*g,p=l+h*c,m=_;break;default:l=u=e.coordinate,f=n+ +s*i,d=f+h*g,m=d+h*c,p=_;break}return{line:{x1:l,y1:d,x2:u,y2:f},tick:{x:p,y:m}}}function nB(e,t){switch(e){case`left`:return t?`start`:`end`;case`right`:return t?`end`:`start`;default:return`middle`}}function rB(e,t){switch(e){case`left`:case`right`:return`middle`;case`top`:return t?`start`:`end`;default:return t?`end`:`start`}}function iB(e){var{option:t,tickProps:n,value:r}=e,i,a=cw(n.className,`recharts-cartesian-axis-tick-value`);if(N.isValidElement(t))i=N.cloneElement(t,Yz(Yz({},n),{},{className:a}));else if(typeof t==`function`)i=t(Yz(Yz({},n),{},{className:a}));else{var o=`recharts-cartesian-axis-tick-value`;typeof t!=`boolean`&&(o=cw(o,t?.className)),i=N.createElement(sR,qz({},n,{className:o}),r)}return i}function aB(e){var{ticks:t=[],tick:n,tickLine:r,stroke:i,tickFormatter:a,unit:o,padding:s,tickTextProps:c,orientation:l,mirror:u,x:d,y:f,width:p,height:m,tickSize:h,tickMargin:g,fontSize:_,letterSpacing:v,getTicksConfig:y,events:b}=e,x=zz(Yz(Yz({},y),{},{ticks:t}),_,v),S=nB(l,u),C=rB(l,u),w=fw(y),T=pw(n),E={};typeof r==`object`&&(E=r);var D=Yz(Yz({},w),{},{fill:`none`},E),O=x.map((e,t)=>{var{line:_,tick:v}=tB(e,d,f,p,m,l,h,u,g),y=Yz(Yz(Yz(Yz({textAnchor:S,verticalAnchor:C},w),{},{stroke:`none`,fill:i},T),v),{},{index:t,payload:e,visibleTicksCount:x.length,tickFormatter:a,padding:s},c);return N.createElement(vw,qz({className:`recharts-cartesian-axis-tick`,key:`tick-${e.value}-${e.coordinate}-${e.tickCoord}`},PT(b,e,t)),r&&N.createElement(`line`,qz({},D,_,{className:cw(`recharts-cartesian-axis-tick-line`,(0,Vz.default)(r,`className`))})),n&&N.createElement(iB,{option:n,tickProps:y,value:`${typeof a==`function`?a(e.value,t):e.value}${o||``}`}))});return O.length>0?N.createElement(`g`,{className:`recharts-cartesian-axis-ticks`},O):null}var oB=(0,N.forwardRef)((e,t)=>{var{axisLine:n,width:r,height:i,className:a,hide:o,ticks:s}=e,c=Gz(e,Hz),[l,u]=(0,N.useState)(``),[d,f]=(0,N.useState)(``),p=(0,N.useRef)(null);(0,N.useImperativeHandle)(t,()=>({getCalculatedWidth:()=>Bz({ticks:p.current,label:e.labelRef?.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}));var m=(0,N.useCallback)(e=>{if(e){var t=e.getElementsByClassName(`recharts-cartesian-axis-tick-value`);p.current=t;var n=t[0];if(n){var r=window.getComputedStyle(n),i=r.fontSize,a=r.letterSpacing;(i!==l||a!==d)&&(u(i),f(a))}}},[l,d]);return o||r!=null&&r<=0||i!=null&&i<=0?null:N.createElement(vw,{className:cw(`recharts-cartesian-axis`,a),ref:m},N.createElement(eB,{x:e.x,y:e.y,width:r,height:i,orientation:e.orientation,mirror:e.mirror,axisLine:n,otherSvgProps:fw(e)}),N.createElement(aB,{ticks:s,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:l,letterSpacing:d,getTicksConfig:e,events:c}),N.createElement(o_e,{x:e.x,y:e.y,width:e.width,height:e.height},N.createElement(g_e,{label:e.label,labelRef:e.labelRef}),e.children))}),sB=N.memo(oB,(e,t)=>{var{viewBox:n}=e,r=Gz(e,Uz),{viewBox:i}=t,a=Gz(t,Wz);return Tz(n,i)&&Tz(r,a)}),cB=N.forwardRef((e,t)=>{var n=EA(e,$z);return N.createElement(sB,qz({},n,{ref:t}))});cB.displayName=`CartesianAxis`;var lB=[`x1`,`y1`,`x2`,`y2`,`key`],uB=[`offset`],dB=[`xAxisId`,`yAxisId`],fB=[`xAxisId`,`yAxisId`];function pB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function mB(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?pB(Object(n),!0).forEach(function(t){hB(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pB(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function hB(e,t,n){return(t=gB(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gB(e){var t=_B(e,`string`);return typeof t==`symbol`?t:t+``}function _B(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function vB(){return vB=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},vB.apply(null,arguments)}function yB(e,t){if(e==null)return{};var n,r,i=bB(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function bB(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var xB=e=>{var{fill:t}=e;if(!t||t===`none`)return null;var{fillOpacity:n,x:r,y:i,width:a,height:o,ry:s}=e;return N.createElement(`rect`,{x:r,y:i,ry:s,width:a,height:o,stroke:`none`,fill:t,fillOpacity:n,className:`recharts-cartesian-grid-bg`})};function SB(e,t){var n;if(N.isValidElement(e))n=N.cloneElement(e,t);else if(typeof e==`function`)n=e(t);else{var{x1:r,y1:i,x2:a,y2:o,key:s}=t,c=yB(t,lB),l=fw(c),{offset:u}=l,d=yB(l,uB);n=N.createElement(`line`,vB({},d,{x1:r,y1:i,x2:a,y2:o,fill:`none`,key:s}))}return n}function CB(e){var{x:t,width:n,horizontal:r=!0,horizontalPoints:i}=e;if(!r||!i||!i.length)return null;var{xAxisId:a,yAxisId:o}=e,s=yB(e,dB),c=i.map((e,i)=>{var a=mB(mB({},s),{},{x1:t,y1:e,x2:t+n,y2:e,key:`line-${i}`,index:i});return SB(r,a)});return N.createElement(`g`,{className:`recharts-cartesian-grid-horizontal`},c)}function wB(e){var{y:t,height:n,vertical:r=!0,verticalPoints:i}=e;if(!r||!i||!i.length)return null;var{xAxisId:a,yAxisId:o}=e,s=yB(e,fB),c=i.map((e,i)=>{var a=mB(mB({},s),{},{x1:e,y1:t,x2:e,y2:t+n,key:`line-${i}`,index:i});return SB(r,a)});return N.createElement(`g`,{className:`recharts-cartesian-grid-vertical`},c)}function TB(e){var{horizontalFill:t,fillOpacity:n,x:r,y:i,width:a,height:o,horizontalPoints:s,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var l=s.map(e=>Math.round(e+i-i)).sort((e,t)=>e-t);i!==l[0]&&l.unshift(0);var u=l.map((e,s)=>{var c=l[s+1]?l[s+1]-e:i+o-e;if(c<=0)return null;var u=s%t.length;return N.createElement(`rect`,{key:`react-${s}`,y:e,x:r,height:c,width:a,stroke:`none`,fill:t[u],fillOpacity:n,className:`recharts-cartesian-grid-bg`})});return N.createElement(`g`,{className:`recharts-cartesian-gridstripes-horizontal`},u)}function EB(e){var{vertical:t=!0,verticalFill:n,fillOpacity:r,x:i,y:a,width:o,height:s,verticalPoints:c}=e;if(!t||!n||!n.length)return null;var l=c.map(e=>Math.round(e+i-i)).sort((e,t)=>e-t);i!==l[0]&&l.unshift(0);var u=l.map((e,t)=>{var c=l[t+1]?l[t+1]-e:i+o-e;if(c<=0)return null;var u=t%n.length;return N.createElement(`rect`,{key:`react-${t}`,x:e,y:a,width:c,height:s,stroke:`none`,fill:n[u],fillOpacity:r,className:`recharts-cartesian-grid-bg`})});return N.createElement(`g`,{className:`recharts-cartesian-gridstripes-vertical`},u)}var DB=(e,t)=>{var{xAxis:n,width:r,height:i,offset:a}=e;return OO(zz(mB(mB(mB({},$z),n),{},{ticks:kO(n,!0),viewBox:{x:0,y:0,width:r,height:i}})),a.left,a.left+a.width,t)},OB=(e,t)=>{var{yAxis:n,width:r,height:i,offset:a}=e;return OO(zz(mB(mB(mB({},$z),n),{},{ticks:kO(n,!0),viewBox:{x:0,y:0,width:r,height:i}})),a.top,a.top+a.height,t)},kB={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:`#ccc`,fill:`none`,verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function AB(e){var t=qk(),n=Jk(),r=Kk(),i=mB(mB({},EA(e,kB)),{},{x:yT(e.x)?e.x:r.left,y:yT(e.y)?e.y:r.top,width:yT(e.width)?e.width:r.width,height:yT(e.height)?e.height:r.height}),{xAxisId:a,yAxisId:o,x:s,y:c,width:l,height:u,syncWithTicks:d,horizontalValues:f,verticalValues:p}=i,m=_k(),h=tE(e=>bI(e,`xAxis`,a,m)),g=tE(e=>bI(e,`yAxis`,o,m));if(!yT(l)||l<=0||!yT(u)||u<=0||!yT(s)||s!==+s||!yT(c)||c!==+c)return null;var _=i.verticalCoordinatesGenerator||DB,v=i.horizontalCoordinatesGenerator||OB,{horizontalPoints:y,verticalPoints:b}=i;if((!y||!y.length)&&typeof v==`function`){var x=f&&f.length,S=v({yAxis:g?mB(mB({},g),{},{ticks:x?f:g.ticks}):void 0,width:t,height:n,offset:r},x?!0:d);Tk(Array.isArray(S),`horizontalCoordinatesGenerator should return Array but instead it returned [${typeof S}]`),Array.isArray(S)&&(y=S)}if((!b||!b.length)&&typeof _==`function`){var C=p&&p.length,w=_({xAxis:h?mB(mB({},h),{},{ticks:C?p:h.ticks}):void 0,width:t,height:n,offset:r},C?!0:d);Tk(Array.isArray(w),`verticalCoordinatesGenerator should return Array but instead it returned [${typeof w}]`),Array.isArray(w)&&(b=w)}return N.createElement(`g`,{className:`recharts-cartesian-grid`},N.createElement(xB,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),N.createElement(TB,vB({},i,{horizontalPoints:y})),N.createElement(EB,vB({},i,{verticalPoints:b})),N.createElement(CB,vB({},i,{offset:r,horizontalPoints:y,xAxis:h,yAxis:g})),N.createElement(wB,vB({},i,{offset:r,verticalPoints:b,xAxis:h,yAxis:g})))}AB.displayName=`CartesianGrid`;var jB=(e,t,n,r)=>CI(e,`xAxis`,t,r),MB=(e,t,n,r)=>SI(e,`xAxis`,t,r),NB=(e,t,n,r)=>CI(e,`yAxis`,n,r),PB=(e,t,n,r)=>SI(e,`yAxis`,n,r),FB=L([Yk,jB,NB,MB,PB],(e,t,n,r,i)=>DO(e,`xAxis`)?WO(t,r,!1):WO(n,i,!1)),IB=(e,t,n,r,i)=>i;function LB(e){return e.type===`line`}var RB=L([bF,IB],(e,t)=>e.filter(LB).find(e=>e.id===t)),zB=L([Yk,jB,NB,MB,PB,RB,FB,lP],(e,t,n,r,i,a,o,s)=>{var{chartData:c,dataStartIndex:l,dataEndIndex:u}=s;if(!(a==null||t==null||n==null||r==null||i==null||r.length===0||i.length===0||o==null)){var{dataKey:d,data:f}=a,p=f!=null&&f.length>0?f:c?.slice(l,u+1);if(p!=null)return hV({layout:e,xAxis:t,yAxis:n,xAxisTicks:r,yAxisTicks:i,dataKey:d,bandSize:o,displayedData:p})}});function BB(e){var t=pw(e),n=3,r=2;if(t!=null){var{r:i,strokeWidth:a}=t,o=Number(i),s=Number(a);return(Number.isNaN(o)||o<0)&&(o=n),(Number.isNaN(s)||s<0)&&(s=r),{r:o,strokeWidth:s}}return{r:n,strokeWidth:r}}var VB=[`id`],HB=[`type`,`layout`,`connectNulls`,`needClip`],UB=[`activeDot`,`animateNewValues`,`animationBegin`,`animationDuration`,`animationEasing`,`connectNulls`,`dot`,`hide`,`isAnimationActive`,`label`,`legendType`,`xAxisId`,`yAxisId`,`id`];function WB(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function GB(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?WB(Object(n),!0).forEach(function(t){KB(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):WB(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function KB(e,t,n){return(t=qB(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qB(e){var t=JB(e,`string`);return typeof t==`symbol`?t:t+``}function JB(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function YB(e,t){if(e==null)return{};var n,r,i=XB(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function XB(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function ZB(){return ZB=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ZB.apply(null,arguments)}var QB=e=>{var{dataKey:t,name:n,stroke:r,legendType:i,hide:a}=e;return[{inactive:a,dataKey:t,type:i,color:r,value:KO(n,t),payload:e}]};function $B(e){var{dataKey:t,data:n,stroke:r,strokeWidth:i,fill:a,name:o,hide:s,unit:c}=e;return{dataDefinedOnItem:n,positions:void 0,settings:{stroke:r,strokeWidth:i,fill:a,dataKey:t,nameKey:void 0,name:KO(o,t),hide:s,type:e.tooltipType,color:e.stroke,unit:c}}}var eV=(e,t)=>`${t}px ${e-t}px`;function tV(e,t){for(var n=e.length%2==0?e:[...e,0],r=[],i=0;i<t;++i)r=[...r,...n];return r}var nV=(e,t,n)=>{var r=n.reduce((e,t)=>e+t);if(!r)return eV(t,e);for(var i=Math.floor(e/r),a=e%r,o=t-e,s=[],c=0,l=0;c<n.length;l+=n[c],++c)if(l+n[c]>a){s=[...n.slice(0,c),a-l];break}var u=s.length%2==0?[0,o]:[o];return[...tV(n,i),...s,...u].map(e=>`${e}px`).join(`, `)};function rV(e,t){var n;if(N.isValidElement(e))n=N.cloneElement(e,t);else if(typeof e==`function`)n=e(t);else{var r=cw(`recharts-line-dot`,typeof e==`boolean`?``:e.className);n=N.createElement(wR,ZB({},t,{className:r}))}return n}function iV(e,t){return e==null?!1:t?!0:e.length===1}function aV(e){var{clipPathId:t,points:n,props:r}=e,{dot:i,dataKey:a,needClip:o}=r;if(!iV(n,i))return null;var{id:s}=r,c=YB(r,VB),l=jR(i),u=fw(c),d=nse(i),f=n.map((e,t)=>{var r=GB(GB(GB({key:`dot-${t}`,r:3},u),d),{},{index:t,cx:e.x,cy:e.y,dataKey:a,value:e.value,payload:e.payload,points:n});return rV(i,r)}),p={clipPath:o?`url(#clipPath-${l?``:`dots-`}${t})`:void 0};return N.createElement(vw,ZB({className:`recharts-line-dots`,key:`dots`},p),f)}function oV(e){var{showLabels:t,children:n,points:r}=e,i=(0,N.useMemo)(()=>r?.map(e=>{var t={x:e.x,y:e.y,width:0,height:0};return GB(GB({},t),{},{value:e.value,payload:e.payload,viewBox:t,parentViewBox:void 0,fill:void 0})}),[r]);return N.createElement(yR,{value:t?i:null},n)}function sV(e){var{clipPathId:t,pathRef:n,points:r,strokeDasharray:i,props:a}=e,{type:o,layout:s,connectNulls:c,needClip:l}=a,u=YB(a,HB),d=GB(GB({},mw(u)),{},{fill:`none`,className:`recharts-line-curve`,clipPath:l?`url(#clipPath-${t})`:void 0,points:r,type:o,layout:s,connectNulls:c,strokeDasharray:i??a.strokeDasharray});return N.createElement(N.Fragment,null,r?.length>1&&N.createElement(SA,ZB({},d,{pathRef:n})),N.createElement(aV,{points:r,clipPathId:t,props:a}))}function cV(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function lV(e){var{clipPathId:t,props:n,pathRef:r,previousPointsRef:i,longestAnimatedLengthRef:a}=e,{points:o,strokeDasharray:s,isAnimationActive:c,animationBegin:l,animationDuration:u,animationEasing:d,animateNewValues:f,width:p,height:m,onAnimationEnd:h,onAnimationStart:g}=n,_=i.current,v=UA(n,`recharts-line-`),[y,b]=(0,N.useState)(!1),x=!y,S=(0,N.useCallback)(()=>{typeof h==`function`&&h(),b(!1)},[h]),C=(0,N.useCallback)(()=>{typeof g==`function`&&g(),b(!0)},[g]),w=cV(r.current),T=a.current;return N.createElement(oV,{points:o,showLabels:x},n.children,N.createElement(HA,{animationId:v,begin:l,duration:u,isActive:c,easing:d,onAnimationEnd:S,onAnimationStart:C,key:v},e=>{var l=wT(T,w+T,e),u=Math.min(l,w),d;if(c)if(s){var h=`${s}`.split(/[,\s]+/gim).map(e=>parseFloat(e));d=nV(u,w,h)}else d=eV(w,u);else d=s==null?void 0:String(s);if(_){var g=_.length/o.length,v=e===1?o:o.map((t,n)=>{var r=Math.floor(n*g);if(_[r]){var i=_[r];return GB(GB({},t),{},{x:wT(i.x,t.x,e),y:wT(i.y,t.y,e)})}return f?GB(GB({},t),{},{x:wT(p*2,t.x,e),y:wT(m/2,t.y,e)}):GB(GB({},t),{},{x:t.x,y:t.y})});return i.current=v,N.createElement(sV,{props:n,points:v,clipPathId:t,pathRef:r,strokeDasharray:d})}return e>0&&w>0&&(i.current=o,a.current=u),N.createElement(sV,{props:n,points:o,clipPathId:t,pathRef:r,strokeDasharray:d})}),N.createElement(SR,{label:n.label}))}function uV(e){var{clipPathId:t,props:n}=e,r=(0,N.useRef)(null),i=(0,N.useRef)(0),a=(0,N.useRef)(null);return N.createElement(lV,{props:n,clipPathId:t,previousPointsRef:r,longestAnimatedLengthRef:i,pathRef:a})}var dV=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:wO(e.payload,t)}),fV=class extends N.Component{render(){var{hide:e,dot:t,points:n,className:r,xAxisId:i,yAxisId:a,top:o,left:s,width:c,height:l,id:u,needClip:d}=this.props;if(e)return null;var f=cw(`recharts-line`,r),p=u,{r:m,strokeWidth:h}=BB(t),g=jR(t),_=m*2+h;return N.createElement(N.Fragment,null,N.createElement(vw,{className:f},d&&N.createElement(`defs`,null,N.createElement(sz,{clipPathId:p,xAxisId:i,yAxisId:a}),!g&&N.createElement(`clipPath`,{id:`clipPath-dots-${p}`},N.createElement(`rect`,{x:s-_/2,y:o-_/2,width:c+_,height:l+_}))),N.createElement(az,{xAxisId:i,yAxisId:a,data:n,dataPointFormatter:dV,errorBarOffset:0},N.createElement(uV,{props:this.props,clipPathId:p}))),N.createElement(Ove,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}},pV={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:`ease`,connectNulls:!1,dot:!0,fill:`#fff`,hide:!1,isAnimationActive:!pA.isSsr,label:!1,legendType:`line`,stroke:`#3182bd`,strokeWidth:1,xAxisId:0,yAxisId:0};function mV(e){var t=EA(e,pV),{activeDot:n,animateNewValues:r,animationBegin:i,animationDuration:a,animationEasing:o,connectNulls:s,dot:c,hide:l,isAnimationActive:u,label:d,legendType:f,xAxisId:p,yAxisId:m,id:h}=t,g=YB(t,UB),{needClip:_}=oz(p,m),v=XR(),y=Xk(),b=_k(),x=tE(e=>zB(e,p,m,b,h));if(y!==`horizontal`&&y!==`vertical`||x==null||v==null)return null;var{height:S,width:C,x:w,y:T}=v;return N.createElement(fV,ZB({},g,{id:h,connectNulls:s,dot:c,activeDot:n,animateNewValues:r,animationBegin:i,animationDuration:a,animationEasing:o,isAnimationActive:u,hide:l,label:d,legendType:f,xAxisId:p,yAxisId:m,points:x,layout:y,height:S,width:C,left:w,top:T,needClip:_}))}function hV(e){var{layout:t,xAxis:n,yAxis:r,xAxisTicks:i,yAxisTicks:a,dataKey:o,bandSize:s,displayedData:c}=e;return c.map((e,c)=>{var l=wO(e,o);if(t===`horizontal`){var u=IO({axis:n,ticks:i,bandSize:s,entry:e,index:c}),d=ET(l)?null:r.scale(l);return{x:u,y:d,value:l,payload:e}}var f=ET(l)?null:n.scale(l),p=IO({axis:r,ticks:a,bandSize:s,entry:e,index:c});return f==null||p==null?null:{x:f,y:p,value:l,payload:e}}).filter(Boolean)}function gV(e){var t=EA(e,pV),n=_k();return N.createElement(WR,{id:t.id,type:`line`},e=>N.createElement(N.Fragment,null,N.createElement(UR,{legendPayload:QB(t)}),N.createElement(HR,{fn:$B,args:t}),N.createElement(KR,{type:`line`,id:e,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:n}),N.createElement(mV,ZB({},t,{id:e}))))}var _V=N.memo(gV);_V.displayName=`Line`;var vV=[`dangerouslySetInnerHTML`,`ticks`],yV=[`id`],bV=[`domain`],xV=[`domain`];function SV(){return SV=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},SV.apply(null,arguments)}function CV(e,t){if(e==null)return{};var n,r,i=wV(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function wV(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function TV(e){var t=$T();return(0,N.useLayoutEffect)(()=>(t(pve(e)),()=>{t(mve(e))}),[e,t]),null}var EV=e=>{var{xAxisId:t,className:n}=e,r=tE(hk),i=_k(),a=`xAxis`,o=tE(e=>cI(e,a,t,i)),s=tE(e=>xI(e,a,t,i)),c=tE(e=>pI(e,t)),l=tE(e=>qme(e,t)),u=tE(e=>uF(e,t));if(c==null||l==null||u==null)return null;var{dangerouslySetInnerHTML:d,ticks:f}=e,p=CV(e,vV),{id:m}=u,h=CV(u,yV);return N.createElement(cB,SV({},p,h,{scale:o,x:l.x,y:l.y,width:c.width,height:c.height,className:cw(`recharts-${a} ${a}`,n),viewBox:r,ticks:s}))},DV={allowDataOverflow:lF.allowDataOverflow,allowDecimals:lF.allowDecimals,allowDuplicatedCategory:lF.allowDuplicatedCategory,height:lF.height,hide:!1,mirror:lF.mirror,orientation:lF.orientation,padding:lF.padding,reversed:lF.reversed,scale:lF.scale,tickCount:lF.tickCount,type:lF.type,xAxisId:0},OV=N.memo(e=>{var t=EA(e,DV);return N.createElement(N.Fragment,null,N.createElement(TV,{interval:t.interval??`preserveEnd`,id:t.xAxisId,scale:t.scale,type:t.type,padding:t.padding,allowDataOverflow:t.allowDataOverflow,domain:t.domain,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,includeHidden:t.includeHidden??!1,reversed:t.reversed,ticks:t.ticks,height:t.height,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle??0,minTickGap:t.minTickGap??5,tick:t.tick??!0,tickFormatter:t.tickFormatter}),N.createElement(EV,t))},(e,t)=>{var{domain:n}=e,r=CV(e,bV),{domain:i}=t,a=CV(t,xV);return Tz(r,a)?Array.isArray(n)&&n.length===2&&Array.isArray(i)&&i.length===2?n[0]===i[0]&&n[1]===i[1]:Tz({domain:n},{domain:i}):!1});OV.displayName=`XAxis`;var kV=[`dangerouslySetInnerHTML`,`ticks`],AV=[`id`],jV=[`domain`],MV=[`domain`];function NV(){return NV=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},NV.apply(null,arguments)}function PV(e,t){if(e==null)return{};var n,r,i=FV(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function FV(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function IV(e){var t=$T();return(0,N.useLayoutEffect)(()=>(t(hve(e)),()=>{t(gve(e))}),[e,t]),null}var LV=e=>{var{yAxisId:t,className:n,width:r,label:i}=e,a=(0,N.useRef)(null),o=(0,N.useRef)(null),s=tE(hk),c=_k(),l=$T(),u=`yAxis`,d=tE(e=>cI(e,u,t,c)),f=tE(e=>mI(e,t)),p=tE(e=>Jme(e,t)),m=tE(e=>xI(e,u,t,c)),h=tE(e=>pF(e,t));if((0,N.useLayoutEffect)(()=>{if(!(r!==`auto`||!f||pR(i)||(0,N.isValidElement)(i)||h==null)){var e=a.current;if(e){var n=e.getCalculatedWidth();Math.round(f.width)!==Math.round(n)&&l(yve({id:t,width:n}))}}},[m,f,l,i,t,r,h]),f==null||p==null||h==null)return null;var{dangerouslySetInnerHTML:g,ticks:_}=e,v=PV(e,kV),{id:y}=h,b=PV(h,AV);return N.createElement(cB,NV({},v,b,{ref:a,labelRef:o,scale:d,x:p.x,y:p.y,tickTextProps:r===`auto`?{width:void 0}:{width:r},width:f.width,height:f.height,className:cw(`recharts-${u} ${u}`,n),viewBox:s,ticks:m}))},RV={allowDataOverflow:fF.allowDataOverflow,allowDecimals:fF.allowDecimals,allowDuplicatedCategory:fF.allowDuplicatedCategory,hide:!1,mirror:fF.mirror,orientation:fF.orientation,padding:fF.padding,reversed:fF.reversed,scale:fF.scale,tickCount:fF.tickCount,type:fF.type,width:fF.width,yAxisId:0},zV=N.memo(e=>{var t=EA(e,RV);return N.createElement(N.Fragment,null,N.createElement(IV,{interval:t.interval??`preserveEnd`,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden??!1,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle??0,minTickGap:t.minTickGap??5,tick:t.tick??!0,tickFormatter:t.tickFormatter}),N.createElement(LV,t))},(e,t)=>{var{domain:n}=e,r=PV(e,jV),{domain:i}=t,a=PV(t,MV);return Tz(r,a)?Array.isArray(n)&&n.length===2&&Array.isArray(i)&&i.length===2?n[0]===i[0]&&n[1]===i[1]:Tz({domain:n},{domain:i}):!1});zV.displayName=`YAxis`;var BV=o((e=>{var t=Zm();typeof Object.is==`function`&&Object.is,t.useSyncExternalStore,t.useRef,t.useEffect,t.useMemo,t.useDebugValue}));o(((e,t)=>{t.exports=BV()}))();function VV(e){e()}function HV(){let e=null,t=null;return{clear(){e=null,t=null},notify(){VV(()=>{let t=e;for(;t;)t.callback(),t=t.next})},get(){let t=[],n=e;for(;n;)t.push(n),n=n.next;return t},subscribe(n){let r=!0,i=t={callback:n,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!r||e===null||(r=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}var UV={notify(){},get:()=>[]};function WV(e,t){let n,r=UV,i=0,a=!1;function o(e){u();let t=r.subscribe(e),n=!1;return()=>{n||(n=!0,t(),d())}}function s(){r.notify()}function c(){m.onStateChange&&m.onStateChange()}function l(){return a}function u(){i++,n||(n=t?t.addNestedSub(c):e.subscribe(c),r=HV())}function d(){i--,n&&i===0&&(n(),n=void 0,r.clear(),r=UV)}function f(){a||(a=!0,u())}function p(){a&&(a=!1,d())}let m={addNestedSub:o,notifyNestedSubs:s,handleChangeWrapper:c,isSubscribed:l,trySubscribe:f,tryUnsubscribe:p,getListeners:()=>r};return m}var GV=(()=>typeof window<`u`&&window.document!==void 0&&window.document.createElement!==void 0)(),KV=(()=>typeof navigator<`u`&&navigator.product===`ReactNative`)(),qV=(()=>GV||KV?N.useLayoutEffect:N.useEffect)();Object.prototype;var JV=Symbol.for(`react-redux-context`),YV=typeof globalThis<`u`?globalThis:{};function XV(){if(!N.createContext)return{};let e=YV[JV]??=new Map,t=e.get(N.createContext);return t||(t=N.createContext(null),e.set(N.createContext,t)),t}var ZV=XV();function QV(e){let{children:t,context:n,serverState:r,store:i}=e,a=N.useMemo(()=>{let e=WV(i);return{store:i,subscription:e,getServerState:r?()=>r:void 0}},[i,r]),o=N.useMemo(()=>i.getState(),[i]);qV(()=>{let{subscription:e}=a;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),o!==i.getState()&&e.notifyNestedSubs(),()=>{e.tryUnsubscribe(),e.onStateChange=void 0}},[a,o]);let s=n||ZV;return N.createElement(s.Provider,{value:a},t)}var $V=QV,eH=L([(e,t)=>t,Yk,qP,ZP,tL,rL,Xhe,pk],tge),tH=e=>{var t=e.currentTarget.getBoundingClientRect(),n=t.width/e.currentTarget.offsetWidth,r=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/n),chartY:Math.round((e.clientY-t.top)/r)}},nH=uD(`mouseClick`),rH=JD();rH.startListening({actionCreator:nH,effect:(e,t)=>{var n=e.payload,r=eH(t.getState(),tH(n));r?.activeIndex!=null&&t.dispatch(ihe({activeIndex:r.activeIndex,activeDataKey:void 0,activeCoordinate:r.activeCoordinate}))}});var iH=uD(`mouseMove`),aH=JD();aH.startListening({actionCreator:iH,effect:(e,t)=>{var n=e.payload,r=t.getState(),i=DI(r,r.tooltip.settings.shared),a=eH(r,tH(n));i===`axis`&&(a?.activeIndex==null?t.dispatch(MI()):t.dispatch(NI({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate})))}});function oH(e,t){return t instanceof HTMLElement?`HTMLElement <${t.tagName} class="${t.className}">`:t===window?`global.window`:t}var sH={accessibilityLayer:!0,barCategoryGap:`10%`,barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:`none`,syncId:void 0,syncMethod:`index`},cH=yD({name:`rootProps`,initialState:sH,reducers:{updateOptions:(e,t)=>{e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=t.payload.barGap??sH.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),lH=cH.reducer,{updateOptions:uH}=cH.actions,dH=yD({name:`polarOptions`,initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:Zye}=dH.actions,fH=dH.reducer,pH=uD(`keyDown`),mH=uD(`focus`),hH=JD();hH.startListening({actionCreator:pH,effect:(e,t)=>{var n=t.getState();if(n.rootProps.accessibilityLayer!==!1){var{keyboardInteraction:r}=n.tooltip,i=e.payload;if(!(i!==`ArrowRight`&&i!==`ArrowLeft`&&i!==`Enter`)){var a=Number(zI(r,YI(n))),o=rL(n);if(i===`Enter`){var s=bL(n,`axis`,`hover`,String(r.index));t.dispatch(FI({active:!r.active,activeIndex:r.index,activeDataKey:r.dataKey,activeCoordinate:s}));return}var c=Xme(n)===`left-to-right`?1:-1,l=a+(i===`ArrowRight`?1:-1)*c;if(!(o==null||l>=o.length||l<0)){var u=bL(n,`axis`,`hover`,String(l));t.dispatch(FI({active:!0,activeIndex:l.toString(),activeDataKey:void 0,activeCoordinate:u}))}}}}}),hH.startListening({actionCreator:mH,effect:(e,t)=>{var n=t.getState();if(n.rootProps.accessibilityLayer!==!1){var{keyboardInteraction:r}=n.tooltip;if(!r.active&&r.index==null){var i=`0`,a=bL(n,`axis`,`hover`,String(i));t.dispatch(FI({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:a}))}}}});var gH=uD(`externalEvent`),_H=JD();_H.startListening({actionCreator:gH,effect:(e,t)=>{if(e.payload.handler!=null){var n=t.getState(),r={activeCoordinate:zhe(n),activeDataKey:uL(n),activeIndex:cL(n),activeLabel:lL(n),activeTooltipIndex:cL(n),isTooltipActive:Bhe(n)};e.payload.handler(r,e.payload.reactEvent)}}});var vH=L([UI],e=>e.tooltipItemPayloads),yH=L([vH,HI,(e,t,n)=>t,(e,t,n)=>n],(e,t,n,r)=>{var i=e.find(e=>e.settings.dataKey===r);if(i!=null){var{positions:a}=i;if(a!=null)return t(a,n)}}),bH=uD(`touchMove`),xH=JD();xH.startListening({actionCreator:bH,effect:(e,t)=>{var n=e.payload,r=t.getState(),i=DI(r,r.tooltip.settings.shared);if(i===`axis`){var a=eH(r,tH({clientX:n.touches[0].clientX,clientY:n.touches[0].clientY,currentTarget:n.currentTarget}));a?.activeIndex!=null&&t.dispatch(NI({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}else if(i===`item`){var o=n.touches[0],s=document.elementFromPoint(o.clientX,o.clientY);if(!s||!s.getAttribute)return;var c=s.getAttribute(nk),l=s.getAttribute(`data-recharts-item-data-key`)??void 0,u=yH(t.getState(),c,l);t.dispatch(jI({activeDataKey:l,activeIndex:c,activeCoordinate:u}))}}});var SH=vE({brush:zye,cartesianAxis:bve,chartData:mge,errorBars:Hve,graphicalItems:lve,layout:tO,legend:Hle,options:lge,polarAxis:j_e,polarOptions:fH,referenceElements:Sz,rootProps:lH,tooltip:ahe}),CH=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:`Chart`;return mle({reducer:SH,preloadedState:e,middleware:e=>e({serializableCheck:!1}).concat([rH.middleware,aH.middleware,hH.middleware,_H.middleware,xH.middleware]),enhancers:e=>{var t=e;return typeof e==`function`&&(t=e()),t.concat(_D({type:`raf`}))},devTools:pA.devToolsEnabled&&{serialize:{replacer:oH},name:`recharts-${t}`}})};function wH(e){var{preloadedState:t,children:n,reduxStoreName:r}=e,i=_k(),a=(0,N.useRef)(null);if(i)return n;a.current??=CH(t,r);var o=QT;return N.createElement($V,{context:o,store:a.current},n)}function TH(e){var{layout:t,margin:n}=e,r=$T(),i=_k();return(0,N.useEffect)(()=>{i||(r(QD(t)),r(ZD(n)))},[r,i,t,n]),null}function EH(e){var t=$T();return(0,N.useEffect)(()=>{t(uH(e))},[t,e]),null}var DH=[`children`];function OH(e,t){if(e==null)return{};var n,r,i=kH(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function kH(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}function AH(){return AH=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},AH.apply(null,arguments)}var jH={width:`100%`,height:`100%`,display:`block`},MH=(0,N.forwardRef)((e,t)=>{var n=qk(),r=Jk(),i=mA();if(!Pk(n)||!Pk(r))return null;var{children:a,otherAttributes:o,title:s,desc:c}=e,l=typeof o.tabIndex==`number`?o.tabIndex:i?0:void 0,u=typeof o.role==`string`?o.role:i?`application`:void 0;return N.createElement(gw,AH({},o,{title:s,desc:c,role:u,tabIndex:l,width:n,height:r,style:jH,ref:t}),a)}),NH=e=>{var{children:t}=e,n=tE(yk);if(!n)return null;var{width:r,height:i,y:a,x:o}=n;return N.createElement(gw,{width:r,height:i,x:o,y:a},t)},PH=(0,N.forwardRef)((e,t)=>{var{children:n}=e,r=OH(e,DH);return _k()?N.createElement(NH,null,n):N.createElement(MH,AH({ref:t},r),n)});function FH(){var e=$T(),[t,n]=(0,N.useState)(null),r=tE(QO);return(0,N.useEffect)(()=>{if(t!=null){var n=t.getBoundingClientRect().width/t.offsetWidth;Nk(n)&&n!==r&&e(eO(n))}},[t,e,r]),n}function IH(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function LH(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]==null?{}:arguments[t];t%2?IH(Object(n),!0).forEach(function(t){RH(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IH(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function RH(e,t,n){return(t=zH(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zH(e){var t=BH(e,`string`);return typeof t==`symbol`?t:t+``}function BH(e,t){if(typeof e!=`object`||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||`default`);if(typeof r!=`object`)return r;throw TypeError(`@@toPrimitive must return a primitive value.`)}return(t===`string`?String:Number)(e)}function VH(){return VH=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},VH.apply(null,arguments)}var HH=()=>(Cge(),null);function UH(e){if(typeof e==`number`)return e;if(typeof e==`string`){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var WH=(0,N.forwardRef)((e,t)=>{var n=(0,N.useRef)(null),[r,i]=(0,N.useState)({containerWidth:UH(e.style?.width),containerHeight:UH(e.style?.height)}),a=(0,N.useCallback)((e,t)=>{i(n=>{var r=Math.round(e),i=Math.round(t);return n.containerWidth===r&&n.containerHeight===i?n:{containerWidth:r,containerHeight:i}})},[]),o=(0,N.useCallback)(e=>{if(typeof t==`function`&&t(e),e!=null){var{width:r,height:i}=e.getBoundingClientRect();a(r,i);var o=new ResizeObserver(e=>{var{width:t,height:n}=e[0].contentRect;a(t,n)});o.observe(e),n.current=o}},[t,a]);return(0,N.useEffect)(()=>()=>{n.current?.disconnect()},[a]),N.createElement(N.Fragment,null,N.createElement(Zk,{width:r.containerWidth,height:r.containerHeight}),N.createElement(`div`,VH({ref:o},e)))}),GH=(0,N.forwardRef)((e,t)=>{var{width:n,height:r}=e,[i,a]=(0,N.useState)({containerWidth:UH(n),containerHeight:UH(r)}),o=(0,N.useCallback)((e,t)=>{a(n=>{var r=Math.round(e),i=Math.round(t);return n.containerWidth===r&&n.containerHeight===i?n:{containerWidth:r,containerHeight:i}})},[]),s=(0,N.useCallback)(e=>{if(typeof t==`function`&&t(e),e!=null){var{width:n,height:r}=e.getBoundingClientRect();o(n,r)}},[t,o]);return N.createElement(N.Fragment,null,N.createElement(Zk,{width:i.containerWidth,height:i.containerHeight}),N.createElement(`div`,VH({ref:s},e)))}),KH=(0,N.forwardRef)((e,t)=>{var{width:n,height:r}=e;return N.createElement(N.Fragment,null,N.createElement(Zk,{width:n,height:r}),N.createElement(`div`,VH({ref:t},e)))}),qH=(0,N.forwardRef)((e,t)=>{var{width:n,height:r}=e;return vT(n)||vT(r)?N.createElement(GH,VH({},e,{ref:t})):N.createElement(KH,VH({},e,{ref:t}))});function JH(e){return e===!0?WH:qH}var YH=(0,N.forwardRef)((e,t)=>{var{children:n,className:r,height:i,onClick:a,onContextMenu:o,onDoubleClick:s,onMouseDown:c,onMouseEnter:l,onMouseLeave:u,onMouseMove:d,onMouseUp:f,onTouchEnd:p,onTouchMove:m,onTouchStart:h,style:g,width:_,responsive:v,dispatchTouchEvents:y=!0}=e,b=(0,N.useRef)(null),x=$T(),[S,C]=(0,N.useState)(null),[w,T]=(0,N.useState)(null),E=FH(),D=Uk(),O=D?.width>0?D.width:_,k=D?.height>0?D.height:i,ee=(0,N.useCallback)(e=>{E(e),typeof t==`function`&&t(e),C(e),T(e),e!=null&&(b.current=e)},[E,t,C,T]),te=(0,N.useCallback)(e=>{x(nH(e)),x(gH({handler:a,reactEvent:e}))},[x,a]),ne=(0,N.useCallback)(e=>{x(iH(e)),x(gH({handler:l,reactEvent:e}))},[x,l]),A=(0,N.useCallback)(e=>{x(MI()),x(gH({handler:u,reactEvent:e}))},[x,u]),j=(0,N.useCallback)(e=>{x(iH(e)),x(gH({handler:d,reactEvent:e}))},[x,d]),re=(0,N.useCallback)(()=>{x(mH())},[x]),ie=(0,N.useCallback)(e=>{x(pH(e.key))},[x]),ae=(0,N.useCallback)(e=>{x(gH({handler:o,reactEvent:e}))},[x,o]),oe=(0,N.useCallback)(e=>{x(gH({handler:s,reactEvent:e}))},[x,s]),se=(0,N.useCallback)(e=>{x(gH({handler:c,reactEvent:e}))},[x,c]),ce=(0,N.useCallback)(e=>{x(gH({handler:f,reactEvent:e}))},[x,f]),le=(0,N.useCallback)(e=>{x(gH({handler:h,reactEvent:e}))},[x,h]),ue=(0,N.useCallback)(e=>{y&&x(bH(e)),x(gH({handler:m,reactEvent:e}))},[x,y,m]),de=(0,N.useCallback)(e=>{x(gH({handler:p,reactEvent:e}))},[x,p]),fe=JH(v);return N.createElement(TL.Provider,{value:S},N.createElement(yw.Provider,{value:w},N.createElement(fe,{width:O??g?.width,height:k??g?.height,className:cw(`recharts-wrapper`,r),style:LH({position:`relative`,cursor:`default`,width:O,height:k},g),onClick:te,onContextMenu:ae,onDoubleClick:oe,onFocus:re,onKeyDown:ie,onMouseDown:se,onMouseEnter:ne,onMouseLeave:A,onMouseMove:j,onMouseUp:ce,onTouchEnd:de,onTouchMove:ue,onTouchStart:le,ref:ee},N.createElement(HH,null),n)))}),XH=[`width`,`height`,`responsive`,`children`,`className`,`style`,`compact`,`title`,`desc`];function ZH(e,t){if(e==null)return{};var n,r,i=QH(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function QH(e,t){if(e==null)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;n[r]=e[r]}return n}var $H=(0,N.forwardRef)((e,t)=>{var{width:n,height:r,responsive:i,children:a,className:o,style:s,compact:c,title:l,desc:u}=e,d=ZH(e,XH),f=fw(d);return c?N.createElement(N.Fragment,null,N.createElement(Zk,{width:n,height:r}),N.createElement(PH,{otherAttributes:f,title:l,desc:u},a)):N.createElement(YH,{className:o,style:s,width:n,height:r,responsive:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},N.createElement(PH,{otherAttributes:f,title:l,desc:u,ref:t},N.createElement(wz,null,a)))});function eU(){return eU=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},eU.apply(null,arguments)}var tU={accessibilityLayer:!0,layout:`horizontal`,stackOffset:`none`,barCategoryGap:`10%`,barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:`index`,responsive:!1},nU=(0,N.forwardRef)(function(e,t){var n=EA(e.categoricalChartProps,tU),{chartName:r,defaultTooltipEventType:i,validateTooltipEventTypes:a,tooltipPayloadSearcher:o,categoricalChartProps:s}=e,c={chartName:r,defaultTooltipEventType:i,validateTooltipEventTypes:a,tooltipPayloadSearcher:o,eventEmitter:void 0};return N.createElement(wH,{preloadedState:{options:c},reduxStoreName:s.id??r},N.createElement(Lye,{chartData:s.data}),N.createElement(TH,{layout:n.layout,margin:n.margin}),N.createElement(EH,{accessibilityLayer:n.accessibilityLayer,barCategoryGap:n.barCategoryGap,maxBarSize:n.maxBarSize,stackOffset:n.stackOffset,barGap:n.barGap,barSize:n.barSize,syncId:n.syncId,syncMethod:n.syncMethod,className:n.className}),N.createElement($H,eU({},n,{ref:t})))}),rU=[`axis`],iU=(0,N.forwardRef)((e,t)=>N.createElement(nU,{chartName:`LineChart`,defaultTooltipEventType:`axis`,validateTooltipEventTypes:rU,tooltipPayloadSearcher:kL,categoricalChartProps:e,ref:t})),aU=[`axis`,`item`],oU=(0,N.forwardRef)((e,t)=>N.createElement(nU,{chartName:`BarChart`,defaultTooltipEventType:`axis`,validateTooltipEventTypes:aU,tooltipPayloadSearcher:kL,categoricalChartProps:e,ref:t}));function sU({subs:e}){let t=(0,N.useMemo)(()=>[...e].filter(e=>e.createdAt?.toDate).sort((e,t)=>e.createdAt.toDate().getTime()-t.createdAt.toDate().getTime()),[e]),n=(0,N.useMemo)(()=>t.map(e=>({date:cU(e.createdAt?.toDate?.()),wellbeing:e?.model?.risk==null?null:Math.round(100-e.model.risk*100),category:e?.model?.category??``})).filter(e=>e.wellbeing!=null),[t]),r=(0,N.useMemo)(()=>{let e=[...t].reverse().find(e=>e.instrumentId===`dass21`&&e.scores?.sub);return e?.scores?.sub?{stress:Math.round((e.scores.sub.stress??0)/42*100),anxiety:Math.round((e.scores.sub.anxiety??0)/42*100),depression:Math.round((e.scores.sub.depression??0)/42*100)}:null},[t]),i=(0,N.useMemo)(()=>r?[{name:`Estrs`,value:r.stress},{name:`Ansiedad`,value:r.anxiety},{name:`Depresin`,value:r.depression}]:[],[r]),a=n.length>0,o=i.length>0;return(0,I.jsxs)(`div`,{className:`row g-3`,children:[(0,I.jsx)(`div`,{className:`col-12 col-lg-6`,children:(0,I.jsxs)(`div`,{className:`border rounded-3 p-3 h-100`,children:[(0,I.jsx)(`div`,{className:`fw-semibold mb-2`,children:`Progreso de bienestar`}),a?(0,I.jsx)(`div`,{style:{width:`100%`,height:280},children:(0,I.jsx)(Wk,{children:(0,I.jsxs)(iU,{data:n,children:[(0,I.jsx)(AB,{strokeDasharray:`3 3`}),(0,I.jsx)(OV,{dataKey:`date`}),(0,I.jsx)(zV,{domain:[0,100]}),(0,I.jsx)(zL,{}),(0,I.jsx)(iA,{}),(0,I.jsx)(_V,{type:`monotone`,dataKey:`wellbeing`,name:`Bienestar`,dot:!1})]})})}):(0,I.jsx)(lU,{text:`An no hay datos suficientes para el grfico de bienestar.`}),(0,I.jsx)(`div`,{className:`small text-secondary mt-2`,children:`* Bienestar = 100  (riesgo  100). Cada punto es una evaluacin guardada.`})]})}),(0,I.jsx)(`div`,{className:`col-12 col-lg-6`,children:(0,I.jsxs)(`div`,{className:`border rounded-3 p-3 h-100`,children:[(0,I.jsx)(`div`,{className:`fw-semibold mb-2`,children:`Subescalas DASS-21 (ltima evaluacin)`}),o?(0,I.jsx)(`div`,{style:{width:`100%`,height:280},children:(0,I.jsx)(Wk,{children:(0,I.jsxs)(oU,{data:i,children:[(0,I.jsx)(AB,{strokeDasharray:`3 3`}),(0,I.jsx)(OV,{dataKey:`name`}),(0,I.jsx)(zV,{domain:[0,100]}),(0,I.jsx)(zL,{}),(0,I.jsx)(iA,{}),(0,I.jsx)(pz,{dataKey:`value`,name:`ndice (0100)`})]})})}):(0,I.jsx)(lU,{text:`An no hay una evaluacin DASS-21 para mostrar subescalas.`}),(0,I.jsx)(`div`,{className:`small text-secondary mt-2`,children:`* Normalizado respecto a 42 pts por subescala (DASS-21 2).`})]})})]})}function cU(e){return e?e.toLocaleString(void 0,{day:`2-digit`,month:`2-digit`,hour:`2-digit`,minute:`2-digit`}):``}function lU({text:e}){return(0,I.jsxs)(`div`,{className:`text-secondary py-4`,children:[(0,I.jsx)(`i`,{className:`bi bi-graph-up me-2`}),` `,e]})}function uU(){let{user:e}=QS(),[t,n]=(0,N.useState)([]),[r,i]=(0,N.useState)(null),[a,o]=(0,N.useState)(null);(0,N.useEffect)(()=>{if(!e?.uid)return;let t=Fb(XS,`users`,e.uid);return gx(t,e=>{o(e.exists()?e.data():null)})},[e?.uid]),(0,N.useEffect)(()=>{if(!e?.uid)return;let t=ax(Pb(XS,`assessments`,e.uid,`submissions`),sx(`createdAt`,`desc`));return gx(t,e=>{n(e.docs.map(e=>({id:e.id,...e.data()})))})},[e?.uid]),(0,N.useEffect)(()=>{if(!e?.uid)return;let t=Xh.now(),n=ax(Pb(XS,`users`,e.uid,`sessions`),hie(`scheduledAt`,`>=`,t),sx(`scheduledAt`,`asc`),yie(1));return gx(n,e=>{let t=e.docs[0];i(t?{id:t.id,...t.data()}:null)})},[e?.uid]);let{wellbeing:s,riskLabel:c,evalCount90d:l,nextSessionLabel:u,deltaVsWeek:d}=(0,N.useMemo)(()=>{let e=Xh.now(),n=t[0],i=n?.model?.risk??null,a=i==null?null:Math.round(100-i*100),o=(()=>{let e=n?.model?.category;return e===`low`?`Bajo`:e===`med`?`Medio`:e===`high`?`Alto`:``})(),s=t.filter(t=>{let n=t.createdAt?.toDate?.();return n&&e.toDate().getTime()-n.getTime()<=7776e6}).length,c=null;if(i!=null&&n?.createdAt?.toDate){let e=n.createdAt.toDate(),r=new Date(e.getTime()-14400*60*1e3),i=new Date(e.getTime()-5760*60*1e3),o=t.find((e,t)=>t>0&&e.createdAt?.toDate&&e.createdAt.toDate()>=r&&e.createdAt.toDate()<=i);if(o?.model?.risk!=null){let e=Math.round(100-o.model.risk*100),t=a-e;c=`${t>=0?`+`:``}${t} vs semana pasada`}}let l=r?.scheduledAt?.toDate?dU(r.scheduledAt.toDate()):``;return{wellbeing:a,riskLabel:o,evalCount90d:s,nextSessionLabel:l,deltaVsWeek:c}},[t,r]),f=(0,N.useMemo)(()=>fU(a?.name)||fU(e?.displayName??``)||fU(pU((e?.email??``).split(`@`)[0]?.replace(/[._-]/g,` `)))||`estudiante`,[a?.name,e?.displayName,e?.email]),p=(0,N.useMemo)(()=>t.filter(e=>e.createdAt?.toDate).length,[t]);return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)($oe,{}),(0,I.jsxs)(`div`,{className:`container-xxl py-4`,children:[(0,I.jsxs)(`div`,{className:`hero p-4 p-md-5 rounded-4 mb-4`,children:[(0,I.jsxs)(`div`,{className:`d-flex align-items-center gap-2`,children:[(0,I.jsx)(`span`,{className:`badge badge-soft`,children:`ML activo`}),(0,I.jsx)(`span`,{className:`badge text-bg-info`,children:`Recomendacin disponible`})]}),(0,I.jsxs)(`h2`,{className:`mt-3 mb-2`,children:[`Bienvenido/a, `,f,`.`]}),(0,I.jsx)(`p`,{className:`text-muted-2 mb-4`,children:`Monitorea tu progreso, completa evaluaciones y recibe recomendaciones personalizadas.`}),(0,I.jsxs)(`div`,{className:`d-flex flex-wrap gap-2`,children:[(0,I.jsxs)(`a`,{href:`/evaluate/dass21`,className:`btn btn-success btn-pill`,children:[(0,I.jsx)(`i`,{className:`bi bi-play-fill me-1`}),` Iniciar DASS-21`]}),(0,I.jsx)(`a`,{href:`/evaluate/pss10`,className:`btn btn-outline-primary btn-pill`,children:`PSS-10`}),(0,I.jsx)(`a`,{href:`/results`,className:`btn btn-outline-secondary btn-pill`,children:`Ver resultados`})]})]}),(0,I.jsxs)(`div`,{className:`row g-3 mb-3`,children:[(0,I.jsx)(`div`,{className:`col-12 col-sm-6 col-lg-3`,children:(0,I.jsxs)(`div`,{className:`kpi-card rounded-4 p-3 h-100`,children:[(0,I.jsxs)(`div`,{className:`d-flex align-items-center justify-content-between`,children:[(0,I.jsx)(`div`,{className:`kpi-title`,children:`ndice de bienestar`}),(0,I.jsx)(`i`,{className:`bi bi-activity text-success`})]}),(0,I.jsx)(`div`,{className:`kpi-value mt-1`,children:s==null?``:`${s}/100`}),(0,I.jsx)(`div`,{className:`kpi-hint mt-1`,children:d??``})]})}),(0,I.jsx)(`div`,{className:`col-12 col-sm-6 col-lg-3`,children:(0,I.jsxs)(`div`,{className:`kpi-card rounded-4 p-3 h-100`,children:[(0,I.jsxs)(`div`,{className:`d-flex align-items-center justify-content-between`,children:[(0,I.jsx)(`div`,{className:`kpi-title`,children:`Riesgo actual`}),(0,I.jsx)(`i`,{className:`bi bi-thermometer-half text-warning`})]}),(0,I.jsx)(`div`,{className:`kpi-value mt-1`,children:c}),(0,I.jsx)(`div`,{className:`kpi-hint mt-1`,children:`Basado en ltimas respuestas`})]})}),(0,I.jsx)(`div`,{className:`col-12 col-sm-6 col-lg-3`,children:(0,I.jsxs)(`div`,{className:`kpi-card rounded-4 p-3 h-100`,children:[(0,I.jsxs)(`div`,{className:`d-flex align-items-center justify-content-between`,children:[(0,I.jsx)(`div`,{className:`kpi-title`,children:`Evaluaciones`}),(0,I.jsx)(`i`,{className:`bi bi-check2-square text-primary`})]}),(0,I.jsx)(`div`,{className:`kpi-value mt-1`,children:String(l)}),(0,I.jsx)(`div`,{className:`kpi-hint mt-1`,children:`ltimos 90 das`})]})}),(0,I.jsx)(`div`,{className:`col-12 col-sm-6 col-lg-3`,children:(0,I.jsxs)(`div`,{className:`kpi-card rounded-4 p-3 h-100`,children:[(0,I.jsxs)(`div`,{className:`d-flex align-items-center justify-content-between`,children:[(0,I.jsx)(`div`,{className:`kpi-title`,children:`Sesiones`}),(0,I.jsx)(`i`,{className:`bi bi-calendar-event text-info`})]}),(0,I.jsx)(`div`,{className:`kpi-value mt-1`,children:r?`1`:`0`}),(0,I.jsxs)(`div`,{className:`kpi-hint mt-1`,children:[`Prx. `,u]})]})})]}),(0,I.jsx)(`div`,{className:`card card-elevated rounded-4`,children:(0,I.jsxs)(`div`,{className:`card-body`,children:[(0,I.jsxs)(`div`,{className:`d-flex align-items-center justify-content-between mb-2`,children:[(0,I.jsx)(`div`,{className:`fw-semibold`,children:`Tu progreso`}),(0,I.jsx)(`span`,{className:`badge text-bg-light`,children:p})]}),(0,I.jsx)(sU,{subs:t})]})})]})]})}function dU(e){return e.toLocaleString(void 0,{weekday:`short`,hour:`2-digit`,minute:`2-digit`})}function fU(e){if(!e)return``;let t=e.trim().split(/\s+/)[0];return pU(t)}function pU(e){return e?e.replace(/\b\w/g,e=>e.toUpperCase()):``}function mU({name:e,text:t,value:n,onChange:r,options:i,required:a=!1}){return(0,I.jsxs)(`div`,{className:`mb-4`,children:[(0,I.jsx)(`div`,{className:`fw-semibold mb-2`,children:t}),(0,I.jsx)(`div`,{className:`d-flex flex-wrap gap-3`,children:i.map(t=>{let i=`${e}-${t.value}`;return(0,I.jsxs)(`div`,{className:`form-check`,children:[(0,I.jsx)(`input`,{className:`form-check-input`,type:`radio`,name:e,id:i,value:t.value,checked:n===t.value,onChange:()=>r(t.value),required:a&&n===void 0}),(0,I.jsx)(`label`,{className:`form-check-label`,htmlFor:i,children:t.label})]},i)})})]})}const hU={id:`dass21`,version:`v1`,scale:{min:0,max:3,labels:[`Nunca`,`A veces`,`Frecuente`,`Casi siempre`]},subscales:{depression:[`d1`,`d2`,`d3`,`d4`,`d5`,`d6`,`d7`],anxiety:[`a1`,`a2`,`a3`,`a4`,`a5`,`a6`,`a7`],stress:[`s1`,`s2`,`s3`,`s4`,`s5`,`s6`,`s7`]},items:[`d1`,`d2`,`d3`,`d4`,`d5`,`d6`,`d7`,`a1`,`a2`,`a3`,`a4`,`a5`,`a6`,`a7`,`s1`,`s2`,`s3`,`s4`,`s5`,`s6`,`s7`],text:{d1:`(Depresin) Me ha resultado difcil sentirme entusiasmado/a por algo.`,d2:`(Depresin) No he podido sentir ningn sentimiento positivo.`,d3:`(Depresin) He sentido que no tena nada que esperar del futuro.`,d4:`(Depresin) He sentido que la vida no tena sentido.`,d5:`(Depresin) He tenido dificultad para tomar la iniciativa para hacer cosas.`,d6:`(Depresin) He sentido que no vala para nada.`,d7:`(Depresin) Me he sentido triste y deprimido/a.`,a1:`(Ansiedad) He sentido miedo sin motivo aparente.`,a2:`(Ansiedad) He sentido que mi corazn lata sin razn aparente (por ejemplo, aumento del ritmo cardaco o palpitaciones).`,a3:`(Ansiedad) He sentido dificultad para respirar (por ejemplo, respiracin entrecortada sin haber hecho ejercicio).`,a4:`(Ansiedad) He sentido temblores (por ejemplo, en las manos).`,a5:`(Ansiedad) He sentido que estaba al borde de una crisis de nervios.`,a6:`(Ansiedad) He sentido miedo de que me ocurriera algo terrible.`,a7:`(Ansiedad) He sentido que estaba muy nervioso/a.`,s1:`(Estrs) Me ha costado mucho relajarme.`,s2:`(Estrs) He tenido dificultad para tranquilizarme despus de haberme molestado.`,s3:`(Estrs) He sentido que estaba usando mucha energa nerviosa.`,s4:`(Estrs) He sentido que me preocupaba en exceso por situaciones que podran salirse de control.`,s5:`(Estrs) He sentido que me irritaba fcilmente.`,s6:`(Estrs) He sentido que estaba muy alterado/a.`,s7:`(Estrs) He sentido que me resultaba difcil soportar cualquier interrupcin o demora.`}};function gU(e,t){return e.reduce((e,n)=>e+(t[n]??0),0)}function _U(e){let t=gU(hU.subscales.depression,e)*2,n=gU(hU.subscales.anxiety,e)*2,r=gU(hU.subscales.stress,e)*2;return{raw:t+n+r,sub:{depression:t,anxiety:n,stress:r}}}const vU={id:`pss10`,version:`v1`,scale:{min:0,max:4,labels:[`Nunca`,`Casi nunca`,`A veces`,`A menudo`,`Muy a menudo`]},items:[`p1`,`p2`,`p3`,`p4`,`p5`,`p6`,`p7`,`p8`,`p9`,`p10`],reverse:[`p4`,`p5`,`p7`,`p8`],text:{p1:`(Estrs percibido) En el ltimo mes, con qu frecuencia ha estado afectado por algo que ocurri inesperadamente?`,p2:`(Estrs percibido) En el ltimo mes, con qu frecuencia se ha sentido incapaz de controlar las cosas importantes en su vida?`,p3:`(Estrs percibido) En el ltimo mes, con qu frecuencia se ha sentido nervioso o estresado?`,p4:`(Invertido) En el ltimo mes, con qu frecuencia ha sentido que las cosas le iban bien?`,p5:`(Invertido) En el ltimo mes, con qu frecuencia ha sentido que poda manejar los problemas molestos de su vida?`,p6:`(Estrs percibido) En el ltimo mes, con qu frecuencia ha sentido que no poda afrontar todas las cosas que tena que hacer?`,p7:`(Invertido) En el ltimo mes, con qu frecuencia ha sentido que poda controlar las dificultades que se presentaban en su vida?`,p8:`(Invertido) En el ltimo mes, con qu frecuencia ha sentido que tena todo bajo control?`,p9:`(Estrs percibido) En el ltimo mes, con qu frecuencia se ha enfadado porque las cosas estaban fuera de su control?`,p10:`(Estrs percibido) En el ltimo mes, con qu frecuencia ha sentido que las dificultades se acumulaban tanto que no poda superarlas?`}};var yU=e=>vU.reverse.includes(e);function bU(e){let t=t=>yU(t)?4-(e[t]??0):e[t]??0;return{raw:vU.items.reduce((e,n)=>e+t(n),0)}}var xU=class{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}},SU=class{refCount(e){return CU(`refCount`)}incRef(e){return CU(`incRef`)}timerAvailable(){return!0}time(e){return CU(`time`)}read(e){return CU(`read`)}readSync(e){return CU(`readSync`)}readToGPU(e,t){return CU(`readToGPU`)}numDataIds(){return CU(`numDataIds`)}disposeData(e,t){return CU(`disposeData`)}write(e,t,n){return CU(`write`)}move(e,t,n,r,i){return CU(`move`)}createTensorFromGPUData(e,t,n){return CU(`createTensorFromGPUData`)}memory(){return CU(`memory`)}floatPrecision(){return CU(`floatPrecision`)}epsilon(){return this.floatPrecision()===32?1e-7:1e-4}dispose(){return CU(`dispose`)}};function CU(e){throw Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}
/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
function wU(e){let t=e.length,n=0;for(;t>0;)n=Math.random()*t|0,t--,DU(e,t,n)}function TU(e,t,n){return Math.max(e,Math.min(t,n))}function EU(e){return e%2==0?e:e+1}function DU(e,t,n){let r=e[t];e[t]=e[n],e[n]=r}function OU(e){let t=0;for(let n=0;n<e.length;n++)t+=e[n];return t}function R(e,t){if(!e)throw Error(typeof t==`string`?t:t())}function kU(e,t,n=``){R(jU(e,t),()=>n+` Shapes ${e} and ${t} must match`)}function AU(e){R(e!=null,()=>`The input to the tensor constructor must be a non-null value.`)}function z(e){if(e.length===0)return 1;let t=e[0];for(let n=1;n<e.length;n++)t*=e[n];return t}function jU(e,t){if(e===t)return!0;if(e==null||t==null||e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function MU(e){return e%1==0}function NU(e){let t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function PU(e,t){return t<=e.length?e:e+` `.repeat(t-e.length)}function FU(e,t=e=>0,n,r){return new Promise((i,a)=>{let o=0,s=()=>{if(e()){i();return}o++;let c=t(o);if(n!=null&&o>=n){a();return}r==null?setTimeout(s,c):r(s,c)};s()})}function IU(e,t){let n=1,r=-1;for(let t=0;t<e.length;++t)if(e[t]>=0)n*=e[t];else if(e[t]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${t}`);r=t}else if(e[t]<0)throw Error(`Shapes can not be < 0. Found ${e[t]} at dim ${t}`);if(r===-1){if(t>0&&t!==n)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(n===0)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${n}`);let i=e.slice();return i[r]=t/n,i}function LU(e,t){let n=t.length;return e=e==null?t.map((e,t)=>t):[].concat(e),R(e.every(e=>e>=-n&&e<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${e}`),R(e.every(e=>MU(e)),()=>`All values in axis param must be integers but got axis ${e}`),e.map(e=>e<0?n+e:e)}function RU(e,t){let n=[],r=[],i=t!=null&&Array.isArray(t)&&t.length===0,a=t==null||i?null:LU(t,e).sort(),o=0;for(let t=0;t<e.length;++t){if(a!=null){if(a[o]===t&&e[t]!==1)throw Error(`Can't squeeze axis ${t} since its dim '${e[t]}' is not 1`);(a[o]==null||a[o]>t)&&e[t]===1&&(n.push(e[t]),r.push(t)),a[o]<=t&&o++}e[t]!==1&&(n.push(e[t]),r.push(t))}return{newShape:n,keptDims:r}}function zU(e,t){return BU(e,t)}function BU(e,t){let n=null;if(e==null||e===`float32`)n=new Float32Array(t);else if(e===`int32`)n=new Int32Array(t);else if(e===`bool`)n=new Uint8Array(t);else if(e===`string`)n=Array(t);else throw Error(`Unknown data type ${e}`);return n}function VU(e,t){for(let n=0;n<e.length;n++){let r=e[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${t} being uploaded contains ${r}.`)}}function HU(e){return e===`bool`||e===`complex64`||e===`float32`||e===`int32`||e===`string`}function UU(e,t){return!(t===`complex64`||t===`float32`&&e!==`complex64`||t===`int32`&&e!==`float32`&&e!==`complex64`||t===`bool`&&e===`bool`)}function WU(e){if(e===`float32`||e===`int32`)return 4;if(e===`complex64`)return 8;if(e===`bool`)return 1;throw Error(`Unknown dtype ${e}`)}function GU(e){if(e==null)return 0;let t=0;return e.forEach(e=>t+=e.length),t}function KU(e){return typeof e==`string`||e instanceof String}function qU(e){return typeof e==`boolean`}function JU(e){return typeof e==`number`}function YU(e){return Array.isArray(e)?YU(e[0]):e instanceof Float32Array?`float32`:e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?`int32`:JU(e)?`float32`:KU(e)?`string`:qU(e)?`bool`:`float32`}function XU(e){return!!(e&&e.constructor&&e.call&&e.apply)}function ZU(e,t){for(let n=t;n<e;++n)if(e%n===0)return n;return e}function QU(e){let t=e.length;if(t<2)return[];let n=Array(t-1);n[t-2]=e[t-1];for(let r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function $U(e,t,n,r=!1){let i=[];if(t.length===1){let a=t[0]*(r?2:1);for(let t=0;t<a;t++)i[t]=n[e+t]}else{let a=t[0],o=t.slice(1),s=o.reduce((e,t)=>e*t)*(r?2:1);for(let t=0;t<a;t++)i[t]=$U(e+t*s,o,n,r)}return i}function eW(e,t,n=!1){if(e.length===0)return t[0];let r=e.reduce((e,t)=>e*t)*(n?2:1);if(r===0)return[];if(r!==t.length)throw Error(`[${e}] does not match the input size ${t.length}${n?` for a complex tensor`:``}.`);return $U(0,e,t,n)}function tW(e,t){if(Array.isArray(e))return e;if(t===`float32`)return e instanceof Float32Array?e:new Float32Array(e);if(t===`int32`)return e instanceof Int32Array?e:new Int32Array(e);if(t===`bool`||t===`string`)return Uint8Array.from(new Int32Array(e));throw Error(`Unknown dtype ${t}`)}function nW(e,t){let n=rW(e,t);for(let e=0;e<n.length;e++)n[e]=1;return n}function rW(e,t){if(t==null||t===`float32`||t===`complex64`)return new Float32Array(e);if(t===`int32`)return new Int32Array(e);if(t===`bool`)return new Uint8Array(e);throw Error(`Unknown data type ${t}`)}function iW(e,t){let n=e.reduce((e,t)=>e*t,1);if(t==null||t===`float32`)return eW(e,new Float32Array(n));if(t===`int32`)return eW(e,new Int32Array(n));if(t===`bool`)return eW(e,new Uint8Array(n));throw Error(`Unknown data type ${t}`)}function aW(e){e.forEach(t=>{R(Number.isInteger(t)&&t>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`)})}function oW(e,t,n){if(t===0)return 0;if(t===1)return e[0];let r=e[e.length-1];for(let t=0;t<e.length-1;++t)r+=n[t]*e[t];return r}function sW(e,t,n){if(t===0)return[];if(t===1)return[e];let r=Array(t);for(let t=0;t<r.length-1;++t)r[t]=Math.floor(e/n[t]),e-=r[t]*n[t];return r[r.length-1]=e,r}function cW(e){return e&&e.then&&typeof e.then==`function`}var lW=`tfjsflags`,uW=class{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=dW,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(B().getBool(`IS_TEST`)||B().getBool(`PROD`)||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},this.urlFlags[e]!=null){let t=this.urlFlags[e];B().getBool(`IS_TEST`)||B().getBool(`PROD`)||console.warn(`Setting feature override from URL ${e}: ${t}.`),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];let t=this.evaluateFlag(e);if(cW(t))throw Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(this.global===void 0||this.global.location===void 0||this.global.location.search===void 0)return;let e=this.getQueryParams(this.global.location.search);lW in e&&e[lW].split(`,`).forEach(e=>{let[t,n]=e.split(`:`);this.urlFlags[t]=pW(t,n)})}};function dW(e){let t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(e,...n)=>(fW(t,n[0],n[1]),n.join(`=`))),t}function fW(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||``)}function pW(e,t){let n=t.toLowerCase();return n===`true`||n===`false`?n===`true`:`${+n}`===n?+n:t}function B(){return mW}let mW=null;function hW(e){mW=e}
/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var gW;function _W(){if(gW==null){let e;if(typeof window<`u`)e=window;else if(typeof global<`u`)e=global;else if(typeof process<`u`)e=process;else if(typeof self<`u`)e=self;else throw Error(`Could not find a global object`);gW=e}return gW}function Qye(){let e=_W();return e._tfGlobals??=new Map,e._tfGlobals}function vW(e,t){let n=Qye();if(n.has(e))return n.get(e);{let r=t();return n.set(e,r),n.get(e)}}const yW=`Acos`,bW=`Acosh`,xW=`AddN`,SW=`ArgMax`,CW=`ArgMin`,wW=`Asin`,TW=`Asinh`,EW=`Atan`,DW=`Atanh`,OW=`Atan2`,kW=`AvgPool`,AW=`AvgPoolGrad`,jW=`AvgPool3D`,MW=`AvgPool3DGrad`,NW=`BatchMatMul`,PW=`BatchToSpaceND`,FW=`Bincount`,IW=`BitwiseAnd`,LW=`BroadcastArgs`,RW=`Cast`,zW=`Ceil`,BW=`ClipByValue`,VW=`Complex`,HW=`ComplexAbs`,UW=`Concat`,WW=`Conv2D`,GW=`Conv2DBackpropFilter`,KW=`Conv2DBackpropInput`,qW=`Conv3D`,JW=`Conv3DBackpropFilterV2`,YW=`Conv3DBackpropInputV2`,XW=`Cosh`,ZW=`Cumprod`,QW=`Cumsum`,$W=`CropAndResize`,eG=`DenseBincount`,tG=`DepthToSpace`,nG=`DepthwiseConv2dNative`,rG=`DepthwiseConv2dNativeBackpropFilter`,iG=`DepthwiseConv2dNativeBackpropInput`,aG=`Diag`,oG=`Dilation2D`,sG=`Dilation2DBackpropInput`,cG=`Dilation2DBackpropFilter`,lG=`RealDiv`,uG=`Einsum`,dG=`EluGrad`,fG=`Equal`,pG=`ExpandDims`,mG=`Expm1`,hG=`Fill`,gG=`FlipLeftRight`,_G=`Floor`,vG=`FloorDiv`,yG=`FusedBatchNorm`,bG=`GatherV2`,xG=`GatherNd`,SG=`Greater`,CG=`GreaterEqual`,wG=`Identity`,TG=`IFFT`,EG=`Imag`,DG=`IsFinite`,OG=`IsInf`,kG=`IsNan`,AG=`LeakyRelu`,jG=`Less`,MG=`LessEqual`,NG=`LinSpace`,PG=`Log1p`,FG=`LogicalAnd`,IG=`LogicalNot`,LG=`LogicalOr`,RG=`LRNGrad`,zG=`Maximum`,BG=`MaxPool`,VG=`MaxPoolGrad`,HG=`MaxPool3D`,UG=`MaxPool3DGrad`,WG=`MaxPoolWithArgmax`,GG=`Mean`,KG=`Minimum`,qG=`MirrorPad`,JG=`Multinomial`,YG=`Multiply`,XG=`NotEqual`,ZG=`NonMaxSuppressionV3`,QG=`NonMaxSuppressionV4`,$G=`NonMaxSuppressionV5`,eK=`OnesLike`,tK=`OneHot`,nK=`Pack`,rK=`PadV2`,iK=`Prelu`,aK=`Prod`,oK=`RaggedGather`,sK=`RaggedRange`,cK=`RaggedTensorToTensor`,lK=`Range`,uK=`Real`,dK=`Reciprocal`,fK=`Relu`,pK=`Reshape`,mK=`ResizeNearestNeighbor`,hK=`ResizeNearestNeighborGrad`,gK=`ResizeBilinear`,_K=`ResizeBilinearGrad`,vK=`Relu6`,yK=`Reverse`,bK=`Round`,xK=`Rsqrt`,SK=`ScatterNd`,CK=`TensorScatterUpdate`,wK=`SearchSorted`,TK=`Select`,EK=`Selu`,DK=`Slice`,OK=`Sinh`,kK=`Sign`,AK=`Sigmoid`,jK=`Softplus`,MK=`Sqrt`,NK=`SpaceToBatchND`,PK=`SplitV`,FK=`Softmax`,IK=`SparseFillEmptyRows`,LK=`SparseReshape`,RK=`SparseSegmentMean`,zK=`SparseSegmentSum`,BK=`SparseToDense`,VK=`SquaredDifference`,HK=`Square`,UK=`StaticRegexReplace`,WK=`StridedSlice`,GK=`StringNGrams`,KK=`StringSplit`,qK=`StringToHashBucketFast`,JK=`Tanh`,YK=`Tile`,XK=`TopK`,ZK=`Transform`,QK=`Transpose`,$K=`Unique`,eq=`Unpack`,tq=`UnsortedSegmentSum`,nq=`ZerosLike`,rq=`Step`,iq=`RotateWithOffset`,aq=`_FusedMatMul`,oq=`FusedConv2D`,sq=`FusedDepthwiseConv2D`;function cq(...e){B().getBool(`IS_TEST`)||B().getBool(`PROD`)||console.warn(...e)}function $ye(...e){B().getBool(`IS_TEST`)||B().getBool(`PROD`)||console.log(...e)}var lq=vW(`kernelRegistry`,()=>new Map),uq=vW(`gradRegistry`,()=>new Map);function dq(e,t){let n=hq(e,t);return lq.get(n)}function fq(e){return uq.get(e)}function pq(e){let t=lq.entries(),n=[];for(;;){let{done:r,value:i}=t.next();if(r)break;let[a,o]=i,[s]=a.split(`_`);s===e&&n.push(o)}return n}function mq(e){let{kernelName:t,backendName:n}=e,r=hq(t,n);lq.has(r)&&cq(`The kernel '${t}' for backend '${n}' is already registered`),lq.set(r,e)}function ebe(e){let{kernelName:t}=e;uq.has(t)&&B().getBool(`DEBUG`)&&cq(`Overriding the gradient for '${t}'`),uq.set(t,e)}function hq(e,t){return`${t}_${e}`}
/**
* @license
* Copyright 2023 Google LLC.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
function gq(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}var _q=l(o(((e,t)=>{t.exports=r;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function r(e,t,n){this.low=e|0,this.high=t|0,this.unsigned=!!n}r.prototype.__isLong__,Object.defineProperty(r.prototype,`__isLong__`,{value:!0});function i(e){return(e&&e.__isLong__)===!0}r.isLong=i;var a={},o={};function s(e,t){var n,r,i;return t?(e>>>=0,(i=0<=e&&e<256)&&(r=o[e],r)?r:(n=l(e,(e|0)<0?-1:0,!0),i&&(o[e]=n),n)):(e|=0,(i=-128<=e&&e<128)&&(r=a[e],r)?r:(n=l(e,e<0?-1:0,!1),i&&(a[e]=n),n))}r.fromInt=s;function c(e,t){if(isNaN(e))return t?b:y;if(t){if(e<0)return b;if(e>=g)return T}else{if(e<=-_)return E;if(e+1>=_)return w}return e<0?c(-e,t).neg():l(e%h|0,e/h|0,t)}r.fromNumber=c;function l(e,t,n){return new r(e,t,n)}r.fromBits=l;var u=Math.pow;function d(e,t,n){if(e.length===0)throw Error(`empty string`);if(e===`NaN`||e===`Infinity`||e===`+Infinity`||e===`-Infinity`)return y;if(typeof t==`number`?(n=t,t=!1):t=!!t,n||=10,n<2||36<n)throw RangeError(`radix`);var r;if((r=e.indexOf(`-`))>0)throw Error(`interior hyphen`);if(r===0)return d(e.substring(1),t,n).neg();for(var i=c(u(n,8)),a=y,o=0;o<e.length;o+=8){var s=Math.min(8,e.length-o),l=parseInt(e.substring(o,o+s),n);if(s<8){var f=c(u(n,s));a=a.mul(f).add(c(l))}else a=a.mul(i),a=a.add(c(l))}return a.unsigned=t,a}r.fromString=d;function f(e,t){return typeof e==`number`?c(e,t):typeof e==`string`?d(e,t):l(e.low,e.high,typeof t==`boolean`?t:e.unsigned)}r.fromValue=f;var p=65536,m=1<<24,h=p*p,g=h*h,_=g/2,v=s(m),y=s(0);r.ZERO=y;var b=s(0,!0);r.UZERO=b;var x=s(1);r.ONE=x;var S=s(1,!0);r.UONE=S;var C=s(-1);r.NEG_ONE=C;var w=l(-1,2147483647,!1);r.MAX_VALUE=w;var T=l(-1,-1,!0);r.MAX_UNSIGNED_VALUE=T;var E=l(0,-2147483648,!1);r.MIN_VALUE=E;var D=r.prototype;D.toInt=function(){return this.unsigned?this.low>>>0:this.low},D.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},D.toString=function(e){if(e||=10,e<2||36<e)throw RangeError(`radix`);if(this.isZero())return`0`;if(this.isNegative())if(this.eq(E)){var t=c(e),n=this.div(t),r=n.mul(t).sub(this);return n.toString(e)+r.toInt().toString(e)}else return`-`+this.neg().toString(e);for(var i=c(u(e,6),this.unsigned),a=this,o=``;;){var s=a.div(i),l=(a.sub(s.mul(i)).toInt()>>>0).toString(e);if(a=s,a.isZero())return l+o;for(;l.length<6;)l=`0`+l;o=``+l+o}},D.getHighBits=function(){return this.high},D.getHighBitsUnsigned=function(){return this.high>>>0},D.getLowBits=function(){return this.low},D.getLowBitsUnsigned=function(){return this.low>>>0},D.getNumBitsAbs=function(){if(this.isNegative())return this.eq(E)?64:this.neg().getNumBitsAbs();for(var e=this.high==0?this.low:this.high,t=31;t>0&&!(e&1<<t);t--);return this.high==0?t+1:t+33},D.isZero=function(){return this.high===0&&this.low===0},D.eqz=D.isZero,D.isNegative=function(){return!this.unsigned&&this.high<0},D.isPositive=function(){return this.unsigned||this.high>=0},D.isOdd=function(){return(this.low&1)==1},D.isEven=function(){return(this.low&1)==0},D.equals=function(e){return i(e)||(e=f(e)),this.unsigned!==e.unsigned&&this.high>>>31==1&&e.high>>>31==1?!1:this.high===e.high&&this.low===e.low},D.eq=D.equals,D.notEquals=function(e){return!this.eq(e)},D.neq=D.notEquals,D.ne=D.notEquals,D.lessThan=function(e){return this.comp(e)<0},D.lt=D.lessThan,D.lessThanOrEqual=function(e){return this.comp(e)<=0},D.lte=D.lessThanOrEqual,D.le=D.lessThanOrEqual,D.greaterThan=function(e){return this.comp(e)>0},D.gt=D.greaterThan,D.greaterThanOrEqual=function(e){return this.comp(e)>=0},D.gte=D.greaterThanOrEqual,D.ge=D.greaterThanOrEqual,D.compare=function(e){if(i(e)||(e=f(e)),this.eq(e))return 0;var t=this.isNegative(),n=e.isNegative();return t&&!n?-1:!t&&n?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},D.comp=D.compare,D.negate=function(){return!this.unsigned&&this.eq(E)?E:this.not().add(x)},D.neg=D.negate,D.add=function(e){i(e)||(e=f(e));var t=this.high>>>16,n=this.high&65535,r=this.low>>>16,a=this.low&65535,o=e.high>>>16,s=e.high&65535,c=e.low>>>16,u=e.low&65535,d=0,p=0,m=0,h=0;return h+=a+u,m+=h>>>16,h&=65535,m+=r+c,p+=m>>>16,m&=65535,p+=n+s,d+=p>>>16,p&=65535,d+=t+o,d&=65535,l(m<<16|h,d<<16|p,this.unsigned)},D.subtract=function(e){return i(e)||(e=f(e)),this.add(e.neg())},D.sub=D.subtract,D.multiply=function(e){if(this.isZero())return y;if(i(e)||(e=f(e)),n){var t=n.mul(this.low,this.high,e.low,e.high);return l(t,n.get_high(),this.unsigned)}if(e.isZero())return y;if(this.eq(E))return e.isOdd()?E:y;if(e.eq(E))return this.isOdd()?E:y;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(v)&&e.lt(v))return c(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,a=this.high&65535,o=this.low>>>16,s=this.low&65535,u=e.high>>>16,d=e.high&65535,p=e.low>>>16,m=e.low&65535,h=0,g=0,_=0,b=0;return b+=s*m,_+=b>>>16,b&=65535,_+=o*m,g+=_>>>16,_&=65535,_+=s*p,g+=_>>>16,_&=65535,g+=a*m,h+=g>>>16,g&=65535,g+=o*p,h+=g>>>16,g&=65535,g+=s*d,h+=g>>>16,g&=65535,h+=r*m+a*p+o*d+s*u,h&=65535,l(_<<16|b,h<<16|g,this.unsigned)},D.mul=D.multiply,D.divide=function(e){if(i(e)||(e=f(e)),e.isZero())throw Error(`division by zero`);if(n){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,e.low,e.high);return l(t,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?b:y;var r,a,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return b;if(e.gt(this.shru(1)))return S;o=b}else{if(this.eq(E))return e.eq(x)||e.eq(C)?E:e.eq(E)?x:(r=this.shr(1).div(e).shl(1),r.eq(y)?e.isNegative()?x:C:(a=this.sub(e.mul(r)),o=r.add(a.div(e)),o));if(e.eq(E))return this.unsigned?b:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=y}for(a=this;a.gte(e);){r=Math.max(1,Math.floor(a.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(r)/Math.LN2),d=s<=48?1:u(2,s-48),p=c(r),m=p.mul(e);m.isNegative()||m.gt(a);)r-=d,p=c(r,this.unsigned),m=p.mul(e);p.isZero()&&(p=x),o=o.add(p),a=a.sub(m)}return o},D.div=D.divide,D.modulo=function(e){if(i(e)||(e=f(e)),n){var t=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,e.low,e.high);return l(t,n.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))},D.mod=D.modulo,D.rem=D.modulo,D.not=function(){return l(~this.low,~this.high,this.unsigned)},D.and=function(e){return i(e)||(e=f(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},D.or=function(e){return i(e)||(e=f(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},D.xor=function(e){return i(e)||(e=f(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},D.shiftLeft=function(e){return i(e)&&(e=e.toInt()),(e&=63)==0?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},D.shl=D.shiftLeft,D.shiftRight=function(e){return i(e)&&(e=e.toInt()),(e&=63)==0?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},D.shr=D.shiftRight,D.shiftRightUnsigned=function(e){if(i(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var n=this.low;return l(n>>>e|t<<32-e,t>>>e,this.unsigned)}else if(e===32)return l(t,0,this.unsigned);else return l(t>>>e-32,0,this.unsigned)},D.shru=D.shiftRightUnsigned,D.shr_u=D.shiftRightUnsigned,D.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},D.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},D.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},D.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]},D.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}}))()),vq=_q.default||_q;function yq(e){return vq.fromString(e,!0,16)}var bq=yq(`c3a5c85c97cb3127`),xq=yq(`b492b66fbe98f273`),Sq=yq(`9ae16a3b2f90404f`);function Cq(e){return e.xor(e.shru(47))}function wq(e,t,n){let r=e.slice(t,t+n);return vq.fromBytes(Array.from(r),!0,!0)}function Tq(e,t){return wq(e,t,8)}function Eq(e,t){return wq(e,t,4)}function Dq(e,t){return t===0?e:e.shru(t).or(e.shl(64-t))}function Oq(e,t,n=yq(`9ddfea08eb382d69`)){let r=e.xor(t).mul(n);r=r.xor(r.shru(47));let i=t.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function tbe(e,t,n,r,i,a){i=i.add(e),a=Dq(a.add(i).add(r),21);let o=i;return i=i.add(t),i=i.add(n),a=a.add(Dq(i,44)),[i.add(r),a.add(o)]}function kq(e,t,n,r){return tbe(Tq(e,t),Tq(e,t+8),Tq(e,t+16),Tq(e,t+24),n,r)}function nbe(e,t=e.length){if(t>=8){let n=Sq.add(t*2),r=Tq(e,0).add(Sq),i=Tq(e,t-8),a=Dq(i,37).mul(n).add(r),o=Dq(r,25).add(i).mul(n);return Oq(a,o,n)}if(t>=4){let n=Sq.add(t*2),r=Eq(e,0);return Oq(r.shl(3).add(t),Eq(e,t-4),n)}if(t>0){let n=e[0],r=e[t>>1],i=e[t-1],a=n+(r<<8),o=t+(i<<2);return Cq(Sq.mul(a).xor(bq.mul(o))).mul(Sq)}return Sq}function rbe(e,t=e.length){let n=Sq.add(t*2),r=Tq(e,0).mul(xq),i=Tq(e,8),a=Tq(e,t-8).mul(n),o=Tq(e,t-16).mul(Sq);return Oq(Dq(r.add(i),43).add(Dq(a,30)).add(o),r.add(Dq(i.add(Sq),18)).add(a),n)}function ibe(e,t=e.length){let n=Sq.add(t*2),r=Tq(e,0).mul(Sq),i=Tq(e,8),a=Tq(e,t-8).mul(n),o=Tq(e,t-16).mul(Sq),s=Dq(r.add(i),43).add(Dq(a,30)).add(o),c=Oq(s,r.add(Dq(i.add(Sq),18)).add(a),n),l=Tq(e,16).mul(n),u=Tq(e,24),d=s.add(Tq(e,t-32)).mul(n),f=c.add(Tq(e,t-24)).mul(n);return Oq(Dq(l.add(u),43).add(Dq(d,30)).add(f),l.add(Dq(u.add(r),18)).add(d),n)}function abe(e,t=e.length){let n=vq.fromNumber(81,!0);if(t<=32)return t<=16?nbe(e,t):rbe(e,t);if(t<=64)return ibe(e,t);let r=n,i=n.mul(xq).add(113),a=Cq(i.mul(Sq).add(113)).mul(Sq),o=[vq.UZERO,vq.UZERO],s=[vq.UZERO,vq.UZERO];r=r.mul(Sq).add(Tq(e,0));let c=0,l=(t-1>>6)*64,u=l+(t-1&63)-63;do r=Dq(r.add(i).add(o[0]).add(Tq(e,c+8)),37).mul(xq),i=Dq(i.add(o[1]).add(Tq(e,c+48)),42).mul(xq),r=r.xor(s[1]),i=i.add(o[0]).add(Tq(e,c+40)),a=Dq(a.add(s[0]),33).mul(xq),o=kq(e,c,o[1].mul(xq),r.add(s[0])),s=kq(e,c+32,a.add(s[1]),i.add(Tq(e,c+16))),[a,r]=[r,a],c+=64;while(c!==l);let d=xq.add(a.and(255).shl(1));return c=u,s[0]=s[0].add(t-1&63),o[0]=o[0].add(s[0]),s[0]=s[0].add(o[0]),r=Dq(r.add(i).add(o[0]).add(Tq(e,c+8)),37).mul(d),i=Dq(i.add(o[1]).add(Tq(e,c+48)),42).mul(d),r=r.xor(s[1].mul(9)),i=i.add(o[0].mul(9).add(Tq(e,c+40))),a=Dq(a.add(s[0]),33).mul(d),o=kq(e,c,o[1].mul(d),r.add(s[0])),s=kq(e,c+32,a.add(s[1]),i.add(Tq(e,c+16))),[a,r]=[r,a],Oq(Oq(o[0],s[0],d).add(Cq(i).mul(bq)).add(a),Oq(o[1],s[1],d).add(r),d)}function Aq(e,t){return t===`string`?Nq(e):jq([e],t)}function obe(e,t){return e instanceof Float32Array&&t===`float32`||e instanceof Int32Array&&t===`int32`||e instanceof Uint8Array&&t===`bool`}function jq(e,t){if(t===`string`)throw Error(`Cannot convert a string[] to a TypedArray`);if(Array.isArray(e)&&(e=Iq(e)),B().getBool(`DEBUG`)&&VU(e,t),obe(e,t))return e;if(t==null||t===`float32`||t===`complex64`)return new Float32Array(e);if(t===`int32`)return new Int32Array(e);if(t===`bool`){let t=new Uint8Array(e.length);for(let n=0;n<t.length;++n)Math.round(e[n])!==0&&(t[n]=1);return t}else throw Error(`Unknown data type ${t}`)}function Mq(){return B().platform.now()}function Nq(e,t=`utf-8`){return t||=`utf-8`,B().platform.encode(e,t)}function Pq(e,t=`utf-8`){return t||=`utf-8`,B().platform.decode(e,t)}function Fq(e){return B().platform.isTypedArray==null?gq(e):B().platform.isTypedArray(e)}function Iq(e,t=[],n=!1){if(t??=[],typeof e==`boolean`||typeof e==`number`||typeof e==`string`||cW(e)||e==null||Fq(e)&&n)t.push(e);else if(Array.isArray(e)||Fq(e))for(let r=0;r<e.length;++r)Iq(e[r],t,n);else{let r=-1;for(let t of Object.keys(e))/^([1-9]+[0-9]*|0)$/.test(t)&&(r=Math.max(r,Number(t)));for(let i=0;i<=r;i++)Iq(e[i],t,n)}return t}var sbe=class{constructor(e,t){this.backendTimer=e,this.logger=t,t??(this.logger=new lbe)}profileKernel(e,t,n){let r,i=()=>{r=n()},a,o=Mq();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(i);else{i();for(let e of r)e.dataSync();a=Promise.resolve({kernelMs:Mq()-o})}if(B().getBool(`CHECK_COMPUTATION_FOR_ERRORS`))for(let t=0;t<r.length;t++){let n=r[t];n.data().then(t=>{cbe(t,n.dtype,e)})}return{kernelName:e,outputs:r,inputs:t,timeMs:a.then(e=>e.kernelMs),extraInfo:a.then(e=>e.getExtraProfileInfo==null?``:e.getExtraProfileInfo())}}logKernelProfile(e){let{kernelName:t,outputs:n,timeMs:r,inputs:i,extraInfo:a}=e;n.forEach(e=>{Promise.all([e.data(),r,a]).then(n=>{this.logger.logKernelProfile(t,e,n[0],n[1],i,n[2])})})}};function cbe(e,t,n){if(t!==`float32`)return!1;for(let t=0;t<e.length;t++){let r=e[t];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}var lbe=class{logKernelProfile(e,t,n,r,i,a){let o=typeof r==`number`?PU(`${r}ms`,9):r.error,s=PU(e,25),c=t.rank,l=t.size,u=PU(t.shape.toString(),14),d=``;for(let e in i){let n=i[e];if(n!=null){let r=n.shape||t.shape,i=r.length;d+=`${e}: ${i}D ${i>0?r:``} `}}console.log(`%c${s}\t%c${o}\t%c${c}D ${u}\t%c${l}\t%c${d}\t%c${a}`,`font-weight:bold`,`color:red`,`color:blue`,`color: orange`,`color: green`,`color: steelblue`)}};function ube(e,t,n){let r={},i={};for(let e=0;e<t.length;e++)r[t[e].id]=!0;for(let n=0;n<e.length;n++){let a=e[n],o=a.inputs;for(let e in o){let n=o[e],s=!1;for(let e=0;e<t.length;e++)if(r[n.id]){a.outputs.forEach(e=>r[e.id]=!0),s=!0,i[a.id]=!0;break}if(s)break}}let a={};a[n.id]=!0;let o={};for(let t=e.length-1;t>=0;t--){let n=e[t],r=n.inputs;for(let e=0;e<n.outputs.length;e++)if(a[n.outputs[e].id]){for(let e in r)a[r[e].id]=!0,o[n.id]=!0;break}}let s=[];for(let t=0;t<e.length;t++){let n=e[t];if(i[n.id]&&o[n.id]){let e={};for(let t in n.inputs){let i=n.inputs[t];r[i.id]&&(e[t]=i)}let t=Object.assign({},n);t.inputs=e,t.outputs=n.outputs,s.push(t)}}return s}function dbe(e,t,n,r){for(let i=t.length-1;i>=0;i--){let a=t[i],o=[];if(a.outputs.forEach(t=>{let n=e[t.id];n==null?o.push(null):o.push(n)}),a.gradient==null)throw Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);let s=a.gradient(o);for(let t in a.inputs){if(!(t in s))throw Error(`Cannot backprop through input ${t}. Available gradients found: ${Object.keys(s)}.`);let i=n(()=>s[t]());if(i.dtype!==`float32`)throw Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${t} must have 'float32' dtype, but has '${i.dtype}'`);let o=a.inputs[t];if(!jU(i.shape,o.shape))throw Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${t}' has shape '${i.shape}', which does not match the shape of the input '${o.shape}'`);if(e[o.id]==null)e[o.id]=i;else{let t=e[o.id];e[o.id]=r(t,i),t.dispose()}}}}var Lq=20,Rq=3,zq=7;function fbe(e,t,n,r){let i=QU(t),a=pbe(e,t,n,i),o=t.length,s=Hq(e,t,n,i,a),c=[`Tensor`];return r&&(c.push(`  dtype: ${n}`),c.push(`  rank: ${o}`),c.push(`  shape: [${t}]`),c.push(`  values:`)),c.push(s.map(e=>`    `+e).join(`
`)),c.join(`
`)}function pbe(e,t,n,r){let i=z(t),a=r[r.length-1],o=Array(a).fill(0),s=t.length,c=n===`complex64`?Uq(e):e;if(s>1)for(let e=0;e<i/a;e++){let t=e*a;for(let e=0;e<a;e++)o[e]=Math.max(o[e],Bq(c[t+e],0,n).length)}return o}function Bq(e,t,n){let r;return r=Array.isArray(e)?`${parseFloat(e[0].toFixed(zq))} + ${parseFloat(e[1].toFixed(zq))}j`:KU(e)?`'${e}'`:n===`bool`?Vq(e):parseFloat(e.toFixed(zq)).toString(),PU(r,t)}function Vq(e){return e===0?`false`:`true`}function Hq(e,t,n,r,i,a=!0){let o=n===`complex64`?2:1,s=t[0],c=t.length;if(c===0){if(n===`complex64`){let t=Uq(e);return[Bq(t[0],0,n)]}return n===`bool`?[Vq(e[0])]:[e[0].toString()]}if(c===1){if(s>Lq){let t=Rq*o,r=Array.from(e.slice(0,t)),a=Array.from(e.slice((s-Rq)*o,s*o));return n===`complex64`&&(r=Uq(r),a=Uq(a)),[`[`+r.map((e,t)=>Bq(e,i[t],n)).join(`, `)+`, ..., `+a.map((e,t)=>Bq(e,i[s-Rq+t],n)).join(`, `)+`]`]}return[`[`+(n===`complex64`?Uq(e):Array.from(e)).map((e,t)=>Bq(e,i[t],n)).join(`, `)+`]`]}let l=t.slice(1),u=r.slice(1),d=r[0]*o,f=[];if(s>Lq){for(let t=0;t<Rq;t++){let r=t*d,a=r+d;f.push(...Hq(e.slice(r,a),l,n,u,i,!1))}f.push(`...`);for(let t=s-Rq;t<s;t++){let r=t*d,a=r+d;f.push(...Hq(e.slice(r,a),l,n,u,i,t===s-1))}}else for(let t=0;t<s;t++){let r=t*d,a=r+d;f.push(...Hq(e.slice(r,a),l,n,u,i,t===s-1))}let p=c===2?`,`:``;f[0]=`[`+(s>0?f[0]+p:``);for(let e=1;e<f.length-1;e++)f[e]=` `+f[e]+p;let m=`,
`;for(let e=2;e<c;e++)m+=`
`;return f[f.length-1]=` `+f[f.length-1]+`]`+(a?``:m),f}function Uq(e){let t=[];for(let n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var Wq=class{constructor(e,t,n){if(this.dtype=t,this.shape=e.slice(),this.size=z(e),n!=null){let e=n.length;R(e===this.size,()=>`Length of values '${e}' does not match the size inferred by the shape '${this.size}'.`)}if(t===`complex64`)throw Error(`complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).`);this.values=n||BU(t,this.size),this.strides=QU(e)}set(e,...t){t.length===0&&(t=[0]),R(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);let n=this.locToIndex(t);this.values[n]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(let n of e){if(n<0||n>=this.shape[t]){let t=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw Error(t)}t++}let n=e[e.length-1];for(let t=0;t<e.length-1;++t)n+=this.strides[t]*e[t];return this.values[n]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];let t=Array(this.shape.length);for(let n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Gq().makeTensor(this.values,this.shape,this.dtype)}},Gq=null,Kq=null;function mbe(e){Gq=e}function hbe(e){Kq=e}var qq=class{constructor(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||`float32`,this.size=z(e),this.strides=QU(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():`higher`}get rank(){return this.shape.length}async buffer(){let e=await this.data();return Kq.buffer(this.shape,this.dtype,e)}bufferSync(){return Kq.buffer(this.shape,this.dtype,this.dataSync())}async array(){let e=await this.data();return eW(this.shape,e,this.dtype===`complex64`)}arraySync(){return eW(this.shape,this.dataSync(),this.dtype===`complex64`)}async data(){this.throwIfDisposed();let e=Gq().read(this.dataId);if(this.dtype===`string`){let t=await e;try{return t.map(e=>Pq(e))}catch{throw Error(`Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().`)}}return e}dataToGPU(e){return this.throwIfDisposed(),Gq().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();let e=Gq().readSync(this.dataId);if(this.dtype===`string`)try{return e.map(e=>Pq(e))}catch{throw Error(`Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().`)}return e}async bytes(){this.throwIfDisposed();let e=await Gq().read(this.dataId);return this.dtype===`string`?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Gq().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw Error(`Tensor is disposed.`)}print(e=!1){return Kq.print(this,e)}clone(){return this.throwIfDisposed(),Kq.clone(this)}toString(e=!1){let t=this.dataSync();return fbe(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Kq.cast(this,e)}variable(e=!0,t,n){return this.throwIfDisposed(),Gq().makeVariable(this,e,t,n)}};Object.defineProperty(qq,Symbol.hasInstance,{value:e=>!!e&&e.data!=null&&e.dataSync!=null&&e.throwIfDisposed!=null});function V(){return vW(`Tensor`,()=>qq)}V();var Jq=class extends qq{constructor(e,t,n,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=n}assign(e){if(e.dtype!==this.dtype)throw Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!jU(e.shape,this.shape))throw Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Gq().disposeTensor(this),this.dataId=e.dataId,Gq().incRef(this,null)}dispose(){Gq().disposeVariable(this),this.isDisposedInternal=!0}};Object.defineProperty(Jq,Symbol.hasInstance,{value:e=>e instanceof qq&&e.assign!=null&&e.assign instanceof Function});
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var gbe;(function(e){e.R0=`R0`,e.R1=`R1`,e.R2=`R2`,e.R3=`R3`,e.R4=`R4`,e.R5=`R5`,e.R6=`R6`})(gbe||={});var Yq;(function(e){e.float32=`float32`,e.int32=`int32`,e.bool=`int32`,e.complex64=`complex64`})(Yq||={});var Xq;(function(e){e.float32=`float32`,e.int32=`int32`,e.bool=`bool`,e.complex64=`complex64`})(Xq||={});var Zq;(function(e){e.float32=`float32`,e.int32=`float32`,e.bool=`float32`,e.complex64=`complex64`})(Zq||={});var Qq;(function(e){e.float32=`complex64`,e.int32=`complex64`,e.bool=`complex64`,e.complex64=`complex64`})(Qq||={});var _be={float32:Zq,int32:Yq,bool:Xq,complex64:Qq};function $q(e,t){if(e===`string`||t===`string`){if(e===`string`&&t===`string`)return`string`;throw Error(`Can not upcast ${e} with ${t}`)}return _be[e][t]}function eJ(e){return $q(e,`int32`)}function tJ(e){return typeof e==`object`&&!!e&&`texture`in e&&e.texture instanceof WebGLTexture}function nJ(e){return typeof GPUBuffer<`u`&&typeof e==`object`&&!!e&&`buffer`in e&&e.buffer instanceof GPUBuffer}function rJ(e,t){if(e.dtype===t.dtype)return[e,t];let n=$q(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function iJ(e,t){return t.some(t=>t.id===e.id)}function aJ(e){let t=[];return oJ(e,t,new Set),t}function oJ(e,t,n){if(e==null)return;if(e instanceof qq){t.push(e);return}if(!vbe(e))return;let r=e;for(let e in r){let i=r[e];n.has(i)||(n.add(i),oJ(i,t,n))}}function vbe(e){return Array.isArray(e)||typeof e==`object`}function sJ(e){return e.kernelName!=null}var cJ=class{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(let e in this.registeredVariables)this.registeredVariables[e].dispose()}},lJ=class e{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new cJ}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t];if(await this.initializeBackend(n).success){await this.setBackend(n);return}}throw Error(`Could not initialize any backends, all backend initializations failed.`)}get backend(){if(this.pendingBackendInit!=null)throw Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){let{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){let{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,n=1){return e in this.registryFactory?(cq(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;let{success:t,asyncInit:n}=this.initializeBackend(e);if(!(n?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new sbe(this.backendInstance),!0}setupRegisteredKernels(){pq(this.backendName).forEach(e=>{e.setupFunc!=null&&e.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){pq(e).forEach(t=>{t.disposeFunc!=null&&t.disposeFunc(this.registry[e])})}initializeBackend(e){let t=this.registryFactory[e];if(t==null)throw Error(`Cannot initialize backend ${e}, no registration found.`);try{let n=t.factory();if(n&&!(n instanceof SU)&&typeof n.then==`function`){let t=++this.pendingBackendInitId,r=n.then(n=>t<this.pendingBackendInitId?!1:(this.registry[e]=n,this.pendingBackendInit=null,!0)).catch(n=>t<this.pendingBackendInitId?!1:(this.pendingBackendInit=null,cq(`Initialization of backend ${e} failed`),cq(n.stack||n.message),!1));return this.pendingBackendInit=r,{success:r,asyncInit:!0}}else return this.registry[e]=n,{success:!0,asyncInit:!1}}catch(t){return cq(`Initialization of backend ${e} failed`),cq(t.stack||t.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw Error(`No backend found in registry.`);return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){let e=this.getSortedBackends();for(let t=0;t<e.length;t++){let n=e[t],{success:r,asyncInit:i}=this.initializeBackend(n);if(i||r)return{name:n,asyncInit:i}}throw Error(`Could not initialize any backends, all backend initializations failed.`)}moveData(e,t){let n=this.state.tensorInfo.get(t),r=n.backend,i=this.readSync(t),a=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,i,n.shape,n.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let n=null;if(t==null){if(typeof e!=`function`)throw Error(`Please provide a function to tidy()`);t=e}else{if(typeof e!=`string`&&!(e instanceof String))throw Error(`When calling with two arguments, the first argument to tidy() must be a string`);if(typeof t!=`function`)throw Error(`When calling with two arguments, the 2nd argument to tidy() must be a function`);n=e}let r;return this.scopedRun(()=>this.startScope(n),()=>this.endScope(r),()=>(r=t(),r instanceof Promise&&console.error(`Cannot return a Promise inside of tidy.`),r))}scopedRun(e,t,n){e();try{let e=n();return t(),e}catch(e){throw t(),e}}nextTensorId(){return e.nextTensorId++}nextVariableId(){return e.nextVariableId++}clone(e){let t=H.runKernel(wG,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],e=>({x:()=>{let t={x:e};return H.runKernel(RW,t,{dtype:`float32`})}}),[],{}),t}runKernel(e,t,n){if(this.backendName??this.backend,dq(e,this.backendName)==null)throw Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}shouldCheckForMemLeaks(){return this.ENV.getBool(`IS_TEST`)}checkKernelForMemLeak(e,t,n){let r=this.backend.numDataIds(),i=0;n.forEach(e=>{i+=e.dtype===`complex64`?3:1});let a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-i-a;if(o>0)throw Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let t,n=[],r=this.isTapeOn(),i=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName??this.backend;let s,c=sJ(e)?e.kernelName:this.state.activeScope==null?``:this.state.activeScope.name;if(sJ(e)){let{kernelName:t,inputs:i,attrs:a}=e;this.backendName??this.backend;let c=dq(t,this.backendName);R(c!=null,()=>`Cannot find registered kernel '${t}' for backend '${this.backendName}'`),o=()=>{let e=this.backend.numDataIds();s=c.kernelFunc({inputs:i,attrs:a,backend:this.backend});let o=Array.isArray(s)?s:[s];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,o);let l=o.map(e=>e.rank==null?this.makeTensorFromTensorInfo(e):e);if(r){let e=this.getTensorsForGradient(t,i,l);n=this.saveTensorsForBackwardMode(e)}return l}}else{let{forwardFunc:t}=e,i=e=>{r&&(n=e.map(e=>this.keep(this.clone(e))))};o=()=>{let e=this.backend.numDataIds();s=this.tidy(()=>t(this.backend,i));let n=Array.isArray(s)?s:[s];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,e,n),n}}let{inputs:l,attrs:u}=e,d=sJ(e)?null:e.backwardsFunc,f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool(`DEBUG`)&&!this.state.profiling?t=o():(f=this.profiler.profileKernel(c,l,()=>o()),this.ENV.getBool(`DEBUG`)&&this.profiler.logKernelProfile(f),t=f.outputs)}),r&&this.addTapeNode(c,l,t,d,n,u),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-i,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(l).map(e=>l[e]==null?null:l[e].shape),outputShapes:t.map(e=>e.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(s)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(e=>this.keep(this.clone(e)))}getTensorsForGradient(e,t,n){let r=fq(e);if(r!=null){let e=r.inputsToSave||[],i=r.outputsToSave||[],a;r.saveAllInputs?(R(Array.isArray(t),()=>`saveAllInputs is true, expected inputs to be an array.`),a=Object.keys(t).map(e=>t[e])):a=e.map(e=>t[e]);let o=n.filter((e,t)=>i[t]);return a.concat(o)}return[]}makeTensor(e,t,n,r){if(e==null)throw Error(`Values passed to engine.makeTensor() are null`);n||=`float32`,r||=this.backend;let i=e;n===`string`&&KU(e[0])&&(i=e.map(e=>Nq(e)));let a=r.write(i,t,n),o=new qq(t,n,a,this.nextTensorId());if(this.trackTensor(o,r),n===`string`){let e=this.state.tensorInfo.get(a),t=GU(i);this.state.numBytes+=t-e.bytes,e.bytes=t}return o}makeTensorFromDataId(e,t,n,r){n||=`float32`;let i={dataId:e,shape:t,dtype:n};return this.makeTensorFromTensorInfo(i,r)}makeTensorFromTensorInfo(e,t){let{dataId:n,shape:r,dtype:i}=e,a=new qq(r,i,n,this.nextTensorId());return this.trackTensor(a,t),a}makeVariable(e,t=!0,n,r){n||=this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));let i=new Jq(e,t,n,this.nextTensorId());if(this.state.registeredVariables[i.name]!=null)throw Error(`Variable with name ${i.name} was already registered`);return this.state.registeredVariables[i.name]=i,this.incRef(i,this.backend),i}trackTensor(e,t){this.state.numTensors++,e.dtype===`string`&&this.state.numStringTensors++;let n=0;e.dtype!==`complex64`&&e.dtype!==`string`&&(n=e.size*WU(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof Jq||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;let t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype===`string`&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!==`complex64`&&e.dtype!==`string`){let t=e.size*WU(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(let e in this.state.registeredVariables){let t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){let e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons??=[],e.reasons.push(`Memory usage by string tensors is approximate (2 bytes per character)`)),e}async profile(e){this.state.profiling=!0;let t=this.state.numBytes,n=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(e=>e.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n;for(let e of this.state.activeProfile.kernels)e.kernelTimeMs=await e.kernelTimeMs,e.extraInfo=await e.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,n,r,i,a){let o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:i},s=fq(e);s!=null&&(r=s.gradFunc),r!=null&&(o.gradient=e=>(e=e.map((e,t)=>{if(e==null){let e=n[t],r=rW(e.size,e.dtype);return this.makeTensor(r,e.shape,e.dtype)}return e}),r(e.length>1?e:e[0],i,a))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){let t={track:[],name:`unnamed scope`,id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){let t=aJ(e),n=new Set(t.map(e=>e.id));for(let e=0;e<this.state.activeScope.track.length;e++){let t=this.state.activeScope.track[e];!t.kept&&!n.has(t.id)&&t.dispose()}let r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(e=>{!e.kept&&e.scopeId===r.id&&this.track(e)})}gradients(e,t,n,r=!1){if(R(t.length>0,()=>`gradients() received an empty list of xs.`),n!=null&&n.dtype!==`float32`)throw Error(`dy must have 'float32' dtype, but has '${n.dtype}'`);let i=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy(`forward`,e));R(i instanceof qq,()=>`The result y returned by f() must be a tensor.`);let a=ube(this.state.activeTape,t,i);if(!r&&a.length===0&&t.length>0)throw Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.`);return this.tidy(`backward`,()=>{let e={};e[i.id]=n??ybe(i.shape),dbe(e,a,e=>this.tidy(e),bbe);let r=t.map(t=>e[t.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(e=>{for(let t of e.saved)t.dispose()}),this.state.activeTape=null),{value:i,grads:r}})}customGrad(e){return R(XU(e),()=>`The f passed in customGrad(f) must be a function.`),(...t)=>{R(t.every(e=>e instanceof qq),()=>`The args passed in customGrad(f)(x1, x2,...) must all be tensors`);let n,r={};return t.forEach((e,t)=>{r[t]=e}),this.runKernelFunc({forwardFunc:(r,i)=>(n=e(...t,i),R(n.value instanceof qq,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),R(XU(n.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),n.value),backwardsFunc:(e,r)=>{let i=n.gradFunc(e,r),a=Array.isArray(i)?i:[i];R(a.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),R(a.every(e=>e instanceof qq),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");let o={};return a.forEach((e,t)=>{o[t]=()=>e}),o},inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){let t=Mq(),n=await this.backend.time(e);return n.wallMs=Mq()-t,n}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){for(let e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new cJ,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}};lJ.nextTensorId=0,lJ.nextVariableId=0;function ybe(e){let t=nW(z(e),`float32`);return H.makeTensor(t,e,`float32`)}function uJ(){let e=_W();if(e._tfengine==null){let t=new uW(e);e._tfengine=new lJ(t)}return hW(e._tfengine.ENV),mbe(()=>e._tfengine),e._tfengine}const H=uJ();function bbe(e,t){let n={a:e,b:t};return H.runKernel(`Add`,n)}
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
function xbe(){return typeof navigator<`u`&&navigator!=null}var dJ;function fJ(e){if(dJ!==void 0)return dJ;if(e||xbe()){if(e||=navigator,e.product===`ReactNative`)return!0;let t=e.userAgent||e.vendor||(typeof window<`u`?window.opera:``);if(!t){let t=e;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function pJ(){return typeof window<`u`&&window.document!=null||typeof WorkerGlobalScope<`u`}var mJ=B();mJ.registerFlag(`DEBUG`,()=>!1,e=>{e&&console.warn(`Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.`)}),mJ.registerFlag(`IS_BROWSER`,()=>pJ()),mJ.registerFlag(`IS_NODE`,()=>typeof process<`u`&&process.versions!==void 0&&process.versions.node!==void 0),mJ.registerFlag(`IS_CHROME`,()=>typeof navigator<`u`&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)),mJ.registerFlag(`IS_SAFARI`,()=>typeof navigator<`u`&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor)),mJ.registerFlag(`PROD`,()=>!1),mJ.registerFlag(`TENSORLIKE_CHECK_SHAPE_CONSISTENCY`,()=>mJ.getBool(`DEBUG`)),mJ.registerFlag(`DEPRECATION_WARNINGS_ENABLED`,()=>!0),mJ.registerFlag(`IS_TEST`,()=>!1),mJ.registerFlag(`CHECK_COMPUTATION_FOR_ERRORS`,()=>mJ.getBool(`DEBUG`)),mJ.registerFlag(`WRAP_TO_IMAGEBITMAP`,()=>!1),mJ.registerFlag(`CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU`,()=>!1),mJ.registerFlag(`USE_SETTIMEOUTCUSTOM`,()=>!1);function hJ(e,t){let n=e;if(Fq(e))return t===`string`?[]:[e.length];if(tJ(e)){let t=e.channels||`RGBA`;return[e.height,e.width*t.length]}else if(nJ(e))return[e.buffer.size/(t==null?4:WU(t))];if(!Array.isArray(e))return[];let r=[];for(;Array.isArray(n)||Fq(n)&&t!==`string`;)r.push(n.length),n=n[0];return Array.isArray(e)&&B().getBool(`TENSORLIKE_CHECK_SHAPE_CONSISTENCY`)&&gJ(e,r,[]),r}function gJ(e,t,n){if(n||=[],!Array.isArray(e)&&!Fq(e)){R(t.length===0,()=>`Element arr[${n.join(`][`)}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`);return}R(t.length>0,()=>`Element arr[${n.join(`][`)}] should be a primitive, but is an array of ${e.length} elements`),R(e.length===t[0],()=>`Element arr[${n.join(`][`)}] should have ${t[0]} elements, but has ${e.length} elements`);let r=t.slice(1);for(let t=0;t<e.length;++t)gJ(e[t],r,n.concat(t))}function _J(e,t,n,r){if(e!==`string_or_numeric`){if(e==null)throw Error(`Expected dtype cannot be null.`);if(e!==`numeric`&&e!==t||e===`numeric`&&t===`string`)throw Error(`Argument '${n}' passed to '${r}' must be ${e} tensor, but got ${t} tensor`)}}function U(e,t,n,r=`numeric`){if(e instanceof V())return _J(r,e.dtype,t,n),e;let i=YU(e);if(i!==`string`&&[`bool`,`int32`,`float32`].indexOf(r)>=0&&(i=r),_J(r,i,t,n),e==null||!Fq(e)&&!Array.isArray(e)&&typeof e!=`number`&&typeof e!=`boolean`&&typeof e!=`string`){let r=e==null?`null`:e.constructor.name;throw Error(`Argument '${t}' passed to '${n}' must be a Tensor or TensorLike, but got '${r}'`)}let a=hJ(e,i);!Fq(e)&&!Array.isArray(e)&&(e=[e]);let o=i===`string`?Iq(e,[],!0):jq(e,i);return H.makeTensor(o,a,i)}function vJ(e,t,n,r=`numeric`){if(!Array.isArray(e))throw Error(`Argument ${t} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map((e,i)=>U(e,`${t}[${i}]`,n,r))}function W(e){let t=Object.keys(e);if(t.length!==1)throw Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let n=t[0],r=e[n];n.endsWith(`_`)&&(n=n.substring(0,n.length-1)),n+=`__op`;let i=(...e)=>{H.startScope(n);try{let t=r(...e);return cW(t)&&console.error(`Cannot return a Promise inside of tidy.`),H.endScope(t),t}catch(e){throw H.endScope(null),e}};return Object.defineProperty(i,`name`,{value:n,configurable:!0}),i}function Sbe(e,t){let n=U(e,`real`,`complex`),r=U(t,`imag`,`complex`);kU(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);let i={real:n,imag:r};return H.runKernel(VW,i)}const yJ=W({complex_:Sbe});function bJ(e,t,n,r){if(r==null)r=YU(e);else if(r===`complex64`)throw Error(`Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).`);if(nJ(e)||tJ(e)){if(r!==`float32`&&r!==`int32`)throw Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return H.backend.createTensorFromGPUData(e,t||n,r)}if(!Fq(e)&&!Array.isArray(e)&&typeof e!=`number`&&typeof e!=`boolean`&&typeof e!=`string`)throw Error(`values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray`);if(t!=null){aW(t);let e=z(t),r=z(n);R(e===r,()=>`Based on the provided shape, [${t}], the tensor should have ${e} values but has ${r}`);for(let e=0;e<n.length;++e){let r=n[e],i=e===n.length-1?r!==z(t.slice(e)):!0;R(n[e]===t[e]||!i,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${t}). `)}}return!Fq(e)&&!Array.isArray(e)&&(e=[e]),t||=n,e=r===`string`?Iq(e,[],!0):jq(e,r),H.makeTensor(e,t,r)}function xJ(e,t,n){let r=hJ(e,n);return bJ(e,t,r,n)}
/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
const SJ={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};var CJ=class e{static join(t){return new e(t).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(e=>Fq(e)?e.buffer:e),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let t=0;for(let n=0;n<e.length;n++){let r=e[n];n!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);let i=t+r.byteLength;this.shards.push({buffer:r,start:t,end:i}),t=i}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,t=this.byteLength){if(this.shards.length===0||(e=isNaN(Number(e))?0:e,t=isNaN(Number(t))?0:t,e=Math.max(0,e),t=Math.min(this.byteLength,t),t<=e))return new ArrayBuffer(0);let n=this.findShardForByte(e);if(n===-1)throw Error(`Could not find start shard for byte ${e}`);let r=t-e,i=new ArrayBuffer(r),a=new Uint8Array(i),o=0;for(let r=n;r<this.shards.length;r++){let n=this.shards[r],i=e+o-n.start,s=o,c=Math.min(t,n.end)-n.start,l=new Uint8Array(n.buffer,i,c-i);if(a.set(l,s),o+=l.length,t<n.end)break}return i}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function t(t){return e<t.start?-1:e>=t.end?1:0}if(t(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;let n=Cbe(this.shards,t);return n===-1?-1:(this.previousShardIndex=n,this.previousShardIndex)}};function Cbe(e,t){let n=0,r=e.length;for(;n<=r;){let i=Math.floor((r-n)/2)+n,a=t(e[i]);if(a===0)return i;a<0?r=i:n=i+1}return-1}function wJ(){return H}function TJ(){return H.memory()}function G(e,t){return H.tidy(e,t)}function EJ(e){aJ(e).forEach(e=>e.dispose())}function DJ(e){return H.keep(e)}function OJ(e,t,n=1){return H.registerBackend(e,t,n)}function wbe(){return H.backend}var kJ=4;async function AJ(e,t){let n=[],r=[],i=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);for(let a=0;a<i.length;++a){let o=i[a],s=Array.isArray(e)?e[a].tensor:e[o];if(s.dtype!==`float32`&&s.dtype!==`int32`&&s.dtype!==`bool`&&s.dtype!==`string`&&s.dtype!==`complex64`)throw Error(`Unsupported dtype in weight '${o}': ${s.dtype}`);let c={name:o,shape:s.shape,dtype:s.dtype};if(s.dtype===`string`){let e=new Promise(async e=>{let t=await s.bytes(),n=t.reduce((e,t)=>e+t.length,0)+kJ*t.length,r=new Uint8Array(n),i=0;for(let e=0;e<t.length;e++){let n=t[e],a=new Uint8Array(new Uint32Array([n.length]).buffer);r.set(a,i),i+=kJ,r.set(n,i),i+=n.length}e(r)});r.push(e)}else r.push(s.data());t!=null&&(c.group=t),n.push(c)}let a=await Promise.all(r);return{data:Obe(a),specs:n}}function Tbe(e,t){let n=new CJ(e),r={},i=0;for(let e of t){let t=Ebe(e,(e,t)=>n.slice(i+e,i+t));r[e.name]=Dbe(e,n.slice(i,i+t)),i+=t}return r}function Ebe(e,t){let n=z(e.shape),r;if(`quantization`in e){let t=e.quantization;r=SJ[t.dtype]}else if(e.dtype===`string`){let e=0;for(let r=0;r<n;r++)e+=kJ+new Uint32Array(t(e,e+kJ))[0];return e}else r=SJ[e.dtype];return n*r}function Dbe(e,t){let n=e.name,r=e.dtype,i=e.shape,a=z(i),o,s=0;if(`quantization`in e){let i=e.quantization;if(i.dtype===`uint8`||i.dtype===`uint16`){if(!(`min`in i&&`scale`in i))throw Error(`Weight ${e.name} with quantization ${i.dtype} doesn't have corresponding metadata min and scale.`)}else if(i.dtype===`float16`){if(r!==`float32`)throw Error(`Weight ${e.name} is quantized with ${i.dtype} which only supports weights of type float32 not ${r}.`)}else throw Error(`Weight ${e.name} has unknown quantization dtype ${i.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);let c=SJ[i.dtype],l=i.dtype===`uint8`?new Uint8Array(t):new Uint16Array(t);if(r===`float32`)if(i.dtype===`uint8`||i.dtype===`uint16`){o=new Float32Array(l.length);for(let e=0;e<l.length;e++)o[e]=l[e]*i.scale+i.min}else if(i.dtype===`float16`)o=Rbe()(l);else throw Error(`Unsupported quantization type ${i.dtype} for weight type float32.`);else if(r===`int32`){if(i.dtype!==`uint8`&&i.dtype!==`uint16`)throw Error(`Unsupported quantization type ${i.dtype} for weight type int32.`);o=new Int32Array(l.length);for(let e=0;e<l.length;e++){let t=l[e];o[e]=Math.round(t*i.scale+i.min)}}else throw Error(`Unsupported dtype in weight '${n}': ${r}`);s+=a*c}else if(r===`string`){let n=z(e.shape);o=[];for(let e=0;e<n;e++){let e=new Uint32Array(t.slice(s,s+kJ))[0];s+=kJ;let n=new Uint8Array(t.slice(s,s+e));o.push(n),s+=e}}else{let e=SJ[r];if(r===`float32`)o=new Float32Array(t);else if(r===`int32`)o=new Int32Array(t);else if(r===`bool`)o=new Uint8Array(t);else if(r===`complex64`){o=new Float32Array(t);let e=new Float32Array(o.length/2),n=new Float32Array(o.length/2);for(let t=0;t<e.length;t++)e[t]=o[t*2],n[t]=o[t*2+1];let r=xJ(e,i,`float32`),a=xJ(n,i,`float32`),s=yJ(r,a);return r.dispose(),a.dispose(),s}else throw Error(`Unsupported dtype in weight '${n}': ${r}`);s+=a*e}return xJ(o,i,r)}function Obe(e){if(e===null)throw Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0,n=[];e.forEach(e=>{if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw Error(`Unsupported TypedArray subtype: ${e.constructor.name}`)});let r=new Uint8Array(t),i=0;return n.forEach(e=>{r.set(new Uint8Array(e.buffer),i),i+=e.byteLength}),r.buffer}var jJ=typeof Buffer<`u`&&(typeof Blob>`u`||typeof atob>`u`||typeof btoa>`u`);function MJ(e){return jJ?Buffer.byteLength(e,`utf8`):new Blob([e]).size}function kbe(e){if(jJ)return Buffer.from(e).toString(`base64`);let t=new Uint8Array(e),n=``;for(let e=0,r=t.length;e<r;e++)n+=String.fromCharCode(t[e]);return btoa(n)}function Abe(e){if(jJ){let t=Buffer.from(e,`base64`);return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}let t=atob(e),n=new Uint8Array(t.length);for(let e=0;e<t.length;++e)n.set([t.charCodeAt(e)],e);return n.buffer}function jbe(e){return CJ.join(e)}function Mbe(e,t){let n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return e.signature!=null&&(n.signature=e.signature),e.userDefinedMetadata!=null&&(n.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(n.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(n.initializerSignature=e.initializerSignature),e.trainingConfig!=null&&(n.trainingConfig=e.trainingConfig),n}function Nbe(e,t,n){let r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(e.trainingConfig!=null&&(r.trainingConfig=e.trainingConfig),e.weightsManifest!=null){if(!t)throw Error(`modelJSON has weightsManifest but weightSpecs is null`);if(!n)throw Error(`modelJSON has weightsManifest but weightData is null`);r.weightSpecs=t,r.weightData=n}return e.signature!=null&&(r.signature=e.signature),e.userDefinedMetadata!=null&&(r.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(r.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(r.initializerSignature=e.initializerSignature),r}async function Pbe(e,t){let n,r;return e.weightsManifest!=null&&([n,r]=await t(e.weightsManifest)),Nbe(e,n,r)}function NJ(e){if(e.modelTopology instanceof ArrayBuffer)throw Error(`Expected JSON model topology, received ArrayBuffer.`);return{dateSaved:new Date,modelTopologyType:`JSON`,modelTopologyBytes:e.modelTopology==null?0:MJ(JSON.stringify(e.modelTopology)),weightSpecsBytes:e.weightSpecs==null?0:MJ(JSON.stringify(e.weightSpecs)),weightDataBytes:e.weightData==null?0:new CJ(e.weightData).byteLength}}function PJ(e){let t=[];for(let n of e)t.push(...n.weights);return t}function Fbe(){let e=e=>{let t=e<<13,n=0;for(;!(t&8388608);)n-=8388608,t<<=1;return t&=-8388609,n+=947912704,t|n},t=new Uint32Array(2048);t[0]=0;for(let n=1;n<1024;n++)t[n]=e(n);for(let e=1024;e<2048;e++)t[e]=939524096+(e-1024<<13);return t}function Ibe(){let e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}function Lbe(){let e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}function Rbe(){let e=Fbe(),t=Ibe(),n=Lbe();return r=>{let i=new ArrayBuffer(4*r.length),a=new Uint32Array(i);for(let i=0;i<r.length;i++){let o=r[i];a[i]=e[n[o>>10]+(o&1023)]+t[o>>10]}return new Float32Array(i)}}
/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var FJ=class e{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return e.instance??=new e,e.instance}static registerSaveRouter(t){e.getInstance().saveRouters.push(t)}static registerLoadRouter(t){e.getInstance().loadRouters.push(t)}static getSaveHandlers(t){return e.getHandlers(t,`save`)}static getLoadHandlers(t,n){return e.getHandlers(t,`load`,n)}static getHandlers(t,n,r){let i=[];return(n===`load`?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach(e=>{let n=e(t,r);n!==null&&i.push(n)}),i}};const zbe=e=>FJ.getSaveHandlers(e),Bbe=(e,t)=>FJ.getLoadHandlers(e,t);var IJ=`tensorflowjs`,LJ=1,RJ=`models_store`,zJ=`model_info_store`;function BJ(){if(!B().getBool(`IS_BROWSER`))throw Error(`Failed to obtain IndexedDB factory because the current environmentis not a web browser.`);let e=typeof window>`u`?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(t==null)throw Error(`The current browser does not appear to support IndexedDB.`);return t}function VJ(e){let t=e.result;t.createObjectStore(RJ,{keyPath:`modelPath`}),t.createObjectStore(zJ,{keyPath:`modelPath`})}var HJ=class{constructor(e){if(this.indexedDB=BJ(),e==null||!e)throw Error(`For IndexedDB, modelPath must not be null, undefined or empty.`);this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw Error(`BrowserLocalStorage.save() does not support saving model topology in binary formats yet.`);return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((e,n)=>{let r=this.indexedDB.open(IJ,LJ);r.onupgradeneeded=()=>VJ(r),r.onsuccess=()=>{let i=r.result;if(t==null){let t=i.transaction(RJ,`readonly`),r=t.objectStore(RJ).get(this.modelPath);r.onsuccess=()=>{if(r.result==null)return i.close(),n(Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));e(r.result.modelArtifacts)},r.onerror=e=>(i.close(),n(r.error)),t.oncomplete=()=>i.close()}else{t.weightData=CJ.join(t.weightData);let r=NJ(t),a=i.transaction(zJ,`readwrite`),o=a.objectStore(zJ),s;try{s=o.put({modelPath:this.modelPath,modelArtifactsInfo:r})}catch(e){return n(e)}let c;s.onsuccess=()=>{c=i.transaction(RJ,`readwrite`);let s=c.objectStore(RJ),l;try{l=s.put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:r})}catch(e){return n(e)}l.onsuccess=()=>e({modelArtifactsInfo:r}),l.onerror=e=>{o=a.objectStore(zJ);let t=o.delete(this.modelPath);t.onsuccess=()=>(i.close(),n(l.error)),t.onerror=e=>(i.close(),n(l.error))}},s.onerror=e=>(i.close(),n(s.error)),a.oncomplete=()=>{c==null?i.close():c.oncomplete=()=>i.close()}}},r.onerror=e=>n(r.error)})}};HJ.URL_SCHEME=`indexeddb://`;const UJ=e=>B().getBool(`IS_BROWSER`)&&!Array.isArray(e)&&e.startsWith(HJ.URL_SCHEME)?Vbe(e.slice(HJ.URL_SCHEME.length)):null;FJ.registerSaveRouter(UJ),FJ.registerLoadRouter(UJ);function Vbe(e){return new HJ(e)}function Hbe(e){return e.startsWith(HJ.URL_SCHEME)?e.slice(HJ.URL_SCHEME.length):e}var Ube=class{constructor(){this.indexedDB=BJ()}async listModels(){return new Promise((e,t)=>{let n=this.indexedDB.open(IJ,LJ);n.onupgradeneeded=()=>VJ(n),n.onsuccess=()=>{let r=n.result,i=r.transaction(zJ,`readonly`),a=i.objectStore(zJ).getAll();a.onsuccess=()=>{let t={};for(let e of a.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},a.onerror=e=>(r.close(),t(a.error)),i.oncomplete=()=>r.close()},n.onerror=e=>t(n.error)})}async removeModel(e){return e=Hbe(e),new Promise((t,n)=>{let r=this.indexedDB.open(IJ,LJ);r.onupgradeneeded=()=>VJ(r),r.onsuccess=()=>{let i=r.result,a=i.transaction(zJ,`readwrite`),o=a.objectStore(zJ),s=o.get(e),c;s.onsuccess=()=>{if(s.result==null)return i.close(),n(Error(`Cannot find model with path '${e}' in IndexedDB.`));{let r=o.delete(e),a=()=>{c=i.transaction(RJ,`readwrite`);let r=c.objectStore(RJ).delete(e);r.onsuccess=()=>t(s.result.modelArtifactsInfo),r.onerror=e=>n(s.error)};r.onsuccess=a,r.onerror=e=>(a(),i.close(),n(s.error))}},s.onerror=e=>(i.close(),n(s.error)),a.oncomplete=()=>{c==null?i.close():c.oncomplete=()=>i.close()}},r.onerror=e=>n(r.error)})}},WJ=`/`,GJ=`tensorflowjs_models`,KJ=`info`,Wbe=`model_topology`,Gbe=`weight_specs`,Kbe=`weight_data`,qbe=`model_metadata`;function qJ(e){return{info:[GJ,e,KJ].join(WJ),topology:[GJ,e,Wbe].join(WJ),weightSpecs:[GJ,e,Gbe].join(WJ),weightData:[GJ,e,Kbe].join(WJ),modelMetadata:[GJ,e,qbe].join(WJ)}}function JJ(e){for(let t of Object.values(e))window.localStorage.removeItem(t)}function Jbe(e){let t=e.split(WJ);if(t.length<3)throw Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(WJ)}function Ybe(e){return e.startsWith(YJ.URL_SCHEME)?e.slice(YJ.URL_SCHEME.length):e}var YJ=class{constructor(e){if(!B().getBool(`IS_BROWSER`)||typeof window>`u`||window.localStorage===void 0)throw Error(`The current environment does not support local storage.`);if(this.LS=window.localStorage,e==null||!e)throw Error(`For local storage, modelPath must not be null, undefined or empty.`);this.modelPath=e,this.keys=qJ(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw Error(`BrowserLocalStorage.save() does not support saving model topology in binary formats yet.`);{let t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=NJ(e),i=CJ.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,kbe(i));let a={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature==null?void 0:e.signature,userDefinedMetadata:e.userDefinedMetadata==null?void 0:e.userDefinedMetadata,modelInitializer:e.modelInitializer==null?void 0:e.modelInitializer,initializerSignature:e.initializerSignature==null?void 0:e.initializerSignature,trainingConfig:e.trainingConfig==null?void 0:e.trainingConfig};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:r}}catch{throw JJ(this.keys),Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){let e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!==`JSON`)throw Error(`BrowserLocalStorage does not support loading non-JSON model topology yet.`);let t={},n=JSON.parse(this.LS.getItem(this.keys.topology));if(n==null)throw Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=n;let r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;let i=this.LS.getItem(this.keys.modelMetadata);if(i!=null){let e=JSON.parse(i);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,e.signature!=null&&(t.signature=e.signature),e.userDefinedMetadata!=null&&(t.userDefinedMetadata=e.userDefinedMetadata),e.modelInitializer!=null&&(t.modelInitializer=e.modelInitializer),e.initializerSignature!=null&&(t.initializerSignature=e.initializerSignature),e.trainingConfig!=null&&(t.trainingConfig=e.trainingConfig)}let a=this.LS.getItem(this.keys.weightData);if(a==null)throw Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=Abe(a),t}};YJ.URL_SCHEME=`localstorage://`;const XJ=e=>B().getBool(`IS_BROWSER`)&&!Array.isArray(e)&&e.startsWith(YJ.URL_SCHEME)?Xbe(e.slice(YJ.URL_SCHEME.length)):null;FJ.registerSaveRouter(XJ),FJ.registerLoadRouter(XJ);function Xbe(e){return new YJ(e)}var Zbe=class{constructor(){R(B().getBool(`IS_BROWSER`),()=>`Current environment is not a web browser`),R(typeof window>`u`||window.localStorage!==void 0,()=>`Current browser does not appear to support localStorage`),this.LS=window.localStorage}async listModels(){let e={},t=GJ+WJ,n=WJ+KJ;for(let r=0;r<this.LS.length;++r){let i=this.LS.key(r);if(i.startsWith(t)&&i.endsWith(n)){let t=Jbe(i);e[t]=JSON.parse(this.LS.getItem(i))}}return e}async removeModel(e){e=Ybe(e);let t=qJ(e);if(this.LS.getItem(t.info)==null)throw Error(`Cannot find model at path '${e}'`);let n=JSON.parse(this.LS.getItem(t.info));return JJ(t),n}},ZJ=`://`,QJ=class e{constructor(){this.managers={}}static getInstance(){return e.instance??=new e,e.instance}static registerManager(t,n){R(t!=null,()=>`scheme must not be undefined or null.`),t.endsWith(ZJ)&&(t=t.slice(0,t.indexOf(ZJ))),R(t.length>0,()=>`scheme must not be an empty string.`);let r=e.getInstance();R(r.managers[t]==null,()=>`A model store manager is already registered for scheme '${t}'.`),r.managers[t]=n}static getManager(t){let n=e.getInstance().managers[t];if(n==null)throw Error(`Cannot find model manager for scheme '${t}'`);return n}static getSchemes(){return Object.keys(e.getInstance().managers)}},Qbe=class{constructor(){this.messageName=`setTimeoutCustom`,this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!==`utf-8`&&t!==`utf8`)throw Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder??=new TextEncoder,this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(typeof window>`u`||!B().getBool(`USE_SETTIMEOUTCUSTOM`)){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},`*`)},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener(`message`,e=>{if(e.source===window&&e.data.name===this.messageName){e.stopPropagation();let t=this.functionRefs[e.data.index];t(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return gq(e)}};if(B().get(`IS_BROWSER`)){B().setPlatform(`browser`,new Qbe);try{QJ.registerManager(YJ.URL_SCHEME,new Zbe)}catch{}try{QJ.registerManager(HJ.URL_SCHEME,new Ube)}catch{}}var $J=o(((e,t)=>{t.exports={}}));const $be={importFetch:()=>$J()};var eY,exe=class{constructor(){this.util=$J(),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return B().global.fetch==null?(eY??=$be.importFetch(),eY(e,t)):B().global.fetch(e,t)}now(){let e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!==`utf-8`&&t!==`utf8`)throw Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?``:new this.util.TextDecoder(t).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}};B().get(`IS_NODE`)&&!B().get(`IS_BROWSER`)&&B().setPlatform(`node`,new exe);function tY(e,t=`float32`,n){return t||=`float32`,aW(e),new Wq(e,t,n)}function txe(e,t){let n=U(e,`x`,`cast`);if(!HU(t))throw Error(`Failed to cast to unknown dtype ${t}`);if(t===`string`&&n.dtype!==`string`||t!==`string`&&n.dtype===`string`)throw Error(`Only strings can be casted to strings`);let r={x:n},i={dtype:t};return H.runKernel(RW,r,i)}const K=W({cast_:txe});function nxe(e){let t={x:U(e,`x`,`clone`,`string_or_numeric`)};return H.runKernel(wG,t)}const nY=W({clone_:nxe});
/**
* @license
* Copyright 2020 Google Inc. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
function rxe(e,t=!1){console.log(e.toString(t))}uJ(),hbe({buffer:tY,cast:K,clone:nY,print:rxe});function ixe(e,t){let n=U(e,`a`,`add`),r=U(t,`b`,`add`);[n,r]=rJ(n,r);let i={a:n,b:r};return H.runKernel(`Add`,i)}const q=W({add_:ixe});function axe(e,t){let n=U(e,`a`,`floorDiv`),r=U(t,`b`,`floorDiv`);[n,r]=rJ(n,r);let i={a:n,b:r};return H.runKernel(vG,i)}const rY=W({floorDiv_:axe});function oxe(e,t){let n=U(e,`a`,`div`),r=U(t,`b`,`div`);if([n,r]=rJ(n,r),n.dtype===`int32`&&r.dtype===`int32`)return rY(n,r);let i={a:n,b:r};return H.runKernel(lG,i,{})}const iY=W({div_:oxe});function sxe(e,t){let n=U(e,`a`,`mul`),r=U(t,`b`,`mul`);[n,r]=rJ(n,r);let i={a:n,b:r};return H.runKernel(YG,i)}const J=W({mul_:sxe});function cxe(e){let t=U(e,`x`,`abs`);if(t.dtype===`complex64`){let e={x:t};return H.runKernel(HW,e)}else{let e={x:t};return H.runKernel(`Abs`,e)}}const aY=W({abs_:cxe});function lxe(e){let t={x:U(e,`x`,`acos`)};return H.runKernel(yW,t)}const uxe=W({acos_:lxe});function dxe(e){let t={x:U(e,`x`,`acosh`)};return H.runKernel(bW,t)}const fxe=W({acosh_:dxe});function pxe(e,t=null,n=!1){let r={x:U(e,`x`,`all`,`bool`)},i={axis:t,keepDims:n};return H.runKernel(`All`,r,i)}const oY=W({all_:pxe});function mxe(e,t=null,n=!1){let r={x:U(e,`x`,`any`,`bool`)},i={axis:t,keepDims:n};return H.runKernel(`Any`,r,i)}const sY=W({any_:mxe});function hxe(e,t=0){let n={x:U(e,`x`,`argMax`)},r={axis:t};return H.runKernel(SW,n,r)}const cY=W({argMax_:hxe});function gxe(e,t=0){let n={x:U(e,`x`,`argMin`)},r={axis:t};return H.runKernel(CW,n,r)}const _xe=W({argMin_:gxe});function vxe(e){let t={x:U(e,`x`,`asin`)};return H.runKernel(wW,t)}const yxe=W({asin_:vxe});function bxe(e){let t={x:U(e,`x`,`asinh`)};return H.runKernel(TW,t)}const xxe=W({asinh_:bxe});function Sxe(e){let t={x:U(e,`x`,`atan`)};return H.runKernel(EW,t)}const Cxe=W({atan_:Sxe});function wxe(e,t){let n=U(e,`a`,`atan2`),r=U(t,`b`,`atan2`);[n,r]=rJ(n,r);let i={a:n,b:r};return H.runKernel(OW,i)}const Txe=W({atan2_:wxe});function Exe(e){let t={x:U(e,`x`,`atanh`)};return H.runKernel(DW,t)}const Dxe=W({atanh_:Exe});function lY(e,t,n,r,i=`NHWC`,a){let o=e[3],s=[...t,o],c=SY(i);return fY(e,s,n,a,r,null,null,c)}function uY(e,t,n,r,i,a,o=`channelsLast`){let[s,c]=hY(t),l;if(o===`channelsLast`)l=[s,c,e[3],e[3]];else if(o===`channelsFirst`)l=[s,c,e[1],e[1]];else throw Error(`Unknown dataFormat ${o}`);return fY(e,l,n,r,i,a,!1,o)}function dY(e,t,n,r,i,a,o=`NDHWC`){let[s,c,l]=gY(t),u,d;if(o===`NDHWC`)d=`channelsLast`,u=[s,c,l,e[4],e[4]];else if(o===`NCDHW`)d=`channelsFirst`,u=[s,c,l,e[1],e[1]];else throw Error(`Unknown dataFormat ${o}`);return pY(e,u,n,r,i,!1,d,a)}function fY(e,t,n,r,i,a,o=!1,s=`channelsLast`){let[c,l,u,d]=[-1,-1,-1,-1];if(s===`channelsLast`)[c,l,u,d]=e;else if(s===`channelsFirst`)[c,d,l,u]=e;else throw Error(`Unknown dataFormat ${s}`);let[f,p,,m]=t,[h,g]=hY(n),[_,v]=hY(r),y=_Y(f,_),b=_Y(p,v),{padInfo:x,outHeight:S,outWidth:C}=Axe(i,l,u,h,g,y,b,a,s),w=o?m*d:m,T;return s===`channelsFirst`?T=[c,w,S,C]:s===`channelsLast`&&(T=[c,S,C,w]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:u,inChannels:d,outHeight:S,outWidth:C,outChannels:w,padInfo:x,strideHeight:h,strideWidth:g,filterHeight:f,filterWidth:p,effectiveFilterHeight:y,effectiveFilterWidth:b,dilationHeight:_,dilationWidth:v,inShape:e,outShape:T,filterShape:t}}function pY(e,t,n,r,i,a=!1,o=`channelsLast`,s){let[c,l,u,d,f]=[-1,-1,-1,-1,-1];if(o===`channelsLast`)[c,l,u,d,f]=e;else if(o===`channelsFirst`)[c,f,l,u,d]=e;else throw Error(`Unknown dataFormat ${o}`);let[p,m,h,,g]=t,[_,v,y]=gY(n),[b,x,S]=gY(r),C=_Y(p,b),w=_Y(m,x),T=_Y(h,S),{padInfo:E,outDepth:D,outHeight:O,outWidth:k}=jxe(i,l,u,d,_,v,y,C,w,T,s),ee=a?g*f:g,te;return o===`channelsFirst`?te=[c,ee,D,O,k]:o===`channelsLast`&&(te=[c,D,O,k,ee]),{batchSize:c,dataFormat:o,inDepth:l,inHeight:u,inWidth:d,inChannels:f,outDepth:D,outHeight:O,outWidth:k,outChannels:ee,padInfo:E,strideDepth:_,strideHeight:v,strideWidth:y,filterDepth:p,filterHeight:m,filterWidth:h,effectiveFilterDepth:C,effectiveFilterHeight:w,effectiveFilterWidth:T,dilationDepth:b,dilationHeight:x,dilationWidth:S,inShape:e,outShape:te,filterShape:t}}function Oxe(e,t,n,r,i){r??=mY(e,t,n);let a=e[0],o=e[1],s=vY((a-t+2*r)/n+1,i),c=vY((o-t+2*r)/n+1,i);return[s,c]}function kxe(e,t,n,r,i,a){i??=mY(e,t[0],r[0]);let o=[0,0,0,n];for(let n=0;n<3;n++)e[n]+2*i>=t[n]&&(o[n]=vY((e[n]-t[n]+2*i)/r[n]+1,a));return o}function mY(e,t,n,r=1){let i=_Y(t,r);return Math.floor((e[0]*(n-1)-n+i)/2)}function hY(e){return typeof e==`number`?[e,e,e]:e.length===2?[e[0],e[1],1]:e}function gY(e){return typeof e==`number`?[e,e,e]:e}function _Y(e,t){return t<=1?e:e+(e-1)*(t-1)}function Axe(e,t,n,r,i,a,o,s,c){let l,u,d;if(typeof e==`number`){l={top:e,bottom:e,left:e,right:e,type:e===0?`VALID`:`NUMBER`};let i=Oxe([t,n],a,r,e,s);u=i[0],d=i[1]}else if(e===`same`){u=Math.ceil(t/r),d=Math.ceil(n/i);let e=Math.max(0,(u-1)*r+a-t),s=Math.max(0,(d-1)*i+o-n),c=Math.floor(e/2),f=e-c,p=Math.floor(s/2),m=s-p;l={top:c,bottom:f,left:p,right:m,type:`SAME`}}else if(e===`valid`)l={top:0,bottom:0,left:0,right:0,type:`VALID`},u=Math.ceil((t-a+1)/r),d=Math.ceil((n-o+1)/i);else if(typeof e==`object`){let f=c===`channelsLast`?e[1][0]:e[2][0],p=c===`channelsLast`?e[1][1]:e[2][1],m=c===`channelsLast`?e[2][0]:e[3][0],h=c===`channelsLast`?e[2][1]:e[3][1];l={top:f,bottom:p,left:m,right:h,type:f===0&&p===0&&m===0&&h===0?`VALID`:`EXPLICIT`},u=vY((t-a+f+p)/r+1,s),d=vY((n-o+m+h)/i+1,s)}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:l,outHeight:u,outWidth:d}}function jxe(e,t,n,r,i,a,o,s,c,l,u){let d,f,p,m;if(e===`valid`&&(e=0),typeof e==`number`){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:e===0?`VALID`:`NUMBER`};let h=kxe([t,n,r,1],[s,c,l],1,[i,a,o],e,u);f=h[0],p=h[1],m=h[2]}else if(e===`same`){f=Math.ceil(t/i),p=Math.ceil(n/a),m=Math.ceil(r/o);let e=(f-1)*i+s-t,u=(p-1)*a+c-n,h=(m-1)*o+l-r,g=Math.floor(e/2),_=e-g,v=Math.floor(u/2),y=u-v,b=Math.floor(h/2),x=h-b;d={top:v,bottom:y,left:b,right:x,front:g,back:_,type:`SAME`}}else throw Error(`Unknown padding parameter: ${e}`);return{padInfo:d,outDepth:f,outHeight:p,outWidth:m}}function vY(e,t){if(!t)return Math.trunc(e);switch(t){case`round`:return Math.round(e);case`ceil`:return Math.ceil(e);case`floor`:return Math.floor(e);default:throw Error(`Unknown roundingMode ${t}`)}}function yY(e){let[t,n,r]=hY(e);return t===1&&n===1&&r===1}function bY(e,t){return yY(e)||yY(t)}function xY(e){return hY(e).every(e=>e>0)}function SY(e){if(e===`NHWC`)return`channelsLast`;if(e===`NCHW`)return`channelsFirst`;throw Error(`Unknown dataFormat ${e}`)}function CY(e,t,n){if(n!=null){if(typeof t==`string`)throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);if(typeof t==`number`)R(MU(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`);else if(typeof t==`object`)t.forEach(t=>{t.forEach(t=>{R(MU(t),()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${n} but got pad ${t}.`)})});else throw Error(`Error in ${e}: Unknown padding parameter: ${t}`)}}function Mxe(e,t){let n={x:U(e,`x`,`reshape`,`string_or_numeric`)},r={shape:t};return H.runKernel(pK,n,r)}const Y=W({reshape_:Mxe});function Nxe(e,t,n,r,i){let a=U(e,`x`,`avgPool`,`float32`);R(bY(n,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`);let o=a,s=!1;a.rank===3&&(s=!0,o=Y(a,[1,a.shape[0],a.shape[1],a.shape[2]])),R(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),CY(`avgPool`,r,i);let c={x:o},l={filterSize:t,strides:n,pad:r,dimRoundingMode:i},u=H.runKernel(kW,c,l);return u=K(u,a.dtype),s?Y(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const wY=W({avgPool_:Nxe});function Pxe(e,t,n,r,i,a=`NDHWC`){let o=U(e,`x`,`avgPool3d`,`float32`),s=o,c=!1;o.rank===4&&(c=!0,s=Y(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),R(s.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${s.rank}.`),R(a===`NDHWC`,()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),R(typeof n==`number`&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),CY(`avgPool3d`,r,i);let l={x:s},u={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:a},d=H.runKernel(jW,l,u);return d=K(d,s.dtype),c?Y(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Fxe=W({avgPool3d_:Pxe});function Ixe(e,t=0){R(e.length>=1,()=>`Pass at least one tensor to concat`);let n=vJ(e,`tensors`,`concat`,`string_or_numeric`);if(n[0].dtype===`complex64`&&n.forEach(e=>{if(e.dtype!==`complex64`)throw Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${e.dtype}. `)}),n.length===1)return nY(n[0]);let r=n,i={axis:t};return H.runKernel(UW,r,i)}const TY=W({concat_:Ixe});function Lxe(e,t,n=!1,r=!1){let i=U(e,`a`,`matMul`),a=U(t,`b`,`matMul`);[i,a]=rJ(i,a);let o={a:i,b:a},s={transposeA:n,transposeB:r};return H.runKernel(NW,o,s)}const EY=W({matMul_:Lxe});function Rxe(e){let t={x:U(e,`x`,`sigmoid`,`float32`)};return H.runKernel(AK,t)}const DY=W({sigmoid_:Rxe});function zxe(e,t,n){let r=U(e,`x`,`slice`,`string_or_numeric`);if(r.rank===0)throw Error(`Slicing scalar is not possible`);let i={x:r},a={begin:t,size:n};return H.runKernel(DK,i,a)}const OY=W({slice_:zxe});function Bxe(e){let t={x:U(e,`x`,`tanh`,`float32`)};return H.runKernel(JK,t)}const kY=W({tanh_:Bxe});function Vxe(e,t,n){let r=U(e,`x`,`batchToSpaceND`),i=t.reduce((e,t)=>e*t);R(r.rank>=1+t.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${t.length}`),R(n.length===t.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${t.length}`),R(r.shape[0]%i===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(` * `)} === ${i}`);let a={x:r},o={blockShape:t,crops:n};return H.runKernel(PW,a,o)}const AY=W({batchToSpaceND_:Vxe});function Hxe(e){let t;return t=e.rank===0||e.rank===1?Y(e,[1,1,1,e.size]):e.rank===2?Y(e,[1,1,e.shape[0],e.shape[1]]):e.rank===3?Y(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e,t}function Uxe(e,t,n,r,i,a){a??=.001;let o=U(e,`x`,`batchNorm`),s=U(t,`mean`,`batchNorm`),c=U(n,`variance`,`batchNorm`),l;i!=null&&(l=U(i,`scale`,`batchNorm`));let u;r!=null&&(u=U(r,`offset`,`batchNorm`)),R(s.rank===c.rank,()=>`Batch normalization gradient requires mean and variance to have equal ranks.`),R(u==null||s.rank===u.rank,()=>`Batch normalization gradient requires mean and offset to have equal ranks.`),R(l==null||s.rank===l.rank,()=>`Batch normalization gradient requires mean and scale to have equal ranks.`);let d={x:Hxe(o),scale:l,offset:u,mean:s,variance:c},f={varianceEpsilon:a},p=H.runKernel(yG,d,f);return Y(p,o.shape)}const jY=W({batchNorm_:Uxe});function Wxe(e,t,n,r,i,a){let o=U(e,`x`,`batchNorm`),s=U(t,`mean`,`batchNorm`),c=U(n,`variance`,`batchNorm`),l;i!=null&&(l=U(i,`scale`,`batchNorm`));let u;return r!=null&&(u=U(r,`offset`,`batchNorm`)),R(o.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${o.rank}.`),R(s.rank===2||s.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${s.rank}.`),R(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${c.rank}.`),l!=null&&R(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&R(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),jY(o,s,c,u,l,a)}const Gxe=W({batchNorm2d_:Wxe});function Kxe(e,t,n,r,i,a){let o=U(e,`x`,`batchNorm`),s=U(t,`mean`,`batchNorm`),c=U(n,`variance`,`batchNorm`),l;i!=null&&(l=U(i,`scale`,`batchNorm`));let u;return r!=null&&(u=U(r,`offset`,`batchNorm`)),R(o.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${o.rank}.`),R(s.rank===3||s.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${s.rank}.`),R(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${c.rank}.`),l!=null&&R(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&R(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),jY(o,s,c,u,l,a)}const qxe=W({batchNorm3d_:Kxe});function Jxe(e,t,n,r,i,a){let o=U(e,`x`,`batchNorm`),s=U(t,`mean`,`batchNorm`),c=U(n,`variance`,`batchNorm`),l;i!=null&&(l=U(i,`scale`,`batchNorm`));let u;return r!=null&&(u=U(r,`offset`,`batchNorm`)),R(o.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${o.rank}.`),R(s.rank===4||s.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${s.rank}.`),R(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${c.rank}.`),l!=null&&R(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&R(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),jY(o,s,c,u,l,a)}const Yxe=W({batchNorm4d_:Jxe});function Xxe(e,t,n){let r=U(e,`x`,`bincount`),i=U(t,`weights`,`bincount`);R(r.dtype===`int32`,()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),R(n>=0,()=>`size must be non-negative, but got ${n}.`),R(i.size===r.size||i.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`);let a={x:r,weights:i},o={size:n};return H.runKernel(FW,a,o)}const Zxe=W({bincount_:Xxe});function Qxe(e,t){let n=U(e,`broadcastTo`,`x`),r=n.shape;if(aW(t),t.length<n.rank)throw Error(`broadcastTo(): shape.length=${t.length} < input.rank=${n.rank}.`);if(t.length>n.rank){let e=n.shape.slice();for(;e.length<t.length;)e.unshift(1);n=Y(n,e)}let i=n.shape,a=Array.from(t);for(let e=t.length-1;e>=0;e--)if(i[e]===t[e])a[e]=1;else if(n.shape[e]!==1)throw Error(`broadcastTo(): [${r}] cannot be broadcast to [${t}].`);if(a.map((e,t)=>e>1?t:-1).filter(e=>e>=0).length===0)return nY(n);let o={x:n},s={reps:a};return H.runKernel(YK,o,s)}const MY=W({broadcastTo_:Qxe});function $xe(e){let t={x:U(e,`x`,`ceil`,`float32`)};return H.runKernel(zW,t)}const eSe=W({ceil_:$xe});function NY(e,t,n){aW(e),n||=YU(t);let r={shape:e,value:t,dtype:n};return H.runKernel(hG,{},r)}function tSe(e,t,n){let r=U(e,`x`,`clipByValue`);if(R(t<=n,()=>`Error in clip: min (${t}) must be less than or equal to max (${n}).`),t===n)return NY(r.shape,t,r.dtype);let i={x:r},a={clipValueMin:t,clipValueMax:n};return H.runKernel(BW,i,a)}const PY=W({clipByValue_:tSe});function nSe(e){return TY(e,0)}const rSe=W({concat1d_:nSe});function iSe(e,t){return TY(e,t)}const aSe=W({concat2d_:iSe});function oSe(e,t){return TY(e,t)}const sSe=W({concat3d_:oSe});function cSe(e,t){return TY(e,t)}const lSe=W({concat4d_:cSe});function uSe(e,t,n,r,i=`NHWC`,a=[1,1],o){let s=U(e,`x`,`conv2d`,`float32`),c=U(t,`filter`,`conv2d`,`float32`),l=s,u=!1;s.rank===3&&(u=!0,l=Y(s,[1,s.shape[0],s.shape[1],s.shape[2]])),R(l.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${l.rank}.`),R(c.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${c.rank}.`),CY(`conv2d`,r,o);let d=i===`NHWC`?l.shape[3]:l.shape[1];R(d===c.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${c.shape[2]}.`),R(bY(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),R(xY(a),()=>`Error in conv2D: Dilated rates should be larger than 0.`),R(xY(n),()=>`Error in conv2D: Strides should be larger than 0.`);let f={x:l,filter:c},p={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:o},m=H.runKernel(WW,f,p);return u?Y(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const FY=W({conv2d_:uSe});function dSe(e,t,n,r,i=`NWC`,a=1,o){let s=U(e,`x`,`conv1d`),c=U(t,`filter`,`conv1d`),l=s,u=!1;s.rank===2&&(u=!0,l=Y(s,[1,s.shape[0],s.shape[1]])),R(l.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${l.rank}.`),R(c.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${c.rank}.`),CY(`conv1d`,r,o),R(l.shape[2]===c.shape[1],()=>`Error in conv1d: depth of input (${l.shape[2]}) must match input depth for filter ${c.shape[1]}.`),R(bY(n,a),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${a}'`),R(xY(a),()=>`Error in conv1D: Dilated rates should be larger than 0.`),R(xY(n),()=>`Error in conv1D: Stride should be larger than 0.`),R(i===`NWC`,()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);let d=Y(c,[1,c.shape[0],c.shape[1],c.shape[2]]),f=Y(l,[l.shape[0],1,l.shape[1],l.shape[2]]),p=FY(f,d,[1,n],r,`NHWC`,[1,a],o);return u?Y(p,[p.shape[2],p.shape[3]]):Y(p,[p.shape[0],p.shape[2],p.shape[3]])}const IY=W({conv1d_:dSe});function fSe(e,t,n,r,i,a=`NHWC`,o){R(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let s=e,c=t,l=!1;t.rank===3&&(l=!0,c=Y(t,[1,t.shape[0],t.shape[1],t.shape[2]]),s=[1,e[0],e[1],e[2]]),R(s.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${s.length}.`),R(c.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${c.rank}`),R(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);let u=a===`NHWC`?s[3]:s[1],d=a===`NHWC`?c.shape[3]:c.shape[1];R(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),R(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),CY(`conv2dDerInput`,i,o);let f={dy:c,filter:n},p={strides:r,pad:i,dataFormat:a,dimRoundingMode:o,inputShape:s},m=H.runKernel(KW,f,p);return l?Y(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const LY=W({conv2DBackpropInput_:fSe});function pSe(e,t,n,r,i,a){let o=U(e,`x`,`conv2dTranspose`),s=U(t,`filter`,`conv2dTranspose`);return LY(n,o,s,r,i,`NHWC`,a)}const RY=W({conv2dTranspose_:pSe});function mSe(e,t,n,r,i=`NDHWC`,a=[1,1,1]){let o=U(e,`x`,`conv3d`),s=U(t,`filter`,`conv3d`),c=o,l=!1;o.rank===4&&(l=!0,c=Y(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),R(c.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${c.rank}.`),R(s.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${s.rank}.`),R(c.shape[4]===s.shape[3],()=>`Error in conv3d: depth of input (${c.shape[4]}) must match input depth for filter ${s.shape[3]}.`),R(bY(n,a),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),R(i===`NDHWC`,()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`),R(xY(a),()=>`Error in conv3D: Dilated rates should be larger than 0.`),R(xY(n),()=>`Error in conv3D: Strides should be larger than 0.`);let u={x:c,filter:s},d={strides:n,pad:r,dataFormat:i,dilations:a},f=H.runKernel(qW,u,d);return l?Y(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const hSe=W({conv3d_:mSe});function gSe(e,t,n,r,i){R(e.length===t.rank,()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`);let a=e,o=t,s=!1;t.rank===4&&(s=!0,o=Y(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),a=[1,e[0],e[1],e[2],e[3]]);let c=a[4],l=o.shape[4];R(a.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`),R(o.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${o.rank}`),R(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),R(c===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[3]}.`),R(l===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${l}) must match output depth for filter ${n.shape[4]}.`);let u={dy:o,filter:n},d={pad:i,strides:r,inputShape:a},f=H.runKernel(YW,u,d);return s?Y(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const zY=W({conv3DBackpropInput_:gSe});function _Se(e,t,n,r,i){let a=U(e,`x`,`conv3dTranspose`),o=U(t,`filter`,`conv3dTranspose`);return zY(n,a,o,r,i)}const vSe=W({conv3dTranspose_:_Se});function ySe(e){let t={x:U(e,`x`,`cos`,`float32`)};return H.runKernel(`Cos`,t)}const BY=W({cos_:ySe});function bSe(e){let t={x:U(e,`x`,`cosh`,`float32`)};return H.runKernel(XW,t)}const VY=W({cosh_:bSe});function xSe(e,t=0,n=!1,r=!1){let i={x:U(e,`x`,`cumprod`)},a={axis:t,exclusive:n,reverse:r};return H.runKernel(ZW,i,a)}const HY=W({cumprod_:xSe});function SSe(e,t=0,n=!1,r=!1){let i={x:U(e,`x`,`cumsum`)},a={axis:t,exclusive:n,reverse:r};return H.runKernel(QW,i,a)}const UY=W({cumsum_:SSe});function CSe(e,t,n,r=!1){let i=U(e,`x`,`denseBincount`),a=U(t,`weights`,`denseBincount`);R(i.dtype===`int32`,()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`),R(i.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`),R(n>=0,()=>`size must be non-negative, but got ${n}.`),R(a.size===i.size||a.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${a.shape}.`);let o={x:i,weights:a},s={size:n,binaryOutput:r};return H.runKernel(eG,o,s)}const WY=W({denseBincount_:CSe});function wSe(e,t,n=`NHWC`){let r=U(e,`x`,`depthToSpace`,`float32`),i=n===`NHWC`?r.shape[1]:r.shape[2],a=n===`NHWC`?r.shape[2]:r.shape[3],o=n===`NHWC`?r.shape[3]:r.shape[1];R(t>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`),R(i*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${t}  for depthToSpace with input shape
    ${r.shape}`),R(a*t>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${t} for depthToSpace with input shape
        ${r.shape}`),R(o%(t*t)===0,()=>`Dimension size must be evenly divisible by ${t*t} but is ${o} for depthToSpace with input shape ${r.shape}`);let s={x:r},c={blockSize:t,dataFormat:n};return H.runKernel(tG,s,c)}const TSe=W({depthToSpace_:wSe});function ESe(e,t,n,r,i=`NHWC`,a=[1,1],o){let s=U(e,`x`,`depthwiseConv2d`,`float32`),c=U(t,`filter`,`depthwiseConv2d`,`float32`),l=s,u=!1;s.rank===3&&(u=!0,l=Y(s,[1,s.shape[0],s.shape[1],s.shape[2]])),R(l.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${l.rank}.`),R(c.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${c.rank}.`);let d=i===`NHWC`?l.shape[3]:l.shape[1];R(d===c.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${c.shape[2]}.`),CY(`depthwiseConv2d`,r,o);let f={x:l,filter:c},p={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:o},m=H.runKernel(nG,f,p);return u?Y(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const GY=W({depthwiseConv2d_:ESe});function DSe(e,t,n,r,i=[1,1],a=`NHWC`){let o=U(e,`x`,`dilation2d`),s=U(t,`filter`,`dilation2d`);R(o.rank===3||o.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${o.rank}.`),R(s.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${s.rank}.`),R(a===`NHWC`,()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`);let c=o,l=!1;o.rank===3&&(c=Y(o,[1,o.shape[0],o.shape[1],o.shape[2]]),l=!0),R(c.shape[3]===s.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${c.shape[3]} vs ${s.shape[2]}`);let u={x:c,filter:s},d={strides:n,pad:r,dilations:i},f=H.runKernel(oG,u,d);return l?Y(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const OSe=W({dilation2d_:DSe});
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
function KY(e,t){let n=e.length,r=[];for(let i=0;i<n;i++){let a=n-1-i,o=e[a]||1;(t[t.length-1-i]||1)>1&&o===1&&r.unshift(a)}return r}function qY(e,t){let n=[];for(let r=0;r<t.length;r++){let i=e[e.length-r-1],a=t.length-r-1,o=t[a];(i==null||i===1&&o>1)&&n.unshift(a)}return n}function JY(e,t){let n=Math.max(e.length,t.length),r=Array(n);for(let i=0;i<n;i++){let a=e[e.length-i-1];a??=1;let o=t[t.length-i-1];if(o??=1,a===1)r[n-i-1]=o;else if(o===1)r[n-i-1]=a;else if(a!==o){let n=`Operands could not be broadcast together with shapes ${e} and ${t}.`;throw Error(n)}else r[n-i-1]=a}return r}function kSe(e,t){let n=U(e,`a`,`equal`,`string_or_numeric`),r=U(t,`b`,`equal`,`string_or_numeric`);[n,r]=rJ(n,r),JY(n.shape,r.shape);let i={a:n,b:r};return H.runKernel(fG,i)}const YY=W({equal_:kSe});function ASe(e,t,n){let r=U(t,`a`,`where`),i=U(n,`b`,`where`),a=U(e,`condition`,`where`,`bool`),o=JY(JY(a.shape,r.shape),i.shape),s=MY(a,o),c=MY(r,o),l=MY(i,o),u={condition:s,t:c,e:l};return H.runKernel(TK,u)}const XY=W({where_:ASe});function jSe(e){let t={x:U(e,`x`,`zerosLike`)};return H.runKernel(nq,t)}const ZY=W({zerosLike_:jSe});function MSe(e,t){let n=U(e,`a`,`div`),r=U(t,`b`,`div`);[n,r]=rJ(n,r);let i=iY(n,r),a=ZY(i),o=YY(r,a);return XY(o,a,i)}const NSe=W({divNoNan_:MSe});function PSe(e,t){let n=U(e,`t1`,`dot`),r=U(t,`t2`,`dot`);R((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);let i=n.rank===1?n.size:n.shape[1],a=r.rank===1?r.size:r.shape[0];if(R(i===a,()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${a}.`),n.rank===1&&r.rank===1){let e=Y(n,[1,-1]),t=Y(r,[-1,1]),i=EY(e,t);return Y(i,[])}else if(n.rank===1&&r.rank===2){let e=Y(n,[1,-1]),t=Y(r,[r.shape[0],r.shape[1]]),i=EY(e,t);return Y(i,[i.size])}else if(n.rank===2&&r.rank===1){let e=Y(r,[-1,1]),t=EY(n,e);return Y(t,[t.size])}else{let e=Y(r,[r.shape[0],r.shape[1]]);return EY(n,e)}}const FSe=W({dot_:PSe});function ISe(e,...t){let n=t.map((e,t)=>U(e,`tensors${t}`,`einsum`)),r={equation:e};return H.runKernel(uG,n,r)}const QY=W({einsum_:ISe});function LSe(e){let t={x:U(e,`x`,`elu`,`float32`)};return H.runKernel(`Elu`,t)}const $Y=W({elu_:LSe});function RSe(e){let t=U(e,`x`,`erf`);R(t.dtype===`int32`||t.dtype===`float32`,()=>"Input dtype must be `int32` or `float32`."),t.dtype===`int32`&&(t=K(t,`float32`));let n={x:t};return H.runKernel(`Erf`,n)}const eX=W({erf_:RSe});function tX(e,t){for(let n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function nX(e,t,n){let r=e.length+t.length,i=[],a=0,o=0;for(let s=0;s<r;s++)n.indexOf(s)===-1?i.push(e[a++]):i.push(t[o++]);return i}function rX(e,t){let n=[],r=e.length;for(let i=0;i<r;i++)t.indexOf(i)===-1&&n.push(e[i]);let i=t.map(t=>e[t]);return[n,i]}function iX(e,t){let n=t.map(e=>1);return nX(e,n,t)}function aX(e,t,n){R(tX(t,n),()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${n} input.`)}function oX(e,t){if(tX(e,t))return null;let n=[];for(let r=0;r<t;++r)e.indexOf(r)===-1&&n.push(r);return e.forEach(e=>n.push(e)),n}function sX(e){return e.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function cX(e,t){let n=[];for(let r=t-e;r<t;++r)n.push(r);return n}function zSe(e,t=null,n=!1){let r={x:U(e,`x`,`max`)},i={reductionIndices:t,keepDims:n};return H.runKernel(`Max`,r,i)}const lX=W({max_:zSe});function BSe(e,t=null,n=!1){let r={x:U(e,`x`,`min`)},i={axis:t,keepDims:n};return H.runKernel(`Min`,r,i)}const uX=W({min_:BSe});function VSe(e,t){let n=U(e,`base`,`pow`),r=U(t,`exp`,`pow`);[n,r]=rJ(n,r);let i={a:n,b:r};return H.runKernel(`Pow`,i)}const dX=W({pow_:VSe});function fX(e,t){if((Fq(e)&&t!==`string`||Array.isArray(e))&&t!==`complex64`)throw Error(`Error creating a new Scalar: value must be a primitive (number|boolean|string)`);if(t===`string`&&Fq(e)&&!(e instanceof Uint8Array))throw Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return bJ(e,[],[],t)}function HSe(e){let t={x:U(e,`x`,`sqrt`,`float32`)};return H.runKernel(MK,t)}const pX=W({sqrt_:HSe});function USe(e){let t=U(e,`x`,`square`);return H.runKernel(`Square`,{x:t},{})}const mX=W({square_:USe});function WSe(e,t=null,n=!1){let r=U(e,`x`,`sum`);r.dtype===`bool`&&(r=K(r,`int32`));let i={x:r},a={axis:t,keepDims:n};return H.runKernel(`Sum`,i,a)}const hX=W({sum_:WSe});function GSe(e,t=`euclidean`,n=null,r=!1){e=U(e,`x`,`norm`);let i=gX(e,t,n),a=i.shape;if(r){let t=LU(n,e.shape);a=iX(i.shape,t)}return Y(i,a)}function gX(e,t,n=null){if(e.rank===0)return aY(e);if(e.rank!==1&&n===null)return gX(Y(e,[-1]),t,n);if(e.rank===1||typeof n==`number`||Array.isArray(n)&&n.length===1){if(t===1)return hX(aY(e),n);if(t===1/0)return lX(aY(e),n);if(t===-1/0)return uX(aY(e),n);if(t===`euclidean`||t===2)return pX(hX(dX(aY(e),fX(2,`int32`)),n));throw Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(n)&&n.length===2){if(t===1)return lX(hX(aY(e),n[0]),n[1]-1);if(t===1/0)return lX(hX(aY(e),n[1]),n[0]);if(t===-1/0)return uX(hX(aY(e),n[1]),n[0]);if(t===`fro`||t===`euclidean`)return pX(hX(mX(e),n));throw Error(`Error in norm: invalid ord value: ${t}`)}throw Error(`Error in norm: invalid axis: ${n}`)}const _X=W({norm_:GSe});function KSe(e,t=null,n=!1){return _X(e,`euclidean`,t,n)}const qSe=W({euclideanNorm_:KSe});function JSe(e){let t={x:U(e,`x`,`exp`)};return H.runKernel(`Exp`,t)}const vX=W({exp_:JSe});function YSe(e,t=0){let n=U(e,`x`,`expandDims`,`string_or_numeric`);R(t<=n.rank,()=>`Axis must be <= rank of the tensor`);let r={input:n},i={dim:t};return H.runKernel(pG,r,i)}const yX=W({expandDims_:YSe});function XSe(e){let t={x:U(e,`x`,`expm1`)};return H.runKernel(mG,t)}const ZSe=W({expm1_:XSe});function QSe(e,t){let n=U(e,`x`,`tile`,`string_or_numeric`);R(n.rank===t.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${t}.`);let r={x:n},i={reps:t};return H.runKernel(YK,r,i)}const bX=W({tile_:QSe});function $Se(e,t,n,r=`float32`){t??=e;let i=tY([e,t],r),a=e<=t?e:t;for(let e=0;e<a;++e)i.set(1,e,e);let o=Y(i.toTensor(),[e,t]);if(n==null)return o;if(n.length===1)return bX(yX(o,0),[n[0],1,1]);if(n.length===2)return bX(yX(yX(o,0),0),[n[0],n[1],1,1]);if(n.length===3)return bX(yX(yX(yX(o,0),0),0),[n[0],n[1],n[2],1,1]);throw Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const xX=W({eye_:$Se});function eCe(e){let t={x:U(e,`x`,`floor`,`float32`)};return H.runKernel(_G,t)}const SX=W({floor_:eCe});function tCe(e,t,n=0,r=0){let i=U(e,`x`,`gather`),a=U(t,`indices`,`gather`,`int32`),o={x:i,indices:a},s={axis:n,batchDims:r};return H.runKernel(bG,o,s)}const CX=W({gather_:tCe});function nCe(e,t){let n=U(e,`a`,`greater`,`string_or_numeric`),r=U(t,`b`,`greater`,`string_or_numeric`);[n,r]=rJ(n,r),JY(n.shape,r.shape);let i={a:n,b:r};return H.runKernel(SG,i)}const wX=W({greater_:nCe});function rCe(e,t){let n=U(e,`a`,`greaterEqual`,`string_or_numeric`),r=U(t,`b`,`greaterEqual`,`string_or_numeric`);[n,r]=rJ(n,r),JY(n.shape,r.shape);let i={a:n,b:r};return H.runKernel(CG,i)}const TX=W({greaterEqual_:rCe});function iCe(e){let t={input:U(e,`input`,`imag`)};return H.runKernel(EG,t)}const EX=W({imag_:iCe});function aCe(e){let t={x:U(e,`x`,`isFinite`)};return H.runKernel(DG,t)}const oCe=W({isFinite_:aCe});function sCe(e){let t={x:U(e,`x`,`isInf`)};return H.runKernel(OG,t)}const cCe=W({isInf_:sCe});function lCe(e){let t={x:U(e,`x`,`isNaN`)};return H.runKernel(kG,t)}const uCe=W({isNaN_:lCe});function dCe(e,t=.2){let n={x:U(e,`x`,`leakyRelu`)},r={alpha:t};return H.runKernel(AG,n,r)}const DX=W({leakyRelu_:dCe});function fCe(e,t){let n=U(e,`a`,`less`,`string_or_numeric`),r=U(t,`b`,`less`,`string_or_numeric`);[n,r]=rJ(n,r),JY(n.shape,r.shape);let i={a:n,b:r};return H.runKernel(jG,i)}const OX=W({less_:fCe});function pCe(e,t){let n=U(e,`a`,`lessEqual`,`string_or_numeric`),r=U(t,`b`,`lessEqual`,`string_or_numeric`);[n,r]=rJ(n,r),JY(n.shape,r.shape);let i={a:n,b:r};return H.runKernel(MG,i)}const kX=W({lessEqual_:pCe});function mCe(e,t=5,n=1,r=1,i=.5){let a=U(e,`x`,`localResponseNormalization`);R(a.rank===4||a.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${a.rank}.`),R(MU(t),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`);let o=a,s=!1;a.rank===3&&(s=!0,o=Y(a,[1,a.shape[0],a.shape[1],a.shape[2]]));let c={x:o},l={depthRadius:t,bias:n,alpha:r,beta:i},u=H.runKernel(`LRN`,c,l);return s?Y(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const hCe=W({localResponseNormalization_:mCe});function gCe(e){let t={x:U(e,`x`,`log`,`float32`)};return H.runKernel(`Log`,t)}const AX=W({log_:gCe});function _Ce(e){let t={x:U(e,`x`,`log1p`)};return H.runKernel(PG,t)}const jX=W({log1p_:_Ce});function vCe(e,t){R(XU(e),()=>`The f passed in variableGrads(f) must be a function`),R(t==null||Array.isArray(t)&&t.every(e=>e instanceof Jq),()=>`The varList passed in variableGrads(f, varList) must be an array of variables`);let n=t!=null;if(!n)for(let e in t=[],H.registeredVariables)t.push(H.registeredVariables[e]);let r=n?t.filter(e=>!e.trainable):null,i=t.length;t=t.filter(e=>e.trainable),R(t.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`);let{value:a,grads:o}=H.gradients(e,t,null,!0);R(o.some(e=>e!=null),()=>`Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize().`),R(a.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`);let s={};return t.forEach((e,t)=>{o[t]!=null&&(s[e.name]=o[t])}),r?.forEach(e=>s[e.name]=null),{value:a,grads:s}}function MX(e){return H.customGrad(e)}function yCe(e){let t={x:U(e,`x`,`neg`)};return H.runKernel(`Neg`,t)}const NX=W({neg_:yCe});function bCe(e){let t={x:U(e,`x`,`softplus`)};return H.runKernel(jK,t)}const PX=W({softplus_:bCe});function xCe(e){let t=U(e,`x`,`logSigmoid`);return MX(e=>({value:NX(PX(NX(e))),gradFunc:t=>J(t,DY(NX(e)))}))(t)}const SCe=W({logSigmoid_:xCe});function CCe(e,t){let n=U(e,`a`,`sub`),r=U(t,`b`,`sub`);[n,r]=rJ(n,r);let i={a:n,b:r};return H.runKernel(`Sub`,i)}const FX=W({sub_:CCe});function wCe(e,t=-1){let n=U(e,`logits`,`logSoftmax`);if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${t}`);return MX((e,n)=>{let r=lX(e,t,!0),i=FX(e,r),a=FX(K(i,`float32`),AX(hX(vX(i),t,!0)));return n([a]),{value:a,gradFunc:(e,n)=>{let[r]=n,i=vX(r);return FX(e,J(hX(e,t,!0),i))}}})(n)}const IX=W({logSoftmax_:wCe});function TCe(e,t=null,n=!1){let r=U(e,`x`,`logSumExp`),i=LU(t,r.shape),a=lX(r,i,!0),o=FX(r,a),s=vX(o),c=hX(s,i),l=AX(c),u=q(Y(a,l.shape),l);if(n){let e=iX(u.shape,i);return Y(u,e)}return u}const LX=W({logSumExp_:TCe});function ECe(e,t){let n=U(e,`a`,`logicalAnd`,`bool`),r=U(t,`b`,`logicalAnd`,`bool`);JY(n.shape,r.shape);let i={a:n,b:r};return H.runKernel(FG,i)}const RX=W({logicalAnd_:ECe});function DCe(e){let t={x:U(e,`x`,`logicalNot`,`bool`)};return H.runKernel(IG,t)}const zX=W({logicalNot_:DCe});function OCe(e,t){let n=U(e,`a`,`logicalOr`,`bool`),r=U(t,`b`,`logicalOr`,`bool`);JY(n.shape,r.shape);let i={a:n,b:r};return H.runKernel(LG,i)}const BX=W({logicalOr_:OCe});function kCe(e,t){let n=U(e,`a`,`logicalXor`,`bool`),r=U(t,`b`,`logicalXor`,`bool`);return JY(n.shape,r.shape),RX(BX(e,t),zX(RX(e,t)))}const ACe=W({logicalXor_:kCe});function jCe(e,t,n,r,i){let a=U(e,`x`,`maxPool`),o=a,s=!1;a.rank===3&&(s=!0,o=Y(a,[1,a.shape[0],a.shape[1],a.shape[2]])),R(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),R(bY(n,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '1'`),CY(`maxPool`,r,i);let c={x:o},l={filterSize:t,strides:n,pad:r,dimRoundingMode:i},u=H.runKernel(BG,c,l);return s?Y(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const VX=W({maxPool_:jCe});function MCe(e,t=[1,1,1],n,r,i,a=`NDHWC`){let o=U(e,`x`,`maxPool3d`),s=o,c=!1;o.rank===4&&(c=!0,s=Y(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),R(s.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${s.rank}.`),R(a===`NDHWC`,()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),CY(`maxPool3d`,r,i);let l={x:s},u={filterSize:t,strides:n,pad:r,dimRoundingMode:i,dataFormat:a},d=H.runKernel(HG,l,u);return c?Y(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const NCe=W({maxPool3d_:MCe});function PCe(e,t){let n=U(e,`a`,`maximum`),r=U(t,`b`,`maximum`);[n,r]=rJ(n,r),n.dtype===`bool`&&(n=K(n,`int32`),r=K(r,`int32`)),JY(n.shape,r.shape);let i={a:n,b:r};return H.runKernel(zG,i)}const HX=W({maximum_:PCe});function FCe(e,t=null,n=!1){let r={x:U(e,`x`,`mean`)},i={axis:t,keepDims:n};return H.runKernel(GG,r,i)}const UX=W({mean_:FCe});function WX(e,t=`float32`){if(aW(e),t===`complex64`){let t=WX(e,`float32`),n=WX(e,`float32`);return yJ(t,n)}let n=rW(z(e),t);return H.makeTensor(n,e,t)}function GX(e,t=`float32`){if(aW(e),t===`complex64`){let t=GX(e,`float32`),n=WX(e,`float32`);return yJ(t,n)}let n=nW(z(e),t);return H.makeTensor(n,e,t)}function ICe(e,t){let n=U(e,`a`,`minimum`),r=U(t,`b`,`minimum`);[n,r]=rJ(n,r),n.dtype===`bool`&&(n=K(n,`int32`),r=K(r,`int32`)),JY(n.shape,r.shape);let i={a:n,b:r};return H.runKernel(KG,i)}const KX=W({minimum_:ICe});function LCe(e,t,n){R(n===`reflect`||n===`symmetric`,()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);let r=U(e,`x`,`mirrorPad`);if(r.rank===0)throw Error(`mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad`);R(t.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${t.length}.`);let i=n===`reflect`?1:0;for(let e=0;e<r.rank;e++)R(t[e].length===2,()=>`Invalid number of paddings. Must be length of 2 each.`),R(t[e][0]>=0&&t[e][0]<=r.shape[e]-i&&t[e][1]>=0&&t[e][1]<=r.shape[e]-i,()=>`Padding in dimension ${e} cannot be greater than or equal to ${r.shape[e]-i} or less than 0 for input of shape ${r.shape}`);let a={paddings:t,mode:n},o={x:r};return H.runKernel(qG,o,a)}const RCe=W({mirrorPad_:LCe});function zCe(e,t){let n=U(e,`a`,`mod`),r=U(t,`b`,`mod`);[n,r]=rJ(n,r);let i={a:n,b:r};return H.runKernel(`Mod`,i)}const BCe=W({mod_:zCe});function VCe(e,t=null,n=!1){e=U(e,`x`,`moments`);let r=LU(t,e.shape),i=UX(e,r,n),a=i.shape;n||(a=iX(i.shape,r));let o=mX(FX(K(e,`float32`),Y(i,a))),s=UX(o,r,n);return{mean:i,variance:s}}const qX=W({moments_:VCe});function HCe(e,t){let n=U(e,`a`,`notEqual`,`string_or_numeric`),r=U(t,`b`,`notEqual`,`string_or_numeric`);[n,r]=rJ(n,r),JY(n.shape,r.shape);let i={a:n,b:r};return H.runKernel(XG,i)}const JX=W({notEqual_:HCe});function UCe(e,t,n=1,r=0,i=`int32`){if(t<2)throw Error(`Error in oneHot: depth must be >=2, but it is ${t}`);let a={indices:U(e,`indices`,`oneHot`,`int32`)},o={dtype:i,depth:t,onValue:n,offValue:r};return H.runKernel(tK,a,o)}const YX=W({oneHot_:UCe});function WCe(e){let t={x:U(e,`x`,`onesLike`)};return H.runKernel(eK,t)}const XX=W({onesLike_:WCe});function GCe(e,t,n=0){let r=U(e,`x`,`pad`);if(r.rank===0)throw Error(`pad(scalar) is not defined. Pass non-scalar to pad`);let i={paddings:t,constantValue:n},a={x:r};return H.runKernel(rK,a,i)}const ZX=W({pad_:GCe});function KCe(e,t,n){let r=U(e,`x`,`spaceToBatchND`);R(r.rank>=1+t.length,()=>`input rank ${r.rank} should be > than [blockShape] ${t.length}`),R(n.length===t.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${t.length}`),R(r.shape.reduce((e,r,i)=>i>0&&i<=t.length?e&&(r+n[i-1][0]+n[i-1][1])%t[i-1]===0:e,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${t.toString()}`);let i={x:r},a={blockShape:t,paddings:n};return H.runKernel(NK,i,a)}const QX=W({spaceToBatchND_:KCe});function qCe(e,t,n,r,i,a,o){i??=[1,1],a??=1,r===0&&(r=`valid`);let s=U(e,`x`,`maxPool`),c=s,l=!1;s.rank===3&&(l=!0,c=Y(s,[1,s.shape[0],s.shape[1],s.shape[2]])),R(bY(a,i),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${i}'`);let u=uY(c.shape,t,a,i,r),d=[u.dilationHeight,u.dilationWidth],f;f=r===`same`?YCe([u.filterHeight,u.filterWidth],d):[[0,0],[0,0]];let p=d[0]===1&&d[1]===1,[m,h]=JCe([u.inHeight,u.inWidth],d,f),g=p?r:`valid`,_=p?c:QX(c,d,m),v=(n===`avg`?()=>wY(_,t,a,g,o):()=>VX(_,t,a,g,o))(),y=p?v:AY(v,d,h);return l?Y(y,[y.shape[1],y.shape[2],y.shape[3]]):y}function JCe(e,t,n){let r=n.map(e=>e[0]),i=n.map(e=>e[1]),a=e.concat(r,i),o=t.map((e,t)=>(e-a[t]%e)%e),s=i.map((e,t)=>e+o[t]),c=t.map((e,t)=>[r[t],s[t]]),l=t.map((e,t)=>[0,o[t]]);return[c,l]}function YCe(e,t){let n=e.map((e,n)=>e+(e-1)*(t[n]-1)).map(e=>e-1),r=n.map(e=>Math.floor(e/2)),i=n.map((e,t)=>e-r[t]);return n.map((e,t)=>[r[t],i[t]])}const XCe=W({pool_:qCe});function ZCe(e,t){let n=U(e,`x`,`prelu`),r=U(t,`alpha`,`prelu`),i={x:n,alpha:r};return H.runKernel(iK,i)}const $X=W({prelu_:ZCe});function QCe(e,t=null,n=!1){let r=U(e,`x`,`prod`);r.dtype===`bool`&&(r=K(r,`int32`));let i={x:r},a={axis:t,keepDims:n};return H.runKernel(aK,i,a)}const $Ce=W({prod_:QCe});var ewe=o(((e,t)=>{(function(e,t,n){function r(e){var t=this,n=o();t.next=function(){var e=2091639*t.s0+t.c*23283064365386963e-26;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=e|0)},t.c=1,t.s0=n(` `),t.s1=n(` `),t.s2=n(` `),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function a(e,t){var n=new r(e),a=t&&t.state,o=n.next;return o.int32=function(){return n.next()*4294967296|0},o.double=function(){return o()+(o()*2097152|0)*11102230246251565e-32},o.quick=o,a&&(typeof a==`object`&&i(a,n),o.state=function(){return i(n,{})}),o}function o(){var e=4022871197;return function(t){t=String(t);for(var n=0;n<t.length;n++){e+=t.charCodeAt(n);var r=.02519603282416938*e;e=r>>>0,r-=e,r*=e,e=r>>>0,r-=e,e+=r*4294967296}return(e>>>0)*23283064365386963e-26}}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.alea=a})(e,typeof t==`object`&&t,typeof define==`function`&&define)})),twe=o(((e,t)=>{(function(e,t,n){function r(e){var t=this,n=``;t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(e|0)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=n.charCodeAt(r)|0,t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function a(e,t){var n=new r(e),a=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,r=(e+t)/(1<<21);while(r===0);return r},o.int32=n.next,o.quick=o,a&&(typeof a==`object`&&i(a,n),o.state=function(){return i(n,{})}),o}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.xor128=a})(e,typeof t==`object`&&t,typeof define==`function`&&define)})),nwe=o(((e,t)=>{(function(e,t,n){function r(e){var t=this,n=``;t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^(e^e<<1))|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(e|0)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=n.charCodeAt(r)|0,r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function a(e,t){var n=new r(e),a=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,r=(e+t)/(1<<21);while(r===0);return r},o.int32=n.next,o.quick=o,a&&(typeof a==`object`&&i(a,n),o.state=function(){return i(n,{})}),o}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.xorwow=a})(e,typeof t==`object`&&t,typeof define==`function`&&define)})),rwe=o(((e,t)=>{(function(e,t,n){function r(e){var t=this;t.next=function(){var e=t.x,n=t.i,r=e[n],i;return r^=r>>>7,i=r^r<<24,r=e[n+1&7],i^=r^r>>>10,r=e[n+3&7],i^=r^r>>>3,r=e[n+4&7],i^=r^r<<7,r=e[n+7&7],r^=r<<13,i^=r^r<<9,e[n]=i,t.i=n+1&7,i};function n(e,t){var n,r=[];if(t===(t|0))r[0]=t;else for(t=``+t,n=0;n<t.length;++n)r[n&7]=r[n&7]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&r[n]===0;++n);for(n==8?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}n(t,e)}function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function a(e,t){e??=+new Date;var n=new r(e),a=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,r=(e+t)/(1<<21);while(r===0);return r},o.int32=n.next,o.quick=o,a&&(a.x&&i(a,n),o.state=function(){return i(n,{})}),o}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.xorshift7=a})(e,typeof t==`object`&&t,typeof define==`function`&&define)})),iwe=o(((e,t)=>{(function(e,t,n){function r(e){var t=this;t.next=function(){var e=t.w,n=t.X,r=t.i,i,a;return t.w=e=e+1640531527|0,a=n[r+34&127],i=n[r=r+1&127],a^=a<<13,i^=i<<17,a^=a>>>15,i^=i>>>12,a=n[r]=a^i,t.i=r,a+(e^e>>>16)|0};function n(e,t){var n,r,i,a,o,s=[],c=128;for(t===(t|0)?(r=t,t=null):(t+=`\0`,r=0,c=Math.max(c,t.length)),i=0,a=-32;a<c;++a)t&&(r^=t.charCodeAt((a+32)%t.length)),a===0&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(o=o+1640531527|0,n=s[a&127]^=r+o,i=n==0?i+1:0);for(i>=128&&(s[(t&&t.length||0)&127]=-1),i=127,a=512;a>0;--a)r=s[i+34&127],n=s[i=i+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[i]=r^n;e.w=o,e.X=s,e.i=i}n(t,e)}function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function a(e,t){e??=+new Date;var n=new r(e),a=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,r=(e+t)/(1<<21);while(r===0);return r},o.int32=n.next,o.quick=o,a&&(a.X&&i(a,n),o.state=function(){return i(n,{})}),o}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.xor4096=a})(e,typeof t==`object`&&t,typeof define==`function`&&define)})),awe=o(((e,t)=>{(function(e,t,n){function r(e){var t=this,n=``;t.next=function(){var e=t.b,n=t.c,r=t.d,i=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^i,i=i-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^i,t.a=i-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=e|0):n+=e;for(var r=0;r<n.length+20;r++)t.b^=n.charCodeAt(r)|0,t.next()}function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function a(e,t){var n=new r(e),a=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do var e=n.next()>>>11,t=(n.next()>>>0)/4294967296,r=(e+t)/(1<<21);while(r===0);return r},o.int32=n.next,o.quick=o,a&&(typeof a==`object`&&i(a,n),o.state=function(){return i(n,{})}),o}t&&t.exports?t.exports=a:n&&n.amd?n(function(){return a}):this.tychei=a})(e,typeof t==`object`&&t,typeof define==`function`&&define)})),owe=o(((e,t)=>{(function(e,n,r){var i=256,a=6,o=52,s=`random`,c=r.pow(i,a),l=r.pow(2,o),u=l*2,d=i-1,f;function p(e,t,o){var d=[];t=t==1?{entropy:!0}:t||{};var f=_(g(t.entropy?[e,y(n)]:e??v(),3),d),p=new m(d),b=function(){for(var e=p.g(a),t=c,n=0;e<l;)e=(e+n)*i,t*=i,n=p.g(1);for(;e>=u;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return p.g(4)|0},b.quick=function(){return p.g(4)/4294967296},b.double=b,_(y(p.S),n),(t.pass||o||function(e,t,n,i){return i&&(i.S&&h(i,p),e.state=function(){return h(p,{})}),n?(r[s]=e,t):e})(b,f,`global`in t?t.global:this==r,t.state)}function m(e){var t,n=e.length,r=this,a=0,o=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);a<i;)s[a]=a++;for(a=0;a<i;a++)s[a]=s[o=d&o+e[a%n]+(t=s[a])],s[o]=t;(r.g=function(e){for(var t,n=0,a=r.i,o=r.j,s=r.S;e--;)t=s[a=d&a+1],n=n*i+s[d&(s[a]=s[o=d&o+t])+(s[o]=t)];return r.i=a,r.j=o,n})(i)}function h(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function g(e,t){var n=[],r=typeof e,i;if(t&&r==`object`)for(i in e)try{n.push(g(e[i],t-1))}catch{}return n.length?n:r==`string`?e:e+`\0`}function _(e,t){for(var n=e+``,r,i=0;i<n.length;)t[d&i]=d&(r^=t[d&i]*19)+n.charCodeAt(i++);return y(t)}function v(){try{var t;return f&&(t=f.randomBytes)?t=t(i):(t=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(t)),y(t)}catch{var r=e.navigator,a=r&&r.plugins;return[+new Date,e,a,e.screen,y(n)]}}function y(e){return String.fromCharCode.apply(0,e)}if(_(r.random(),n),typeof t==`object`&&t.exports){t.exports=p;try{f=$J()}catch{}}else typeof define==`function`&&define.amd?define(function(){return p}):r[`seed`+s]=p})(typeof self<`u`?self:e,[],Math)})),eZ=o(((e,t)=>{var n=ewe(),r=twe(),i=nwe(),a=rwe(),o=iwe(),s=awe(),c=owe();c.alea=n,c.xor128=r,c.xorwow=i,c.xorshift7=a,c.xor4096=o,c.tychei=s,t.exports=c})),tZ=l(eZ()),nZ=class{constructor(e,t,n,r,i){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);let a=i||Math.random();this.random=tZ.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){let e=this.nextVal;return this.nextVal=NaN,e}let e,t,n=!1;for(;!n;){let r,i,a;do r=2*this.random()-1,i=2*this.random()-1,a=r*r+i*i;while(a>=1||a===0);let o=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*r*o,t=this.mean+this.stdDev*i*o,(!this.truncated||this.isValidTruncated(e))&&(n=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype===`float32`?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}},swe=class{constructor(e=0,t=1,n,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype===`float32`,this.min=e,this.range=t-e,this.dtype=n,r??=Math.random(),typeof r==`number`&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=tZ.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}};function cwe(e,t=0,n=1,r,i){if(aW(e),r!=null&&r===`bool`)throw Error(`Unsupported data type ${r}`);let a=new nZ(t,n,r,!1,i),o=tY(e,r);for(let e=0;e<o.values.length;e++)o.values[e]=a.nextValue();return o.toTensor()}const lwe=W({randomNormal_:cwe});function uwe(e,t=0,n=1,r=`float32`,i){aW(e);let a=tY(e,r),o=new swe(t,n,null,i);for(let e=0;e<a.values.length;e++)a.values[e]=o.nextValue();return a.toTensor()}const rZ=W({randomUniform_:uwe});function iZ(e,t,n=1,r=`float32`){if(n===0)throw Error(`Cannot have a step of zero`);let i={start:e,stop:t,step:n,dtype:r};return H.runKernel(lK,{},i)}function dwe(e){let t={input:U(e,`input`,`real`)};return H.runKernel(uK,t)}const aZ=W({real_:dwe});function fwe(e){let t={x:U(e,`x`,`reciprocal`)};return H.runKernel(dK,t)}const pwe=W({reciprocal_:fwe});function mwe(e){let t={x:U(e,`x`,`relu`)};return H.runKernel(fK,t)}const oZ=W({relu_:mwe});function hwe(e){let t={x:U(e,`x`,`relu6`)};return H.runKernel(vK,t)}const sZ=W({relu6_:hwe});function gwe(e,t){let n={x:U(e,`x`,`reverse`)},r={dims:t};return H.runKernel(yK,n,r)}const cZ=W({reverse_:gwe});function _we(e){let t={x:U(e,`x`,`round`)};return H.runKernel(bK,t)}const lZ=W({round_:_we});function vwe(e){let t={x:U(e,`x`,`rsqrt`,`float32`)};return H.runKernel(xK,t)}const uZ=W({rsqrt_:vwe});function ywe(e){let t={x:U(e,`x`,`selu`)};return H.runKernel(EK,t)}const dZ=W({selu_:ywe});function bwe(e,t,n,r,i,a=[1,1],o=`NHWC`){let s=U(e,`x`,`separableConv2d`),c=U(t,`depthwiseFilter`,`separableConv2d`),l=U(n,`pointwiseFilter`,`separableConv2d`),u=s,d=!1;if(s.rank===3&&(d=!0,u=Y(s,[1,s.shape[0],s.shape[1],s.shape[2]])),o===`NCHW`)throw Error(`separableConv2d currently does not support dataFormat NCHW; only NHWC is supported`);R(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),R(c.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${c.rank}.`),R(l.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${c.rank}.`),R(l.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${l.shape[0]}.`),R(l.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${l.shape[1]}.`);let f=c.shape[2],p=c.shape[3];R(l.shape[2]===f*p,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${f*p}, but got ${l.shape[2]}.`);let m=GY(u,c,r,i,o,a),h=FY(m,l,1,`valid`,o);return d?Y(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const fZ=W({separableConv2d_:bwe});function xwe(e){let t={x:U(e,`x`,`sign`)};return H.runKernel(kK,t)}const Swe=W({sign_:xwe});function Cwe(e){let t={x:U(e,`x`,`sin`,`float32`)};return H.runKernel(`Sin`,t)}const pZ=W({sin_:Cwe});function wwe(e){let t={x:U(e,`x`,`sinh`)};return H.runKernel(OK,t)}const mZ=W({sinh_:wwe});function Twe(e,t,n){let r=U(e,`x`,`slice1d`);return R(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),OY(r,[t],[n])}const hZ=W({slice1d_:Twe});function Ewe(e,t,n){let r=U(e,`x`,`slice2d`);return R(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),OY(r,t,n)}const gZ=W({slice2d_:Ewe});function Dwe(e,t,n){let r=U(e,`x`,`slice3d`);return R(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),OY(r,t,n)}const _Z=W({slice3d_:Dwe});function Owe(e,t,n){let r=U(e,`x`,`slice4d`);return R(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),OY(r,t,n)}const vZ=W({slice4d_:Owe});function kwe(e,t=-1){let n=U(e,`logits`,`softmax`,`float32`);if(t===-1&&(t=n.rank-1),t!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${t}`);let r={logits:n},i={dim:t};return H.runKernel(FK,r,i)}const yZ=W({softmax_:kwe});function Awe(e){R(e.dtype===`complex64`,()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`);let t={input:e};return H.runKernel(`FFT`,t)}const bZ=W({fft_:Awe});function jwe(e){R(e.dtype===`complex64`,()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`);let t={input:e};return H.runKernel(TG,t)}const xZ=W({ifft_:jwe});function Mwe(e){let t=e.shape[e.shape.length-1],n=e.size/t,r;if(t<=2){let i=Y(e,[n,t]);r=xZ(i)}else{let i=[n,2*(t-1)],a=Y(aZ(e),[n,t]),o=Y(EX(e),[n,t]),s=cZ(OY(a,[0,1],[n,t-2]),1),c=J(cZ(OY(o,[0,1],[n,t-2]),1),fX(-1)),l=TY([a,s],1),u=TY([o,c],1),d=Y(yJ(l,u),[i[0],i[1]]);r=xZ(d)}if(r=aZ(r),e.rank===3&&e.shape[0]!==0){let t=r,n=e.shape[0];r=Y(r,[n,r.shape[0]/n,r.shape[1]]),t.dispose()}return r}const Nwe=W({irfft_:Mwe});function Pwe(e,t,n=0){let r={x:U(e,`x`,`split`)},i={numOrSizeSplits:t,axis:n};return H.runKernel(PK,r,i)}const SZ=W({split_:Pwe});function Fwe(e,t){R(e.dtype===`float32`,()=>`The dtype for rfft() must be real value but got ${e.dtype}`);let n=e.shape[e.shape.length-1],r=e.size/n,i;if(t!=null&&t<n){let r=e.shape.map(e=>0),a=e.shape.map(e=>e);a[e.shape.length-1]=t,i=OY(e,r,a),n=t}else if(t!=null&&t>n){let r=e.shape.map(e=>e);r[e.shape.length-1]=t-n,i=TY([e,WX(r)],e.shape.length-1),n=t}else i=e;let a=ZY(i),o=Y(yJ(i,a),[r,n]),s=bZ(o),c=Math.floor(n/2)+1,l=aZ(s),u=EX(s),d=SZ(l,[c,n-c],l.shape.length-1),f=SZ(u,[c,n-c],u.shape.length-1),p=i.shape.slice();return p[i.shape.length-1]=c,Y(yJ(d[0],f[0]),p)}const Iwe=W({rfft_:Fwe});function Lwe(e,t){let n=U(e,`a`,`squaredDifference`),r=U(t,`b`,`squaredDifference`);[n,r]=rJ(n,r),JY(n.shape,r.shape);let i={a:n,b:r};return H.runKernel(VK,i,{})}const Rwe=W({squaredDifference_:Lwe});function zwe(e,t){let n=U(e,`x`,`squeeze`,`string_or_numeric`);return Y(n,RU(n.shape,t).newShape)}const CZ=W({squeeze_:zwe});function Bwe(e,t=0){let n=vJ(e,`tensors`,`stack`,`string_or_numeric`);R(n.length>=1,()=>`Pass at least one tensor to tf.stack`),n.length>0&&R(t<=n[0].rank,()=>`Axis must be <= rank of the tensor`);let r=n,i={axis:t};return H.runKernel(nK,r,i)}const wZ=W({stack_:Bwe});function Vwe(e,t=0){let n={x:U(e,`x`,`step`)},r={alpha:t};return H.runKernel(rq,n,r)}const TZ=W({step_:Vwe});function Hwe(e,t,n,r,i=0,a=0,o=0,s=0,c=0){let l={x:U(e,`x`,`stridedSlice`,`string_or_numeric`)},u={begin:t,end:n,strides:r,beginMask:i,endMask:a,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:c};return H.runKernel(WK,l,u)}const Uwe=W({stridedSlice_:Hwe});function Wwe(e){let t={x:U(e,`x`,`tan`,`float32`)};return H.runKernel(`Tan`,t)}const Gwe=W({tan_:Wwe});function EZ(e,t){AU(e);let n=hJ(e,t);if(n.length!==1)throw Error(`tensor1d() requires values to be a flat/TypedArray`);return bJ(e,null,n,t)}function DZ(e,t,n){if(AU(e),t!=null&&t.length!==2)throw Error(`tensor2d() requires shape to have two numbers`);let r=hJ(e,n);if(r.length!==2&&r.length!==1)throw Error(`tensor2d() requires values to be number[][] or flat/TypedArray`);if(r.length===1&&t==null)throw Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return bJ(e,t,r,n)}function OZ(e,t,n){let r=t.rank>1?t.shape[t.rank-1]:1,i=t.rank>1?t.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw Error(a+` update.rank < ${i}. `);if(e.length<r+(n.rank-i))throw Error(a+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+e.length-r)throw Error(a+` update.rank != ${i+e.length-r}`);for(let e=0;e<i;++e)if(n.shape[e]!==t.shape[e])throw Error(a+` updates.shape[${e}] (${n.shape[e]}) != indices.shape[${e}] (${t.shape[e]}).`);for(let t=0;t<n.rank-i;++t)if(n.shape[t+i]!==e[t+r])throw Error(a+` updates.shape[${t+i}] (${n.shape[t+i]}) != shape[${t+i}] (${e[t+i]})`)}function Kwe(e,t,n){if(t.rank<1)throw Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.dtype!==`int32`)throw Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(n.length<1)throw Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(t.size===0)throw Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(e.size===0)throw Error(`Updates specified for empty output. updates shape: ${e.shape}`)}OZ(n,t,e)}function kZ(e,t,n){let r=t.shape.length,i=r>1?t.shape[r-1]:1,a=n.length,o=1;for(let e=i;e<a;++e)o*=n[e];let s=i<1?1:i,c=z(t.shape)/s,l=[...QU(n.slice(0,i)),1],u=z(n);return{sliceRank:i,numUpdates:c,sliceSize:o,strides:l,outputSize:u}}function qwe(e,t=1,n=!0){let r=U(e,`x`,`topk`);if(r.rank===0)throw Error(`topk() expects the input to be of rank 1 or higher`);let i=r.shape[r.shape.length-1];if(t<0)throw Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>i)throw Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${t}`);let a={x:r},o={k:t,sorted:n},[s,c]=H.runKernel(XK,a,o);return{values:s,indices:c}}const Jwe=W({topk_:qwe});function Ywe(e,t=0,n=1,r,i){if(aW(e),r!=null&&r===`bool`)throw Error(`Unsupported data type $ { dtype }`);let a=new nZ(t,n,r,!0,i),o=tY(e,r);for(let e=0;e<o.values.length;e++)o.values[e]=a.nextValue();return o.toTensor()}const AZ=W({truncatedNormal_:Ywe});function Xwe(e,t=0){let n=U(e,`x`,`unique`,`string_or_numeric`);R(n.rank>0,()=>`The input tensor must be at least 1D`);let r={x:n},i={axis:t},[a,o]=H.runKernel($K,r,i);return{values:a,indices:o}}const Zwe=W({unique_:Xwe});function Qwe(e,t,n){let r=U(e,`x`,`unsortedSegmentSum`),i=U(t,`segmentIds`,`unsortedSegmentSum`,`int32`);R(MU(n),()=>`numSegments must be of dtype int`);let a={x:r,segmentIds:i},o={numSegments:n};return H.runKernel(tq,a,o)}const jZ=W({unsortedSegmentSum_:Qwe});function $we(e,t=0){let n=U(e,`x`,`unstack`,`string_or_numeric`);R(t>=-n.shape.length&&t<n.shape.length,()=>`Axis = ${t} is not in [-${n.shape.length}, ${n.shape.length})`);let r={value:n},i={axis:t};return H.runKernel(eq,r,i)}const MZ=W({unstack_:$we});function eTe(e,t=!0,n,r){return H.makeVariable(e,t,n,r)}function NZ(e,t){let n=[];for(let e=0;e<t.length;e++)t[e]&&n.push(e);let r=tY(e,`int32`),i=tY([n.length,e.length],`int32`);for(let t=0;t<n.length;t++){let a=r.indexToLoc(n[t]),o=t*e.length;i.values.set(a,o)}return i.toTensor()}function tTe(e,t,n){let r=U(e,`x`,`transpose`);if(t??=r.shape.map((e,t)=>t).reverse(),R(r.rank===t.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${t}.`),t.forEach(e=>{R(e>=0&&e<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${t}`)}),r.rank<=1)return r.clone();let i={x:r},a={perm:t};return r.dtype===`complex64`?G(()=>{let e=aZ(r),t=EX(r);return e=H.runKernel(QK,{x:e},a),t=H.runKernel(QK,{x:t},a),n&&(t=NX(t)),yJ(e,t)}):H.runKernel(QK,i,a)}const PZ=W({transpose_:tTe});function nTe(e,t){if(t==null)return e.shape.slice();if(jU(e.shape,t))return t;if(e.shape.length===t.length){let n=[];for(let r=0;r<e.shape.length;r++)t[r]==null&&e.shape[r]!=null?n.push(e.shape[r]):n.push(t[r]);return n}return t}function rTe(e,t,n,r){let i=U(e,`x`,`dropout`);if(R(i.dtype===`float32`,()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),R(t>=0&&t<1,()=>`rate must be a float in the range [0, 1), but got ${t}.`),t===0)return e instanceof qq?i.clone():i;let a=nTe(i,n),o=1-t,s=iY(SX(q(rZ(a,0,1,`float32`,r),o)),o);return J(i,s)}const iTe=W({dropout_:rTe});function aTe(e,t,n,r,i,a=`NHWC`,o){let s=e;e.rank===3&&(s=Y(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let c=t;c.rank===3&&(c=Y(t,[1,t.shape[0],t.shape[1],t.shape[2]])),R(s.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${s.shape}.`),R(c.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${c.shape}.`),R(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);let l=a===`NHWC`?s.shape[3]:s.shape[1],u=a===`NHWC`?c.shape[3]:c.shape[1];R(l===n[2],()=>`Error in conv2dDerFilter: depth of input ${l}) must match input depth in filter (${n[2]}.`),R(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),CY(`conv2dDerFilter`,i,o);let d={x:s,dy:c},f={strides:r,pad:i,dataFormat:a,dimRoundingMode:o,filterShape:n};return H.runKernel(GW,d,f)}const FZ=W({conv2DBackpropFilter_:aTe});function IZ(e,t,n){if(n==null||n===`linear`)return e;if(n===`relu`)return J(e,TZ(t));throw Error(`Cannot compute gradient for fused activation ${n}.`)}function LZ(e,t){let n=t,r=qY(e.shape,t.shape);return r.length>0&&(n=hX(n,r)),Y(n,e.shape)}function RZ(e,t,n,r){if(t===`linear`)return e;if(t===`relu`)return oZ(e);if(t===`elu`)return $Y(e);if(t===`relu6`)return sZ(e);if(t===`prelu`)return $X(e,n);if(t===`leakyrelu`)return DX(e,r);if(t===`sigmoid`)return DY(e);throw Error(`Unknown fused activation ${t}.`)}const zZ=(e,t)=>!(e>0)||t===`linear`;function oTe({x:e,filter:t,strides:n,pad:r,dataFormat:i=`NHWC`,dilations:a=[1,1],dimRoundingMode:o,bias:s,activation:c=`linear`,preluActivationWeights:l,leakyreluAlpha:u}){if(c||=`linear`,zZ(H.state.gradientDepth,c)===!1){R(i===`NHWC`,()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let d=FY(e,t,n,r,i,a,o);return s!=null&&(d=q(d,s)),RZ(d,c,l,u)}let d=U(e,`x`,`conv2d`,`float32`),f=U(t,`filter`,`conv2d`,`float32`),p=d,m=!1;d.rank===3&&(m=!0,p=Y(d,[1,d.shape[0],d.shape[1],d.shape[2]])),R(p.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${p.rank}.`),R(f.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${f.rank}.`),CY(`fused conv2d`,r,o);let h=i===`NHWC`?p.shape[3]:p.shape[1];R(f.shape[2]===h,()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${f.shape[2]}.`),R(bY(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);let g=fY(p.shape,f.shape,n,a,r,o),_;s!=null&&(_=U(s,`bias`,`fused conv2d`),[_]=rJ(_,d),i===`NHWC`?JY(g.outShape,_.shape):(R(_.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${_.shape.length}.`),R(_.shape.length===0||_.shape[0]===g.outChannels||_.shape[0]===1,()=>`Error in fused conv2d: bias shape (${_.shape}) is not compatible with the number of output channels (${g.outChannels})`)));let v;if(l!=null){let e=l.shape;if(R(e.length<=1||e.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${e.length}.`),e.length===1)R(e[0]===1||e[0]===g.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${e}) is not compatible with the number of output channels (${g.outChannels}).`);else if(e.length===3)try{JY(e,g.outShape)}catch{let t=`Error in fused conv2d: PReLU activation weights (${e}) is not compatible with the output shape of the conv2d (${g.outShape}).`;throw Error(t)}v=U(l,`prelu weights`,`fused conv2d`)}let y=(e,t)=>{R(i===`NHWC`,()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`);let[o,s,l,u]=t,d=IZ(e,l,c);R(yY(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);let f=LY(s.shape,d,o,n,r),p=FZ(s,d,o.shape,n,r),m=[f,p];if(u!=null){let e=LZ(u,d);m.push(e)}return m},b={x:p,filter:f,bias:_,preluActivationWeights:v},x={strides:n,pad:r,dataFormat:i,dilations:a,dimRoundingMode:o,activation:c,leakyreluAlpha:u};return s==null?MX((e,t,n)=>{let r=H.runKernel(oq,b,x);return n([t,e,r]),m&&(r=Y(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:y}})(p,f):MX((e,t,n,r)=>{let i=H.runKernel(oq,b,x);return r([t,e,i,n]),m&&(i=Y(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:y}})(p,f,_)}const sTe=W({fusedConv2d_:oTe});function cTe(e,t,n,r,i,a=[1,1],o){let s=e;e.rank===3&&(s=Y(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let c=t;c.rank===3&&(c=Y(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l={x:s,dy:c},u={strides:r,pad:i,dimRoundingMode:o,dilations:a,filterShape:n};return H.runKernel(rG,l,u)}const lTe=W({depthwiseConv2dNativeBackpropFilter_:cTe});function uTe(e,t,n,r,i,a=[1,1],o){let s=t,c=!1;t.rank===3&&(c=!0,s=Y(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l={dy:s,filter:n},u={strides:r,pad:i,dimRoundingMode:o,dilations:a,inputShape:e},d=H.runKernel(iG,l,u);return c?Y(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const dTe=W({depthwiseConv2dNativeBackpropInput_:uTe});function fTe({a:e,b:t,transposeA:n=!1,transposeB:r=!1,bias:i,activation:a=`linear`,preluActivationWeights:o,leakyreluAlpha:s=.2}){if(zZ(H.state.gradientDepth,a)===!1){let c=EY(e,t,n,r);return i!=null&&(c=q(c,i)),RZ(c,a,o,s)}let c=U(e,`a`,`fused matMul`),l=U(t,`b`,`fused matMul`);[c,l]=rJ(c,l);let u=n?c.shape[c.rank-2]:c.shape[c.rank-1],d=r?l.shape[l.rank-1]:l.shape[l.rank-2],f=n?c.shape[c.rank-1]:c.shape[c.rank-2],p=r?l.shape[l.rank-2]:l.shape[l.rank-1],m=c.shape.slice(0,-2),h=l.shape.slice(0,-2),g=z(m),_=z(h);R(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${c.shape} and ${l.shape} and transposeA=${n} and transposeB=${r} must match.`);let v=JY(c.shape.slice(0,-2),l.shape.slice(0,-2)).concat([f,p]),y=n?Y(c,[g,u,f]):Y(c,[g,f,u]),b=r?Y(l,[_,p,d]):Y(l,[_,d,p]),x;i!=null&&(x=U(i,`bias`,`fused matMul`),[x]=rJ(x,c),JY(v,x.shape));let S;o!=null&&(S=U(o,`prelu weights`,`fused matMul`));let C=(e,t)=>{let[o,s,c,l]=t,u=IZ(Y(e,c.shape),c,a),d,f;if(!n&&!r?(d=EY(u,s,!1,!0),f=EY(o,u,!0,!1)):!n&&r?(d=EY(u,s,!1,!1),f=EY(u,o,!0,!1)):n&&!r?(d=EY(s,u,!1,!0),f=EY(o,u,!1,!1)):(d=EY(s,u,!0,!0),f=EY(u,o,!0,!0)),i!=null){let e=LZ(l,u);return[d,f,e]}else return[d,f]},w={a:y,b,bias:x,preluActivationWeights:S},T={transposeA:n,transposeB:r,activation:a,leakyreluAlpha:s};return i==null?MX((e,t,n)=>{let r=H.runKernel(aq,w,T);return n([e,t,r]),{value:Y(r,v),gradFunc:C}})(y,b):MX((e,t,n,r)=>{let i=H.runKernel(aq,w,T);return r([e,t,i,n]),{value:Y(i,v),gradFunc:C}})(y,b,x)}const BZ=W({fusedMatMul_:fTe});function pTe(e,t,n,r,i=`bilinear`,a=0){let o=U(e,`image`,`cropAndResize`),s=U(t,`boxes`,`cropAndResize`,`float32`),c=U(n,`boxInd`,`cropAndResize`,`int32`),l=s.shape[0];R(o.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${o.rank}.`),R(s.rank===2&&s.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${l},4] but had shape ${s.shape}.`),R(c.rank===1&&c.shape[0]===l,()=>`Error in cropAndResize: boxInd must be have size [${l}] but had shape ${s.shape}.`),R(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),R(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),R(i===`bilinear`||i===`nearest`,()=>`method must be bilinear or nearest, but was ${i}`);let u={image:o,boxes:s,boxInd:c},d={method:i,extrapolationValue:a,cropSize:r};return H.runKernel($W,u,d)}const mTe=W({cropAndResize_:pTe});function hTe(e){let t=U(e,`image`,`flipLeftRight`,`float32`);R(t.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`);let n={image:t};return H.runKernel(gG,n,{})}const gTe=W({flipLeftRight_:hTe});function _Te(e){let t=U(e,`image`,`grayscaleToRGB`),n=t.rank-1,r=t.shape[n];R(t.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`),R(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);let i=Array(t.rank);return i.fill(1,0,n),i[n]=3,bX(t,i)}const vTe=W({grayscaleToRGB_:_Te});function yTe(e){let t=U(e,`image`,`RGBToGrayscale`),n=t.rank-1,r=t.shape[n];R(t.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${t.rank}.`),R(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);let i=t.dtype,a=K(t,`float32`),o=EZ([.2989,.587,.114]),s;switch(t.rank){case 2:s=QY(`ij,j->i`,a,o);break;case 3:s=QY(`ijk,k->ij`,a,o);break;case 4:s=QY(`ijkl,l->ijk`,a,o);break;case 5:s=QY(`ijklm,m->ijkl`,a,o);break;case 6:s=QY(`ijklmn,n->ijklm`,a,o);break;default:throw Error(`Not a valid tensor rank.`)}return s=yX(s,-1),K(s,i)}const bTe=W({rgbToGrayscale_:yTe});function xTe(e,t,n=0,r=.5){let i=U(e,`image`,`rotateWithOffset`,`float32`);R(i.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`);let a={image:i},o={radians:t,fillValue:n,center:r};return H.runKernel(iq,a,o)}const STe=W({rotateWithOffset_:xTe});function VZ(e,t,n,r,i,a){r??=.5,i??=-1/0,a??=0;let o=e.shape[0];return n=Math.min(n,o),R(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),R(e.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`),R(e.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`),R(t.rank===1,()=>`scores must be a 1D tensor`),R(t.shape[0]===o,()=>`scores has incompatible shape with boxes. Expected ${o}, but was ${t.shape[0]}`),R(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a}}function CTe(e,t,n,r=.5,i=-1/0){let a=U(e,`boxes`,`nonMaxSuppression`,`float32`),o=U(t,`scores`,`nonMaxSuppression`,`float32`),s=VZ(a,o,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;let c={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return H.runKernel(ZG,{boxes:a,scores:o},c)}const wTe=W({nonMaxSuppression_:CTe});
/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
function TTe(e,t,n){let r=ETe(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function ETe(e,t,n){return OTe(e,t,n||DTe)}function DTe(e,t){return e>t?1:e<t?-1:0}function OTe(e,t,n){let r=0,i=e.length,a=0,o=!1;for(;r<i;){a=r+(i-r>>>1);let s=n(t,e[a]);s>0?r=a+1:(i=a,o=!s)}return o?r:-r-1}function HZ(e,t,n,r,i){return GZ(e,t,n,r,i,0)}function UZ(e,t,n,r,i,a){return GZ(e,t,n,r,i,0,!1,a,!0)}function WZ(e,t,n,r,i,a){return GZ(e,t,n,r,i,a,!0)}function GZ(e,t,n,r,i,a,o=!1,s=!1,c=!1){let l=[];for(let e=0;e<t.length;e++)t[e]>i&&l.push({score:t[e],boxIndex:e,suppressBeginIndex:0});l.sort(KZ);let u=a>0?-.5/a:0,d=[],f=[];for(;d.length<n&&l.length>0;){let t=l.pop(),{score:n,boxIndex:a,suppressBeginIndex:o}=t;if(n<i)break;let s=!1;for(let n=d.length-1;n>=o;--n){let o=kTe(e,a,d[n]);if(o>=r){s=!0;break}if(t.score*=ATe(r,u,o),t.score<=i)break}t.suppressBeginIndex=d.length,s||(t.score===n?(d.push(a),f.push(t.score)):t.score>i&&TTe(l,t,KZ))}let p=d.length,m=n-p;s&&m>0&&(d.push(...Array(m).fill(0)),f.push(...Array(m).fill(0)));let h={selectedIndices:d};return o&&(h.selectedScores=f),c&&(h.validOutputs=p),h}function kTe(e,t,n){let r=e.subarray(t*4,t*4+4),i=e.subarray(n*4,n*4+4),a=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),l=Math.min(i[0],i[2]),u=Math.min(i[1],i[3]),d=Math.max(i[0],i[2]),f=Math.max(i[1],i[3]),p=(s-a)*(c-o),m=(d-l)*(f-u);if(p<=0||m<=0)return 0;let h=Math.max(a,l),g=Math.max(o,u),_=Math.min(s,d),v=Math.min(c,f),y=Math.max(_-h,0)*Math.max(v-g,0);return y/(p+m-y)}function ATe(e,t,n){let r=Math.exp(t*n*n);return n<=e?r:0}function KZ(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}async function jTe(e,t,n,r=.5,i=-1/0){let a=U(e,`boxes`,`nonMaxSuppressionAsync`),o=U(t,`scores`,`nonMaxSuppressionAsync`),s=VZ(a,o,n,r,i);n=s.maxOutputSize,r=s.iouThreshold,i=s.scoreThreshold;let c=await Promise.all([a.data(),o.data()]),l=c[0],u=c[1],{selectedIndices:d}=HZ(l,u,n,r,i);return a!==e&&a.dispose(),o!==t&&o.dispose(),EZ(d,`int32`)}const MTe=jTe;function NTe(e,t,n,r=.5,i=-1/0,a=0){let o=U(e,`boxes`,`nonMaxSuppression`),s=U(t,`scores`,`nonMaxSuppression`),c=VZ(o,s,n,r,i,a);n=c.maxOutputSize,r=c.iouThreshold,i=c.scoreThreshold,a=c.softNmsSigma;let l={boxes:o,scores:s},u={maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:a},d=H.runKernel($G,l,u);return{selectedIndices:d[0],selectedScores:d[1]}}const PTe=W({nonMaxSuppressionWithScore_:NTe});async function FTe(e,t,n,r=.5,i=-1/0,a=0){let o=U(e,`boxes`,`nonMaxSuppressionAsync`),s=U(t,`scores`,`nonMaxSuppressionAsync`),c=VZ(o,s,n,r,i,a);n=c.maxOutputSize,r=c.iouThreshold,i=c.scoreThreshold,a=c.softNmsSigma;let l=await Promise.all([o.data(),s.data()]),u=l[0],d=l[1],{selectedIndices:f,selectedScores:p}=WZ(u,d,n,r,i,a);return o!==e&&o.dispose(),s!==t&&s.dispose(),{selectedIndices:EZ(f,`int32`),selectedScores:EZ(p)}}const ITe=FTe;function LTe(e,t,n,r=.5,i=-1/0,a=!1){let o=U(e,`boxes`,`nonMaxSuppression`),s=U(t,`scores`,`nonMaxSuppression`),c=VZ(o,s,n,r,i,null),l=c.maxOutputSize,u=c.iouThreshold,d=c.scoreThreshold,f={boxes:o,scores:s},p={maxOutputSize:l,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:a},m=H.runKernel(QG,f,p);return{selectedIndices:m[0],validOutputs:m[1]}}const RTe=W({nonMaxSuppressionPadded_:LTe});async function zTe(e,t,n,r=.5,i=-1/0,a=!1){let o=U(e,`boxes`,`nonMaxSuppressionAsync`),s=U(t,`scores`,`nonMaxSuppressionAsync`),c=VZ(o,s,n,r,i,null),l=c.maxOutputSize,u=c.iouThreshold,d=c.scoreThreshold,[f,p]=await Promise.all([o.data(),s.data()]),{selectedIndices:m,validOutputs:h}=UZ(f,p,l,u,d,a);return o!==e&&o.dispose(),s!==t&&s.dispose(),{selectedIndices:EZ(m,`int32`),validOutputs:fX(h,`int32`)}}const BTe=zTe;function VTe(e,t,n=!1,r=!1){let i=U(e,`images`,`resizeBilinear`);R(i.rank===3||i.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),R(t.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`),R(r===!1||n===!1,()=>`Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.`);let a=i,o=!1;i.rank===3&&(o=!0,a=Y(i,[1,i.shape[0],i.shape[1],i.shape[2]]));let[]=t,s={images:a},c={alignCorners:n,halfPixelCenters:r,size:t},l=H.runKernel(gK,s,c);return o?Y(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const qZ=W({resizeBilinear_:VTe});function HTe(e,t,n=!1,r=!1){let i=U(e,`images`,`resizeNearestNeighbor`);R(i.rank===3||i.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),R(t.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`),R(i.dtype===`float32`||i.dtype===`int32`,()=>"`images` must have `int32` or `float32` as dtype"),R(r===!1||n===!1,()=>`Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.`);let a=i,o=!1;i.rank===3&&(o=!0,a=Y(i,[1,i.shape[0],i.shape[1],i.shape[2]]));let[]=t,s={images:a},c={alignCorners:n,halfPixelCenters:r,size:t},l=H.runKernel(mK,s,c);return o?Y(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const JZ=W({resizeNearestNeighbor_:HTe});function UTe(e,t=`binary`,n=!1,r=.5){let i=U(e,`image`,`threshold`),a=i.shape[0]*i.shape[1],o=J(EZ([r]),255),s,c,l,u;if(R(i.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`),R(i.shape[2]===3||i.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`),R(i.dtype===`int32`||i.dtype===`float32`,()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`),R(t===`otsu`||t===`binary`,()=>`Method must be binary or otsu, but was ${t}`),i.shape[2]===3){[s,c,l]=SZ(i,[1,1,1],-1);let e=J(s,.2989),t=J(c,.587),n=J(l,.114);u=q(q(e,t),n)}else u=e;if(t===`otsu`){let e=Zxe(K(lZ(u),`int32`),xJ([]),256);o=WTe(e,a)}let d=n?kX(u,o):wX(u,o);return K(J(d,255),`int32`)}function WTe(e,t){let n=EZ([-1]),r=EZ([0]),i=EZ([0]),a,o,s,c,l,u;for(let d=0;d<e.size-1;d++){a=OY(e,0,d+1),o=OY(e,d+1),l=iY(hX(a),t),u=iY(hX(o),t);let f=hX(J(a,iZ(0,a.size)));s=iY(f,hX(a));let p=NY(o.shape,a.size),m=q(iZ(0,o.size),p),h=J(o,m);c=iY(hX(h),hX(o));let g=FX(s,c),_=FX(s,c),v=J(l,u);i=J(J(v,g),_);let y=wX(i,r);r=XY(y,i,r),n=XY(y,EZ([d]),n)}return n}const GTe=W({threshold_:UTe});function KTe(e,t,n=`nearest`,r=`constant`,i=0,a){let o=U(e,`image`,`transform`,`float32`),s=U(t,`transforms`,`transform`,`float32`);R(o.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${o.rank}.`),R(s.rank===2&&(s.shape[0]===o.shape[0]||s.shape[0]===1)&&s.shape[1]===8,()=>`Error in transform: Input transform should be batch x 8 or 1 x 8`),R(a==null||a.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`);let c={image:o,transforms:s},l={interpolation:n,fillMode:r,fillValue:i,outputShape:a};return H.runKernel(ZK,c,l)}const qTe=W({transform_:KTe});function JTe(e,t,n){let r=U(e,`a`,`bandPart`);R(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);let i=r.shape,[a,o]=r.shape.slice(-2),s,c;typeof t==`number`?(R(t%1==0,()=>`bandPart(): numLower must be an integer, got ${t}.`),R(t<=a,()=>`bandPart(): numLower (${t}) must not be greater than the number of rows (${a}).`),s=U(t<0?a:t,`numLower`,`bandPart`)):(R(t.dtype===`int32`,()=>`bandPart(): numLower's dtype must be an int32.`),s=XY(OX(t,0),a,KX(t,a))),typeof n==`number`?(R(n%1==0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),R(n<=o,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${o}).`),c=U(n<0?o:n,`numUpper`,`bandPart`)):(R(n.dtype===`int32`,()=>`bandPart(): numUpper's dtype must be an int32.`),c=XY(OX(n,0),o,KX(n,o)));let l=Y(iZ(0,a,1,`int32`),[-1,1]),u=iZ(0,o,1,`int32`),d=FX(l,u),f=RX(kX(d,s),TX(d,NX(c))),p=WX([a,o],r.dtype);return Y(wZ(MZ(Y(r,[-1,a,o])).map(e=>XY(f,e,p))),i)}const YTe=W({bandPart_:JTe});function XTe(e){let t;if(Array.isArray(e)){t=!1,R(e!=null&&e.length>0,()=>`Gram-Schmidt process: input must not be null, undefined, or empty`);let n=e[0].shape[0];for(let t=1;t<e.length;++t)R(e[t].shape[0]===n,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[t].shape[0]} vs. ${n})`)}else t=!0,e=SZ(e,e.shape[0],0).map(e=>CZ(e,[0]));R(e.length<=e[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`);let n=[],r=e;for(let t=0;t<e.length;++t)n.push(H.tidy(()=>{let e=r[t];if(t>0)for(let r=0;r<t;++r){let t=J(hX(J(n[r],e)),n[r]);e=FX(e,t)}return iY(e,_X(e,`euclidean`))}));return t?wZ(n,0):n}const ZTe=W({gramSchmidt_:XTe});function QTe(e,t=!1){if(R(e.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`),e.rank===2)return YZ(e,t);{let n=e.shape.slice(0,e.shape.length-2).reduce((e,t)=>e*t),r=MZ(Y(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],a=[];r.forEach(e=>{let[n,r]=YZ(e,t);i.push(n),a.push(r)});let o=Y(wZ(i,0),e.shape),s=Y(wZ(a,0),e.shape);return[o,s]}}function YZ(e,t=!1){return H.tidy(()=>{R(e.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`);let n=e.shape[0],r=e.shape[1],i=xX(n),a=nY(e),o=DZ([[1]],[1,1]),s=nY(o),c=n>=r?r:n;for(let e=0;e<c;++e){let t=a,c=s,l=i;[s,a,i]=H.tidy(()=>{let t=OY(a,[e,e],[n-e,1]),c=_X(t),l=OY(a,[e,e],[1,1]),u=XY(wX(l,0),DZ([[-1]]),DZ([[1]])),d=FX(l,J(u,c)),f=iY(t,d);s=f.shape[0]===1?nY(o):TY([o,OY(f,[1,0],[f.shape[0]-1,f.shape[1]])],0);let p=NX(iY(EY(u,d),c)),m=OY(a,[e,0],[n-e,r]),h=J(p,s),g=PZ(s);if(e===0)a=FX(m,EY(h,EY(g,m)));else{let t=FX(m,EY(h,EY(g,m)));a=TY([OY(a,[0,0],[e,r]),t],0)}let _=PZ(h),v=OY(i,[0,e],[n,i.shape[1]-e]);if(e===0)i=FX(v,EY(EY(v,s),_));else{let t=FX(v,EY(EY(v,s),_));i=TY([OY(i,[0,0],[n,e]),t],1)}return[s,a,i]}),EJ([t,c,l])}return!t&&n>r&&(i=OY(i,[0,0],[n,r]),a=OY(a,[0,0],[r,r])),[i,a]})}const $Te=W({qr_:QTe});var XZ={flipLeftRight:gTe,grayscaleToRGB:vTe,resizeNearestNeighbor:JZ,resizeBilinear:qZ,rgbToGrayscale:bTe,rotateWithOffset:STe,cropAndResize:mTe,nonMaxSuppression:wTe,nonMaxSuppressionAsync:MTe,nonMaxSuppressionWithScore:PTe,nonMaxSuppressionWithScoreAsync:ITe,nonMaxSuppressionPadded:RTe,nonMaxSuppressionPaddedAsync:BTe,threshold:GTe,transform:qTe},eEe={bandPart:YTe,gramSchmidt:ZTe,qr:$Te},tEe=new Map,nEe=new Map,ZZ=class{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}},QZ=class e{constructor(){this.classNameMap={}}static getMap(){return e.instance??=new e,e.instance}static register(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}};function X(e,t,n){R(e.className!=null,()=>`Class being registered does not have the static className property defined.`),R(typeof e.className==`string`,()=>`className is required to be a string, but got type `+typeof e.className),R(e.className.length>0,()=>`Class being registered has an empty-string as its className, which is disallowed.`),t===void 0&&(t=`Custom`),n===void 0&&(n=e.className);let r=n,i=t+`>`+r;return QZ.register(e),tEe.set(i,e),nEe.set(e,i),e}var $Z=class extends ZZ{minimize(e,t=!1,n){let{value:r,grads:i}=this.computeGradients(e,n);if(n!=null){let e=n.map(e=>({name:e.name,tensor:i[e.name]}));this.applyGradients(e)}else this.applyGradients(i);return EJ(i),t?r:(r.dispose(),null)}get iterations(){return this.iterations_??=0,this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return vCe(e,t)}dispose(){this.iterations_!=null&&EJ(this.iterations_)}async saveIterations(){return this.iterations_??=0,{name:`iter`,tensor:fX(this.iterations_,`int32`)}}async getWeights(){throw Error(`getWeights() is not implemented for this optimizer yet.`)}async setWeights(e){throw Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}};Object.defineProperty($Z,Symbol.hasInstance,{value:e=>e.minimize!=null&&e.computeGradients!=null&&e.applyGradients!=null});var eQ=class extends $Z{static get className(){return`Adadelta`}constructor(e,t,n=null){super(),this.learningRate=e,this.rho=t,this.epsilon=n,this.accumulatedGrads=[],this.accumulatedUpdates=[],n??(this.epsilon=H.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let r=H.registeredVariables[t];this.accumulatedGrads[n]??(this.accumulatedGrads[n]={originalName:`${t}/accum_grad`,variable:G(()=>ZY(r).variable(!1))}),this.accumulatedUpdates[n]??(this.accumulatedUpdates[n]={originalName:`${t}/accum_var`,variable:G(()=>ZY(r).variable(!1))});let i=Array.isArray(e)?e[n].tensor:e[t];if(i==null)return;let a=this.accumulatedGrads[n].variable,o=this.accumulatedUpdates[n].variable;G(()=>{let e=q(J(a,this.rho),J(mX(i),1-this.rho)),t=J(iY(pX(q(o,this.epsilon)),pX(q(a,this.epsilon))),i),n=q(J(o,this.rho),J(mX(t),1-this.rho));a.assign(e),o.assign(n);let s=q(J(t,-this.learningRate),r);r.assign(s)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(EJ(this.accumulatedGrads.map(e=>e.variable)),EJ(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){let e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=e.length/2;this.accumulatedGrads=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})),this.accumulatedUpdates=e.slice(t,t*2).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}},tQ=class extends $Z{static get className(){return`Adagrad`}constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let r=H.registeredVariables[t];this.accumulatedGrads[n]??(this.accumulatedGrads[n]={originalName:`${t}/accumulator`,variable:G(()=>NY(r.shape,this.initialAccumulatorValue).variable(!1))});let i=Array.isArray(e)?e[n].tensor:e[t];if(i==null)return;let a=this.accumulatedGrads[n].variable;G(()=>{let e=q(a,mX(i));a.assign(e);let t=q(J(iY(i,pX(q(e,H.backend.epsilon()))),-this.learningRate),r);r.assign(t)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&EJ(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),this.accumulatedGrads=e.map(e=>({originalName:e.name,variable:e.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}},nQ=class extends $Z{static get className(){return`Adam`}constructor(e,t,n,r=null){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],G(()=>{this.accBeta1=fX(t).variable(),this.accBeta2=fX(n).variable()}),r??(this.epsilon=H.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);G(()=>{let n=FX(1,this.accBeta1),r=FX(1,this.accBeta2);t.forEach((t,i)=>{let a=H.registeredVariables[t];this.accumulatedFirstMoment[i]??(this.accumulatedFirstMoment[i]={originalName:`${t}/m`,variable:G(()=>ZY(a).variable(!1))}),this.accumulatedSecondMoment[i]??(this.accumulatedSecondMoment[i]={originalName:`${t}/v`,variable:G(()=>ZY(a).variable(!1))});let o=Array.isArray(e)?e[i].tensor:e[t];if(o==null)return;let s=this.accumulatedFirstMoment[i].variable,c=this.accumulatedSecondMoment[i].variable,l=q(J(s,this.beta1),J(o,1-this.beta1)),u=q(J(c,this.beta2),J(mX(o),1-this.beta2)),d=iY(l,n),f=iY(u,r);s.assign(l),c.assign(u);let p=q(J(iY(d,q(pX(f),this.epsilon)),-this.learningRate),a);a.assign(p)}),this.accBeta1.assign(J(this.accBeta1,this.beta1)),this.accBeta2.assign(J(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&EJ(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&EJ(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),G(()=>{this.accBeta1.assign(dX(this.beta1,this.iterations_+1)),this.accBeta2.assign(dX(this.beta2,this.iterations_+1))});let t=e.length/2;this.accumulatedFirstMoment=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}},rQ=class extends $Z{static get className(){return`Adamax`}constructor(e,t,n,r=null,i=0){super(),this.learningRate=e,this.beta1=t,this.beta2=n,this.epsilon=r,this.decay=i,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],G(()=>{this.iteration=fX(0).variable(),this.accBeta1=fX(t).variable()}),r??(this.epsilon=H.backend.epsilon())}applyGradients(e){let t=Array.isArray(e)?e.map(e=>e.name):Object.keys(e);G(()=>{let n=FX(1,this.accBeta1),r=iY(-this.learningRate,q(J(this.iteration,this.decay),1));t.forEach((t,i)=>{let a=H.registeredVariables[t];this.accumulatedFirstMoment[i]??(this.accumulatedFirstMoment[i]={originalName:`${t}/m`,variable:ZY(a).variable(!1)}),this.accumulatedWeightedInfNorm[i]??(this.accumulatedWeightedInfNorm[i]={originalName:`${t}/v`,variable:ZY(a).variable(!1)});let o=Array.isArray(e)?e[i].tensor:e[t];if(o==null)return;let s=this.accumulatedFirstMoment[i].variable,c=this.accumulatedWeightedInfNorm[i].variable,l=q(J(s,this.beta1),J(o,1-this.beta1)),u=J(c,this.beta2),d=aY(o),f=HX(u,d);s.assign(l),c.assign(f);let p=q(J(iY(r,n),iY(l,q(f,this.epsilon))),a);a.assign(p)}),this.iteration.assign(q(this.iteration,1)),this.accBeta1.assign(J(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&EJ(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&EJ(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw Error(`getWeights() is not implemented for Adamax yet.`)}async setWeights(e){throw Error(`setWeights() is not implemented for Adamax yet.`)}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}},iQ=class extends $Z{static get className(){return`SGD`}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let r=Array.isArray(e)?e[n].tensor:e[t];if(r==null)return;let i=H.registeredVariables[t];G(()=>{let e=q(J(this.c,r),i);i.assign(e)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=DJ(fX(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw Error(`SGD optimizer does not have settable weights.`)}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}},aQ=class extends iQ{static get className(){return`Momentum`}constructor(e,t,n=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=n,this.accumulations=[],this.m=fX(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let r=H.registeredVariables[t];this.accumulations[n]??(this.accumulations[n]={originalName:`${t}/momentum`,variable:G(()=>ZY(r).variable(!1))});let i=this.accumulations[n].variable,a=Array.isArray(e)?e[n].tensor:e[t];a!=null&&G(()=>{let e,t=q(J(this.m,i),a);e=this.useNesterov?q(J(this.c,q(a,J(t,this.m))),r):q(J(this.c,t),r),i.assign(t),r.assign(e)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&EJ(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e),this.accumulations=e.map(e=>({originalName:e.name,variable:e.tensor.variable(!1)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}},oQ=class extends $Z{static get className(){return`RMSProp`}constructor(e,t=.9,n=0,r=null,i=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=n,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=i,r??(this.epsilon=H.backend.epsilon()),e==null)throw Error(`learningRate for RMSPropOptimizer must be defined.`)}applyGradients(e){(Array.isArray(e)?e.map(e=>e.name):Object.keys(e)).forEach((t,n)=>{let r=H.registeredVariables[t];this.accumulatedMeanSquares[n]??(this.accumulatedMeanSquares[n]={originalName:`${t}/rms`,variable:G(()=>ZY(r).variable(!1))}),this.accumulatedMoments[n]??(this.accumulatedMoments[n]={originalName:`${t}/momentum`,variable:G(()=>ZY(r).variable(!1))}),this.accumulatedMeanGrads[n]==null&&this.centered&&(this.accumulatedMeanGrads[n]={originalName:`${t}/mg`,variable:G(()=>ZY(r).variable(!1))});let i=Array.isArray(e)?e[n].tensor:e[t];if(i==null)return;let a=this.accumulatedMeanSquares[n].variable,o=this.accumulatedMoments[n].variable;G(()=>{let e=q(J(a,this.decay),J(mX(i),1-this.decay));if(this.centered){let t=this.accumulatedMeanGrads[n].variable,s=q(J(t,this.decay),J(i,1-this.decay)),c=iY(J(i,this.learningRate),pX(FX(e,q(mX(s),this.epsilon)))),l=q(J(o,this.momentum),c);a.assign(e),t.assign(s),o.assign(l);let u=FX(r,l);r.assign(u)}else{let e=q(J(a,this.decay),J(mX(i),1-this.decay)),t=q(J(o,this.momentum),iY(J(i,this.learningRate),pX(q(e,this.epsilon))));a.assign(e),o.assign(t);let n=FX(r,t);r.assign(n)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&EJ(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&EJ(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&EJ(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){let e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);let t=this.centered?e.length/3:e.length/2;this.accumulatedMeanSquares=e.slice(0,t).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})),this.accumulatedMoments=e.slice(t,t*2).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(e=>({originalName:e.name,variable:e.tensor.variable(!1)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}},rEe=[eQ,tQ,nQ,rQ,aQ,oQ,iQ];function iEe(){for(let e of rEe)X(e)}function sQ(e,t,n,r){o(e),n??=0,r??=1,s(n,r);let i=0,a=a=>(a.then(a=>{let o=n+ ++i/e.length*(r-n);return t(o),a}),a);function o(e){R(e!=null&&Array.isArray(e)&&e.length>0,()=>`promises must be a none empty array`)}function s(e,t){R(e>=0&&e<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${e}`),R(t>=0&&t<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${t}`),R(t>=e,()=>`startFraction must be no more than endFraction, but got startFraction ${e} and endFraction ${t}`)}return Promise.all(e.map(a))}async function aEe(e,t){t??={};let n=t.fetchFunc==null?B().platform.fetch:t.fetchFunc,r=e.map(e=>n(e,t.requestInit,{isBinary:!0})),i=(t.onProgress==null?await Promise.all(r):await sQ(r,t.onProgress,0,.5)).map(e=>e.arrayBuffer());return t.onProgress==null?await Promise.all(i):await sQ(i,t.onProgress,.5,1)}function oEe(e,t){var n;let r=t.fetchFunc==null?B().platform.fetch:t.fetchFunc,i=0,a;return(n=t.onProgress)==null||n.call(t,0),new ReadableStream({pull:async n=>{for(var o;i<e.length;){a||=(await r(e[i],t.requestInit,{isBinary:!0})).body.getReader();let{done:s,value:c}=await a.read();if(s){i++,a=void 0,(o=t.onProgress)==null||o.call(t,i/e.length);continue}n.enqueue(c);return}n.close()}})}var sEe=`application/octet-stream`,cEe=`application/json`,cQ=class{constructor(e,t){if(this.DEFAULT_METHOD=`POST`,t??={},this.weightPathPrefix=t.weightPathPrefix,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc==null?this.fetch=B().platform.fetch:(R(typeof t.fetchFunc==`function`,()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc),R(e!=null&&e.length>0,()=>`URL path for http must not be null, undefined or empty.`),Array.isArray(e)&&R(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw Error(`requestInit is expected to have no pre-existing body, but has one.`);this.requestInit=t.requestInit||{},this.loadOptions=t}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw Error(`BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.`);let t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;let n=[{paths:[`./model.weights.bin`],weights:e.weightSpecs}],r=Mbe(e,n);if(t.body.append(`model.json`,new Blob([JSON.stringify(r)],{type:cEe}),`model.json`),e.weightData!=null){let n=CJ.join(e.weightData);t.body.append(`model.weights.bin`,new Blob([n],{type:sEe}),`model.weights.bin`)}let i=await this.fetch(this.path,t);if(i.ok)return{modelArtifactsInfo:NJ(e),responses:[i]};throw Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${i.status}.`)}async loadModelJSON(){let e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let e=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(`.pb`)?e+=` Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.`:e+=` Please make sure the server is serving valid JSON for this request.`,Error(e)}let n=t.modelTopology,r=t.weightsManifest;if(n==null&&r==null)throw Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return t}async load(){if(this.loadOptions.streamWeights)return this.loadStream();let e=await this.loadModelJSON();return Pbe(e,e=>this.loadWeights(e))}async loadStream(){let e=await this.loadModelJSON(),t=await this.getWeightUrls(e.weightsManifest),n=PJ(e.weightsManifest);return Object.assign(Object.assign({},e),{weightSpecs:n,getWeightStream:()=>oEe(t,this.loadOptions)})}async getWeightUrls(e){let t=Array.isArray(this.path)?this.path[1]:this.path,[n,r]=lEe(t),i=this.weightPathPrefix||n,a=[],o=[];for(let t of e)for(let e of t.paths)this.weightUrlConverter==null?a.push(i+e+r):o.push(this.weightUrlConverter(e));return this.weightUrlConverter&&a.push(...await Promise.all(o)),a}async loadWeights(e){let t=await this.getWeightUrls(e),n=PJ(e),r=await aEe(t,this.loadOptions);return[n,r]}};cQ.URL_SCHEME_REGEX=/^https?:\/\//;function lEe(e){let t=e.lastIndexOf(`/`),n=e.lastIndexOf(`?`),r=e.substring(0,t),i=n>t?e.substring(n):``;return[r+`/`,i]}function lQ(e){return e.match(cQ.URL_SCHEME_REGEX)!=null}const uQ=(e,t)=>{if(typeof fetch>`u`&&(t==null||t.fetchFunc==null))return null;{let n=!0;if(n=Array.isArray(e)?e.every(e=>lQ(e)):lQ(e),n)return dQ(e,t)}return null};FJ.registerSaveRouter(uQ),FJ.registerLoadRouter(uQ);function dQ(e,t){return new cQ(e,t)}function uEe(e,t){return dQ(e,t)}function fQ(e,t){let n=e.shape.length,r=t.shape.length;if(n<1)throw Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(t.dtype!==`int32`)throw Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[r-1]>n)throw Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[r-1]} vs. ${n}`);if(z(e.shape)===0)throw Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);let i=t.shape,a=i[i.length-1],o=1;for(let e=0;e<i.length-1;++e)o*=i[e];let s=e.shape,c=i.slice();c.pop();let l=1;for(let e=a;e<n;++e)l*=s[e],c.push(s[e]);let u=[...QU(e.shape).map(e=>e/l),1].slice(0,a);return[c,o,l,u]}var dEe=s({assertParamsValid:()=>mQ,computeFlatOffset:()=>TQ,computeOutShape:()=>hQ,getNormalizedAxes:()=>mEe,isSliceContinous:()=>wQ,maskToAxes:()=>pEe,parseSliceParams:()=>EQ,sliceInfo:()=>DQ,startForAxis:()=>SQ,startIndicesWithElidedDims:()=>yQ,stopForAxis:()=>CQ,stopIndicesWithElidedDims:()=>bQ,stridesForAxis:()=>xQ,stridesWithElidedDims:()=>gQ}),pQ=-2,fEe=-1;function mQ(e,t,n){let r=e.shape.length;R(r===t.length,()=>`Error in slice${r}D: Length of begin ${t} must match the rank of the array (${r}).`),R(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let i=0;i<r;++i)R(t[i]+n[i]<=e.shape[i],()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${t[i]+n[i]}) would overflow input.shape[${i}] (${e.shape[i]})`)}function pEe(e){let t=[],n=0;for(;e>0;)e&1&&t.push(n),e/=2,n++;return t}function hQ(e,t,n){let r=[];for(let i=0;i<e.length;i++)r[i]=Math.ceil((t[i]-e[i])/n[i]);return r}function gQ(e,t,n,r){let i=[...e];for(let e=i.length;e<r.length;e++)i.push(1);for(let e=0;e<n;e++)e===0?i[t]=1:(i.splice(t,0,1),i.pop());return i}function _Q(e,t,n){return n<=e?n:n-(t-1)}function vQ(e,t){let n=[];for(let r=0;r<e;r++)n.push(t+r);return n}function mEe(e,t,n,r,i,a,o,s,c){let l=e.length,u=Array(l),d=Array(l),f=Array(l);if(t.length&&n>0){let c=t[0],l=n+1;u=yQ(o,c,l,r,e),d=bQ(s,c,l,i,e),f=gQ(a,c,l,e)}else for(let t=0;t<l;t++)u[t]=SQ(o,r,a,e,t,c),d[t]=CQ(s,i,a,e,t,c),f[t]=xQ(a,t,c);return{begin:u,end:d,strides:f}}function yQ(e,t,n,r,i){let a=[...i],o=vQ(n,t);for(let i=0;i<a.length;i++)if(o.indexOf(i)>-1)a[i]=0;else{let o=_Q(t,n,i),s=r[o];e&1<<o&&(s=0),a[i]=s}return a}function bQ(e,t,n,r,i){let a=[...i],o=vQ(n,t);for(let i=0;i<a.length;i++)if(o.indexOf(i)>-1)a[i]=2**53-1;else{let o=_Q(t,n,i),s=r[o];e&1<<o&&(s=2**53-1),a[i]=s}for(let e=0;e<a.length;e++){let t=i[e];a[e]<0&&(a[e]+=t),a[e]=TU(0,a[e],i[e])}return a}function xQ(e,t,n){let r=e[t];return(n&1<<t||r==null)&&(r=1),r}function SQ(e,t,n,r,i,a){let o=t[i],s=n[i]||1;(e&1<<i||a&1<<i||o==null)&&(o=s>0?-(2**53-1):2**53-1);let c=r[i];return o<0&&(o+=c),o=TU(0,o,c-1),o}function CQ(e,t,n,r,i,a){let o=t[i],s=n[i]||1;(e&1<<i||a&1<<i||o==null)&&(o=s>0?2**53-1:-(2**53-1));let c=r[i];return o<0&&(o+=c),o=s>0?TU(0,o,c):TU(-1,o,c-1),o}function wQ(e,t,n){let r=n.length;for(let e=0;e<n.length;e++)if(n[e]>1){r=e;break}for(let i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function TQ(e,t){let n=e.length>0?e[e.length-1]:1;for(let r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function EQ(e,t,n){let r,i=e.shape.length;r=typeof t==`number`?[t,...Array(i-1).fill(0)]:t.length<i?t.concat(Array(i-t.length).fill(0)):t.slice(),r.forEach(e=>{R(e!==-1,()=>`slice() does not support negative begin indexing.`)});let a;return a=n==null?Array(i).fill(-1):typeof n==`number`?[n,...Array(i-1).fill(-1)]:n.length<i?n.concat(Array(i-n.length).fill(-1)):n,a=a.map((t,n)=>t>=0?t:(R(t===-1,()=>`Negative size values should be exactly -1 but got ${t} for the slice() size at index ${n}.`),e.shape[n]-r[n])),[r,a]}function DQ(e,t,n,r,i,a,o,s,c){let l;if(r==null?(l=Array(t.length),l.fill(1)):l=r,o!=null&&o&o-1)throw Error(`Multiple ellipses in slice is not allowed.`);let u=!1,d={dims:l.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:n.slice(),strides:l.slice(),beginMask:i,endMask:a,ellipsisMask:o,newAxisMask:s,shrinkAxisMask:c};for(let e=0;e<d.dims;e++)u&&1<<e&s&&d.numAddAxisAfterEllipsis++,1<<e&o&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);let f={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};hEe(d,f);let p=!0,m=!0,h=!0,g=[],_=[];for(let t=0;t<e.length;++t){if(f.strides[t]===0)throw Error(`strides[${t}] must be non-zero`);let n=!!(f.shrinkAxisMask&1<<t),r=e[t];if(r===-1){g.push(n?1:-1);continue}let i=[f.beginMask&1<<t,f.endMask&1<<t],a=[f.strides[t]>0?0:-1,f.strides[t]>0?r:r-1];if(n&&f.strides[t]<=0)throw Error(`only stride 1 allowed on non-range indexing.`);h&&=f.strides[t]===1;let o=!!(f.beginMask&1<<t&&f.endMask&1<<t);if(f.beginValid&&f.endValid){if(n){let e=f.begin[t]<0?r+f.begin[t]:f.begin[t];if(f.begin[t]=e,f.end[t]=f.begin[t]+1,e<0||e>=r)throw Error(`slice index ${f.begin[t]} of dimension ${t} out of bounds.`)}else f.begin[t]=OQ(f.begin[t],0,f.strides[t],r,i,a),f.end[t]=OQ(f.end[t],1,f.strides[t],r,i,a);let e=f.strides[t]===1&&f.begin[t]===0&&f.end[t]===r;p&&=e,m&&=t===0&&f.strides[t]===1||e}else p=p&&f.strides[t]===1&&o,m&&=t===0&&f.strides[t]===1||o;let s,c=!1;if(f.beginValid&&f.endValid?(s=f.end[t]-f.begin[t],c=!0):n?(s=1,c=!0):o&&r>=0&&(s=f.strides[t]<0?-r:r,c=!0),c){let e;e=s===0||s<0!=f.strides[t]<0?0:Math.trunc(s/f.strides[t])+(s%f.strides[t]===0?0:1),g.push(e)}else g.push(-1)}for(let e=0;e<f.finalShapeGatherIndices.length;++e){let t=f.finalShapeGatherIndices[e];t>=0?_.push(g[t]):t===pQ&&_.push(1)}return{finalShapeSparse:_.filter((e,t)=>f.finalShapeGatherIndices[t]!==pQ),finalShape:_,isIdentity:p,sliceDim0:m,isSimpleSlice:h,begin:f.begin,end:f.end,strides:f.strides}}function hEe(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let n=0;t.beginValid=e.begin!=null,t.endValid=e.end!=null,t.begin=Array(t.dims),t.end=Array(t.dims),t.strides=Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=Array(t.dims);for(let r=0;r<e.dims;r++)if(1<<r&e.ellipsisMask){let i=Math.min(t.dims-(e.dims-r)+1+e.numAddAxisAfterEllipsis,t.dims);for(;n<i;n++)t.begin[n]=0,t.end[n]=0,t.strides[n]=1,t.beginMask|=1<<n,t.endMask|=1<<n,t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&e.newAxisMask)t.finalShapeGatherIndices.push(pQ),t.finalShapeGatherIndicesSparse.push(-1);else{if(n===t.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${t.dims} dims, ${t.begin.length}.`);e.begin!=null&&(t.begin[n]=e.begin[r]),e.end!=null&&(t.end[n]=e.end[r]),t.strides[n]=e.strides[r],e.beginMask&1<<r&&(t.beginMask|=1<<n),e.endMask&1<<r&&(t.endMask|=1<<n),e.shrinkAxisMask&1<<r?(t.finalShapeGatherIndices.push(fEe),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<n):(t.finalShapeGatherIndices.push(n),t.finalShapeGatherIndicesSparse.push(r)),t.inputShapeGatherIndicesSparse[n]=r,n++}}function OQ(e,t,n,r,i,a){if(i[t])return n>0?a[t]:a[t+1&1];{let t=e<0?r+e:e;return t<a[0]?a[0]:t>a[1]?a[1]:t}}const kQ=class{static sgd(e){return new iQ(e)}static momentum(e,t,n=!1){return new aQ(e,t,n)}static rmsprop(e,t=.9,n=0,r=null,i=!1){return new oQ(e,t,n,r,i)}static adam(e=.001,t=.9,n=.999,r=null){return new nQ(e,t,n,r)}static adadelta(e=.001,t=.95,n=null){return new eQ(e,t,n)}static adamax(e=.002,t=.9,n=.999,r=null,i=0){return new rQ(e,t,n,r,i)}static adagrad(e,t=.1){return new tQ(e,t)}};
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var gEe=(()=>typeof requestAnimationFrame<`u`?requestAnimationFrame:typeof setImmediate<`u`?setImmediate:e=>e())();function AQ(){return new Promise(e=>gEe(()=>e()))}function jQ(e,t){let n=e[0].length;e.forEach((e,t)=>{R(e.length===n,()=>`Error in concat${n}D: rank of tensors[${t}] must be the same as the rank of the rest (${n})`)}),R(t>=0&&t<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);let r=e[0];e.forEach((e,i)=>{for(let a=0;a<n;a++)R(a===t||e[a]===r[a],()=>`Error in concat${n}D: Shape of tensors[${i}] (${e}) does not match the shape of the rest (${r}) along the non-concatenated axis ${i}.`)})}function MQ(e,t){let n=e[0].slice();for(let r=1;r<e.length;r++)n[t]+=e[r][t];return n}
/**
* @license
* Copyright 2022 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var NQ;(function(e){e[e.FIRST_DIM_SIZE=0]=`FIRST_DIM_SIZE`,e[e.VALUE_ROWIDS=1]=`VALUE_ROWIDS`,e[e.ROW_LENGTHS=2]=`ROW_LENGTHS`,e[e.ROW_SPLITS=3]=`ROW_SPLITS`,e[e.ROW_LIMITS=4]=`ROW_LIMITS`,e[e.ROW_STARTS=5]=`ROW_STARTS`})(NQ||={});function PQ(e,t,n){let r=[];if(n==null&&t==null)return r;if(t==null)for(;r.length<e+n.length;)r.push(-1);else r=t.slice();if(n==null)return r;if(e+n.length!==r.length)throw Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+n.length}, but shape.rank = ${r.length}`);for(let i=1;i<n.length;++i){let a=n[i],o=r[r.length-n.length+i],s=r[o];if(a>=0)if(s>=0){if(s!==a)throw Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${i+e}] = ${a} but shape[${i+e}] = ${s}`)}else r[o]=a}return r}function FQ(e){let t={FIRST_DIM_SIZE:NQ.FIRST_DIM_SIZE,VALUE_ROWIDS:NQ.VALUE_ROWIDS,ROW_LENGTHS:NQ.ROW_LENGTHS,ROW_SPLITS:NQ.ROW_SPLITS,ROW_LIMITS:NQ.ROW_LIMITS,ROW_STARTS:NQ.ROW_STARTS},n=[];for(let r of e)if(r in t)n.push(t[r]);else break;return n}function IQ(e){return e.length===0?0:e[0]===NQ.FIRST_DIM_SIZE?e.length-1:e.length}function LQ(e,t){if(e==null||t==null)return;let n=e.length,r=t.length;if(n>=r)throw Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(n,r-1);++i){let n=e[i],r=t[i+1];if(n>=0&&r>=0&&n!==1&&n!==r)throw Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${i-e.length}] = ${n} but ragged tensor input.flatValues.shape[${i-e.length}] = ${r}`)}}function RQ(e){return e<=30?e:ZU(e,Math.floor(Math.sqrt(e)))}
/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
function zQ(e,t,n){let r=n*(typeof e==`number`?e:e[0]),i=t*(typeof e==`number`?e:e[1]);return[r,i]}
/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
function BQ(e,t,n,r=!0){let i=[];if(r)i=i.concat(t.slice(0)),i.push(e[0]/n),i=i.concat(e.slice(1));else{i=i.concat(e[0]);let n=t.length;for(let r=0;r<n;++r)i=i.concat([e[r+1]/t[r],t[r]]);i=i.concat(e.slice(n+1))}return i}function VQ(e,t,n=!0){let r=[];if(n){r.push(t);for(let n=t+1;n<e;++n)n<=2*t?(r.push(n),r.push(n-(t+1))):r.push(n)}else{let n=[],i=[];for(let r=1;r<e;++r)r>=t*2+1||r%2==1?i.push(r):n.push(r);r.push(...n),r.push(0),r.push(...i)}return r}function HQ(e,t,n,r=!0){let i=[];r?i.push(e[0]/n):i.push(e[0]*n);for(let n=1;n<e.length;++n)n<=t.length?r?i.push(t[n-1]*e[n]):i.push(e[n]/t[n-1]):i.push(e[n]);return i}function UQ(e,t){let n=[0];for(let r=0;r<t;++r)n.push(e[r][0]);return n}function WQ(e,t,n){let r=e.slice(0,1);for(let i=0;i<n;++i)r.push(e[i+1]-t[i][0]-t[i][1]);return r}
/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
const GQ=1.7580993408473768,KQ=1.0507009873554805,qQ=.3275911,JQ=.254829592,YQ=-.284496736,XQ=1.421413741,ZQ=-1.453152027,QQ=1.061405429;
/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
function $Q(e,t){if(e.length!==t.length)throw Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);let n=new Float32Array(e.length*2);for(let r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function e$(e){let t=new Float32Array(e.length/2),n=new Float32Array(e.length/2);for(let r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function t$(e){let t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let t=0;t<e.length;t+=4)n[Math.floor(t/4)]=e[t],r[Math.floor(t/4)]=e[t+1];return{real:n,imag:r}}function n$(e){let t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t);for(let t=2;t<e.length;t+=4)n[Math.floor(t/4)]=e[t],r[Math.floor(t/4)]=e[t+1];return{real:n,imag:r}}function r$(e,t){let n=e[t*2],r=e[t*2+1];return{real:n,imag:r}}function i$(e,t,n,r){e[r*2]=t,e[r*2+1]=n}function a$(e,t){let n=new Float32Array(e/2),r=new Float32Array(e/2);for(let i=0;i<Math.ceil(e/2);i++){let a=(t?2:-2)*Math.PI*(i/e);n[i]=Math.cos(a),r[i]=Math.sin(a)}return{real:n,imag:r}}function o$(e,t,n){let r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}var s$=`->`,_Ee=/->/g,c$=`,`,l$=`...`;function u$(e,t){e=e.replace(/\s/g,``);let n=(e.length-e.replace(_Ee,``).length)/2;if(n<1)throw Error(`Equations without an arrow are not supported.`);if(n>1)throw Error(`Equation must contain exactly one arrow ("${s$}").`);let[r,i]=e.split(s$);R(r.indexOf(l$)===-1,()=>`The ellipsis notation ("${l$}") is not supported yet.`);let a=r.split(c$),o=a.length;if(t!==o)throw Error(`Expected ${o} input tensors, received ${t}`);if(o>2)throw Error(`Support for more than 2 input tensors is not implemented yet.`);let s=[];for(let e=0;e<i.length;++e){let t=i[e];if(!a.some(e=>e.indexOf(t)!==-1))throw Error(`Output subscripts contain the label ${t} not present in the input subscripts.`);s.indexOf(t)===-1&&s.push(t)}for(let e=0;e<r.length;++e){let t=r[e];s.indexOf(t)===-1&&t!==c$&&s.push(t)}let c=Array(a.length);for(let e=0;e<o;++e){if(new Set(a[e].split(``)).size!==a[e].length)throw Error(`Found duplicate axes in input component ${a[e]}. Support for duplicate axes in input is not implemented yet.`);c[e]=[];for(let t=0;t<a[e].length;++t)c[e].push(s.indexOf(a[e][t]))}let l=s.length,u=i.length,d=[];for(let e=u;e<l;++e)d.push(e);return{allDims:s,summedDims:d,idDims:c}}function d$(e,t){let n=Array(e);n.fill(-1);for(let e=0;e<t.length;++e)n[t[e]]=e;let r=[];for(let t=0;t<e;++t)n[t]===-1&&r.push(t);return n=n.filter(e=>e!==-1),{permutationIndices:n,expandDims:r}}function f$(e,t,n){let r=Array(e);for(let e=0;e<n.length;++e){let i=n[e].shape;for(let n=0;n<t[e].length;++n)r[t[e][n]]===void 0?r[t[e][n]]=i[n]:R(r[t[e][n]]===i[n],()=>`Expected dimension ${r[t[e][n]]} at axis ${n} of input shaped ${JSON.stringify(i)}, but got dimension ${i[n]}`)}}function p$(e,t){let n=e,r=[],i=0;e.length===0&&n.push(-1),i=e.length+1;for(let e=0;e<i;++e)r.push([]);let a=[];for(let e=0;e<n.length;++e){let i=n[e],o=vEe(t,i);for(let t of o)a.indexOf(t)===-1&&(r[e].push(t),a.push(t))}return{path:n,steps:r}}function m$(e){return e.every((e,t)=>e===t)}function vEe(e,t){let n=[];for(let r=0;r<e.length;++r)(e[r].length===0||e[r].indexOf(t)!==-1||t===-1)&&n.push(r);return n}function h$(e,t,n=0){let r=[];if(typeof t==`number`)R(e.shape[n]%t===0,()=>`Number of splits must evenly divide the axis.`),r=Array(t).fill(e.shape[n]/t);else{let i=t.reduce((e,t)=>(t===-1&&(e+=1),e),0);R(i<=1,()=>`There should be only one negative value in split array.`);let a=t.indexOf(-1);if(a!==-1){let r=t.reduce((e,t)=>t>0?e+t:e);t[a]=e.shape[n]-r}R(e.shape[n]===t.reduce((e,t)=>e+t),()=>`The sum of sizes must match the size of the axis dimension.`),r=t}return r}
/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
function g$(e){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${e}`}function _$(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function v$(e,t,n){return`indices(${e}, 0) is invalid: ${t} >= ${n}`}function y$(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function b$(e,t){return`size ${e} must be non-negative, not ${t}`}function x$(){return`reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero`}function S$(e,t){let n=z(e),r=z(t);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${e} outputShape= ${t}`}function C$(e,t){let n=z(e),r=z(t);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${e} outputShape=${t}`}
/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
function w$(){return`segment ids must be >= 0`}function T$(){return`segment ids are not increasing`}function E$(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function D$(e,t,n){return`Bad: indices[${e}] == ${t} out of range [0, ${n})`}var yEe=s({collectGatherOpShapeInfo:()=>A$,computeOutShape:()=>k$,segOpComputeOptimalWindowSize:()=>O$});function O$(e,t){let n=!1,r;for(e<=30?(r=e,n=!0):r=ZU(e,Math.floor(Math.sqrt(e)));!n;)r>t||r===e?n=!0:r=ZU(e,r+1);return r}function k$(e,t,n){let r=[],i=e.length;for(let a=0;a<i;a++)a===t?r.push(n):r.push(e[a]);return r}function A$(e,t,n,r){let i=t.shape.length,a=e.shape.length;if(r!==0&&(r<-i||r>i))throw Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>a)throw Error(`batchDims (${r}) must be less than rank(x) (
    ${a}).`);if(n<r)throw Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let n=0;n<r;++n)if(e.shape[n]!==t.shape[n])throw Error(`x.shape[${n}]: ${e.shape[n]} should be equal to indices.shape[${n}]: ${t.shape[n]}.`);let o=e.shape[n],s=[],c=1,l=1,u=1;for(let t=0;t<r;++t)s.push(e.shape[t]),c*=e.shape[t];for(let t=r;t<n;t++)s.push(e.shape[t]),l*=e.shape[t];for(let e=r;e<i;e++)s.push(t.shape[e]);for(let t=n+1;t<a;t++)s.push(e.shape[t]),u*=e.shape[t];return{batchSize:c,sliceSize:u,outerSize:l,dimSize:o,outputShape:s}}var bEe=s({ERF_A1:()=>JQ,ERF_A2:()=>YQ,ERF_A3:()=>XQ,ERF_A4:()=>ZQ,ERF_A5:()=>QQ,ERF_P:()=>qQ,PARALLELIZE_THRESHOLD:()=>30,RowPartitionType:()=>NQ,SELU_SCALE:()=>KQ,SELU_SCALEALPHA:()=>GQ,applyActivation:()=>RZ,assertAndGetBroadcastShape:()=>JY,assertAxesAreInnerMostDims:()=>aX,assertParamsConsistent:()=>jQ,assignToTypedArray:()=>i$,axesAreInnerMostDims:()=>tX,calculateShapes:()=>kZ,checkEinsumDimSizes:()=>f$,checkPadOnDimRoundingMode:()=>CY,combineLocations:()=>nX,combineRaggedTensorToTensorShapes:()=>PQ,complexWithEvenIndex:()=>t$,complexWithOddIndex:()=>n$,computeConv2DInfo:()=>fY,computeConv3DInfo:()=>pY,computeDefaultPad:()=>mY,computeDilation2DInfo:()=>lY,computeOptimalWindowSize:()=>RQ,computeOutAndReduceShapes:()=>rX,computeOutShape:()=>MQ,computePool2DInfo:()=>uY,computePool3DInfo:()=>dY,convertConv2DDataFormat:()=>SY,decodeEinsumEquation:()=>u$,eitherStridesOrDilationsAreOne:()=>bY,expandShapeToKeepDim:()=>iX,exponent:()=>o$,exponents:()=>a$,fromStringArrayToUint8:()=>M$,fromUint8ToStringArray:()=>j$,getAxesPermutation:()=>oX,getBroadcastDims:()=>KY,getComplexWithIndex:()=>r$,getEinsumComputePath:()=>p$,getEinsumPermutation:()=>d$,getFusedBiasGradient:()=>LZ,getFusedDyActivation:()=>IZ,getImageCenter:()=>zQ,getInnerMostAxes:()=>cX,getPermuted:()=>VQ,getRaggedRank:()=>IQ,getReductionAxes:()=>qY,getReshaped:()=>BQ,getReshapedPermuted:()=>HQ,getRowPartitionTypesHelper:()=>FQ,getSliceBeginCoords:()=>UQ,getSliceSize:()=>WQ,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>g$,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>_$,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>v$,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>x$,getSparseReshapeInputOutputMismatchErrorMessage:()=>C$,getSparseReshapeInputOutputMultipleErrorMessage:()=>S$,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>y$,getSparseReshapeNegativeOutputDimErrorMessage:()=>b$,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>D$,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>w$,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>T$,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>E$,getUndoAxesPermutation:()=>sX,isIdentityPermutation:()=>m$,log:()=>$ye,mergeRealAndImagArrays:()=>$Q,prepareAndValidate:()=>fQ,prepareSplitSize:()=>h$,segment_util:()=>yEe,shouldFuse:()=>zZ,slice_util:()=>dEe,splitRealAndImagArrays:()=>e$,stridesOrDilationsArePositive:()=>xY,tupleValuesAreOne:()=>yY,upcastType:()=>$q,validateDefaultValueShape:()=>LQ,validateInput:()=>Kwe,validateUpdateShape:()=>OZ,warn:()=>cq});function j$(e){try{return e.map(e=>Pq(e))}catch(e){throw Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function M$(e){return e.map(e=>Nq(e))}iEe();const N$={kernelName:`Abs`,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>J(e,TZ(K(n,`float32`),-1))}}},xEe={kernelName:yW,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=mX(K(n,`float32`)),r=pX(FX(fX(1),t));return NX(iY(e,r))}}}},SEe={kernelName:bW,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=pX(FX(mX(K(n,`float32`)),1));return iY(e,t)}}}},CEe={kernelName:`Add`,inputsToSave:[`a`,`b`],gradFunc:(e,t)=>{let[n,r]=t,i=JY(n.shape,r.shape);return{a:()=>{let t=e,r=qY(n.shape,i);return r.length>0&&(t=hX(t,r)),Y(t,n.shape)},b:()=>{let t=e,n=qY(r.shape,i);return n.length>0&&(t=hX(t,n)),Y(t,r.shape)}}}},wEe={kernelName:xW,saveAllInputs:!0,gradFunc:(e,t)=>{let n={};return t.forEach((t,r)=>{n[r]=()=>e.clone()}),n}},TEe={kernelName:SW,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ZY(n)}}},EEe={kernelName:CW,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>ZY(n)}}},DEe={kernelName:wW,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>iY(e,pX(FX(fX(1),mX(K(n,`float32`)))))}}},OEe={kernelName:TW,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=pX(q(fX(1),mX(K(n,`float32`))));return iY(e,t)}}}},kEe={kernelName:OW,inputsToSave:[`a`,`b`],gradFunc:(e,t)=>{let[n,r]=t,i=JY(n.shape,r.shape);return{a:()=>{let t=q(mX(n),mX(r)),a=J(e,iY(r,t)),o=qY(n.shape,i);return o.length>0&&(a=hX(a,o)),Y(a,n.shape)},b:()=>{let t=q(mX(n),mX(r)),a=NX(J(e,iY(n,t))),o=qY(r.shape,i);return o.length>0&&(a=hX(a,o)),Y(a,r.shape)}}}},AEe={kernelName:EW,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>iY(e,q(mX(K(n,`float32`)),1))}}},jEe={kernelName:DW,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>iY(e,FX(fX(1),mX(K(n,`float32`))))}}};function MEe(e,t,n,r,i,a){let o=U(e,`dy`,`avgPool3dGrad`),s=U(t,`input`,`avgPool3dGrad`),c=o,l=s,u=!1;s.rank===4&&(u=!0,c=Y(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),l=Y(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),R(c.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),R(l.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${l.rank}.`),CY(`avgPool3dGrad`,i,a);let d={dy:c,input:l},f={filterSize:n,strides:r,pad:i,dimRoundingMode:a},p=H.runKernel(MW,d,f);return u?Y(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const NEe=W({avgPool3dGrad_:MEe}),PEe={kernelName:jW,inputsToSave:[`x`],gradFunc:(e,t,n)=>{let[r]=t,{filterSize:i,strides:a,pad:o,dimRoundingMode:s}=n;return{x:()=>NEe(e,r,i,a,o,s)}}};function FEe(e,t,n,r,i){let a=U(e,`dy`,`avgPoolGrad`),o=U(t,`input`,`avgPoolGrad`);R(o.rank===a.rank,()=>`Rank of input (${o.rank}) does not match rank of dy (${a.rank})`);let s=o,c=a,l=!1;o.rank===3&&(l=!0,s=Y(o,[1,o.shape[0],o.shape[1],o.shape[2]]),c=Y(a,[1,a.shape[0],a.shape[1],a.shape[2]])),R(c.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${c.rank}.`),R(s.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${s.rank}.`);let u={dy:c,input:s},d={filterSize:n,strides:r,pad:i},f=H.runKernel(AW,u,d);return l?Y(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const IEe=W({avgPoolGrad_:FEe}),LEe={kernelName:kW,inputsToSave:[`x`],gradFunc:(e,t,n)=>{let[r]=t,{filterSize:i,strides:a,pad:o}=n;return{x:()=>IEe(e,r,i,a,o)}}},REe={kernelName:NW,inputsToSave:[`a`,`b`],gradFunc:(e,t,n)=>{let[r,i]=t,{transposeA:a,transposeB:o}=n;return!a&&!o?{a:()=>EY(e,i,!1,!0),b:()=>EY(r,e,!0,!1)}:!a&&o?{a:()=>EY(e,i,!1,!1),b:()=>EY(e,r,!0,!1)}:a&&!o?{a:()=>EY(i,e,!1,!0),b:()=>EY(r,e,!1,!1)}:{a:()=>EY(i,e,!0,!0),b:()=>EY(e,r,!0,!0)}}},zEe={kernelName:PW,gradFunc:(e,t,n)=>{let{blockShape:r,crops:i}=n;return{x:()=>QX(e,r,i)}}},BEe={kernelName:`BroadcastTo`,gradFunc:(e,t,n)=>{let r=n,i=r.inputShape,a=r.shape,o=Array.from(a);for(let e=i.length-1;e>=0;e--)if(i[e]===a[e])o[e]=1;else if(i[e]!==1)throw Error(`broadcastTo(): [${i}] cannot be broadcast to [${a}].`);let s=[];for(let e=0;e<o.length;e++)o[e]>1&&s.push(e);return{x:()=>hX(e,s,!0)}}},VEe={kernelName:RW,gradFunc:e=>({x:()=>e.clone()})},HEe={kernelName:zW,gradFunc:e=>({x:()=>ZY(e)})},UEe={kernelName:BW,inputsToSave:[`x`],gradFunc:(e,t,n)=>{let[r]=t,{clipValueMin:i,clipValueMax:a}=n;return{x:()=>XY(RX(TX(r,i),kX(r,a)),e,ZY(e))}}},WEe={kernelName:HW,inputsToSave:[`x`],gradFunc:N$.gradFunc},GEe={kernelName:UW,saveAllInputs:!0,gradFunc:(e,t,n)=>{let r=t.map(e=>e.shape),{axis:i}=n,a=LU(i,t[0].shape)[0],o=r.map(e=>e[a]);return SZ(e,o,a).map(e=>()=>e)}},KEe={kernelName:WW,inputsToSave:[`x`,`filter`],gradFunc:(e,t,n)=>{let[r,i]=t,{dilations:a,strides:o,pad:s,dataFormat:c}=n;return R(yY(a),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`),{x:()=>LY(r.shape,e,i,o,s,c),filter:()=>FZ(r,e,i.shape,o,s,c)}}},qEe={kernelName:KW,inputsToSave:[`dy`,`filter`],gradFunc:(e,t,n)=>{let[r,i]=t,{strides:a,pad:o,dataFormat:s,dimRoundingMode:c}=n;return{dy:()=>FY(e,i,a,o,s,1,c),filter:()=>FZ(e,r,i.shape,a,o,s,c)}}};function JEe(e,t,n,r,i){let a=e;e.rank===4&&(a=Y(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));let o=t;o.rank===4&&(o=Y(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),R(a.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${a.shape}.`),R(o.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${o.shape}.`),R(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),R(a.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must match input depth in filter (${n[3]}.`),R(o.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${o.shape[4]}) must match output depth for filter (${n[4]}).`);let s={x:a,dy:o},c={strides:r,pad:i,filterShape:n};return H.runKernel(JW,s,c)}const YEe=W({conv3DBackpropFilter_:JEe}),XEe={kernelName:qW,inputsToSave:[`x`,`filter`],gradFunc:(e,t,n)=>{let{dilations:r,strides:i,pad:a}=n;R(yY(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);let[o,s]=t;return{x:()=>zY(o.shape,e,s,i,a),filter:()=>YEe(o,e,s.shape,i,a)}}},ZEe={kernelName:`Cos`,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>J(NX(pZ(K(n,`float32`))),e)}}},QEe={kernelName:XW,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>J(mZ(K(n,`float32`)),e)}}},$Ee={kernelName:QW,inputsToSave:[`x`],gradFunc:(e,t,n)=>{let[r]=t,{axis:i,exclusive:a,reverse:o}=n;return{x:()=>{let t=oX([i],r.rank),n=UY(e,i,a,!o);return t!=null&&(n=PZ(n,t)),n}}}},eDe={kernelName:nG,inputsToSave:[`x`,`filter`],gradFunc:(e,t,n)=>{let{dilations:r,strides:i,pad:a,dimRoundingMode:o}=n,s=r??[1,1];R(yY(s),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);let[c,l]=t;return R(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${c.rank}.`),R(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${l.rank}.`),R(c.shape[3]===l.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${c.shape[3]}) must match the inChannels dimension in filter ${l.shape[2]}.`),R(bY(i,s),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${s}'.`),CY(`depthwiseConv2d`,a,o),{x:()=>dTe(c.shape,e,l,i,a,s,o),filter:()=>lTe(c,e,l.shape,i,a,s,o)}}},tDe={kernelName:oG,inputsToSave:[`x`,`filter`],gradFunc:(e,t,n)=>{let[r,i]=t,a={x:r,filter:i,dy:e},o={x:r,filter:i,dy:e};return{x:()=>H.runKernel(sG,a,n),filter:()=>H.runKernel(cG,o,n)}}},nDe={kernelName:`Elu`,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t,r={dy:e,y:n};return{x:()=>H.runKernel(dG,r)}}},rDe={kernelName:`Erf`,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t,r=J(vX(NX(mX(n))),2/Math.sqrt(Math.PI));return{x:()=>J(e,r)}}},iDe={kernelName:`Exp`,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>J(e,n)}}},aDe={kernelName:pG,inputsToSave:[`input`],gradFunc:(e,t)=>{let[n]=t;return{input:()=>Y(e,n.shape)}}},oDe={kernelName:mG,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>J(e,vX(n))}}},sDe={kernelName:_G,gradFunc:e=>({x:()=>ZY(e)})},cDe={kernelName:vG,inputsToSave:[`a`,`b`],gradFunc:(e,t)=>{let[n,r]=t,i=JY(n.shape,r.shape);return{a:()=>{let t=iY(e,K(r,`float32`)),a=qY(n.shape,i);return a.length>0?Y(hX(t,a),n.shape):t},b:()=>{let t=J(e,K(n,`float32`)),a=qY(r.shape,i);a.length>0&&(t=Y(hX(t,a),r.shape));let o=mX(r);return NX(iY(t,K(o,`float32`)))}}}},lDe={kernelName:yG,inputsToSave:[`x`,`mean`,`variance`,`scale`],gradFunc:(e,t,n)=>{let{varianceEpsilon:r}=n,[i,a,o,s]=t,c=s??fX(1),l=qY(a.shape,i.shape),u=[];if(a.rank===1){for(let e=0;e<i.shape.length-1;++e)u.push(i.shape[e]);u.push(1)}let d=FX(i,a),f=J(e,c),p=uZ(q(o,fX(r))),m=J(J(J(p,p),p),fX(-.5));return{x:()=>a.rank===1?Y(J(J(e,bX(Y(p,[1,1,1,a.shape[0]]),u)),c),i.shape):Y(J(J(e,p),c),i.shape),mean:()=>{let e=J(J(p,fX(-1)),f);return a.rank===1&&(e=hX(e,l)),Y(e,a.shape)},variance:()=>{let e=J(J(m,d),f);return a.rank===1&&(e=hX(e,l)),Y(e,a.shape)},scale:()=>{let t=J(d,p),n=J(e,t);return a.rank===1&&(n=hX(n,l)),Y(n,a.shape)},offset:()=>{let t=e;return a.rank===1&&(t=hX(t,l)),Y(t,a.shape)}}}},uDe={kernelName:bG,inputsToSave:[`x`,`indices`],gradFunc:(e,t,n)=>{let[r,i]=t,{axis:a,batchDims:o}=n,s=LU(a,r.shape)[0],c=(e,t,n)=>()=>{let r=e.shape,i=t.size,o=r.slice(0,s),c=o.length,l=r.slice(a,r.length).slice(1),u=l.length,d=P$(0,c),f=P$(c+1,c+1+u),p=F$([o,[i],l]),m=Y(n,p),h=Y(t,[i]),g=F$([[c],d,f]),_=PZ(m,g),v=jZ(_,h,e.shape[s]),y=sX(g);return v=PZ(v,y),v};if(o===1){let t=r.shape[0],n=r.split(t,0);return{x:()=>wZ(n.map((t,n)=>c(t,i.slice(n,1),e.slice(n,1))())).reshape(r.shape),indices:()=>i}}else return{x:c(r,i,e),indices:()=>i}}};function P$(e,t){let n=[];for(let r=e;r<t;++r)n.push(r);return n}function F$(e){let t=[];for(let n=0;n<e.length;++n)for(let r=0;r<e[n].length;++r)t.push(e[n][r]);return t}const dDe={kernelName:CG,inputsToSave:[`a`,`b`],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>ZY(n),b:()=>ZY(r)}}},fDe={kernelName:wG,gradFunc:e=>({x:()=>K(e,`float32`)})},pDe={kernelName:DG,gradFunc:e=>({x:()=>ZY(e)})},mDe={kernelName:OG,gradFunc:e=>({x:()=>ZY(e)})},hDe={kernelName:kG,gradFunc:e=>({x:()=>ZY(e)})},gDe={kernelName:AG,inputsToSave:[`x`],gradFunc:(e,t,n)=>{let[r]=t,{alpha:i}=n,a=wX(r,0);return{x:()=>XY(a,e,J(e,i))}}},_De={kernelName:PG,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>iY(e,q(n,1))}}},vDe={kernelName:`Log`,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>iY(e,K(n,`float32`))}}},yDe={kernelName:`LogSoftmax`,inputsToSave:[],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r]=t,{axis:i}=n;return{logits:()=>{let t=vX(r);return FX(e,J(hX(e,i,!0),t))}}}};function bDe(e,t,n,r=5,i=1,a=1,o=.5){let s={x:e,y:t,dy:n},c={depthRadius:r,bias:i,alpha:a,beta:o};return H.runKernel(RG,s,c)}const xDe=W({localResponseNormalizationBackprop_:bDe}),SDe={kernelName:`LRN`,inputsToSave:[`x`],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,i]=t,{depthRadius:a,bias:o,alpha:s,beta:c}=n;return{x:()=>xDe(r,i,e,a,o,s,c)}}};function I$(e,t,n,r){return t.rank<n.rank&&(t=Y(t,iX(t.shape,r))),e.rank<n.rank&&(e=Y(e,iX(e.shape,r))),{x:()=>J(e,K(YY(n,t),e.dtype))}}const L$={kernelName:`Max`,inputsToSave:[`x`],outputsToSave:[!0],gradFunc:(e,t,n)=>{let{reductionIndices:r}=n,i=t[0],a=t[1],o=LU(r,i.shape),s=I$(e,a,i,o);return{x:()=>s.x()}}},CDe={kernelName:zG,inputsToSave:[`a`,`b`],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>J(e,K(TX(n,r),`float32`)),b:()=>J(e,K(OX(n,r),`float32`))}}};function wDe(e,t,n,r,i,a,o){let s=U(e,`dy`,`maxPool3dGrad`),c=U(t,`input`,`maxPool3dGrad`),l=U(n,`output`,`maxPool3dGrad`),u=s,d=c,f=l,p=!1;c.rank===4&&(p=!0,u=Y(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),d=Y(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),f=Y(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),R(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),R(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),R(f.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${f.rank}.`),CY(`maxPool3dGrad`,a,o);let m={dy:u,input:d,output:f},h={filterSize:r,strides:i,pad:a,dimRoundingMode:o},g=H.runKernel(UG,m,h);return p?Y(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}const TDe=W({maxPool3dGrad_:wDe}),EDe={kernelName:HG,inputsToSave:[`x`],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,i]=t,{filterSize:a,strides:o,pad:s,dimRoundingMode:c}=n;return{x:()=>TDe(e,r,i,a,o,s,c)}}};function DDe(e,t,n,r,i,a,o){let s=U(e,`dy`,`maxPoolGrad`),c=U(t,`input`,`maxPoolGrad`),l=U(n,`output`,`maxPoolGrad`);R(c.rank===s.rank,()=>`Rank of input (${c.rank}) does not match rank of dy (${s.rank})`),R(s.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${s.rank}.`),R(c.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${c.rank}.`),CY(`maxPoolGrad`,a,o);let u={dy:s,input:c,output:l},d={filterSize:r,strides:i,pad:a,dimRoundingMode:o};return H.runKernel(VG,u,d)}const ODe=W({maxPoolGrad_:DDe}),kDe={kernelName:BG,inputsToSave:[`x`],outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r,i]=t,{filterSize:a,strides:o,pad:s}=n;return{x:()=>ODe(e,r,i,a,o,s)}}},ADe={kernelName:GG,inputsToSave:[`x`],gradFunc:(e,t,n)=>{let[r]=t,{axis:i}=n,a=LU(i,r.shape),o=rX(r.shape,a)[1],s=z(o);return{x:()=>{let t=r.shape.slice();a.forEach(e=>{t[e]=1});let n=Y(e,t);return iY(J(n,GX(r.shape,`float32`)),s)}}}},jDe={kernelName:`Min`,inputsToSave:[`x`],outputsToSave:[!0],gradFunc:(e,t,n)=>{let{axis:r}=n,[i,a]=t,o=LU(r,i.shape),s=I$(e,a,i,o);return{x:()=>s.x()}}},MDe={kernelName:KG,inputsToSave:[`a`,`b`],gradFunc:(e,t)=>{let[n,r]=t;return{a:()=>J(e,K(kX(n,r),`float32`)),b:()=>J(e,K(wX(n,r),`float32`))}}},NDe={kernelName:qG,inputsToSave:[`x`],gradFunc:(e,t,n)=>{let r=t[0],{paddings:i}=n,a=i.map(e=>e[0]);return{x:()=>OY(e,a,r.shape)}}},PDe={kernelName:`Mod`,inputsToSave:[`a`,`b`],gradFunc:(e,t)=>{let[n,r]=t,i=JY(n.shape,r.shape);return{a:()=>{let t=qY(n.shape,i);return t.length>0?Y(hX(e,t),n.shape):e},b:()=>{let t=J(e,NX(SX(iY(n,r)))),a=qY(r.shape,i);return a.length>0?Y(hX(t,a),r.shape):t}}}},FDe={kernelName:YG,inputsToSave:[`a`,`b`],gradFunc:(e,t)=>{let[n,r]=t,i=JY(n.shape,r.shape);return{a:()=>{let t=J(e,K(r,`float32`)),a=qY(n.shape,i);return a.length>0?Y(hX(t,a),n.shape):t},b:()=>{let t=J(e,K(n,`float32`)),a=qY(r.shape,i);return a.length>0?Y(hX(t,a),r.shape):t}}}},IDe={kernelName:`Neg`,gradFunc:e=>({x:()=>NX(e)})},LDe={kernelName:tK,inputsToSave:[`indices`],gradFunc:(e,t)=>{let n=t[0];return{indices:()=>WX(n.shape,`float32`)}}},RDe={kernelName:eK,gradFunc:e=>({x:()=>ZY(e)})},zDe={kernelName:nK,saveAllInputs:!0,gradFunc:(e,t,n)=>{let{axis:r}=n;return MZ(e,r).map(e=>()=>e)}},R$={kernelName:rK,inputsToSave:[`x`],gradFunc:(e,t,n)=>{let r=t[0],{paddings:i}=n,a=i.map(e=>e[0]);return{x:()=>OY(e,a,r.shape)}}},BDe={kernelName:`Pow`,inputsToSave:[`a`,`b`],outputsToSave:[!0],gradFunc:(e,t)=>{let[n,r,i]=t,a=n,o=r,s=JY(a.shape,o.shape);return{a:()=>{let t=K(o,`float32`),n=J(e,J(t,dX(a,FX(t,fX(1))))),r=qY(a.shape,s);return r.length>0&&(n=hX(n,r)),Y(n,a.shape)},b:()=>{let t=wX(a,0),n=XY(t,AX(a),ZY(a)),r=J(e,J(i,n)),c=qY(o.shape,s);return c.length>0&&(r=hX(r,c)),Y(r,o.shape)}}}},VDe={kernelName:iK,inputsToSave:[`x`,`alpha`],gradFunc:(e,t)=>{let[n,r]=t,i=wX(n,0);return{x:()=>XY(i,e,J(e,r)),alpha:()=>{let t=XY(i,ZY(e),J(e,n)),a=qY(r.shape,e.shape);return a.length>0&&(t=hX(t,a)),Y(t,r.shape)}}}};function HDe(e,t,n){let r=e.shape.slice();r[n]=1;let i=Y(t,r),a=HY(e,n,!0,!1),o=HY(e,n,!0,!0),s=J(a,o);return J(i,s)}function UDe(e,t,n){let r=e.shape.length,i=r-n.length,a=oX(n,r),o=e;a!=null&&(o=PZ(e,a));let s=o.shape.slice(),c=s.splice(r-n.length,n.length).reduce((e,t)=>e*t,1);s.push(c);let l=o.reshape(s),u=HDe(l,t,i);if(u=u.reshape(o.shape),a!=null){let e=sX(a);u=PZ(u,e)}return u}const WDe={kernelName:aK,inputsToSave:[`x`],gradFunc:(e,t,n)=>{let[r]=t,{axis:i}=n,a=[];return a=i==null?r.shape.map((e,t)=>t):typeof i==`number`?[i]:i,{x:()=>UDe(r,e,a)}}},GDe={kernelName:lG,inputsToSave:[`a`,`b`],gradFunc:(e,t)=>{let[n,r]=t,i=JY(n.shape,r.shape);return{a:()=>{let t=iY(e,K(r,`float32`)),a=qY(n.shape,i);return a.length>0?Y(hX(t,a),n.shape):t},b:()=>{let t=J(e,K(n,`float32`)),a=qY(r.shape,i);a.length>0&&(t=Y(hX(t,a),r.shape));let o=mX(r);return NX(iY(t,K(o,`float32`)))}}}},KDe={kernelName:dK,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>iY(e,NX(mX(n)))}}},qDe={kernelName:vK,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t,r=J(kX(n,6),TZ(n));return{x:()=>J(e,K(r,`float32`))}}},JDe={kernelName:fK,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>J(e,K(TZ(n),`float32`))}}},YDe={kernelName:pK,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>Y(e,n.shape)}}},XDe={kernelName:gK,inputsToSave:[`images`],gradFunc:(e,t,n)=>{let[r]=t,i={dy:e,images:r};return{images:()=>H.runKernel(_K,i,n)}}},ZDe={kernelName:mK,inputsToSave:[`images`],gradFunc:(e,t,n)=>{let[r]=t,i={dy:e,images:r};return{images:()=>H.runKernel(hK,i,n)}}},QDe={kernelName:yK,gradFunc:(e,t,n)=>{let{dims:r}=n,i=LU(r,e.shape);return{x:()=>cZ(e,i)}}},$De={kernelName:bK,gradFunc:e=>({x:()=>ZY(e)})},eOe={kernelName:xK,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>NX(iY(e,J(dX(n,1.5),2)))}}},tOe={kernelName:TK,inputsToSave:[`condition`],gradFunc:(e,t)=>{let[n]=t;return{condition:()=>K(ZY(n),`float32`),t:()=>J(e,K(n,e.dtype)),e:()=>J(e,K(zX(n),e.dtype))}}},nOe={kernelName:EK,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>{let t=wX(n,fX(0)),r=fX(GQ),i=fX(KQ),a=J(e,i),o=J(J(e,r),vX(K(n,`float32`)));return XY(t,a,o)}}}},rOe={kernelName:AK,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>J(e,J(n,FX(fX(1),n)))}}},iOe={kernelName:kK,gradFunc:e=>({x:()=>ZY(e)})},aOe={kernelName:`Sin`,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>J(BY(K(n,`float32`)),e)}}},oOe={kernelName:OK,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>J(VY(K(n,`float32`)),e)}}},sOe={kernelName:DK,inputsToSave:[`x`],gradFunc:(e,t,n)=>{let[r]=t,{begin:i,size:a}=n,o=r.shape,[s,c]=EQ(r,i,a),l=[];for(let t=0;t<e.rank;t++)l.push([s[t],o[t]-s[t]-c[t]]);return{x:()=>ZX(e,l)}}},cOe={kernelName:FK,outputsToSave:[!0],gradFunc:(e,t,n)=>{let[r]=t,{dim:i}=n,a=J(e,r);return{logits:()=>FX(a,J(hX(a,[i],!0),r))}}},lOe={kernelName:jK,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>J(e,DY(n))}}},z$={kernelName:NK,gradFunc:(e,t,n)=>{let{blockShape:r,paddings:i}=n;return{x:()=>AY(e,r,i)}}},B$={kernelName:PK,gradFunc:(e,t,n)=>{let{axis:r}=n;return{x:()=>TY(e,r)}}},uOe={kernelName:MK,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>iY(e,J(pX(K(n,`float32`)),2))}}},dOe={kernelName:HK,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>J(e,J(K(n,`float32`),2))}}},fOe={kernelName:VK,inputsToSave:[`a`,`b`],gradFunc:(e,t)=>{let[n,r]=t,i=fX(2);return{a:()=>J(e,J(i,FX(n,r))),b:()=>J(e,J(i,FX(r,n)))}}},pOe={kernelName:rq,gradFunc:e=>({x:()=>ZY(e)})},mOe={kernelName:`Sub`,inputsToSave:[`a`,`b`],gradFunc:(e,t)=>{let[n,r]=t,i=JY(n.shape,r.shape);return{a:()=>{let t=e,r=qY(n.shape,i);return r.length>0&&(t=hX(t,r)),Y(t,n.shape)},b:()=>{let t=e,n=qY(r.shape,i);return n.length>0&&(t=hX(t,n)),Y(NX(t),r.shape)}}}},hOe={kernelName:`Sum`,inputsToSave:[`x`],gradFunc:(e,t,n)=>{let[r]=t,i=r.shape.slice(),{axis:a}=n;LU(a,r.shape).forEach(e=>{i[e]=1});let o=Y(e,i),s=J(o,GX(r.shape,`float32`));return{x:()=>s}}},gOe={kernelName:`Tan`,inputsToSave:[`x`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>iY(e,mX(BY(n)))}}},_Oe={kernelName:JK,outputsToSave:[!0],gradFunc:(e,t)=>{let[n]=t;return{x:()=>J(FX(fX(1),mX(n)),e)}}},vOe={kernelName:YK,inputsToSave:[`x`],gradFunc:(e,t,n)=>{let[r]=t,{reps:i}=n;return{x:()=>{let t=ZY(r);if(r.rank===1)for(let n=0;n<i[0];++n)t=q(t,OY(e,[n*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)t=q(t,OY(e,[n*r.shape[0],a*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)for(let o=0;o<i[2];++o)t=q(t,OY(e,[n*r.shape[0],a*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let n=0;n<i[0];++n)for(let a=0;a<i[1];++a)for(let o=0;o<i[2];++o)for(let s=0;s<i[3];++s)t=q(t,OY(e,[n*r.shape[0],a*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return t}}}},yOe={kernelName:QK,gradFunc:(e,t,n)=>{let{perm:r}=n,i=sX(r);return{x:()=>PZ(e,i)}}},bOe={kernelName:eq,gradFunc:(e,t,n)=>{let{axis:r}=n;return{value:()=>wZ(e,r)}}},xOe={kernelName:tq,inputsToSave:[`segmentIds`],gradFunc:(e,t)=>{let[n]=t;return{x:()=>SOe(e,n)}}};function SOe(e,t){let n=HX(t,ZY(t)),r=CX(e,n),i=TX(t,fX(0,`int32`)),a=r.rank-i.rank;for(let e=0;e<a;++e)i=yX(i,e+1);i=RX(i,GX(r.shape,`bool`));let o=ZY(r);return XY(i,r,o)}var COe=[N$,xEe,SEe,CEe,wEe,TEe,EEe,DEe,OEe,kEe,AEe,jEe,PEe,LEe,REe,zEe,BEe,VEe,HEe,UEe,WEe,GEe,qEe,KEe,XEe,ZEe,QEe,$Ee,eDe,tDe,GDe,nDe,rDe,iDe,aDe,oDe,cDe,sDe,lDe,uDe,dDe,fDe,pDe,mDe,hDe,gDe,_De,vDe,yDe,SDe,L$,L$,CDe,EDe,kDe,ADe,jDe,MDe,NDe,PDe,FDe,IDe,LDe,RDe,zDe,R$,R$,BDe,VDe,WDe,KDe,qDe,JDe,YDe,XDe,ZDe,QDe,$De,eOe,tOe,nOe,rOe,iOe,aOe,oOe,sOe,cOe,lOe,z$,z$,B$,B$,uOe,fOe,dOe,pOe,mOe,hOe,gOe,_Oe,vOe,yOe,bOe,xOe,{kernelName:nq,gradFunc:e=>({x:()=>ZY(e)})}];for(let e of COe)ebe(e);V().prototype.abs=function(){return this.throwIfDisposed(),aY(this)},V().prototype.acos=function(){return this.throwIfDisposed(),uxe(this)},V().prototype.acosh=function(){return this.throwIfDisposed(),fxe(this)},V().prototype.add=function(e){return this.throwIfDisposed(),q(this,e)},V().prototype.all=function(e,t){return this.throwIfDisposed(),oY(this,e,t)},V().prototype.any=function(e,t){return this.throwIfDisposed(),sY(this,e,t)},V().prototype.argMax=function(e){return this.throwIfDisposed(),cY(this,e)},V().prototype.argMin=function(e){return this.throwIfDisposed(),_xe(this,e)},V().prototype.asScalar=function(){return this.throwIfDisposed(),R(this.size===1,()=>`The array must have only 1 element.`),Y(this,[])},V().prototype.asType=function(e){return this.throwIfDisposed(),K(this,e)},V().prototype.as1D=function(){return this.throwIfDisposed(),Y(this,[this.size])},V().prototype.as2D=function(e,t){return this.throwIfDisposed(),Y(this,[e,t])},V().prototype.as3D=function(e,t,n){return this.throwIfDisposed(),Y(this,[e,t,n])},V().prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),Y(this,[e,t,n,r])},V().prototype.as5D=function(e,t,n,r,i){return this.throwIfDisposed(),Y(this,[e,t,n,r,i])},V().prototype.asin=function(){return this.throwIfDisposed(),yxe(this)},V().prototype.asinh=function(){return this.throwIfDisposed(),xxe(this)},V().prototype.atan=function(){return this.throwIfDisposed(),Cxe(this)},V().prototype.atan2=function(e){return this.throwIfDisposed(),Txe(this,e)},V().prototype.atanh=function(){return this.throwIfDisposed(),Dxe(this)},V().prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),wY(this,e,t,n,r)},V().prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),AY(this,e,t)},V().prototype.batchNorm=function(e,t,n,r,i){return this.throwIfDisposed(),jY(this,e,t,n,r,i)},V().prototype.broadcastTo=function(e){return this.throwIfDisposed(),MY(this,e)},V().prototype.cast=function(e){return this.throwIfDisposed(),K(this,e)},V().prototype.ceil=function(){return this.throwIfDisposed(),eSe(this)},V().prototype.clipByValue=function(e,t){return this.throwIfDisposed(),PY(this,e,t)},V().prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof qq&&(e=[e]),TY([this,...e],t)},V().prototype.conv1d=function(e,t,n,r,i,a){return this.throwIfDisposed(),IY(this,e,t,n,r,i,a)},V().prototype.conv2dTranspose=function(e,t,n,r,i){return this.throwIfDisposed(),RY(this,e,t,n,r,i)},V().prototype.conv2d=function(e,t,n,r,i,a){return this.throwIfDisposed(),FY(this,e,t,n,r,i,a)},V().prototype.cos=function(){return this.throwIfDisposed(),BY(this)},V().prototype.cosh=function(){return this.throwIfDisposed(),VY(this)},V().prototype.cumprod=function(e,t,n){return this.throwIfDisposed(),HY(this,e,t,n)},V().prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),UY(this,e,t,n)},V().prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),TSe(this,e,t)},V().prototype.depthwiseConv2d=function(e,t,n,r,i,a){return this.throwIfDisposed(),GY(this,e,t,n,r,i,a)},V().prototype.dilation2d=function(e,t,n,r,i){return this.throwIfDisposed(),OSe(this,e,t,n,r,i)},V().prototype.divNoNan=function(e){return this.throwIfDisposed(),NSe(this,e)},V().prototype.div=function(e){return this.throwIfDisposed(),iY(this,e)},V().prototype.dot=function(e){return this.throwIfDisposed(),FSe(this,e)},V().prototype.elu=function(){return this.throwIfDisposed(),$Y(this)},V().prototype.equal=function(e){return this.throwIfDisposed(),YY(this,e)},V().prototype.erf=function(){return this.throwIfDisposed(),eX(this)},V().prototype.euclideanNorm=function(e,t){return this.throwIfDisposed(),qSe(this,e,t)},V().prototype.exp=function(){return this.throwIfDisposed(),vX(this)},V().prototype.expandDims=function(e){return this.throwIfDisposed(),yX(this,e)},V().prototype.expm1=function(){return this.throwIfDisposed(),ZSe(this)},V().prototype.fft=function(){return this.throwIfDisposed(),bZ(this)},V().prototype.flatten=function(){return this.throwIfDisposed(),Y(this,[this.size])},V().prototype.floor=function(){return this.throwIfDisposed(),SX(this)},V().prototype.floorDiv=function(e){return this.throwIfDisposed(),rY(this,e)},V().prototype.gather=function(e,t,n){return this.throwIfDisposed(),CX(this,e,t,n)},V().prototype.greaterEqual=function(e){return this.throwIfDisposed(),TX(this,e)},V().prototype.greater=function(e){return this.throwIfDisposed(),wX(this,e)},V().prototype.ifft=function(){return this.throwIfDisposed(),xZ(this)},V().prototype.irfft=function(){return this.throwIfDisposed(),Nwe(this)},V().prototype.isFinite=function(){return this.throwIfDisposed(),oCe(this)},V().prototype.isInf=function(){return this.throwIfDisposed(),cCe(this)},V().prototype.isNaN=function(){return this.throwIfDisposed(),uCe(this)},V().prototype.leakyRelu=function(e){return this.throwIfDisposed(),DX(this,e)},V().prototype.lessEqual=function(e){return this.throwIfDisposed(),kX(this,e)},V().prototype.less=function(e){return this.throwIfDisposed(),OX(this,e)},V().prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),hCe(this,e,t,n,r)},V().prototype.logSigmoid=function(){return this.throwIfDisposed(),SCe(this)},V().prototype.logSoftmax=function(e){return this.throwIfDisposed(),IX(this,e)},V().prototype.logSumExp=function(e,t){return this.throwIfDisposed(),LX(this,e,t)},V().prototype.log=function(){return this.throwIfDisposed(),AX(this)},V().prototype.log1p=function(){return this.throwIfDisposed(),jX(this)},V().prototype.logicalAnd=function(e){return this.throwIfDisposed(),RX(this,e)},V().prototype.logicalNot=function(){return this.throwIfDisposed(),zX(this)},V().prototype.logicalOr=function(e){return this.throwIfDisposed(),BX(this,e)},V().prototype.logicalXor=function(e){return this.throwIfDisposed(),ACe(this,e)},V().prototype.matMul=function(e,t,n){return this.throwIfDisposed(),EY(this,e,t,n)},V().prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),VX(this,e,t,n,r)},V().prototype.max=function(e,t){return this.throwIfDisposed(),lX(this,e,t)},V().prototype.maximum=function(e){return this.throwIfDisposed(),HX(this,e)},V().prototype.mean=function(e,t){return this.throwIfDisposed(),UX(this,e,t)},V().prototype.min=function(e,t){return this.throwIfDisposed(),uX(this,e,t)},V().prototype.minimum=function(e){return this.throwIfDisposed(),KX(this,e)},V().prototype.mirrorPad=function(e,t){return this.throwIfDisposed(),RCe(this,e,t)},V().prototype.mod=function(e){return this.throwIfDisposed(),BCe(this,e)},V().prototype.mul=function(e){return this.throwIfDisposed(),J(this,e)},V().prototype.neg=function(){return this.throwIfDisposed(),NX(this)},V().prototype.norm=function(e,t,n){return this.throwIfDisposed(),_X(this,e,t,n)},V().prototype.notEqual=function(e){return this.throwIfDisposed(),JX(this,e)},V().prototype.oneHot=function(e,t=1,n=0){return this.throwIfDisposed(),YX(this,e,t,n)},V().prototype.onesLike=function(){return this.throwIfDisposed(),XX(this)},V().prototype.pad=function(e,t){return this.throwIfDisposed(),ZX(this,e,t)},V().prototype.pool=function(e,t,n,r,i,a){return this.throwIfDisposed(),XCe(this,e,t,n,r,i,a)},V().prototype.pow=function(e){return this.throwIfDisposed(),dX(this,e)},V().prototype.prelu=function(e){return this.throwIfDisposed(),$X(this,e)},V().prototype.prod=function(e,t){return this.throwIfDisposed(),$Ce(this,e,t)},V().prototype.reciprocal=function(){return this.throwIfDisposed(),pwe(this)},V().prototype.relu=function(){return this.throwIfDisposed(),oZ(this)},V().prototype.relu6=function(){return this.throwIfDisposed(),sZ(this)},V().prototype.reshapeAs=function(e){return this.throwIfDisposed(),Y(this,e.shape)},V().prototype.reshape=function(e){return this.throwIfDisposed(),Y(this,e)},V().prototype.resizeBilinear=function(e,t,n){return this.throwIfDisposed(),qZ(this,e,t,n)},V().prototype.resizeNearestNeighbor=function(e,t,n){return this.throwIfDisposed(),JZ(this,e,t,n)},V().prototype.reverse=function(e){return this.throwIfDisposed(),cZ(this,e)},V().prototype.rfft=function(){return this.throwIfDisposed(),Iwe(this)},V().prototype.round=function(){return this.throwIfDisposed(),lZ(this)},V().prototype.rsqrt=function(){return this.throwIfDisposed(),uZ(this)},V().prototype.selu=function(){return this.throwIfDisposed(),dZ(this)},V().prototype.separableConv2d=function(e,t,n,r,i,a){return this.throwIfDisposed(),fZ(this,e,t,n,r,i,a)},V().prototype.sigmoid=function(){return this.throwIfDisposed(),DY(this)},V().prototype.sign=function(){return this.throwIfDisposed(),Swe(this)},V().prototype.sin=function(){return this.throwIfDisposed(),pZ(this)},V().prototype.sinh=function(){return this.throwIfDisposed(),mZ(this)},V().prototype.slice=function(e,t){return this.throwIfDisposed(),OY(this,e,t)},V().prototype.softmax=function(e){return this.throwIfDisposed(),yZ(this,e)},V().prototype.softplus=function(){return this.throwIfDisposed(),PX(this)},V().prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),QX(this,e,t)},V().prototype.split=function(e,t){return this.throwIfDisposed(),SZ(this,e,t)},V().prototype.sqrt=function(){return this.throwIfDisposed(),pX(this)},V().prototype.square=function(){return this.throwIfDisposed(),mX(this)},V().prototype.squaredDifference=function(e){return this.throwIfDisposed(),Rwe(this,e)},V().prototype.squeeze=function(e){return this.throwIfDisposed(),CZ(this,e)},V().prototype.stack=function(e,t){this.throwIfDisposed();let n=e instanceof qq?[this,e]:[this,...e];return wZ(n,t)},V().prototype.step=function(e){return this.throwIfDisposed(),TZ(this,e)},V().prototype.stridedSlice=function(e,t,n,r,i,a,o,s){return this.throwIfDisposed(),Uwe(this,e,t,n,r,i,a,o,s)},V().prototype.sub=function(e){return this.throwIfDisposed(),FX(this,e)},V().prototype.sum=function(e,t){return this.throwIfDisposed(),hX(this,e,t)},V().prototype.tan=function(){return this.throwIfDisposed(),Gwe(this)},V().prototype.tanh=function(){return this.throwIfDisposed(),kY(this)},V().prototype.tile=function(e){return this.throwIfDisposed(),bX(this,e)},V().prototype.toBool=function(){return this.throwIfDisposed(),K(this,`bool`)},V().prototype.toFloat=function(){return this.throwIfDisposed(),K(this,`float32`)},V().prototype.toInt=function(){return this.throwIfDisposed(),K(this,`int32`)},V().prototype.topk=function(e,t){return this.throwIfDisposed(),Jwe(this,e,t)},V().prototype.transpose=function(e){return this.throwIfDisposed(),PZ(this,e)},V().prototype.unique=function(e){return this.throwIfDisposed(),Zwe(this,e)},V().prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),jZ(this,e,t)},V().prototype.unstack=function(e){return this.throwIfDisposed(),MZ(this,e)},V().prototype.where=function(e,t){return this.throwIfDisposed(),XY(e,this,t)},V().prototype.zerosLike=function(){return this.throwIfDisposed(),ZY(this)};
/**
* @license
* Copyright 2018 Google LLC
*
* Use of this source code is governed by an MIT-style
* license that can be found in the LICENSE file or at
* https://opensource.org/licenses/MIT.
* =============================================================================
*/
var V$=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},H$=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},Z=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},U$=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},wOe=class e extends Error{constructor(t){super(t),Object.setPrototypeOf(this,e.prototype)}},W$=class{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){let e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){let e=this.cache.keys().next().value;this.cache.delete(e)}this.maxEntries=e}};function G$(e,t){if(Array.isArray(e)){let n=[];for(let r=0;r<t;r++)n=n.concat(e);return n}else{let n=Array(t);return n.fill(e),n}}function K$(e,t){if(!e)throw new wOe(t)}function q$(e,t){let n=0;for(let r of e)r===t&&n++;return n}function J$(e){return e.length===1?e[0]:e}function Y$(e){return Array.isArray(e)?e:[e]}function X$(e){let t=e.replace(/(.)([A-Z][a-z0-9]+)/g,`$1_$2`).replace(/([a-z])([A-Z])/g,`$1_$2`).toLowerCase();return t[0]===`_`?`private`+t:t}function Z$(e){return e.length<=1||e.indexOf(`_`)===-1?e:e.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}var Q$={};function $$(e){if(e==null)return null;let t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function e1(e){if(!(typeof e!=`object`||!e))if(Array.isArray(e))e.forEach(e=>e1(e));else{let t=Object.keys(e);for(let n of t){let t=e[n];typeof t==`object`&&t&&(!Array.isArray(t)&&t.type===`ndarray`&&typeof t.value==`number`?e[n]=t.value:e1(t))}}}function t1(e,t={},n={},r=`object`,i=!1){if(typeof e==`string`){let i=e,a;if(i in n)a=n[i];else if(i in Q$)a=Q$[i];else if(a=t[i],a==null)throw new Z(`Unknown ${r}: ${e}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return a}else{let a=e;if(a.className==null||a.config==null)throw new Z(`${r}: Improper config format: ${JSON.stringify(a)}.\n'className' and 'config' must set.`);let o=a.className,s,c;if(o in n?[s,c]=n[o]:o in Q$?[s,c]=Q$.className:o in t&&([s,c]=t[o]),s==null)throw new Z(`Unknown ${r}: ${o}. This may be due to one of the following reasons:\n1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.\n2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(c!=null){let e={};for(let t of Object.keys(Q$))e[t]=Q$[t];for(let t of Object.keys(n))e[t]=n[t];let t=a.config;t.customObjects=e;let r=Object.assign({},Q$);for(let e of Object.keys(n))Q$[e]=n[e];e1(a.config);let o=c(s,a.config,n,i);return Q$=Object.assign({},r),o}else{let e=Object.assign({},Q$);for(let e of Object.keys(n))Q$[e]=n[e];let t=new s(a.config);return Q$=Object.assign({},e),t}}}function TOe(e,t){return e<t?-1:e>t?1:0}function n1(e,t){return-1*TOe(e,t)}function r1(e){if(e==null)return e;let t=[];for(let n of e)t.indexOf(n)===-1&&t.push(n);return t}function EOe(e){if(e==null)throw new Z(`Invalid value in obj: ${JSON.stringify(e)}`);for(let t in e)if(e.hasOwnProperty(t))return!1;return!0}function i1(e,t,n){if(n!=null&&e.indexOf(n)<0)throw new Z(`${n} is not a valid ${t}.  Valid values are ${e} or null/undefined.`)}function a1(e,t,n=0,r=1/0){return K$(n>=0),K$(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every(e=>typeof e===t)}function o1(e,t){Array.isArray(e)?(R(e.length>0,()=>`${t} is unexpectedly an empty array.`),e.forEach((e,n)=>o1(e,`element ${n+1} of ${t}`))):R(Number.isInteger(e)&&e>0,()=>`Expected ${t} to be a positive integer, but got ${s1(e)}.`)}function s1(e){return e===null?`null`:Array.isArray(e)?`[`+e.map(e=>s1(e)).join(`,`)+`]`:typeof e==`string`?`"${e}"`:`${e}`}function DOe(e,t,n){let r=n==null?Mq():n(),i;return(...a)=>{let o=n==null?Mq():n();return o-r<t?i:(r=o,i=e(...a),i)}}function c1(e){return e===`relu`?`relu`:e===`linear`?`linear`:e===`elu`?`elu`:null}
/**
* @license
* Copyright 2018 Google LLC
*
* Use of this source code is governed by an MIT-style
* license that can be found in the LICENSE file or at
* https://opensource.org/licenses/MIT.
* =============================================================================
*/
var OOe=0;function l1(){return OOe++}var u1={};function d1(e=``){return e in u1||(u1[e]=0),u1[e]+=1,e+u1[e].toString()}
/**
* @license
* Copyright 2018 Google LLC
*
* Use of this source code is governed by an MIT-style
* license that can be found in the LICENSE file or at
* https://opensource.org/licenses/MIT.
* =============================================================================
*/
const kOe=[`channelsFirst`,`channelsLast`],AOe=[`nearest`,`bilinear`],jOe=[`valid`,`same`,`causal`],MOe=[`max`,`avg`],NOe=[`sum`,`mul`,`concat`,`ave`];var f1=new Map;function p1(e){i1(kOe,`DataFormat`,e)}function POe(e){i1(AOe,`InterpolationFormat`,e)}function m1(e){i1(jOe,`PaddingMode`,e)}function h1(e){i1(MOe,`PoolMode`,e)}var g1=[],_1=`/`;function v1(e,t){g1.push(e);try{let e=t();return g1.pop(),e}catch(e){throw g1.pop(),e}}function FOe(){return g1.length===0?``:g1.join(_1)+_1}function y1(e){if(!x1(e))throw Error(`Not a valid tensor name: '`+e+`'`);return FOe()+e}function b1(e){if(!x1(e))throw Error(`Not a valid tensor name: '`+e+`'`);f1.has(e)||f1.set(e,0);let t=f1.get(e);if(f1.set(e,f1.get(e)+1),t>0){let n=`${e}_${t}`;return f1.set(n,1),n}else return e}var IOe=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function x1(e){return!!e.match(IOe)}function LOe(e){return e===parseInt(e.toString(),10)}function S1(e,t,n){t??=0,n??=e.length;let r=1;for(let i=t;i<n;++i)r*=e[i];return r}function C1(e){if(e.length===0)return NaN;let t=1/0;for(let n=0;n<e.length;n++){let r=e[n];r<t&&(t=r)}return t}function w1(e){if(e.length===0)return NaN;let t=-1/0;for(let n=0;n<e.length;n++){let r=e[n];r>t&&(t=r)}return t}function T1(e,t){if(t<e)throw new Z(`end (${t}) < begin (${e}) is forbidden.`);let n=[];for(let r=e;r<t;++r)n.push(r);return n}var E1;function D1(){return E1??=wbe().epsilon(),E1}function O1(){return`channelsLast`}function k1(e,t){return K(e,t)}function A1(e,t=-1){let n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),Y(e,n)}function ROe(e,t){return G(()=>{if(e.shape.length!==2)throw new Z(`repeat() expects a rank-2 tensor, but received a rank-${e.shape.length} tensor.`);let n=A1(e,1);return I1(n,[1,t,1])})}function zOe(e){let t=[S1(e.shape)];return Y(e,t)}function BOe(e){if(e.rank<=1)throw new Z(`batchFlatten requires a minimum rank of 2. Got rank: ${e.rank}.`);let t=[e.shape[0],S1(e.shape,1)];return Y(e,t)}function j1(e,t,n){return G(()=>{switch(e.rank){case 1:return hZ(e,t,n);case 2:return gZ(e,[t,0],[n,e.shape[1]]);case 3:return _Z(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return vZ(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return OY(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return OY(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new Z(`sliceAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}})}function M1(e,t,n){return G(()=>{switch(e.rank){case 1:return hZ(e,t,n);case 2:return gZ(e,[0,t],[e.shape[0],n]);case 3:return _Z(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return vZ(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new Z(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function N1(e,t,n,r){return G(()=>{switch(e.rank){case 1:return hZ(e,t,n);case 2:switch(r){case 1:return j1(e,t,n);case 2:return M1(e,t,n);default:throw new Z(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return j1(e,t,n);case 2:return _Z(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return M1(e,t,n);default:throw new Z(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return j1(e,t,n);case 2:return vZ(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return vZ(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return M1(e,t,n);default:throw new Z(`The axis is not within the rank of the tensor ${r}`)}default:throw new Z(`sliceAlongLastAxis() received an unsupported tensor rank: ${e.rank}`)}})}function P1(e,t=-1){let n;return t<0&&(n=e[0].rank,t=n===0?0:n),t===e[0].rank&&(t=-1),TY(e,t)}function F1(e,t){switch(e.rank){case 1:return rSe([e,t]);case 2:return aSe([e,t],0);case 3:return sSe([e,t],0);case 4:return lSe([e,t],0);default:throw new Z(`concatAlongFirstAxis() received an unsupported tensor rank: ${e.rank}`)}}function I1(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new Z(`The length of input n (${t.length}) does not match the number of dimensions in input x (${e.rank})`);return bX(e,t)}function L1(e,t=0,n=1,r,i){return lwe(e,t,n,r,i)}function R1(e,t,n,r){if(e.rank<2||t.rank<2)throw new U$(`dot requires both inputs to be rank >= 2 but got x shape = ${e.shape} and y shape = ${t.shape}`);if(t.rank>=3){let n=e.shape.slice(-1)[0],r=t.shape.slice(-2)[0];if(n!==r)throw new U$(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${e.shape} and  y shape = ${t.shape}`)}if(e.rank===2&&t.rank===2)return BZ({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?V1(e.rank,r,O1()):null,activation:n});{let i=e.shape.slice(),a=i.pop();e=Y(e,[-1,a]);let o=t.shape.slice(),s=o.pop(),c=o.pop(),l=[...o,s],u=Array.from({length:t.rank},(e,n)=>n===0?t.rank-2:n<=t.rank-2?n-1:n);t=Y(PZ(t,u),[c,-1]);let d=[...i,...l];return Y(BZ({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?V1(e.rank,r,O1()):null,activation:n}),d)}}function z1(e,t,n){return G(()=>(t=Array.isArray(t)?EZ(t,`int32`):K(t,`int32`),CX(e,t,n)))}function B1(e){return J(e,e)}function V1(e,t,n){let r=t.shape;if(t.rank!==1&&t.rank!==e)throw new Z(`Unexpected bias dimensions: ${t.rank}; expected it to be 1 or ${e}`);if(e===5){if(n===`channelsFirst`)return r.length===1?Y(t,[1,r[0],1,1,1]):Y(t,[1,r[3],r[0],r[1],r[2]]);if(n===`channelsLast`)return r.length===1?Y(t,[1,1,1,1,r[0]]):Y(t,[1].concat(r))}else if(e===4){if(n===`channelsFirst`)return r.length===1?Y(t,[1,r[0],1,1]):Y(t,[1,r[2],r[0],r[1]]);if(n===`channelsLast`)return r.length===1?Y(t,[1,1,1,r[0]]):Y(t,[1].concat(r))}else if(e===3){if(n===`channelsFirst`)return r.length===1?Y(t,[1,r[0],1]):Y(t,[1,r[1],r[0]]);if(n===`channelsLast`)return r.length===1?Y(t,[1,1,r[0]]):Y(t,[1].concat(r))}else if(e<3)return t;throw new Z(`Unsupported input rank by biasAdd: ${t.rank}`)}function H1(e,t,n){return G(()=>(n??=O1(),p1(n),q(e,V1(e.rank,t,n))))}function VOe(e,t=1){if(t!==1)throw new U$(`Support for alpha values other than 1 (${t}) is not implemented yet.`);return $Y(e)}function HOe(e){return G(()=>iY(e,q(aY(e),1)))}function U1(e,t,n,r){return G(()=>iTe(e,t,n,r))}function UOe(e){return G(()=>{let t=q(.5,J(.2,e));return PY(t,0,1)})}function W1(e,t,n=!1){return n?e():t()}
/**
* @license
* Copyright 2018 Google LLC
*
* Use of this source code is governed by an MIT-style
* license that can be found in the LICENSE file or at
* https://opensource.org/licenses/MIT.
* =============================================================================
*/
const WOe=[`fanIn`,`fanOut`,`fanAvg`],GOe=[`normal`,`uniform`,`truncatedNormal`];function KOe(e){i1(WOe,`FanMode`,e)}function qOe(e){i1(GOe,`Distribution`,e)}var G1=class extends ZZ{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}},K1=class extends G1{apply(e,t){return WX(e,t)}};K1.className=`Zeros`,X(K1);var q1=class extends G1{apply(e,t){return GX(e,t)}};q1.className=`Ones`,X(q1);var J1=class extends G1{constructor(e){if(super(),typeof e!=`object`)throw new Z(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new Z(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return G(()=>J(fX(this.value),GX(e,t)))}getConfig(){return{value:this.value}}};J1.className=`Constant`,X(J1);var Y1=class extends G1{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return rZ(e,this.minval,this.maxval,t,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}};Y1.className=`RandomUniform`,X(Y1);var X1=class extends G1{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t||=`float32`,t!==`float32`&&t!==`int32`)throw new U$(`randomNormal does not support dType ${t}.`);return L1(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};X1.className=`RandomNormal`,X(X1);var Z1=class extends G1{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t||=`float32`,t!==`float32`&&t!==`int32`)throw new U$(`truncatedNormal does not support dType ${t}.`);return AZ(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}};Z1.className=`TruncatedNormal`,X(Z1);var Q1=class extends G1{constructor(e){super(),this.gain=e.gain==null?1:e.gain}apply(e,t){return G(()=>{if(e.length!==2||e[0]!==e[1])throw new Z(`Identity matrix initializer can only be used for 2D square matrices.`);return J(this.gain,xX(e[0]))})}getConfig(){return{gain:this.gain}}};Q1.className=`Identity`,X(Q1);function JOe(e,t=`channelsLast`){let n,r;if(p1(t),e.length===2)n=e[0],r=e[1];else if([3,4,5].indexOf(e.length)!==-1){if(t===`channelsFirst`){let t=S1(e,2);n=e[1]*t,r=e[0]*t}else if(t===`channelsLast`){let t=S1(e,0,e.length-2);n=e[e.length-2]*t,r=e[e.length-1]*t}}else{let t=S1(e);n=Math.sqrt(t),r=Math.sqrt(t)}return[n,r]}var $1=class extends G1{constructor(e){if(super(),e.scale<0)throw new Z(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?`fanIn`:e.mode,KOe(this.mode),this.distribution=e.distribution==null?`normal`:e.distribution,qOe(this.distribution),this.seed=e.seed}apply(e,t){let n=JOe(e),r=n[0],i=n[1],a=this.scale;if(this.mode===`fanIn`?a/=Math.max(1,r):this.mode===`fanOut`?a/=Math.max(1,i):a/=Math.max(1,(r+i)/2),this.distribution===`normal`){let n=Math.sqrt(a);if(t||=`float32`,t!==`float32`&&t!==`int32`)throw new U$(`${this.getClassName()} does not support dType ${t}.`);return AZ(e,0,n,t,this.seed)}else{let n=Math.sqrt(3*a);return rZ(e,-n,n,t,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}};$1.className=`VarianceScaling`,X($1);var e0=class extends $1{constructor(e){super({scale:1,mode:`fanAvg`,distribution:`uniform`,seed:e==null?null:e.seed})}getClassName(){return $1.className}};e0.className=`GlorotUniform`,X(e0);var t0=class extends $1{constructor(e){super({scale:1,mode:`fanAvg`,distribution:`normal`,seed:e==null?null:e.seed})}getClassName(){return $1.className}};t0.className=`GlorotNormal`,X(t0);var n0=class extends $1{constructor(e){super({scale:2,mode:`fanIn`,distribution:`normal`,seed:e==null?null:e.seed})}getClassName(){return $1.className}};n0.className=`HeNormal`,X(n0);var r0=class extends $1{constructor(e){super({scale:2,mode:`fanIn`,distribution:`uniform`,seed:e==null?null:e.seed})}getClassName(){return $1.className}};r0.className=`HeUniform`,X(r0);var i0=class extends $1{constructor(e){super({scale:1,mode:`fanIn`,distribution:`normal`,seed:e==null?null:e.seed})}getClassName(){return $1.className}};i0.className=`LeCunNormal`,X(i0);var a0=class extends $1{constructor(e){super({scale:1,mode:`fanIn`,distribution:`uniform`,seed:e==null?null:e.seed})}getClassName(){return $1.className}};a0.className=`LeCunUniform`,X(a0);var o0=class extends G1{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,t){return G(()=>{if(e.length<2)throw new U$(`Shape must be at least 2D.`);if(t!==`int32`&&t!==`float32`&&t!==void 0)throw TypeError(`Unsupported data type ${t}.`);t=t;let n=z(e.slice(0,-1)),r=e[e.length-1],i=n*r;i>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${i}) elements: Slowness may result.`);let a=L1([Math.max(r,n),Math.min(r,n)],0,1,t,this.seed),o=eEe.qr(a,!1),s=o[0],c=o[1].flatten().stridedSlice([0],[Math.min(r,n)*Math.min(r,n)],[Math.min(r,n)+1]);return s=J(s,c.sign()),n<r&&(s=s.transpose()),J(fX(this.gain),s.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}};o0.className=`Orthogonal`,X(o0);const s0={constant:`Constant`,glorotNormal:`GlorotNormal`,glorotUniform:`GlorotUniform`,heNormal:`HeNormal`,heUniform:`HeUniform`,identity:`Identity`,leCunNormal:`LeCunNormal`,leCunUniform:`LeCunUniform`,ones:`Ones`,orthogonal:`Orthogonal`,randomNormal:`RandomNormal`,randomUniform:`RandomUniform`,truncatedNormal:`TruncatedNormal`,varianceScaling:`VarianceScaling`,zeros:`Zeros`};function c0(e,t={}){return t1(e,QZ.getMap().classNameMap,t,`initializer`)}function l0(e){return $$(e)}function u0(e){if(typeof e==`string`){let t=e in s0?s0[e]:e;if(t===`GlorotNormal`)return new t0;if(t===`GlorotUniform`)return new e0;if(t===`HeNormal`)return new n0;if(t===`HeUniform`)return new r0;if(t===`LeCunNormal`)return new i0;if(t===`LeCunUniform`)return new a0;{let e={};return e.className=t,e.config={},c0(e)}}else if(e instanceof G1)return e;else return c0(e)}function d0(e){return Array.isArray(e)&&Array.isArray(e[0])}function f0(e){return e.length===0?[]:Array.isArray(e[0])?e:[e]}function p0(e){let t;if(Array.isArray(e)){if(e.length!==1)throw new Z(`Expected Tensor length to be 1; got ${e.length}`);t=e[0]}else t=e;return t}function m0(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(e.length===1)return e=e,e[0];throw new Z(`Expected exactly 1 Shape; got ${e.length}`)}else return e}
/**
* @license
* Copyright 2018 Google LLC
*
* Use of this source code is governed by an MIT-style
* license that can be found in the LICENSE file or at
* https://opensource.org/licenses/MIT.
* =============================================================================
*/
function h0(e){let t=0;for(let n of e)n.shape.length===0?t+=1:t+=n.shape.reduce((e,t)=>e*t);return t}var g0=`Variable`,YOe=class{constructor(e,t=`float32`,n=g0,r=!0,i=null){this.dtype=t??`float32`,this.shape=e.shape,this.id=l1(),n??=g0,this.originalName=y1(n),this.name=b1(this.originalName),this.trainable_=r,this.constraint=i,this.val=eTe(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),XOe(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}};function XOe(e,t){if(e.shape.toString()!==t.shape.toString())throw Error(`Shape mismatch: `+JSON.stringify(e.shape)+` vs. `+JSON.stringify(t.shape))}function _0(e){return e.map(e=>e.read())}function v0(e){e.forEach(e=>{e[0].write(e[1])})}var y0=class{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape==null?this.ndim=e.ndim:this.ndim=e.shape.length,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}},b0=class{constructor(e,t,n,r,i,a,o){this.dtype=e,this.shape=t,this.sourceLayer=n,this.inputs=r,this.callArgs=i,this.outputTensorIndex=o,this.id=l1(),a!=null&&(this.originalName=y1(a),this.name=b1(this.originalName)),this.rank=t.length}},ZOe=0,x0=class{constructor(e,t){this.callArgs=t,this.id=ZOe++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(let t of e.inboundLayers)t?.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){let e=[];for(let t of this.inboundLayers)t==null?e.push(null):e.push(t.name);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},QOe=0,S0=class extends ZZ{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=QOe++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){let e=this.getClassName();t=X$(e)+`_`+d1(e)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let t;if(e.batchInputShape!=null)t=e.batchInputShape;else if(e.inputShape!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),t=[n].concat(e.inputShape)}this.batchInputShape=t;let n=e.dtype;n??=e.inputDType,n??=`float32`,this.dtype=n}e.weights==null?this.initialWeights=null:this.initialWeights=e.weights,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+`_ib-`+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new H$(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new Z(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return J$(this.getNodeAtIndex(e,`input`).inputTensors)}getOutputAt(e){return J$(this.getNodeAtIndex(e,`output`).outputTensors)}get input(){if(this.inboundNodes.length>1)throw new V$(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new V$(`Layer ${this.name} is not connected, no input to return.`);return J$(this.getNodeAtIndex(0,`input`).inputTensors)}get output(){if(this.inboundNodes.length===0)throw new V$(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new V$(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return J$(this.getNodeAtIndex(0,`output`).outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw Error(`Cannot call the resetStates() method of a non-stateful Layer object.`)}assertInputCompatibility(e){let t=Y$(e);if(this.inputSpec==null||this.inputSpec.length===0)return;let n=Y$(this.inputSpec);if(t.length!==n.length)throw new Z(`Layer ${this.name} expects ${n.length} inputs, but it received ${t.length} input tensors. Input received: ${e}`);for(let e=0;e<t.length;e++){let r=t[e],i=n[e];if(i==null)continue;let a=r.rank;if(i.ndim!=null&&a!==i.ndim)throw new Z(`Input ${e} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${a}`);if(i.maxNDim!=null&&a>i.maxNDim)throw new Z(`Input ${e} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${a}`);if(i.minNDim!=null&&a<i.minNDim)throw new Z(`Input ${e} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${a}.`);if(i.dtype!=null&&r.dtype!==i.dtype)throw new Z(`Input ${e} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${r.dtype}.`);if(i.axes){let t=r.shape;for(let n in i.axes){let r=Number(n),a=i.axes[n],o=r>=0?t[r]:t[t.length+r];if(a!=null&&[a,null].indexOf(o)===-1)throw new Z(`Input ${e} is incompatible with layer ${this.name}: expected axis ${r} of input shape to have value ${a} but got shape ${t}.`)}}if(i.shape!=null)for(let t=0;t<i.shape.length;++t){let n=i.shape[t],a=r.shape[t];if(n!=null&&a!=null&&n!==a)throw new Z(`Input ${e} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${r.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t||={},this.assertNotDisposed();let n=Y$(e),r=tke(e),i=nke(e);if(r===i)throw new Z(`Arguments to apply() must be all SymbolicTensors or all Tensors`);return v1(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);let t=[];for(let n of Y$(e))t.push(n.shape);this.build(J$(t)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&i&&(this._refCount=1)}if(this.assertInputCompatibility(e),i){let r=this.call(e,t);this.supportsMasking&&this.setMaskMetadata(e,r);let i=Y$(r),a=[];for(let e of i)n.indexOf(e)!==-1&&(e=e.clone()),a.push(e);if(r=J$(a),this.activityRegularizer!=null)throw new U$(`Layer invocation in the presence of activity regularizer(s) is not supported yet.`);return r}else{let n=$Oe(e),r=this.computeOutputShape(n),i,a=eke(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?n[0]:n),i=r!=null&&r.length>0&&Array.isArray(r[0])?r.map((n,r)=>new b0(a,n,this,Y$(e),t,this.name,r)):new b0(a,r,this,Y$(e),t,this.name),this.addInboundNode(e,i,null,null,n,r,t),this._refCount++,this.activityRegularizer!=null)throw new U$(`Layer invocation in the presence of activity regularizer(s) is not supported yet.`);return i}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((n,r)=>{n!=null&&e[r]!=null&&e[r]!==n&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new V$(`The layer ${this.name} has never been called and thus has no defined output shape.`);let e=[];for(let t of this.inboundNodes){let n=JSON.stringify(t.outputShapes);e.indexOf(n)===-1&&e.push(n)}if(e.length===1){let e=this.inboundNodes[0].outputShapes;return Array.isArray(e)&&Array.isArray(e[0])&&e.length===1?e[0]:e}else throw new V$(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new H$(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return h0(this.weights)}build(e){this.built=!0}getWeights(e=!1){return _0(e?this.trainableWeights:this.weights)}setWeights(e){G(()=>{let t=this.weights;if(t.length!==e.length)throw new Z(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;let n=[],r=_0(t);for(let i=0;i<r.length;++i){let a=r[i],o=t[i],s=e[i];if(!jU(a.shape,s.shape))throw new Z(`Layer weight shape ${a.shape} not compatible with provided weight shape ${s.shape}`);n.push([o,s])}v0(n)})}addWeight(e,t,n,r,i,a,o,s){if(this._addedWeightNames.indexOf(e)!==-1)throw new Z(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),n??=`float32`,this.fastWeightInitDuringBuild&&(r=s==null?u0(`zeros`):s());let c=r.apply(t,n),l=new YOe(c,n,e,a,o);return c.dispose(),i!=null&&this.addLoss(()=>i.apply(l.read())),a??=!0,a?this._trainableWeights.push(l):this._nonTrainableWeights.push(l),l}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Y$(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(e=>{if(e!=null)throw TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}setMaskMetadata(e,t,n){if(!this.supportsMasking)return;let r=this.computeMask(e,n),i=Y$(t),a=Y$(r);if(i.length!==a.length)throw Error(`${this.name} outputs ${i.length} tensors but ${i.length} masks for those tensors`);for(let e=0;e<i.length;e++)i[e].kerasMask=a[e]}addInboundNode(e,t,n,r,i,a,o=null){let s=Y$(e);t=Y$(t),n=Y$(n),r=Y$(r),i=f0(i),a=f0(a);let c=[],l=[],u=[];for(let e of s)c.push(e.sourceLayer),l.push(e.nodeIndex),u.push(e.tensorIndex);new x0({outboundLayer:this,inboundLayers:c,nodeIndices:l,tensorIndices:u,inputTensors:s,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:i,outputShapes:a},o);for(let e=0;e<t.length;e++)t[e].sourceLayer=this,t[e].nodeIndex=this.inboundNodes.length-1,t[e].tensorIndex=e}getConfig(){let e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}};function $Oe(e){e=Y$(e);let t=[];for(let n of e)t.push(n.shape);return J$(t)}function eke(e){return`float32`}function C0(e,t,n){if((t==null||n!=null&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),t.inboundNodes.length===0)return[e];{let e=t.inboundNodes[n];if(e.inboundLayers.length===0)return e.inputTensors;{let t=[];for(let n=0;n<e.inboundLayers.length;n++){let r=e.inputTensors[n],i=e.inboundLayers[n],a=e.nodeIndices[n],o=C0(r,i,a);for(let e of o)t.indexOf(e)===-1&&t.push(e)}return t}}}function tke(e){let t=!0;for(let n of Y$(e))if(!(n instanceof b0)){t=!1;break}return t}function nke(e){let t=!0;for(let n of Y$(e))if(n instanceof b0){t=!1;break}return t}var w0=class extends S0{constructor(e){if(super({dtype:e.dtype,name:e.name==null?d1(`input`).toString():e.name}),e.batchSize??=null,e.sparse??=!1,this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new Z(`Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.`);let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new Z("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new Z(`Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.`);let n=e.dtype||`float32`;this.batchInputShape=t,this.dtype=n,this.inputSpec=[{shape:t}];let r=new b0(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new x0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new Z(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}};w0.className=`InputLayer`,X(w0);function rke(e){if(e.batchShape==null&&e.shape==null)throw Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(e.batchShape!=null&&e.shape!=null)throw new Z("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let t=e.batchShape;e.shape!=null&&t==null&&(t=[null].concat(e.shape));let n=e.dtype;return n??=`float32`,new w0({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}function ike(e,t){if(e.dtype==null||e.dtype===t.dtype)return t;try{return K(t,e.dtype)}catch{throw new Z(`The dtype of the feed (${t.dtype}) can not be cast to the dtype of the key '${e.name}' (${e.dtype}).`)}}var T0=class e{constructor(t){if(this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(let e in t.id2Value)this.id2Value[e]=t.id2Value[e],e in t.id2Mask&&(this.id2Mask[e]=t.id2Mask[e]);else{if(t==null)return;for(let e of t)this.add(e.key,e.value)}}add(e,t,n){if(this.id2Value[e.id]==null)this.id2Value[e.id]=ike(e,t),this.name2Id[e.name]=e.id,n!=null&&(this.id2Mask[e.id]=n);else throw new Z(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof b0){if(this.id2Value[e.id]==null)throw new Z(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{let t=this.name2Id[e];if(t==null)throw new Z(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof b0){if(this.id2Value[e.id]==null)throw new Z(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{let t=this.name2Id[e];if(t==null)throw new Z(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&EJ(this.id2Mask)}};const E0=new W$,D0=new W$;function ake(e){E0?.setMaxEntries(e),D0?.setMaxEntries(e)}function O0(e,t,n,r){let i=n==null?!1:n.training,a=Array.isArray(e),o=a?e:[e],s=o.map(e=>e.name),c=[],l=t.names();for(let e of s)l.indexOf(e)===-1?c.push(null):c.push(t.getValue(e));r!=null&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);let u=s.join(`,`)+`|`+t.names().sort().join(`,`),d=E0.get(u),f;if(d==null){let e=oke(o,t);d=e.sorted,f=e.recipientCounts,E0.put(u,d),D0.put(u,f)}f={},i||Object.assign(f,D0.get(u));let p=new T0(t);for(let e=0;e<d.length;++e){if(r!=null){let e=TJ().numTensors;e>r.maxNumTensors&&(r.maxNumTensors=e),e<r.minNumTensors&&(r.minNumTensors=e)}let a=d[e],o=a.sourceLayer;if(o instanceof w0)continue;let l=[],u=[],m=[],h=!1;for(let e of a.inputs){let n=p.getValue(e),r=p.getMask(e);l.push(n),u.push(r),r!=null&&(h=!0),i||(f[e.name]--,f[e.name]===0&&!t.hasKey(e)&&s.indexOf(e.name)===-1&&!n.isDisposed&&e.sourceLayer.stateful!==!0&&m.push(n))}h&&(n||={},n.mask=u[0]);let g=Y$(o.apply(l,n)),_=null;o.supportsMasking&&(_=o.computeMask(l,u));let v=cke(a),y=Array.isArray(v)?v:[v];for(let e=0;e<y.length;++e){p.hasKey(y[e])||p.add(y[e],g[e],Array.isArray(_)?_[0]:_);let t=s.indexOf(y[e].name);t!==-1&&(c[t]=g[e])}i||EJ(m)}return p.disposeMasks(),a?c:c[0]}function oke(e,t){R(e!=null&&e.length>0,()=>`Expected at least one fetch, got none`);let n=[],r={};if(e.length===1){let i=k0(e[0],t);n=i.sorted,r=i.recipientMap}else{let i=new Set;for(let a of e){let{sorted:e,recipientMap:o}=k0(a,t);for(let t of e)i.has(t.name)||(n.push(t),i.add(t.name));for(let e in o)r[e]??(r[e]=new Set),o[e].forEach(t=>r[e].add(t))}}return{sorted:n,recipientCounts:ske(r)}}function ske(e){let t={};for(let n in e)t[n]=e[n].size;return t}function k0(e,t){let n=new Set,r=[],i={};for(let e of t.names())n.add(e);let a=[],o=[];for(a.push(e);a.length>0;){let e=a[a.length-1];if(n.has(e.name)){a.pop();continue}let t=o[o.length-1]===a.length-1;if(e.inputs.length===0||t)a.pop(),r.push(e),n.add(e.name),t&&o.pop();else{o.push(a.length-1);for(let t of e.inputs)i[t.name]??(i[t.name]=new Set),i[t.name].add(e.name),!n.has(t.name)&&a.push(t)}}return{sorted:r,recipientMap:i}}function cke(e){let t;if(e.sourceLayer.inboundNodes.length===1)t=e.sourceLayer.output;else{let n=null;for(let t=0;t<e.sourceLayer.inboundNodes.length;++t)for(let r of e.sourceLayer.inboundNodes[t].outputTensors)if(r.id===e.id){n=t;break}t=e.sourceLayer.getOutputAt(n)}return t}B().registerFlag(`TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES`,()=>100,ake);function A0(e,t){return G(()=>pX(hX(J(e,e),t,!0)))}var j0=class extends ZZ{getConfig(){return{}}},M0=class extends j0{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue==null?this.defaultMaxValue:e.maxValue,this.axis=e.axis==null?this.defaultAxis:e.axis}apply(e){return G(()=>{let t=A0(e,this.axis),n=PY(t,0,this.maxValue);return J(e,iY(n,q(D1(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}};M0.className=`MaxNorm`,X(M0);var N0=class extends j0{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis==null?this.defaultAxis:e.axis}apply(e){return G(()=>iY(e,q(D1(),A0(e,this.axis))))}getConfig(){return{axis:this.axis}}};N0.className=`UnitNorm`,X(N0);var P0=class extends j0{apply(e){return oZ(e)}};P0.className=`NonNeg`,X(P0);var F0=class extends j0{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue==null?this.defaultMinValue:e.minValue,this.maxValue=e.maxValue==null?this.defaultMaxValue:e.maxValue,this.rate=e.rate==null?this.defaultRate:e.rate,this.axis=e.axis==null?this.defaultAxis:e.axis}apply(e){return G(()=>{let t=A0(e,this.axis),n=q(J(this.rate,PY(t,this.minValue,this.maxValue)),J(1-this.rate,t));return J(e,iY(n,q(D1(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}};F0.className=`MinMaxNorm`,X(F0);const I0={maxNorm:`MaxNorm`,minMaxNorm:`MinMaxNorm`,nonNeg:`NonNeg`,unitNorm:`UnitNorm`};function L0(e){return $$(e)}function R0(e,t={}){return t1(e,QZ.getMap().classNameMap,t,`constraint`)}function z0(e){if(e==null)return null;if(typeof e==`string`){let t={className:e in I0?I0[e]:e,config:{}};return R0(t)}else if(e instanceof j0)return e;else return R0(e)}async function B0(e){if(e==null)return;let t=[],n=[],r=[];for(let i in e){let a=e[i];if(typeof a!=`number`){let e=a;t.push(e.data()),n.push(i),r.push(e)}}if(t.length>0){let i=await Promise.all(t);for(let t=0;t<i.length;++t)e[n[t]]=i[t][0];EJ(r)}}function V0(e){if(e!=null)for(let t in e){let n=e[t];typeof n!=`number`&&n.dispose()}}var lke;(function(e){e[e.SILENT=0]=`SILENT`,e[e.VERBOSE=1]=`VERBOSE`})(lke||={});var H0=class{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}},uke=class{constructor(e,t=10){e??=[],this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(let t of this.callbacks)t.setParams(e)}setModel(e){for(let t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t??={};for(let n of this.callbacks)await n.onEpochBegin(e,t)}async onEpochEnd(e,t){t??={};for(let n of this.callbacks)await n.onEpochEnd(e,t)}async onBatchBegin(e,t){t??={};for(let n of this.callbacks)await n.onBatchBegin(e,t)}async onBatchEnd(e,t){t??={};for(let n of this.callbacks)await n.onBatchEnd(e,t)}async onTrainBegin(e){e??={};for(let t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e??={};for(let t of this.callbacks)await t.onTrainEnd(e)}},dke=class extends H0{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t??={};let n=t.size==null?0:t.size;for(let e in this.seen+=n,t){let r=t[e];if(typeof r==`number`)this.totals.hasOwnProperty(e)||(this.totals[e]=0),this.totals[e]=this.totals[e]+r*n;else{let t;e in this.totals?t=this.totals[e]:this.totals[e]=0;let i=G(()=>q(this.totals[e],J(r,n)));this.totals[e]=i,t?.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(let e of this.params.metrics)this.totals[e]!=null&&(typeof this.totals[e]==`number`?t[e]=this.totals[e]/this.seen:G(()=>{t[e]=J(iY(1,this.seen),this.totals[e]),this.totals[e].dispose(),DJ(t[e])}))}},fke=class extends H0{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){for(let n in t??={},this.epoch.push(e),t)this.history[n]??(this.history[n]=[]),this.history[n].push(t[n])}async syncData(){let e=[],t=[],n=[];for(let r in this.history){let i=this.history[r];for(let a=0;a<i.length;++a)if(typeof i[a]!=`number`){let o=i[a];e.push(o.data()),t.push(r),n.push(a)}}let r=await Promise.all(e);for(let e=0;e<r.length;++e)this.history[t[e]][n[e]].dispose(),this.history[t[e]][n[e]]=r[e][0]}},pke=class extends H0{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||AQ,this.yieldEvery=t||`auto`,this.yieldEvery===`auto`&&(this.yieldEvery=125),this.yieldEvery===`never`&&e.onYield!=null)throw Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");JU(this.yieldEvery)&&(this.maybeWait=DOe(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,n){let r=[];this.yield!=null&&(await B0(n),r.push(this.yield(e,t,n))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await B0(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){let n=[];this.epochEnd!=null&&(await B0(t),n.push(this.epochEnd(e,t))),this.yieldEvery===`epoch`&&n.push(this.nextFrameFunc()),await Promise.all(n)}async onBatchBegin(e,t){this.batchBegin!=null&&(await B0(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){let n=[];this.batchEnd!=null&&(await B0(t),n.push(this.batchEnd(e,t))),this.yieldEvery===`batch`?n.push(this.nextFrameFunc()):JU(this.yieldEvery)&&n.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(n)}async onTrainBegin(e){this.trainBegin!=null&&(await B0(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await B0(e),await this.trainEnd(e))}};function U0(e,t){return e??={},e instanceof H0?[e]:Array.isArray(e)&&e[0]instanceof H0?e:Y$(e).map(e=>new pke(e,t))}var W0=class e{constructor(){}static registerCallbackConstructor(t,n){R(t>=0&&Number.isInteger(t),()=>`Verbosity level is expected to be an integer >= 0, but got ${t}`),e.checkForDuplicate(n),e.constructors[t]??(e.constructors[t]=[]),e.constructors[t].push(n)}static checkForDuplicate(t){for(let n in e.constructors)e.constructors[+n].forEach(e=>{if(e===t)throw new Z(`Duplicate callback constructor.`)})}static clear(){e.constructors={}}static createCallbacks(t){let n=[];for(let r in e.constructors){let i=+r;t>=i&&n.push(...e.constructors[i])}return n.map(e=>new e)}};W0.constructors={};function G0(e,t,n,r,i,a,o,s,c){let l=new fke,u=[new dke,...W0.createCallbacks(t)];e!=null&&u.push(...e),u.push(l);let d=new uke(u);return d.setParams({epochs:n,initialEpoch:r,samples:i,steps:a,batchSize:o,verbose:t,doValidation:s,metrics:c}),{callbackList:d,history:l}}function K0(e,t={},n=!1){return t1(e,QZ.getMap().classNameMap,t,`layer`,n)}function q0(e,t){return G(()=>{e.dtype!==`float32`&&(e=K(e,`float32`));let n=hX(B1(e),t,!0),r=NY(n.shape,D1()),i=pX(HX(n,r));return iY(e,i)})}function J0(e,t){return G(()=>UX(B1(FX(t,e)),-1))}function Y0(e,t){return G(()=>UX(aY(FX(t,e)),-1))}function X0(e,t){return G(()=>{let n=FX(e,t),r=PY(aY(e),D1(),Number.MAX_VALUE),i=aY(iY(n,r));return J(100,UX(i,-1))})}function mke(e,t){return G(()=>{let n=PY(t,D1(),Number.MAX_VALUE),r=AX(q(1,n)),i=PY(e,D1(),Number.MAX_VALUE),a=AX(q(1,i));return UX(B1(FX(r,a)),-1)})}function hke(e,t){return G(()=>{let n=HX(0,FX(1,J(e,t)));return UX(B1(n),-1)})}function gke(e,t){return G(()=>{let n=HX(0,FX(1,J(e,t)));return UX(n,-1)})}function _ke(e,t){return G(()=>{let n=hX(J(e,t),-1),r=lX(J(FX(1,e),t),-1);return HX(0,q(1,FX(r,n)))})}function vke(e,t){return G(()=>{let n=Math.log(2),r=FX(t,e),i=FX(q(r,PX(J(-2,r))),n);return UX(i,-1)})}function Z0(e,t,n=!1){return G(()=>{if(n)t=yZ(t);else{let e=hX(t,t.shape.length-1,!0);t=iY(t,e)}return t=PY(t,D1(),1-D1()),NX(hX(J(K(e,`float32`),AX(t)),t.shape.length-1))})}function Q0(e,t,n=!1){return G(()=>{let r=K(SX(zOe(e)),`int32`);t=PY(t,D1(),1-D1());let i=t.shape,a=Y(YX(r,i[i.length-1]),i);return Z0(a,t,n)})}function yke(e,t){if(!jU(e.shape,t.shape))throw new Z(`logits and labels must have the same shape, but got shapes ${JSON.stringify(e.shape)} and ${JSON.stringify(t.shape)}`);return G(()=>{let n=oZ(t),r=NX(aY(t));return q(FX(n,J(t,e)),jX(vX(r)))})}function $0(e,t){return G(()=>{let n;return n=PY(t,D1(),1-D1()),n=AX(iY(n,FX(1,n))),UX(yke(e,n),-1)})}function bke(e,t){return G(()=>{let n=PY(e,D1(),1),r=PY(t,D1(),1);return hX(J(e,AX(iY(n,r))),-1)})}function xke(e,t){return G(()=>{let n=AX(q(D1(),t));return UX(FX(t,J(e,n)),-1)})}function e2(e,t){return G(()=>{let n=q0(e,-1),r=q0(t,-1),i=J(n,r);return NX(hX(i,-1))})}const t2={meanSquaredError:J0,meanAbsoluteError:Y0,meanAbsolutePercentageError:X0,meanSquaredLogarithmicError:mke,squaredHinge:hke,hinge:gke,categoricalHinge:_ke,logcosh:vke,categoricalCrossentropy:Z0,sparseCategoricalCrossentropy:Q0,binaryCrossentropy:$0,kullbackLeiblerDivergence:bke,poisson:xke,cosineProximity:e2};function n2(e){if(typeof e==`string`){if(e in t2)return t2[e];let t=`Unknown loss ${e}`;throw e.toLowerCase().includes(`softmaxcrossentropy`)&&(t=`Unknown loss ${e}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new Z(t)}else return e}function r2(e,t){return G(()=>{let n=J(.5,XX(t)),r=k1(wX(t,n),e.dtype);return UX(YY(e,r),-1)})}function i2(e,t){return G(()=>k1(YY(cY(e,-1),cY(t,-1)),`float32`))}function Ske(e,t){return G(()=>K(hX(RX(YY(e,1),YY(t,1))),`float32`))}function Cke(e,t){return G(()=>K(hX(RX(YY(e,0),YY(t,1))),`float32`))}function wke(e,t){return G(()=>{let n=Ske(e,t),r=Cke(e,t),i=q(n,r);return K(XY(wX(i,0),iY(n,i),0),`float32`)})}function Tke(e,t){return $0(e,t)}function Eke(e,t){return e.rank===t.rank&&(e=CZ(e,[e.rank-1])),t=cY(t,-1),t.dtype!==e.dtype&&(t=K(t,e.dtype)),K(YY(e,t),`float32`)}const Dke=J0,Oke=J0,kke=Y0,Ake=Y0,jke=X0,Mke=X0,a2=Z0,Nke=e2,o2=Q0,s2={binaryAccuracy:r2,categoricalAccuracy:i2,precision:wke,categoricalCrossentropy:a2,sparseCategoricalCrossentropy:o2,mse:Dke,MSE:Oke,mae:kke,MAE:Ake,mape:jke,MAPE:Mke,cosine:Nke};function Pke(e){if(typeof e==`string`&&e in s2)return s2[e];if(typeof e!=`string`&&e!=null)return e;throw new Z(`Unknown metric ${e}`)}function c2(e){if(K$(e!==null,`Unknown LossOrMetricFn ${e}`),typeof e==`string`)return e;{let t;for(let n of Object.keys(t2))if(t2[n]===e){t=n;break}if(t!==void 0)return t;for(let n of Object.keys(s2))if(s2[n]===e){t=n;break}return t===void 0?e.name:t}}function Fke(e){let t={Adagrad:()=>kQ.adagrad(.01),Adadelta:()=>kQ.adadelta(1,.95,D1()),Adam:()=>kQ.adam(.001,.9,.999,D1()),Adamax:()=>kQ.adamax(.002,.9,.999,D1(),0),RMSProp:()=>kQ.rmsprop(.001,.9,0,D1()),SGD:()=>kQ.sgd(.01)};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new Z(`Unknown Optimizer ${e}`)}function l2(e,t,n=!1){if(typeof e!=`object`||!e||Object.getPrototypeOf(e)!==Object.prototype||!u2(e))throw Error(`User-defined metadata is expected to be a JSON object, but is not.`);if(n){let n=JSON.stringify(e);n.length>1048576&&console.warn(`User-defined metadata of model "${t}" is too large in size (length=${n.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= 1048576.`)}}function u2(e){if(e===null)return!0;if(typeof e==`object`)if(Object.getPrototypeOf(e)===Object.prototype){let t=Object.keys(e);for(let n of t)if(typeof n!=`string`||!u2(e[n]))return!1;return!0}else if(Array.isArray(e)){for(let t of e)if(!u2(t))return!1;return!0}else return!1;else{let t=typeof e;return t===`string`||t===`number`||t===`boolean`}}function Ike(e,t,n,r=console.log){let i=Rke(e),a=[`Layer (type)`,`Input Shape`,`Output shape`,`Param #`];i?(t||=90,n||=[.32,.61,.89,1]):(t||=115,n||=[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(e=>Math.floor(t*e)));let o;if(!i)for(let t in a.push(`Receives inputs`),o=[],e.nodesByDepth)o.push(...e.nodesByDepth[t]);r(`_`.repeat(t)),d2(a,n,r),r(`=`.repeat(t));let s=e.layers;for(let e=0;e<s.length;++e)i?zke(s[e],n,r):Bke(s[e],n,o,r),r((e===s.length-1?`=`:`_`).repeat(t));e.checkTrainableWeightsConsistency();let c=Lke(e),l=h0(e.nonTrainableWeights);r(`Total params: ${c+l}`),r(`Trainable params: ${c}`),r(`Non-trainable params: ${l}`),r(`_`.repeat(t))}function Lke(e){let t;return t=e.collectedTrainableWeights==null?h0(e.trainableWeights):h0(e.collectedTrainableWeights),t}function Rke(e){let t=!0,n=[],r=[];for(let t in e.nodesByDepth)n.push(e.nodesByDepth[t]);for(let e of n){if(e.length>1||e.length===1&&e[0].inboundLayers.length>1){t=!1;break}r.push(...e)}if(t)for(let n of e.layers){let e=!1;for(let i of n.inboundNodes)if(r.indexOf(i)!==-1)if(e){t=!1;break}else e=!0;if(!t)break}return t}function d2(e,t,n=console.log){let r=``;for(let n=0;n<e.length;++n)n>0&&(r=r.slice(0,r.length-1)+` `),r+=e[n],r=r.slice(0,t[n]),r+=` `.repeat(t[n]-r.length);n(r)}function zke(e,t,n){let r,i;try{i=e.inboundNodes.map(e=>JSON.stringify(e.inputShapes)).join(`,`)}catch{i=`multiple`}try{r=JSON.stringify(e.outputShape)}catch{r=`multiple`}let a=e.name,o=e.getClassName(),s=[`${a} (${o})`,i,r,e.countParams().toString()];d2(s,t,n)}function Bke(e,t,n,r){let i,a;try{a=e.inboundNodes.map(e=>JSON.stringify(e.inputShapes)).join(`,`)}catch{a=`multiple`}try{i=JSON.stringify(e.outputShape)}catch{i=`multiple`}let o=[];for(let t of e.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(t)===-1))for(let e=0;e<t.inboundLayers.length;++e){let n=t.inboundLayers[e].name,r=t.nodeIndices[e],i=t.tensorIndices[e];o.push(`${n}[${r}][${i}]`)}let s=e.name,c=e.getClassName(),l=o.length===0?``:o[0],u=[`${s} (${c})`,a,i,e.countParams().toString(),l];d2(u,t,r);for(let e=1;e<o.length;++e)d2([``,``,``,``,o[e]],t,r)}function f2(e,t,n){return(e===`inboundNodes`||e===`outputLayers`||e===`inputLayers`)&&t===0&&typeof n==`string`}function p2(e,t){if(e===null)return null;if(typeof e==`string`)return Z$(e);if(typeof e==`number`||typeof e==`boolean`)return e;if(e instanceof Array){let n=[],r=e.length;for(let i=0;i<r;++i){let r=e[i];f2(t,i,r)?n.push(r):n.push(p2(r,t))}return n}else{let t={};for(let n of Object.keys(e)){let r=e[n];if(n===`name`&&typeof r==`string`)t[n]=r;else{let e=Z$(n);t[e]=p2(r,e)}}return t}}function m2(e,t){if(e==null)return null;if(typeof e==`string`)return X$(e);if(typeof e==`number`||typeof e==`boolean`)return e;if(e instanceof Array){let n=[],r=e.length;for(let i=0;i<r;++i){let r=e[i];f2(t,i,r)?n.push(r):n.push(m2(r,t))}return n}else{let t={};for(let n of Object.keys(e)){let r=e[n],i=X$(n);(n===`name`||n===`className`)&&typeof r==`string`?t[i]=r:t[i]=m2(r,n)}return t}}
/** @license See the LICENSE file. */
var h2=`4.22.0`,Vke=e=>{let t=Object.keys(e);if(t.length===0)return!1;let n=t[0].split(`/`);return!isNaN(parseInt(n[n.length-1],10))},Hke=class e extends S0{constructor(t){if(super({}),this.containerNodes=new Set,this.name=t.name,this.name==null){let e=this.getClassName().toLowerCase();this.name=d1(e)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(t.inputs)?this.inputs=t.inputs.slice():this.inputs=[t.inputs],Array.isArray(t.outputs)?this.outputs=t.outputs.slice():this.outputs=[t.outputs],r1(this.inputs).length!==this.inputs.length)throw new Z(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(e=>e.name)}`);r1(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(e=>e.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(let e of this.outputs){let t=e.sourceLayer,n=e.nodeIndex,r=e.tensorIndex;this.outputLayers.push(t),this.outputLayersNodeIndices.push(n),this.outputLayersTensorIndices.push(r)}for(let e of this.inputs){let t=e.sourceLayer,n=e.nodeIndex,r=e.tensorIndex;K$(n===0,`input layer has >1 nodes`),K$(r===0,`input layer has >1 tensors`),this.inputLayers.push(t),this.inputLayersNodeIndices.push(n),this.inputLayersTensorIndices.push(r)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let e=0;e<this.inputLayers.length;e++){let n=this.inputLayers[e];if(!(n instanceof w0))throw TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${t.inputs}. Input ${e} (0-based) originates from layer type ${n.getClassName()}.`);this.inputNames.push(n.name),this.feedInputShapes.push(n.batchInputShape),this.feedInputNames.push(n.name)}for(let e of this.outputLayers)this.outputNames.push(e.name);this.internalInputShapes=this.inputs.map(e=>e.shape),this.internalOutputShapes=this.outputs.map(e=>e.shape);let n={},r={},i={},a={},o={},s=[],c=(t,n,r,i,a,l)=>{(i==null||a==null||l==null)&&(i=t.sourceLayer,a=t.nodeIndex,l=t.tensorIndex);let u=i.inboundNodes[a];if(r.indexOf(u)!==-1)throw new H$(`The tensor ${t.name} at layer "${i.name}" is part of a cycle.`);if(n.indexOf(u)!==-1)return;this.containerNodes.add(e.nodeKey(i,a)),i.id in o||(o[i.id]=Object.keys(o).length),r.indexOf(u)===-1&&r.push(u);let d=u.inboundLayers.length;for(let e=0;e<d;e++){let t=u.inputTensors[e],i=u.inboundLayers[e],a=u.nodeIndices[e],o=u.tensorIndices[e];c(t,n,r,i,a,o)}for(n.push(u);r.indexOf(u)>=0;)r.splice(r.indexOf(u),1);s.push(u)},l=[],u=[];for(let e of this.outputs)c(e,l,u);let d=s.slice().reverse();for(let e of d){r[e.id]=e,e.id in n||(n[e.id]=0);let t=n[e.id],o=i[e.outboundLayer.id]==null?0:i[e.outboundLayer.id];t=Math.max(t,o),i[e.outboundLayer.id]=t,a[e.outboundLayer.id]=e.outboundLayer,n[e.id]=t;for(let i=0;i<e.inboundLayers.length;i++){let a=e.inboundLayers[i],o=e.nodeIndices[i],s=a.inboundNodes[o],c=n[s.id]==null?0:n[s.id];n[s.id]=Math.max(t+1,c),r[s.id]=s}}let f={};for(let e in n){let t=n[e];t in f||(f[t]=[]),f[t].push(r[e])}let p={};for(let e in i){let t=i[e];t in p||(p[t]=[]),p[t].push(a[e])}let m=Object.keys(p).map(e=>parseInt(e,10)).sort(n1);this.layers=[];for(let t of m){let n=p[t];n.sort((e,t)=>{let n=o[e.id],r=o[t.id];return n<r?-1:n>r?1:0});for(let t of n)t instanceof e&&this.internalContainerRefs.push(t),this.layers.push(t)}this.layersByDepth=p,m=Object.keys(f).map(e=>parseInt(e,10)).sort(n1);let h=this.inputs.slice(),g=[];for(let e of m)for(let t of f[e]){let e=t.outboundLayer;if(e!=null){for(let n of t.inputTensors)if(h.indexOf(n)===-1)throw new H$(`Graph disconnected: cannot obtain value for tensor ${n} at layer "${e.name}". The following previous layers were accessed without issue: ${g}`);for(let e of t.outputTensors)h.push(e);g.push(e.name)}}this.nodesByDepth=f;let _=this.layers.map(e=>e.name);for(let e of _){let t=_.filter(t=>t===e).length;if(t!==1)throw new H$(`The name "${e}" is used ${t} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(_))}this.outboundNodes=[],this.inboundNodes=[],new x0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(e=>null),outputMasks:this.outputs.map(e=>null),inputShapes:this.inputs.map(e=>e.shape),outputShapes:this.outputs.map(e=>e.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();let e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(let t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(let t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(t=>t.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new Z(`Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.`);if(!this.trainable)return[];let e=[];for(let t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let e of this.layers)t.push(...e.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){let n={},r=0,i=Vke(e);i&&this.parseWeights(e);for(let e of this.layers)for(let[t,a]of e.weights.entries()){let e=i?`${a.name.split(`/`).slice(0,-1).join(`/`)+`/`}${t}`:a.originalName;if(n[e]!=null)throw new Z(`Duplicate weight name: ${e}`);n[e]=a,r++}let a=[];for(let r in e){let i=r;if(n[r]==null){let e=r.split(`/`);i=e.slice(0,-2).concat([e[e.length-1]]).join(`/`)}if(n[i]!=null)a.push([n[i],e[r]]);else if(t)throw new Z(`Provided weight data has no target variable: ${r}`);delete n[i]}if(t){let e=[];for(let t in n)e.push(t);if(e.length>0)throw new Z(`${e.length} of ${r} weights are not set: ${e}`)}v0(a)}parseWeights(e){for(let t in Object.keys(e)){let n=t.split(`/`),r=[`vars`,`layer_checkpoint_dependencies`],i=n.map(e=>e.startsWith(`_`)?e.slice(1):e).filter(e=>!r.includes(e)).join(`/`);i!==t&&(e[i]=e[t],delete e[t])}}updatedConfig(){let e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${h2}`,t.backend=`TensorFlow.js`,t}toJSON(e,t=!0){let n=m2(this.updatedConfig());return t?JSON.stringify(n):n}call(e,t){return G(()=>{e=Y$(e);let n=new T0;for(let t=0;t<this.inputs.length;++t)n.add(this.inputs[t],e[t]);return O0(this.outputs,n,t)})}computeMask(e,t){return G(()=>{e=Y$(e);let n;return n=t==null?G$(null,e.length):Y$(t),this.runInternalGraph(e,n)[1]})}computeOutputShape(e){let t=f0(e);if(t.length!==this.inputLayers.length)throw new Z(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);let n={};for(let e=0;e<t.length;e++){let r=this.inputLayers[e],i=t[e],a=r.name+`_0_0`;n[a]=i}let r=Object.keys(this.nodesByDepth).map(e=>parseInt(e,10)).sort(n1);if(r.length>1)for(let e of r){let t=this.nodesByDepth[e];for(let e of t){let t=e.outboundLayer;if(this.inputLayers.map(e=>e.id).indexOf(t.id)!==-1)continue;let r=[];for(let t=0;t<e.inboundLayers.length;t++){let i=e.inboundLayers[t],a=e.nodeIndices[t],o=e.tensorIndices[t],s=`${i.name}_${a}_${o}`,c=n[s];r.push(c)}let i=t.computeOutputShape(J$(r)),a=f0(i),o=t.inboundNodes.indexOf(e);for(let e=0;e<a.length;e++){let r=`${t.name}_${o}_${e}`;n[r]=a[e]}}}let i=[],a=[];for(let e=0;e<this.outputLayers.length;e++){let t=this.outputLayers[e],n=this.outputLayersNodeIndices[e],r=this.outputLayersTensorIndices[e],i=`${t.name}_${n}_${r}`;a.push(i)}for(let e=0;e<a.length;e++){let t=a[e];K$(t in n),i.push(n[t])}return J$(i)}runInternalGraph(e,t){t??=G$(null,e.length);let n={};for(let r=0;r<this.inputs.length;++r){let i=this.inputs[r],a=e[r],o=t[r];n[i.id]=[a,o]}let r=Object.keys(this.nodesByDepth).map(e=>parseInt(e,10)).sort(n1);for(let e of r){let t=this.nodesByDepth[e];for(let e of t){let t=e.outboundLayer,r=e.inputTensors,i=e.outputTensors,a=[];for(let e of r)e.id in n&&a.push(n[e.id]);if(a.length===r.length){let r={},o,s,c,l;if(e.callArgs!=null&&(r=e.callArgs),a.length===1){let[e,n]=a[0];r.mask??=n,c=Y$(t.call(e,r)),l=Y$(t.computeMask(e,n)),o=[e],s=[n]}else o=a.map(e=>e[0]),s=a.map(e=>e[1]),r.mask??=s,c=Y$(t.call(o,r)),l=Y$(t.computeMask(o,s));if(t.activityRegularizer)throw new U$(`LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.`);for(let e=0;e<i.length;++e){let t=i[e],r=c[e],a=l[e];n[t.id]=[r,a]}}}}let i=[],a=[],o=[];for(let e of this.outputs){K$(e.id in n,`Could not compute output ${e.name} : ${e.id}`);let[t,r]=n[e.id];o.push(t.shape),i.push(t),a.push(r)}return[i,a,o]}buildNodeConversionMap(t){let n={},r;for(let t of this.layers){r=t instanceof e?1:0;for(let i=0;i<t.inboundNodes.length;i++){let a=e.nodeKey(t,i);this.containerNodes.has(a)&&(n[a]=r,r+=1)}}return n}getLayer(e,t){if(t!=null)return this.findLayer(t);if(e==null)throw new Z(`Provide either a layer name or layer index`);if(typeof e==`number`)return this.findLayer(e);for(let t of this.layers)if(t.name===e)return t;throw new Z(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new Z(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return G(()=>{let t=[];for(let n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){let i=e.nodeKey(n,r);this.containerNodes.has(i)&&t.push(...n.calculateLosses())}return t})}getConfig(){let t={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(let t of this.layers){let i=t.getClassName(),a=t.getConfig(),o=[];for(let r=0;r<t.inboundNodes.length;r++){let i=t.inboundNodes[r],a=e.nodeKey(t,r),s={};if(this.containerNodes.has(a)){if(i.callArgs)try{JSON.stringify(i.callArgs),s=i.callArgs}catch{console.warn(`Layer ${t.name} was passed non-serializable keyword arguments: ${i.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),s={}}if(i.inboundLayers.length>0){let t=[];for(let r=0;r<i.inboundLayers.length;r++){let a=i.inboundLayers[r],o=i.nodeIndices[r],c=i.tensorIndices[r],l=e.nodeKey(a,o),u=n[l];u??=0,t.push([a.name,u,c,s])}o.push(t)}}}let s={};s.name=t.name,s.className=i,s.config=a,s.inboundNodes=o,r.push(s)}t.layers=r;let i=[];for(let t=0;t<this.inputLayers.length;t++){let r=this.inputLayers[t],a=this.inputLayersNodeIndices[t],o=e.nodeKey(r,a);if(!this.containerNodes.has(o))continue;let s=n[o];s??=0;let c=this.inputLayersTensorIndices[t];i.push([r.name,s,c])}t.inputLayers=i;let a=[];for(let t=0;t<this.outputLayers.length;t++){let r=this.outputLayers[t],i=this.outputLayersNodeIndices[t],o=e.nodeKey(r,i);if(!this.containerNodes.has(o))continue;let s=n[o];s??=0;let c=this.outputLayersTensorIndices[t];a.push([r.name,s,c])}return t.outputLayers=a,t}static fromConfig(e,t,n={},r=!1){let i={},a={};function o(e,t){e.name in a?a[e.name].push(t):a[e.name]=[t]}function s(e,t){let n=[],r;for(let a of t){let s=a[0],c=a[1],l=a[2];if(r=a[3]==null?{}:a[3],!(s in i)){o(e,t);return}let u=i[s];if(u.inboundNodes.length<=c){o(e,t);return}let d=u.inboundNodes[c];n.push(d.outputTensors[l])}n.length>0&&e.apply(J$(n),r)}function c(e){let n=e.name,a=K0(e,t.customObjects==null?{}:t.customObjects);a.setFastWeightInitDuringBuild(r),i[n]=a,e.inboundNodes.forEach(e=>{if(!(e instanceof Array))throw new Z(`Corrupted configuration, expected array for nodeData: ${e}`);o(a,e)})}let l=t.name,u=t.layers;for(let e of u)c(e);for(;!EOe(a);)for(let e of u){let t=i[e.name];if(t.name in a){let e=a[t.name];delete a[t.name];for(let n of e)s(t,n)}}let d=[],f=[],p=t.inputLayers;for(let e of p){let t=e[0],n=e[1],r=e[2];K$(t in i);let a=i[t].inboundNodes[n].outputTensors;d.push(a[r])}let m=t.outputLayers;for(let e of m){let t=e[0],n=e[1],r=e[2];K$(t in i);let a=i[t].inboundNodes[n].outputTensors;f.push(a[r])}return new e({inputs:d,outputs:f,name:l})}get stateful(){if(this._stateful)throw new Z(`Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.`);for(let e of this.layers)if(e.stateful)return!0;return!1}resetStates(){G(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}};function Uke(e,t,n){let r=t.length;if(e==null||Array.isArray(e)&&e.length===0)return t.map(e=>null);if(r===1)return Array.isArray(e)&&e.length===1?e:typeof e==`object`&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw Error(`Provided ${n} is an array of ${e.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return e}else if(typeof e==`object`&&Object.keys(e).length>0&&typeof e[Object.keys(e)[0]]==`object`){let n=[];return t.forEach(t=>{t in e?n.push(e[t]):n.push(null)}),n}else throw Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${t} keys. Provided ${n} not understood: ${JSON.stringify(e)}`)}function g2(e,t){return Uke(e,t,`classWeight`)}async function _2(e,t,n,r){if(t!=null||r!=null)throw Error(`Support sampleWeight is not implemented yet`);if(n!=null){let t=G(()=>{if(e.shape.length===1)return nY(e);if(e.shape.length===2){if(e.shape[1]>1)return cY(e,1);if(e.shape[1]===1)return Y(e,[e.shape[0]]);throw Error(`Encountered unexpected last-dimension size (${e.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw Error(`Unexpected rank of target (y) tensor (${e.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),r=Array.from(await t.data());EJ(t);let i=[];return r.forEach(e=>{if(n[e]==null)throw Error(`classWeight must contain all classes in the training data. The class ${e} exists in the data but not in classWeight`);i.push(n[e])}),EZ(i,`float32`)}else return null}function Wke(e,t){return J(e,t)}var Gke=32;function v2(e,t){let n,r,i=t;n=i.xs,r=i.ys,R(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${t}`);let a=y2(`input`,e.inputNames,n),o=y2(`output`,e.outputNames,r),s=a[0].shape[0];R(a.length===e.inputs.length,()=>`LayersModel has ${e.inputs.length} inputs, but the dataset provides ${a.length} inputs.  (Expected input keys: ${JSON.stringify(e.inputNames)})`),R(o.length===e.outputs.length,()=>`LayersModel has ${e.outputs.length} outputs, but the dataset provides ${o.length} outputs.  (Expected output keys: ${JSON.stringify(e.outputNames)})`);for(let t=0;t<a.length;t++)R(a[t].shape[0]===s,()=>`Batch size mismatch: input ${e.inputNames[t]} has ${a[t].shape[0]}; expected  ${s} based on input ${e.inputNames[0]}.`);for(let t=0;t<o.length;t++)R(o[t].shape[0]===s,()=>`Batch size mismatch: output ${e.outputNames[t]} has ${o[t].shape[0]}; expected  ${s} based on input ${e.inputNames[0]}.`);return{xs:a,ys:o}}function y2(e,t,n){if(n instanceof qq)return[n];if(Array.isArray(n))return R(n.length===t.length,()=>`Received an array of ${n.length} Tensors, but expected ${t.length} to match the ${e} keys ${t}.`),n;{let r=[];for(let i of t){if(n[i]==null)throw new Z(`The feature data generated by the dataset lacks the required ${e} key '${i}'.`);r.push(n[i])}return r}}function Kke(e){if(e.length===3)throw new U$(`Validation with sample weights is not implemented yet.`);return{xs:e[0],ys:e[1]}}async function qke(e,t,n){let r=n.batchesPerEpoch!=null;if(R(e.optimizer!=null,()=>`You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig).`),R(n!=null,()=>`For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call.`),R(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),R(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),R(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),e.isTraining)throw Error(`Cannot start training because another fit() call is ongoing.`);e.isTraining=!0;try{let i=n.validationData!=null,a,o;if(i)if(b2(n.validationData))R(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{let e=Kke(n.validationData);a=e.xs,o=e.ys}let s=e.makeTrainFunction(),c=e.getDedupedMetricsNames(),l;l=i?c.slice().concat(c.map(e=>`val_`+e)):c.slice();let u=U0(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:f,history:p}=G0(u,d,n.epochs,null,null,Jke(t,n),null,i,l);f.setModel(e),e.history=p,await f.onTrainBegin(),e.stopTraining_=!1;let m=n.initialEpoch==null?0:n.initialEpoch,h=await t.iterator();for(;m<n.epochs;){let l={};await f.onEpochBegin(m);let u=0,d=0;for(r||(h=await t.iterator());!r||u<n.batchesPerEpoch;){let t=await h.next();if(r&&t.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${u} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(t.value!=null){let{xs:r,ys:i}=v2(e,t.value),a={};a.batch=d,a.size=r[0].shape[0],await f.onBatchBegin(d,a);let o=[];if(n.classWeight!=null){let t=g2(n.classWeight,e.outputNames);for(let e=0;e<t.length;++e)o.push(await _2(i[e],null,t[e]))}let l=r.concat(i).concat(o),p=s(l);EJ(l);for(let e=0;e<c.length;++e){let t=c[e],n=p[e];a[t]=n,DJ(n)}await f.onBatchEnd(d,a),V0(a),d++,u++}if(r?u>=n.batchesPerEpoch:t.done){if(i){let t;t=b2(n.validationData)?Y$(await e.evaluateDataset(n.validationData,{batches:n.validationBatches})):Y$(e.evaluate(a,o,{batchSize:n.validationBatchSize==null?Gke:n.validationBatchSize,verbose:0}));for(let n=0;n<e.metricsNames.length;++n)l[`val_${e.metricsNames[n]}`]=t[n]}break}if(e.stopTraining_)break}if(await f.onEpochEnd(m,l),m++,e.stopTraining_)break}return await f.onTrainEnd(),await e.history.syncData(),e.history}finally{e.isTraining=!1}}function Jke(e,t){let n=null;return t.batchesPerEpoch==null?Number.isFinite(e.size)&&(n=e.size):n=t.batchesPerEpoch,n}function b2(e){return typeof e.iterator==`function`}function Yke(e){return typeof e.next==`function`}async function Xke(e,t,n){n||={};let r=n.batches!=null,i=e.testFunction,a=[];if(n.verbose>0)throw new U$(`Verbose mode is not implemented yet.`);R(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);let o=Yke(t)?t:await t.iterator(),s=0,c=0;for(;!r||c<n.batches;){let t=await o.next();if(a=G(()=>{if(t.value){let{xs:n,ys:r}=v2(e,t.value),o=n.concat(r),l=G(()=>i(o));if(EJ(o),c===0)for(let e=0;e<l.length;++e)a.push(fX(0));let u=o[0].shape[0];for(let e=0;e<l.length;++e){let t=l[e],n=a[e];a[e]=G(()=>q(a[e],J(u,t))),c>0&&EJ(n)}EJ(l),s+=u,++c}return a}),t.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let e=0;e<a.length;++e){let t=a[e];a[e]=iY(a[e],s),EJ(t)}return J$(a)}function x2(e){R(e>0&&Number.isInteger(e),()=>`batchSize is required to be a positive integer, but got ${e}`)}function S2(e,t,n){return e==null?[null]:Array.isArray(e)?e.map(e=>j1(e,t,n-t)):j1(e,t,n-t)}function C2(e,t){return G(()=>e==null?null:Array.isArray(e)?e.map(e=>C2(e,t)):z1(e,t.dtype===`int32`?t:K(t,`int32`)))}function w2(e,t){let n=[],r=0,i=null;for(;r<e;)i=r+t,i>=e&&(i=e),n.push([r,i]),r=i;return n}function T2(e){let t=[];e instanceof qq&&(e=[e]);for(let n=0;n<e.length;++n){let r=e[n];if(r.rank===1)t.push(A1(r,1));else if(r.rank===0)throw Error(`Expected tensor to be at least 1D, but received a 0D tensor (scalar).`);else t.push(r)}return t}function E2(e,t){if(e==null)return;let n=[];if(t instanceof qq)n.push(t.id);else if(Array.isArray(t))t.forEach(e=>n.push(e.id));else if(t!=null)for(let e in t){let r=t[e];n.push(r.id)}let r=[];if(e instanceof qq)n.indexOf(e.id)===-1&&r.push(e);else if(Array.isArray(e))e.forEach(e=>{n.indexOf(e.id)===-1&&r.push(e)});else if(e!=null)for(let t in e){let i=e[t];n.indexOf(i.id)===-1&&r.push(i)}r.forEach(e=>{e.isDisposed||e.dispose()})}function Zke(e){return e instanceof qq}function D2(e){return Array.isArray(e)}function O2(e){return!Zke(e)&&!D2(e)}function k2(e,t,n,r=!0,i=``){if(t==null||t.length===0){if(e!=null){let t=!1;if(D2(e)&&e.length>0)t=!0;else if(O2(e)){for(let n in e)if(e.hasOwnProperty(n)){t=!0;break}}else t=!0;if(t)throw new Z(`Error when checking model ${i} expected no data, but got ${e}`)}return[]}if(e==null)return t.map(e=>null);let a;if(O2(e)){e=e,a=[];for(let n of t){if(e[n]==null)throw new Z(`No data provided for "${n}". Need data for each key in: ${t}`);a.push(e[n])}}else if(D2(e)){if(e=e,e.length!==t.length)throw new Z(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${t.length} Tensor(s), but instead got the following list of Tensor(s): ${e}`);a=e}else{if(e=e,t.length>1)throw new Z(`The model ${i} expects ${t.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${e.shape}`);a=[e]}if(a=T2(a),n!=null)for(let e=0;e<t.length;++e){if(n[e]==null)continue;let o=a[e];if(o.shape.length!==n[e].length)throw new Z(`Error when checking ${i}: expected ${t[e]} to have ${n[e].length} dimension(s). but got array with shape ${o.shape}`);for(let t=0;t<n[e].length;++t){if(t===0&&!r)continue;let a=o.shape[t],s=n[e][t];if(s!=null&&s>=0&&a!==s)throw new Z(`${i} expected a batch of elements where each example has shape [${n[e].slice(1,n[e].length)}] (i.e.,tensor shape [*,${n[e].slice(1,n[e].length)}]) but the ${i} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return a}function Qke(e,t,n){let r=r1(e.map(e=>e.shape[0]));r.sort();let i=r1(t.map(e=>e.shape[0]));if(i.sort(),r.length>1)throw new Z(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(e=>e.shape))}`);if(i.length>1)throw new Z(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(e=>e.shape))}`);if(r.length>0&&i.length>0&&!jU(r,i))throw new Z(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${i[0]} target sample(s).`)}function $ke(e,t,n){let r=[J0,$0,Z0];for(let i=0;i<e.length;++i){let a=e[i],o=t[i],s=n[i];if(o!=null){if(o===Z0&&a.shape[a.shape.length-1]===1)throw new Z(`You are passing a target array of shape ${a.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(o)!==-1){let e=a.shape.slice(1),t=s.slice(1);for(let n=0;n<e.length;++n){let r=e[n],i=t[n];if(i!=null&&r!==i)throw new Z(`A target Tensor with shape ${a.shape} was passed for an output of shape ${s}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function A2(e,t,n,r=!0,i=``){let a;if(Array.isArray(e)){if(e.length!==t.length)throw new Z(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${t.length} Tensor(s), but instead got ${e.length} Tensors(s).`);a=e}else{if(t.length>1)throw new Z(`The model expects ${t.length} ${i} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(e.shape)}.`);a=[e]}if(n!=null)for(let e=0;e<t.length;++e){if(n[e]==null)continue;let o=a[e];if(o.shape.length!==n[e].length)throw new Z(`Error when checking ${i}: expected ${t[e]} to have ${n[e].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let a=0;a<n[e].length;++a){if(a===0&&!r)continue;let s=o.shape[a],c=n[e][a];if(c!=null&&c!==s)throw new Z(`Error when checking ${i}: expected ${t[e]} to have shape ${JSON.stringify(n[e])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function eAe(e,t){if(e==null||Array.isArray(e)&&e.length===0)return t.map(e=>[]);let n;if(typeof e==`string`||typeof e==`function`)n=[e];else if(Array.isArray(e)||typeof e==`object`)n=e;else throw TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${e}`);if(Array.isArray(n))return t.map(e=>n);{let e=[];for(let r of t){let t=n.hasOwnProperty(r)?n[r]:[];Array.isArray(t)||(t=[t]),e.push(t)}return e}}var tAe=`layers-model`,j2=class extends Hke{constructor(e){super(e),this.isTraining=!1}summary(e,t,n=console.log){if(!this.built)throw new Z(`This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).`);Ike(this,e,t,n)}compile(e){if(e.loss??=[],this.loss=e.loss,typeof e.optimizer==`string`)this.optimizer_=Fke(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof $Z))throw new Z(`User-defined optimizer must be an instance of tf.Optimizer.`);this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!=`string`&&typeof e.loss!=`function`){for(let t in e.loss=e.loss,e.loss)if(this.outputNames.indexOf(t)===-1)throw new Z(`Unknown entry in loss dictionary: "${t}". Only expected the following keys: ${this.outputNames}`);for(let n of this.outputNames)e.loss[n]??console.warn(`Output "${n}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${n} during training`),t.push(n2(e.loss[n]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new Z(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(e=>n2(e))}else{let n=n2(e.loss);this.outputs.forEach(e=>{t.push(n)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let e=0;e<this.outputs.length;++e){let t=this.internalOutputShapes[e],n=this.outputNames[e];this.feedOutputNames.push(n),this.feedOutputShapes.push(t),this.feedLossFns.push(this.lossFunctions[e])}let n=[];this.metrics=e.metrics,this.metricsNames=[`loss`],this.metricsTensors=[],v1(`loss`,()=>{for(let e=0;e<this.outputs.length;++e){if(n.indexOf(e)!==-1)continue;let t=this.lossFunctions[e];this.outputs.length>1&&(this.metricsTensors.push([t,e]),this.metricsNames.push(this.outputNames[e]+`_loss`))}});let r=eAe(e.metrics,this.outputNames),i=(e,t,n)=>{this.outputNames.length>1&&(t=this.outputNames[e]+`_`+t),this.metricsNames.push(t),this.metricsTensors.push([n,e])};v1(`metric`,()=>{for(let e=0;e<this.outputs.length;++e)n.indexOf(e)===-1&&(t=>{let n,r,a;for(let o of t){if(typeof o==`string`&&[`accuracy`,`acc`,`crossentropy`,`ce`].indexOf(o)!==-1){let t=this.internalOutputShapes[e];t[t.length-1]===1||this.lossFunctions[e]===$0?[`accuracy`,`acc`].indexOf(o)===-1?[`crossentropy`,`ce`].indexOf(o)!==-1&&(r=Tke):r=r2:this.lossFunctions[e]===Q0?[`accuracy`,`acc`].indexOf(o)===-1?[`crossentropy`,`ce`].indexOf(o)!==-1&&(r=o2):r=Eke:[`accuracy`,`acc`].indexOf(o)===-1?[`crossentropy`,`ce`].indexOf(o)!==-1&&(r=a2):r=i2;let i;[`accuracy`,`acc`].indexOf(o)===-1?[`crossentropy`,`ce`].indexOf(o)!==-1&&(i=`ce`):i=`acc`,a=r,n=``+i}else a=Pke(o),n=``+c2(o);let t;v1(n,()=>{t=a}),i(e,n,t)}})(r[e])}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,n={}){let r=n.batchSize==null?32:n.batchSize;x2(r);let i=this.standardizeUserDataXY(e,t,!0,r);try{let e=i[0].concat(i[1]);this.makeTestFunction();let t=this.testFunction,a=this.testLoop(t,e,r,n.verbose,n.steps);return J$(a)}finally{E2(i[0],e),E2(i[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),Xke(this,e,t)}checkNumSamples(e,t,n,r=`steps`){let i;if(n!=null){if(i=null,t!=null)throw new Z(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)i=Array.isArray(e)?e[0].shape[0]:e.shape[0];else throw new Z(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return i}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new Z("`outputs` is an empty Array, which is not allowed.");let n=Array.isArray(t),r=n?t:[t],i=this.retrieveSymbolicTensors(r),a=new T0;if(e instanceof qq&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new Z(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let t=0;t<this.inputs.length;++t)a.add(this.inputs[t],e[t])}else for(let t of this.inputs){let n=e[t.name];if(n==null)throw new Z(`No value is provided for the model's input ${t.name}`);a.add(t,n)}let o=O0(i,a);return n?o:o[0]}retrieveSymbolicTensors(e){let t=G$(null,e.length),n=e.length;for(let r of this.layers){let i=Array.isArray(r.output)?r.output:[r.output],a=i.map(e=>e.name);for(let r=0;r<e.length;++r){let o=a.indexOf(e[r]);if(o!==-1&&(t[r]=i[o],n--),n===0)break}if(n===0)break}if(n>0){let n=[];throw t.forEach((t,r)=>{t??n.push(e[r])}),new Z(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(n)}`)}return t}predictLoop(e,t=32,n=!1){return G(()=>{let r=this.checkNumSamples(e);if(n)throw new U$(`Verbose predictLoop() is not implemented yet.`);let i=w2(r,t),a=this.outputs.map(e=>[]);for(let t=0;t<i.length;++t)G(()=>{let n=i[t][0],r=i[t][1],a=S2(e,n,r),o=[];if(Array.isArray(a))for(let e=0;e<a.length;++e)o.push({key:this.inputs[e],value:a[e]});else o.push({key:this.inputs[0],value:a});let s=new T0(o);return O0(this.outputs,s)}).forEach((e,t)=>a[t].push(e));return J$(a.map(e=>TY(e,0)))})}predict(e,t={}){let n=T2(e);A2(n,this.inputNames,this.feedInputShapes,!1);try{let e=t.batchSize==null?32:t.batchSize;return x2(e),this.predictLoop(n,e)}finally{E2(n,e)}}predictOnBatch(e){A2(e,this.inputNames,this.feedInputShapes,!0);let t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,n=!0,r){if(this.optimizer_==null)throw new H$(`You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).`);let i=[];for(let e=0;e<this.feedOutputShapes.length;++e){let t=this.feedOutputShapes[e];this.feedLossFns[e]===Q0?i.push(t.slice(0,t.length-1).concat([1])):i.push(t)}if(e=k2(e,this.feedInputNames,this.feedInputShapes,!1,`input`),t=k2(t,this.feedOutputNames,i,!1,`target`),Qke(e,t,null),$ke(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new Z(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,n,r,i=!0,a){let[o,s]=this.standardizeUserDataXY(e,t,i,a);if(n!=null)throw Error(`sample weight is not supported yet.`);let c=null;if(r!=null){let e=g2(r,this.outputNames);c=[];for(let t=0;t<e.length;++t)c.push(await _2(s[t],null,e[t]))}return[o,s,c]}testLoop(e,t,n,r=0,i){return G(()=>{let a=this.checkNumSamples(t,n,i,`steps`),o=[];if(r>0)throw new U$(`Verbose mode is not implemented yet.`);if(i!=null)throw new U$(`steps mode in testLoop() is not implemented yet`);{let r=w2(a,n),i=EZ(T1(0,a));for(let n=0;n<r.length;++n){let a=r[n][0],s=r[n][1],c=j1(i,a,s-a),l=C2(t,c),u=e(l);if(n===0)for(let e=0;e<u.length;++e)o.push(fX(0));for(let e=0;e<u.length;++e){let t=u[e];o[e]=q(o[e],J(s-a,t))}}for(let e=0;e<o.length;++e)o[e]=iY(o[e],a)}return o})}getDedupedMetricsNames(){let e=this.metricsNames,t=[];for(let n=0;n<e.length;++n){let r=e[n],i=r;if(q$(e,r)>1){let t=q$(e.slice(0,n),r);i+=`_${t}`}t.push(i)}return t}makeTrainFunction(){return e=>{let t=[],n=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),a=[],o=()=>{let e=[];for(let t=0;t<this.inputs.length;++t)e.push({key:this.inputs[t],value:n[t]});let o=new T0(e),s=O0(this.outputs,o,{training:!0}),c;for(let e=0;e<this.lossFunctions.length;++e){let n=this.lossFunctions[e],a=n(r[e],s[e]);i[e]!=null&&(a=Wke(a,i[e]));let o=UX(a);t.push(o),c=e===0?a:q(c,a)}for(let e=0;e<this.metricsTensors.length;++e){let n;if(this.outputs.length>1&&e<this.outputs.length)n=t[e];else{let t=this.metricsTensors[e][0],i=this.metricsTensors[e][1];n=UX(t(r[i],s[i]))}DJ(n),a.push(n)}return c=UX(c),this.calculateLosses().forEach(e=>{c=q(c,e)}),c},s=this.collectedTrainableWeights.map(e=>e.read());return[this.optimizer_.minimize(o,!0,s)].concat(a)}}makeTestFunction(){this.testFunction=e=>G(()=>{let t=[],n,r=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let e=0;e<this.inputs.length;++e)a.push({key:this.inputs[e],value:r[e]});let o=new T0(a),s=O0(this.outputs,o);for(let e=0;e<this.lossFunctions.length;++e){let r=this.lossFunctions[e],a=UX(r(i[e],s[e]));n=e===0?a:q(n,a),t.push(n)}for(let e=0;e<this.metricsTensors.length;++e){let n=this.metricsTensors[e][0],r=this.metricsTensors[e][1],a=UX(n(i[r],s[r]));t.push(a)}return t})}async fit(e,t,n={}){if(this.isTraining)throw Error(`Cannot start training because another fit() call is ongoing.`);this.isTraining=!0;let r,i,a,o,s,c,l,u,d;try{let f=n.batchSize==null?32:n.batchSize;x2(f);let p=await this.standardizeUserData(e,t,n.sampleWeight,n.classWeight,!1,f);r=p[0],i=p[1],d=p[2];let m=!1,h;if(n.validationData!=null&&n.validationData.length>0){if(m=!0,n.validationData.length===2)s=n.validationData[0],c=n.validationData[1];else if(n.validationData.length===3)throw new U$(`validationData including sample weights is not supported yet.`);else throw new Z(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${n.validationData} is invalid.`);let e=await this.standardizeUserData(s,c,null,null,!0,f);l=e[0],u=e[1],h=l.concat(u)}else if(n.validationSplit!=null&&n.validationSplit>0&&n.validationSplit<1){m=!0;let e=Math.floor(r[0].shape[0]*(1-n.validationSplit)),t=r[0].shape[0];l=S2(r,e,t),a=r,r=S2(r,0,e),u=S2(i,e,t),o=i,i=S2(i,0,e),h=l.concat(u)}else n.validationSteps!=null&&(m=!0);let g=r.concat(i).concat(d);this.checkTrainableWeightsConsistency();let _=this.makeTrainFunction(),v=this.getDedupedMetricsNames(),y,b;m?(this.makeTestFunction(),y=this.testFunction,b=v.slice().concat(v.map(e=>`val_`+e))):(y=null,h=[],b=v.slice());let x=U0(n.callbacks,n.yieldEvery);return await this.fitLoop(_,g,v,f,n.epochs,n.verbose,x,y,h,n.shuffle,b,n.initialEpoch,null,null)}finally{this.isTraining=!1,E2(r,e),E2(i,t),E2(a,e),E2(o,t),E2(l,s),E2(u,c),d!=null&&EJ(d)}}async fitLoop(e,t,n,r,i,a,o,s,c,l,u,d,f,p){r??=32,i??=1,l??=!0,d??=0;let m=!1;if(s!=null&&c!=null&&(m=!0),p!=null&&(m=!0,f==null))throw new Z("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");let h=this.checkNumSamples(t,r,f,`steps_per_epoch`),g;h!=null&&(g=T1(0,h)),a??=1;let{callbackList:_,history:v}=G0(o,a,i,d,h,f,r,m,u);_.setModel(this),this.history=v,await _.onTrainBegin(),this.stopTraining_=!1;for(let a=d;a<i;++a){await _.onEpochBegin(a);let i={};if(f!=null)throw new U$(`stepsPerEpoch mode is not implemented yet.`);{if(l===`batch`)throw new U$(`batch shuffling is not implemneted yet`);l&&wU(g);let a=EZ(g),o=w2(h,r);for(let l=0;l<o.length;++l){let u={};if(await _.onBatchBegin(l,u),G(()=>{let d=o[l][0],f=o[l][1],p=j1(a,d,f-d);u.batch=l,u.size=f-d;let h=C2(t,p),g=e(h);for(let e=0;e<n.length;++e){let t=n[e],r=g[e];u[t]=r,DJ(r)}if(l===o.length-1&&m){let e=this.testLoop(s,c,r);for(let t=0;t<n.length;++t){let r=n[t],a=e[t];DJ(a),i[`val_`+r]=a}}}),await _.onBatchEnd(l,u),V0(u),this.stopTraining_)break}a.dispose()}if(await _.onEpochEnd(a,i),this.stopTraining_)break}return await _.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,t){return qke(this,e,t)}async trainOnBatch(e,t){let n=await this.standardizeUserData(e,t),r=n[0],i=n[1],a=this.makeTrainFunction()(r.concat(i)),o=[];for(let e of a){let t=await e.data();o.push(t[0])}return EJ(a),E2(n[0],e),E2(n[1],t),J$(o)}getNamedWeights(e){let t=[],n=e!=null&&e.trainableOnly,r=n?this.trainableWeights:this.weights,i=this.getWeights(n);for(let e=0;e<r.length;++e)n&&!r[e].trainable||t.push({name:r[e].originalName,tensor:i[e]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){let e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){let t=TJ().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-TJ().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss==`string`)e=X$(this.loss);else if(Array.isArray(this.loss)){for(let e of this.loss)if(typeof e!=`string`)throw Error(`Serialization of non-string loss is not supported.`);e=this.loss.map(e=>X$(e))}else{let t=Object.keys(this.loss);e={};let n=this.loss;for(let r of t)if(typeof n[r]==`string`)e[r]=X$(n[r]);else throw Error(`Serialization of non-string loss is not supported.`)}return e}getMetricIdentifiers(){if(typeof this.metrics==`string`||typeof this.metrics==`function`)return[X$(c2(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>X$(c2(e)));{let e={};for(let t in this.metrics)e[t]=X$(c2(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw Error(`Loading weight_metrics is not supported yet.`);if(e.loss_weights!=null)throw Error(`Loading loss_weights is not supported yet.`);if(e.sample_weight_mode!=null)throw Error(`Loading sample_weight_mode is not supported yet.`);let t=p2(e.optimizer_config),n=K0(t),r;if(typeof e.loss==`string`)r=Z$(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(e=>Z$(e));else if(e.loss!=null)for(let t in r={},e.loss)r[t]=Z$(e.loss[t]);let i;if(Array.isArray(e.metrics))i=e.metrics.map(e=>Z$(e));else if(e.metrics!=null)for(let t in i={},e.metrics)i[t]=Z$(e.metrics[t]);this.compile({loss:r,metrics:i,optimizer:n})}async save(e,t){if(typeof e==`string`){let t=zbe(e);if(t.length===0)throw new Z(`Cannot find any save handlers for URL '${e}'`);if(t.length>1)throw new Z(`Found more than one (${t.length}) save handlers for URL '${e}'`);e=t[0]}if(e.save==null)throw new Z("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");let n=await AJ(this.getNamedWeights(t)),r={modelTopology:this.toJSON(null,!1),format:tAe,generatedBy:`TensorFlow.js tfjs-layers v${h2}`,convertedBy:null};if(t!=null&&t.includeOptimizer&&this.optimizer!=null){r.trainingConfig=this.getTrainingConfig();let{data:e,specs:t}=await AJ(await this.optimizer.getWeights(),`optimizer`);n.specs.push(...t),n.data=jbe([n.data,e])}return this.userDefinedMetadata!=null&&(l2(this.userDefinedMetadata,this.name,!0),r.userDefinedMetadata=this.userDefinedMetadata),r.weightData=n.data,r.weightSpecs=n.specs,e.save(r)}setUserDefinedMetadata(e){l2(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}};j2.className=`Model`,X(j2);var M2=class extends j2{};M2.className=`Functional`,X(M2);async function nAe(e,t){if(t??={},typeof e==`string`){let n=Bbe(e,t);if(n.length===0)n.push(uEe(e,t));else if(n.length>1)throw new Z(`Found more than one (${n.length}) load handlers for URL '${e}'`);e=n[0]}return rAe(e,void 0,t)}async function rAe(e,t,n){if(n??={},e.load==null)throw new Z("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");let r=await e.load(),i=r.modelTopology;i.model_config!=null&&(i=i.model_config);let a=n.strict==null?!0:n.strict,o=r.weightData!=null&&r.weightSpecs!=null&&a,s=K0(p2(i),t,o),c=r.trainingConfig;if(c!=null&&s.loadTrainingConfig(c),r.userDefinedMetadata!=null&&s.setUserDefinedMetadata(r.userDefinedMetadata),r.weightData!=null){if(r.weightSpecs==null)throw new Z(`LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.`);let{modelWeights:e,optimizerWeights:t}=iAe(r.weightData,r.weightSpecs);s.loadWeights(e,a),s.optimizer!=null&&t.length>0&&await s.optimizer.setWeights(t),EJ(e),EJ(t.map(e=>e.tensor))}return s}function iAe(e,t){let n=Tbe(e,t),r={},i=[];return t.forEach(e=>{e.group===`optimizer`?i.push({name:e.name,tensor:n[e.name]}):r[e.name]=n[e.name]}),{modelWeights:r,optimizerWeights:i}}var N2=class e extends j2{constructor(e){if(super({inputs:[],outputs:[]}),e||={},this.trainable=!0,this.built=!1,this.name=e.name==null?d1(`sequential_`):e.name,e.layers!=null)for(let t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(e=>e<0))throw new Z(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(t){let n=t instanceof e||t instanceof j2,r;if(n){if(r=t,r.outputs.length!==1)throw new Z(`All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.`);if(r.inputs.length!==1)throw new Z(`All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.`)}if(this.outputs.length===0){if(t.inboundNodes.length===0){if(t.batchInputShape==null)throw new Z("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");let e=rke({batchShape:t.batchInputShape,dtype:t.dtype,name:t.name+`_input`});t.apply(e)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(t.inboundNodes.length!==1)throw new Z(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${t.name} which has ${t.inboundNodes.length} pre-existing inbound connections.`);if(t.inboundNodes[0].outputTensors.length!==1)throw new Z(`All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.`);this.checkShape(t),this.outputs=[t.inboundNodes[0].outputTensors[0]],this.inputs=C0(this.outputs[0])}this.inboundNodes=[],new x0({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:G$(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(e=>e.shape),outputShapes:this.outputs[0].shape})}else{let e=t.apply(this.outputs[0]);if(Array.isArray(e))throw TypeError(`All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.`);this.checkShape(t),this.outputs=[e],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(t),this.built=!1}pop(){if(this.layers.length===0)throw TypeError(`There are no layers in the model.`);if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{let e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model??this.build(),this.model.call(e,t)}build(e){if(m0(e),this.inputs.length===0||this.outputs.length===0)throw TypeError(`Sequential model cannot be built: model is empty. Add some layers first.`);this.model=new j2({inputs:this.inputs,outputs:this.outputs[0],name:this.name+`_model`}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,n=console.log){this.built||this.build(),super.summary(e,t,n)}setWeights(e){this.model??this.build(),this.model.setWeights(e)}evaluate(e,t,n={}){if(!this.built)throw new H$(`The model needs to be compiled before being used.`);return this.model.evaluate(e,t,n)}async evaluateDataset(e,t){if(!this.built)throw new H$(`The model needs to be compiled before being used.`);return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model??this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model??this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,n={}){if(!this.built)throw new H$(`The model needs to be compiled before being used.`);return this.model.fit(e,t,n)}async fitDataset(e,t){if(!this.built)throw new H$(`The model needs to be compiled before being used.`);return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(t,n,r={},i=!1){let a,o={};if(n instanceof Array){if(n[0].className==null||n[0].className===`Merge`)throw new Z(`Legacy serialization format not supported yet.`);a=n}else R(n.layers!=null,()=>`When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field.`),a=n.layers,delete n.layers,o=n;let s=new t(o);if(!(s instanceof e))throw new U$(`Sequential.fromConfig called on non-Sequential input: ${s}`);for(let e of a){let t=K0(e,void 0,i);i&&t.setFastWeightInitDuringBuild(!0),s.add(t)}return s}set stopTraining(e){if(this.model==null)throw new Z(`Cannot set the stopTraining property of a sequential model before it is compiled.`);this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new Z(`Cannot get the stopTraining property of a sequential model before it is compiled.`);return this.model.stopTraining}getConfig(){let e=[];for(let t of this.layers){let n={};n.className=t.getClassName(),n.config=t.getConfig(),e.push(n)}return{name:this.name,layers:e}}};N2.className=`Sequential`,X(N2);function aAe(e){return new N2(e)}var P2=class extends ZZ{getConfig(){return{}}},F2=class extends P2{apply(e,t=1){return VOe(e,t)}};F2.className=`elu`,X(F2);var I2=class extends P2{apply(e){return dZ(e)}};I2.className=`selu`,X(I2);var L2=class extends P2{apply(e){return oZ(e)}};L2.className=`relu`,X(L2);var R2=class extends P2{apply(e){return G(()=>KX(6,oZ(e)))}};R2.className=`relu6`,X(R2);var z2=class extends P2{apply(e){return e}};z2.className=`linear`,X(z2);var B2=class extends P2{apply(e){return DY(e)}};B2.className=`sigmoid`,X(B2);var V2=class extends P2{apply(e){return UOe(e)}};V2.className=`hardSigmoid`,X(V2);var H2=class extends P2{apply(e){return PX(e)}};H2.className=`softplus`,X(H2);var U2=class extends P2{apply(e){return HOe(e)}};U2.className=`softsign`,X(U2);var W2=class extends P2{apply(e){return kY(e)}};W2.className=`tanh`,X(W2);var G2=class extends P2{apply(e,t=-1){return yZ(e,t)}};G2.className=`softmax`,X(G2);var K2=class extends P2{apply(e,t=-1){return IX(e,t)}};K2.className=`logSoftmax`,X(K2);var q2=class extends P2{apply(e){return G(()=>G(()=>{let t=J(.5,q(1,eX(iY(e,Math.sqrt(2)))));return J(e,t)}))}};q2.className=`gelu`,X(q2);var J2=class extends P2{apply(e){return G(()=>J(.5,J(e,q(1,kY(J(pX(iY(2,Math.PI)),q(e,J(.044715,dX(e,3)))))))))}};J2.className=`gelu_new`,X(J2);var Y2=class extends P2{apply(e){return G(()=>J(e,kY(PX(e))))}};Y2.className=`mish`,X(Y2);var X2=class extends P2{apply(e,t=1){return G(()=>J(DY(J(e,t)),e))}};X2.className=`swish`,X(X2);function Z2(e){return e.getClassName()}function Q2(e,t={}){return t1(e,QZ.getMap().classNameMap,t,`activation`)}function $2(e){if(e==null){let e={};return e.className=`linear`,e.config={},Q2(e)}if(typeof e==`string`){let t={};return t.className=e,t.config={},Q2(t)}else if(e instanceof P2)return e;else return Q2(e)}function oAe(e){if(e!=null&&typeof e!=`object`)throw Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${e}`)}var e4=class extends ZZ{},t4=class extends e4{constructor(e){super(),oAe(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return G(()=>{let t=WX([1]);return this.hasL1&&(t=q(t,hX(J(this.l1,aY(e))))),this.hasL2&&(t=q(t,hX(J(this.l2,B1(e))))),Y(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}};t4.className=`L1L2`,X(t4);const n4={l1l2:`L1L2`};function r4(e){return $$(e)}function i4(e,t={}){return t1(e,QZ.getMap().classNameMap,t,`regularizer`)}function a4(e){if(e==null)return null;if(typeof e==`string`){let t={className:e in n4?n4[e]:e,config:{}};return i4(t)}else if(e instanceof e4)return e;else return i4(e)}var o4=class extends S0{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=p0(e);let n=oZ(e);return this.maxValue!=null&&(n=PY(n,0,this.maxValue)),n}computeOutputShape(e){return e}getConfig(){let e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}};o4.className=`ReLU`,X(o4);var s4=class extends S0{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e??={},this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=p0(e);return DX(n,this.alpha)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};s4.className=`LeakyReLU`,X(s4);var c4=class extends S0{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER=`zeros`,e??={},this.supportsMasking=!0,this.alphaInitializer=u0(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=a4(e.alphaRegularizer),this.alphaConstraint=z0(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes==`number`)this.sharedAxes=[e.sharedAxes];else throw new Z(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=m0(e);let t=e.slice(1);if(this.sharedAxes!=null)for(let e of this.sharedAxes)t[e-1]=1;this.alpha=this.addWeight(`alpha`,t,`float32`,this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);let n={};if(this.sharedAxes!=null)for(let t=1;t<e.length;++t)n[t]=e[t];this.inputSpec=[new y0({ndim:e.length,axes:n})],this.built=!0}call(e,t){return e=p0(e),$X(e,this.alpha.read())}getConfig(){let e={alphaInitializer:l0(this.alphaInitializer),alphaRegularizer:r4(this.alphaRegularizer),alphaConstraint:L0(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}};c4.className=`PReLU`,X(c4);var l4=class extends S0{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e??={},e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new U$(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){let n=p0(e);return $Y(n)}computeOutputShape(e){return e}getConfig(){let e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};l4.className=`ELU`,X(l4);var u4=class extends S0{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e??={},this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){let n=p0(e);return J(n,K(wX(n,this.theta),`float32`))}computeOutputShape(e){return e}getConfig(){let e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}};u4.className=`ThresholdedReLU`,X(u4);var d4=class extends S0{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e??={},this.softmax=new G2().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){return G(()=>{let n=p0(e),r=t.mask;if(r!=null){let e=J(FX(GX(n.shape),K(r,n.dtype)),fX(-1e9));n=q(n,e)}return this.axis instanceof Array?this.axis.length>1?vX(FX(n,LX(n,this.axis,!0))):this.softmax(n,this.axis[0]):this.softmax(n,this.axis)})}computeOutputShape(e){return e}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};d4.className=`Softmax`,X(d4);function f4(e,t,n){if(typeof e==`number`)return G$(e,t);if(e.length!==t)throw new Z(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${e.length} elements.`);for(let r=0;r<t;++r){let i=e[r];if(!LOe(i))throw new Z(`The ${n} argument must be an integer or tuple of ${t} integers. Received: ${JSON.stringify(e)} including a non-integer number ${i}`)}return e}function p4(e,t,n,r,i=1){if(e==null)return e;let a=t+(t-1)*(i-1),o;return o=n===`same`?e:e-a+1,Math.floor((o+r-1)/r)}function m4(e,t,n,r){if(e==null)return null;if(r===`valid`)e=e*t+w1([n-t,0]);else if(r===`same`)e*=t;else throw new Z(`Unsupport padding mode: ${r}.`);return e}function h4(e,t){return G(()=>(p1(t),t===`channelsFirst`?PZ(e,[0,2,3,1]):e))}function g4(e,t){return G(()=>(p1(t),t===`channelsFirst`?PZ(e,[0,2,3,4,1]):e))}function sAe(e,t,n,r=1,i=`valid`,a,o=1){return G(()=>{if(a??=O1(),p1(a),e.shape.length!==3)throw new Z(`The input of a conv1dWithBias operation should be 3, but is ${e.shape.length} instead.`);if(t.shape.length!==3)throw new Z(`The kernel for a conv1dWithBias operation should be 3, but is ${t.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new Z(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(a===`channelsFirst`&&(e=PZ(e,[0,2,1])),i===`causal`)throw new U$(`The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.`);let s=IY(e,t,r,i===`same`?`same`:`valid`,`NWC`,o);return n!=null&&(s=H1(s,n)),s})}function _4(e,t,n,r=[1,1],i=`valid`,a,o,s=null){return G(()=>{if(a??=O1(),p1(a),e.rank!==3&&e.rank!==4)throw new Z(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${e.rank}.`);if(t.rank!==3&&t.rank!==4)throw new Z(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${e.rank}.`);let c=h4(e,a);if(i===`causal`)throw new U$(`The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.`);return c=sTe({x:c,filter:t,strides:r,pad:i===`same`?`same`:`valid`,dilations:o,dataFormat:`NHWC`,bias:n,activation:s}),a===`channelsFirst`&&(c=PZ(c,[0,3,1,2])),c})}function cAe(e,t,n,r=[1,1,1],i=`valid`,a,o){return G(()=>{if(a??=O1(),p1(a),e.rank!==4&&e.rank!==5)throw new Z(`conv3dWithBias expects input to be of rank 4 or 5, but received ${e.rank}.`);if(t.rank!==4&&t.rank!==5)throw new Z(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${e.rank}.`);let s=g4(e,a);if(i===`causal`)throw new U$(`The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.`);return s=hSe(s,t,r,i===`same`?`same`:`valid`,`NDHWC`,o),n!=null&&(s=H1(s,n)),a===`channelsFirst`&&(s=PZ(s,[0,4,1,2,3])),s})}var v4=class e extends S0{constructor(t,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER=`glorotNormal`,this.DEFAULT_BIAS_INITIALIZER=`zeros`,e.verifyArgs(n),this.rank=t,o1(this.rank,`rank`),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new U$(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=f4(n.kernelSize,t,`kernelSize`),this.strides=f4(n.strides==null?1:n.strides,t,`strides`),this.padding=n.padding==null?`valid`:n.padding,m1(this.padding),this.dataFormat=n.dataFormat==null?`channelsLast`:n.dataFormat,p1(this.dataFormat),this.activation=$2(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=u0(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=z0(n.biasConstraint),this.biasRegularizer=a4(n.biasRegularizer),this.activityRegularizer=a4(n.activityRegularizer),this.dilationRate=f4(n.dilationRate==null?1:n.dilationRate,t,`dilationRate`),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new Z(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate==`number`)this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new Z(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate==`number`)this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new Z(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(K$(`kernelSize`in e,`required key 'kernelSize' not in config`),typeof e.kernelSize!=`number`&&!a1(e.kernelSize,`number`,1,3))throw new Z(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){let e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Z2(this.activation),useBias:this.useBias,biasInitializer:l0(this.biasInitializer),biasRegularizer:r4(this.biasRegularizer),activityRegularizer:r4(this.activityRegularizer),biasConstraint:L0(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}},y4=class e extends v4{constructor(t,n){super(t,n),this.kernel=null,e.verifyArgs(n),this.filters=n.filters,o1(this.filters,`filters`),this.kernelInitializer=u0(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=z0(n.kernelConstraint),this.kernelRegularizer=a4(n.kernelRegularizer)}build(e){e=m0(e);let t=this.dataFormat===`channelsFirst`?1:e.length-1;if(e[t]==null)throw new Z(`The channel dimension of the input should be defined. Found ${e[t]}`);let n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight(`kernel`,r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight(`bias`,[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:n}}],this.built=!0}call(e,t){return G(()=>{e=p0(e);let t,n=this.bias==null?null:this.bias.read(),r=c1(this.activation.getClassName());if(r!=null&&this.rank===2)t=_4(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate,r);else{if(this.rank===1)t=sAe(e,this.kernel.read(),n,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)t=_4(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)t=cAe(e,this.kernel.read(),n,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new U$(`convolutions greater than 3D are not implemented yet.`);this.activation!=null&&(t=this.activation.apply(t))}return t})}computeOutputShape(e){e=m0(e);let t=[],n=this.dataFormat===`channelsLast`?e.slice(1,e.length-1):e.slice(2);for(let e=0;e<n.length;++e){let r=p4(n[e],this.kernelSize[e],this.padding,this.strides[e],typeof this.dilationRate==`number`?this.dilationRate:this.dilationRate[e]);t.push(r)}let r=[e[0]];return this.dataFormat===`channelsLast`?(r=r.concat(t),r.push(this.filters)):(r.push(this.filters),r=r.concat(t)),r}getConfig(){let e={filters:this.filters,kernelInitializer:l0(this.kernelInitializer),kernelRegularizer:r4(this.kernelRegularizer),kernelConstraint:L0(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!(`filters`in e)||typeof e.filters!=`number`||e.filters<1)throw new Z(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}},b4=class e extends y4{constructor(t){super(2,t),e.verifyArgs(t)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!=`number`&&!a1(e.kernelSize,`number`,1,2))throw new Z(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}};b4.className=`Conv2D`,X(b4);var x4=class e extends y4{constructor(t){super(3,t),e.verifyArgs(t)}getConfig(){let e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!=`number`&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new Z(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}};x4.className=`Conv3D`,X(x4);var S4=class extends b4{constructor(e){if(super(e),this.inputSpec=[new y0({ndim:4})],this.padding!==`same`&&this.padding!==`valid`)throw new Z(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=m0(e),e.length!==4)throw new Z(`Input should have rank 4; Received input shape: `+JSON.stringify(e));let t=this.dataFormat===`channelsFirst`?1:e.length-1;if(e[t]==null)throw new Z("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight(`kernel`,r,`float32`,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight(`bias`,[this.filters],`float32`,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new y0({ndim:4,axes:{[t]:n}})],this.built=!0}call(e,t){return G(()=>{let t=p0(e);if(t.shape.length!==4)throw new Z(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${t.shape.length}`);let n=t.shape,r=n[0],i,a;this.dataFormat===`channelsFirst`?(i=2,a=3):(i=1,a=2);let o=n[i],s=n[a],c=this.kernelSize[0],l=this.kernelSize[1],u=this.strides[0],d=this.strides[1],f=m4(o,u,c,this.padding),p=m4(s,d,l,this.padding),m=[r,f,p,this.filters];this.dataFormat!==`channelsLast`&&(t=PZ(t,[0,2,3,1]));let h=RY(t,this.kernel.read(),m,this.strides,this.padding);return this.dataFormat!==`channelsLast`&&(h=PZ(h,[0,3,1,2])),this.bias!=null&&(h=H1(h,this.bias.read(),this.dataFormat)),this.activation!=null&&(h=this.activation.apply(h)),h})}computeOutputShape(e){e=m0(e);let t=e.slice(),n,r,i;this.dataFormat===`channelsFirst`?(n=1,r=2,i=3):(n=3,r=1,i=2);let a=this.kernelSize[0],o=this.kernelSize[1],s=this.strides[0],c=this.strides[1];return t[n]=this.filters,t[r]=m4(t[r],s,a,this.padding),t[i]=m4(t[i],c,o,this.padding),t}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};S4.className=`Conv2DTranspose`,X(S4);var C4=class extends x4{constructor(e){if(super(e),this.inputSpec=[new y0({ndim:5})],this.padding!==`same`&&this.padding!==`valid`)throw new Z(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=m0(e),e.length!==5)throw new Z(`Input should have rank 5; Received input shape: `+JSON.stringify(e));let t=this.dataFormat===`channelsFirst`?1:e.length-1;if(e[t]==null)throw new Z("The channel dimension of the inputs should be defined. Found `None`.");let n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight(`kernel`,r,`float32`,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight(`bias`,[this.filters],`float32`,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new y0({ndim:5,axes:{[t]:n}})],this.built=!0}call(e,t){return G(()=>{let t=p0(e);if(t.shape.length!==5)throw new Z(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${t.shape.length}`);let n=t.shape,r=n[0],i,a,o;this.dataFormat===`channelsFirst`?(o=2,i=3,a=4):(o=1,i=2,a=3);let s=n[o],c=n[i],l=n[a],u=this.kernelSize[0],d=this.kernelSize[1],f=this.kernelSize[2],p=this.strides[0],m=this.strides[1],h=this.strides[2],g=m4(s,p,u,this.padding),_=m4(c,m,d,this.padding),v=m4(l,h,f,this.padding),y=[r,g,_,v,this.filters];this.dataFormat!==`channelsLast`&&(t=PZ(t,[0,2,3,4,1]));let b=vSe(t,this.kernel.read(),y,this.strides,this.padding);return this.dataFormat!==`channelsLast`&&(b=PZ(b,[0,4,1,2,3])),this.bias!==null&&(b=H1(b,this.bias.read(),this.dataFormat)),this.activation!==null&&(b=this.activation.apply(b)),b})}computeOutputShape(e){e=m0(e);let t=e.slice(),n,r,i,a;this.dataFormat===`channelsFirst`?(n=1,r=2,i=3,a=4):(n=4,r=1,i=2,a=3);let o=this.kernelSize[0],s=this.kernelSize[1],c=this.kernelSize[2],l=this.strides[0],u=this.strides[1],d=this.strides[2];return t[n]=this.filters,t[r]=m4(t[r],l,o,this.padding),t[i]=m4(t[i],u,s,this.padding),t[a]=m4(t[a],d,c,this.padding),t}getConfig(){let e=super.getConfig();return delete e.dilationRate,e}};C4.className=`Conv3DTranspose`,X(C4);var w4=class extends y4{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER=`glorotUniform`,this.DEFAULT_POINTWISE_INITIALIZER=`glorotUniform`,this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new Z("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new Z(`Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.`);if(t.padding!=null&&t.padding!==`same`&&t.padding!==`valid`)throw new Z(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=u0(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=a4(t.depthwiseRegularizer),this.depthwiseConstraint=z0(t.depthwiseConstraint),this.pointwiseInitializer=u0(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=a4(t.pointwiseRegularizer),this.pointwiseConstraint=z0(t.pointwiseConstraint)}build(e){if(e=m0(e),e.length<this.rank+2)throw new Z(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);let t=this.dataFormat===`channelsFirst`?1:e.length-1;if(e[t]==null||e[t]<0)throw new Z(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);let n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),i=[];for(let e=0;e<this.rank;++e)i.push(1);i.push(n*this.depthMultiplier,this.filters),this.depthwiseKernel=this.addWeight(`depthwise_kernel`,r,`float32`,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight(`pointwise_kernel`,i,`float32`,this.pointwiseInitializer,this.pointwiseRegularizer,!0,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight(`bias`,[this.filters],`float32`,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.inputSpec=[new y0({ndim:this.rank+2,axes:{[t]:n}})],this.built=!0}call(e,t){return G(()=>{e=p0(e);let t;if(this.rank===1)throw new U$(`1D separable convolution is not implemented yet.`);return this.rank===2&&(this.dataFormat===`channelsFirst`&&(e=PZ(e,[0,2,3,1])),t=fZ(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,`NHWC`)),this.useBias&&(t=H1(t,this.bias.read(),this.dataFormat)),this.activation!=null&&(t=this.activation.apply(t)),this.dataFormat===`channelsFirst`&&(t=PZ(t,[0,3,1,2])),t})}getConfig(){let e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=l0(this.depthwiseInitializer),e.pointwiseInitializer=l0(this.pointwiseInitializer),e.depthwiseRegularizer=r4(this.depthwiseRegularizer),e.pointwiseRegularizer=r4(this.pointwiseRegularizer),e.depthwiseConstraint=L0(this.depthwiseConstraint),e.pointwiseConstraint=L0(this.pointwiseConstraint),e}};w4.className=`SeparableConv`;var T4=class extends w4{constructor(e){super(2,e)}};T4.className=`SeparableConv2D`,X(T4);var E4=class e extends y4{constructor(t){super(1,t),e.verifyArgs(t),this.inputSpec=[{ndim:3}]}getConfig(){let e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!=`number`&&!a1(e.kernelSize,`number`,1,1))throw new Z(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}};E4.className=`Conv1D`,X(E4);var D4=class extends S0{constructor(e){super(e),typeof e.cropping==`number`?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]==`number`?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?`channelsLast`:e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat===`channelsFirst`?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return G(()=>{if(e=p0(e),this.dataFormat===`channelsLast`){let t=N1(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return N1(t,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{let t=N1(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return N1(t,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){let e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};D4.className=`Cropping2D`,X(D4);var O4=class extends S0{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?`channelsLast`:e.dataFormat,p1(this.dataFormat),this.interpolation=e.interpolation==null?`nearest`:e.interpolation,POe(this.interpolation)}computeOutputShape(e){if(this.dataFormat===`channelsFirst`){let t=e[2]==null?null:this.size[0]*e[2],n=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,n]}else{let t=e[1]==null?null:this.size[0]*e[1],n=e[2]==null?null:this.size[1]*e[2];return[e[0],t,n,e[3]]}}call(e,t){return G(()=>{let t=p0(e),n=t.shape;if(this.dataFormat===`channelsFirst`){t=PZ(t,[0,2,3,1]);let e=this.size[0]*n[2],r=this.size[1]*n[3],i=this.interpolation===`nearest`?XZ.resizeNearestNeighbor(t,[e,r]):XZ.resizeBilinear(t,[e,r]);return PZ(i,[0,3,1,2])}else{let e=this.size[0]*n[1],r=this.size[1]*n[2];return this.interpolation===`nearest`?XZ.resizeNearestNeighbor(t,[e,r]):XZ.resizeBilinear(t,[e,r])}})}getConfig(){let e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}};O4.className=`UpSampling2D`,X(O4);function lAe(e,t,n=[1,1],r=`valid`,i,a){return G(()=>{i??=O1(),p1(i);let o=h4(e,i);if(e.rank!==4)throw new Z(`Input for depthwiseConv2d is required to be 4-D, but is instead ${e.rank}-D`);if(t.rank!==4)throw new Z(`depthwiseKernel is required to be 4-D, but is instead ${t.rank}-D`);return o=GY(o,t,n,r===`same`?`same`:`valid`,`NHWC`,a),i===`channelsFirst`&&(o=PZ(o,[0,3,1,2])),o})}var k4=class extends v4{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=u0(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=z0(e.depthwiseConstraint),this.depthwiseRegularizer=a4(e.depthwiseRegularizer)}build(e){if(e=m0(e),e.length<4)throw new Z(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);let t=this.dataFormat===`channelsFirst`?1:3;if(e[t]==null||e[t]<0)throw new Z(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);let n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight(`depthwise_kernel`,r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight(`bias`,[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return G(()=>{e=p0(e);let t=lAe(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(t=H1(t,this.bias.read(),this.dataFormat)),this.activation!=null&&(t=this.activation.apply(t)),t})}computeOutputShape(e){e=m0(e);let t=this.dataFormat===`channelsFirst`?e[2]:e[1],n=this.dataFormat===`channelsFirst`?e[3]:e[2],r=this.dataFormat===`channelsFirst`?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,i=p4(t,this.kernelSize[0],this.padding,this.strides[0]),a=p4(n,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat===`channelsFirst`?[e[0],r,i,a]:[e[0],i,a,r]}getConfig(){let e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=l0(this.depthwiseInitializer),e.depthwiseRegularizer=r4(this.depthwiseRegularizer),e.depthwiseConstraint=L0(this.depthwiseRegularizer),e}};k4.className=`DepthwiseConv2D`,X(k4);function A4(e,t,n,r){if(Array.isArray(e)){if(t!=null||n!=null)throw new Z(`When inputs is an array, neither initialState or constants should be provided`);r!=null&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function i(e){return e==null||Array.isArray(e)?e:[e]}return t=i(t),n=i(n),{inputs:e,initialState:t,constants:n}}function j4(e,t,n,r=!1,i,a,o=!1,s=!1){return G(()=>{let c=t.shape.length;if(c<3)throw new Z(`Input should be at least 3D, but is ${c}D.`);let l=[1,0].concat(T1(2,c));if(t=PZ(t,l),a!=null)throw new U$(`The rnn() functoin of the deeplearn.js backend does not support constants yet.`);o&&console.warn(`Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend.`),i!=null&&(i=K(K(i,`bool`),`float32`),i.rank===c-1&&(i=yX(i,-1)),i=PZ(i,l)),r&&(t=cZ(t,0),i!=null&&(i=cZ(i,0)));let u=[],d,f=n,p=t.shape[0],m=MZ(t),h;i!=null&&(h=MZ(i));for(let t=0;t<p;++t){let n=m[t],r=G(()=>e(n,f));if(i==null)d=r[0],f=r[1];else{let e=G(()=>{let e=h[t],n=FX(XX(e),e),i=q(J(r[0],e),J(f[0],n)),a=f.map((t,i)=>q(J(r[1][i],e),J(t,n)));return{output:i,newStates:a}});d=e.output,f=e.newStates}s&&u.push(d)}let g;return s&&(g=wZ(u,1)),[d,g,f]})}var M4=class e extends S0{constructor(e){super(e);let t;if(e.cell==null)throw new Z(`cell property is missing for the constructor of RNN.`);if(t=Array.isArray(e.cell)?new B4({cells:e.cell}):e.cell,t.stateSize==null)throw new Z("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new y0({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){let e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return T1(0,e).map(e=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){d0(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);let n=t[0],r;if(r=this.returnSequences?[e[0],e[1],n]:[e[0],n],this.returnState){let n=[];for(let r of t)n.push([e[0],r]);return[r].concat(n)}else return r}computeMask(e,t){return G(()=>{Array.isArray(t)&&(t=t[0]);let e=this.returnSequences?t:null;if(this.returnState){let t=this.states.map(e=>null);return[e].concat(t)}else return e})}get states(){if(this.states_==null){let e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let n=0;n<e;++n)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new U$(`Constants support is not implemented in RNN yet.`);d0(e)&&(e=e[0]),e=e;let t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new y0({shape:[t,null,...n]});let r=[e[0]].concat(e.slice(2));this.cell.build(r);let i;if(i=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],this.stateSpec!=null){if(!jU(this.stateSpec.map(e=>e.shape[e.shape.length-1]),i))throw new Z(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=i.map(e=>new y0({shape:[null,e]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){G(()=>{if(!this.stateful)throw new V$(`Cannot call resetStates() on an RNN Layer that is not stateful.`);let n=this.inputSpec[0].shape[0];if(n==null)throw new Z("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(e=>WX([n,e])):this.states_=[WX([n,this.cell.stateSize])];else if(e==null)EJ(this.states_),this.keptStates!=null&&(EJ(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(e=>WX([n,e])):this.states_[0]=WX([n,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new Z(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t===!0?this.keptStates.push(this.states_.slice()):EJ(this.states_);for(let t=0;t<this.states_.length;++t){let r=e[t],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[t]:this.cell.stateSize,a=[n,i];if(!jU(r.shape,a))throw new Z(`State ${t} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${r.shape}`);this.states_[t]=r}}this.states_=this.states_.map(e=>DJ(e.clone()))})}apply(e,t){let n=t==null?null:t.initialState,r=t==null?null:t.constants;t??={};let i=A4(e,n,r,this.numConstants);e=i.inputs,n=i.initialState,r=i.constants;let a=[],o=[];if(n!=null){t.initialState=n,a=a.concat(n),this.stateSpec=[];for(let e of n)this.stateSpec.push(new y0({shape:e.shape}));o=o.concat(this.stateSpec)}if(r!=null&&(t.constants=r,a=a.concat(r),this.numConstants=r.length),a[0]instanceof b0){let n=[e].concat(a),r=this.inputSpec.concat(o),i=this.inputSpec;this.inputSpec=r;let s=super.apply(n,t);return this.inputSpec=i,s}else return super.apply(e,t)}call(e,t){return G(()=>{let n=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;e=p0(e),i??=this.stateful?this.states_:this.getInitialState(e);let a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(i.length!==a)throw new Z(`RNN Layer has ${a} state(s) but was passed ${i.length} initial state(s).`);this.unroll&&console.warn(`Ignoring unroll = true for RNN layer, due to imperative backend.`);let o={training:r},s=j4((e,t)=>{let n=this.cell.call([e].concat(t),o);return[n[0],n.slice(1)]},e,i,this.goBackwards,n,null,this.unroll,this.returnSequences),c=s[0],l=s[1],u=s[2];this.stateful&&this.resetStates(u,r);let d=this.returnSequences?l:c;return this.returnState?[d].concat(u):d})}getInitialState(e){return G(()=>{let t=WX(e.shape);return t=hX(t,[1,2]),t=A1(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(e=>e>1?I1(t,[1,e]):t):this.cell.stateSize>1?[I1(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){let t=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);let r=this.cell.getConfig();return this.getClassName()===e.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),t),n)}static fromConfig(e,t,n={}){let r=t.cell,i=K0(r,n);return new e(Object.assign(t,{cell:i}))}};M4.className=`RNN`,X(M4);var N4=class extends S0{},P4=class extends N4{constructor(e){super(e),this.DEFAULT_ACTIVATION=`tanh`,this.DEFAULT_KERNEL_INITIALIZER=`glorotNormal`,this.DEFAULT_RECURRENT_INITIALIZER=`orthogonal`,this.DEFAULT_BIAS_INITIALIZER=`zeros`,this.units=e.units,o1(this.units,`units`),this.activation=$2(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=u0(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=u0(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=u0(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=a4(e.kernelRegularizer),this.recurrentRegularizer=a4(e.recurrentRegularizer),this.biasRegularizer=a4(e.biasRegularizer),this.kernelConstraint=z0(e.kernelConstraint),this.recurrentConstraint=z0(e.recurrentConstraint),this.biasConstraint=z0(e.biasConstraint),this.dropout=C1([1,w1([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=C1([1,w1([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=m0(e),this.kernel=this.addWeight(`kernel`,[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight(`recurrent_kernel`,[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight(`bias`,[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return G(()=>{if(e=e,e.length!==2)throw new Z(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let n=e[1];e=e[0];let r=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=V4({ones:()=>XX(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=V4({ones:()=>XX(n),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let i,a=this.dropoutMask,o=this.recurrentDropoutMask;i=R1(a==null?e:J(e,a),this.kernel.read()),this.bias!=null&&(i=H1(i,this.bias.read())),o!=null&&(n=J(n,o));let s=q(i,R1(n,this.recurrentKernel.read()));return this.activation!=null&&(s=this.activation.apply(s)),[s,s]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:Z2(this.activation),useBias:this.useBias,kernelInitializer:l0(this.kernelInitializer),recurrentInitializer:l0(this.recurrentInitializer),biasInitializer:l0(this.biasInitializer),kernelRegularizer:r4(this.kernelRegularizer),recurrentRegularizer:r4(this.recurrentRegularizer),biasRegularizer:r4(this.biasRegularizer),activityRegularizer:r4(this.activityRegularizer),kernelConstraint:L0(this.kernelConstraint),recurrentConstraint:L0(this.recurrentConstraint),biasConstraint:L0(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),t)}};P4.className=`SimpleRNNCell`,X(P4);var F4=class extends M4{constructor(e){e.cell=new P4(e),super(e)}call(e,t){return G(()=>{this.cell.dropoutMask!=null&&(EJ(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(EJ(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})})}static fromConfig(e,t){return new e(t)}};F4.className=`SimpleRNN`,X(F4);var I4=class extends N4{constructor(e){if(super(e),this.DEFAULT_ACTIVATION=`tanh`,this.DEFAULT_RECURRENT_ACTIVATION=`hardSigmoid`,this.DEFAULT_KERNEL_INITIALIZER=`glorotNormal`,this.DEFAULT_RECURRENT_INITIALIZER=`orthogonal`,this.DEFAULT_BIAS_INITIALIZER=`zeros`,e.resetAfter)throw new Z(`GRUCell does not support reset_after parameter set to true.`);this.units=e.units,o1(this.units,`units`),this.activation=$2(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=$2(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=u0(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=u0(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=u0(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=a4(e.kernelRegularizer),this.recurrentRegularizer=a4(e.recurrentRegularizer),this.biasRegularizer=a4(e.biasRegularizer),this.kernelConstraint=z0(e.kernelConstraint),this.recurrentConstraint=z0(e.recurrentConstraint),this.biasConstraint=z0(e.biasConstraint),this.dropout=C1([1,w1([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=C1([1,w1([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=m0(e);let t=e[e.length-1];this.kernel=this.addWeight(`kernel`,[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight(`recurrent_kernel`,[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight(`bias`,[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return G(()=>{if(e=e,e.length!==2)throw new Z(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);let n=t.training==null?!1:t.training,r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=V4({ones:()=>XX(e),rate:this.dropout,training:n,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=V4({ones:()=>XX(r),rate:this.recurrentDropout,training:n,count:3,dropoutFunc:this.dropoutFunc}));let i=this.dropoutMask,a=this.recurrentDropoutMask,o,s,c;0<this.dropout&&this.dropout<1&&(e=J(e,i[0]));let l=R1(e,this.kernel.read());this.useBias&&(l=H1(l,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=J(r,a[0]));let u=this.recurrentKernel.read(),[d,f]=SZ(u,[2*this.units,this.units],u.rank-1),p=R1(r,d),[m,h,g]=SZ(l,3,l.rank-1),[_,v]=SZ(p,2,p.rank-1);o=this.recurrentActivation.apply(q(m,_)),s=this.recurrentActivation.apply(q(h,v));let y=R1(J(s,r),f);c=this.activation.apply(q(g,y));let b=q(J(o,r),J(q(1,NX(o)),c));return[b,b]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:Z2(this.activation),recurrentActivation:Z2(this.recurrentActivation),useBias:this.useBias,kernelInitializer:l0(this.kernelInitializer),recurrentInitializer:l0(this.recurrentInitializer),biasInitializer:l0(this.biasInitializer),kernelRegularizer:r4(this.kernelRegularizer),recurrentRegularizer:r4(this.recurrentRegularizer),biasRegularizer:r4(this.biasRegularizer),activityRegularizer:r4(this.activityRegularizer),kernelConstraint:L0(this.kernelConstraint),recurrentConstraint:L0(this.recurrentConstraint),biasConstraint:L0(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),t)}};I4.className=`GRUCell`,X(I4);var L4=class extends M4{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new I4(e),super(e)}call(e,t){return G(()=>{this.cell.dropoutMask!=null&&(EJ(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(EJ(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}};L4.className=`GRU`,X(L4);var R4=class extends N4{constructor(e){super(e),this.DEFAULT_ACTIVATION=`tanh`,this.DEFAULT_RECURRENT_ACTIVATION=`hardSigmoid`,this.DEFAULT_KERNEL_INITIALIZER=`glorotNormal`,this.DEFAULT_RECURRENT_INITIALIZER=`orthogonal`,this.DEFAULT_BIAS_INITIALIZER=`zeros`,this.units=e.units,o1(this.units,`units`),this.activation=$2(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=$2(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=u0(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=u0(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=u0(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=a4(e.kernelRegularizer),this.recurrentRegularizer=a4(e.recurrentRegularizer),this.biasRegularizer=a4(e.biasRegularizer),this.kernelConstraint=z0(e.kernelConstraint),this.recurrentConstraint=z0(e.recurrentConstraint),this.biasConstraint=z0(e.biasConstraint),this.dropout=C1([1,w1([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=C1([1,w1([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=m0(e);let n=e[e.length-1];this.kernel=this.addWeight(`kernel`,[n,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight(`recurrent_kernel`,[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){let e=this.biasInitializer,n=this.units;r=new(t=class extends G1{apply(t,r){let i=e.apply([n]),a=new q1().apply([n]),o=e.apply([n*2]);return F1(F1(i,a),o)}},t.className=`CustomInit`,t)}else r=this.biasInitializer;this.bias=this.addWeight(`bias`,[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return G(()=>{let n=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new Z(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1],i=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=V4({ones:()=>XX(e),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=V4({ones:()=>XX(r),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let a=this.dropoutMask,o=this.recurrentDropoutMask,s,c,l,u;0<this.dropout&&this.dropout<1&&(e=J(e,a[0]));let d=R1(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=J(r,o[0])),d=q(d,R1(r,this.recurrentKernel.read())),this.useBias&&(d=H1(d,this.bias.read()));let[f,p,m,h]=SZ(d,4,d.rank-1);s=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(p),l=q(J(c,i),J(s,this.activation.apply(m))),u=this.recurrentActivation.apply(h);let g=J(u,this.activation.apply(l));return[g,g,l]})}getConfig(){let e=super.getConfig(),t={units:this.units,activation:Z2(this.activation),recurrentActivation:Z2(this.recurrentActivation),useBias:this.useBias,kernelInitializer:l0(this.kernelInitializer),recurrentInitializer:l0(this.recurrentInitializer),biasInitializer:l0(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:r4(this.kernelRegularizer),recurrentRegularizer:r4(this.recurrentRegularizer),biasRegularizer:r4(this.biasRegularizer),activityRegularizer:r4(this.activityRegularizer),kernelConstraint:L0(this.kernelConstraint),recurrentConstraint:L0(this.recurrentConstraint),biasConstraint:L0(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),t)}};R4.className=`LSTMCell`,X(R4);var z4=class extends M4{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new R4(e),super(e)}call(e,t){return G(()=>{this.cell.dropoutMask!=null&&(EJ(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(EJ(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);let n=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}};z4.className=`LSTM`,X(z4);var B4=class extends N4{constructor(e){super(e),this.cells=e.cells}get stateSize(){let e=[];for(let t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return G(()=>{e=e;let n=e.slice(1),r=[];for(let e of this.cells.slice().reverse())Array.isArray(e.stateSize)?r.push(n.splice(0,e.stateSize.length)):r.push(n.splice(0,1));r.reverse();let i=[],a;for(let o=0;o<this.cells.length;++o){let s=this.cells[o];n=r[o],a=o===0?[e[0]].concat(n):[a[0]].concat(n),a=s.call(a,t),i.push(a.slice(1))}n=[];for(let e of i.slice().reverse())n.push(...e);return[a[0]].concat(n)})}build(e){d0(e)&&(e=e[0]),e=e;let t;this.cells.forEach((n,r)=>{v1(`RNNCell_${r}`,()=>{n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){let e=super.getConfig(),t={cells:this.cells.map(e=>({className:e.getClassName(),config:e.getConfig()}))};return Object.assign(Object.assign({},e),t)}static fromConfig(e,t,n={}){let r=[];for(let e of t.cells)r.push(K0(e,n));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];let e=[];for(let t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){let e=[];for(let t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){let t=[];for(let e of this.cells)t.push(...e.trainableWeights);return t.concat(e)}return e}getWeights(){let e=[];for(let t of this.cells)e.push(...t.weights);return _0(e)}setWeights(e){let t=[];for(let n of this.cells){let r=n.weights.length,i=e.splice(r);for(let e=0;e<n.weights.length;++e)t.push([n.weights[e],i[e]])}v0(t)}};B4.className=`StackedRNNCells`,X(B4);function V4(e){let{ones:t,rate:n,training:r=!1,count:i=1,dropoutFunc:a}=e,o=()=>a==null?U1(t(),n):a(t(),n),s=()=>W1(o,t,r);return!i||i<=1?DJ(s().clone()):Array(i).fill(void 0).map(s).map(e=>DJ(e.clone()))}
/**
* @license
* Copyright 2020 Google LLC
*
* Use of this source code is governed by an MIT-style
* license that can be found in the LICENSE file or at
* https://opensource.org/licenses/MIT.
* =============================================================================
*/
var uAe=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols==`function`)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n},H4=class extends M4{constructor(e){if(e.unroll)throw new U$(`Unrolling is not possible with convolutional RNNs.`);if(Array.isArray(e.cell))throw new U$(`It is not possible at the moment to stack convolutional cells.`);super(e),this.inputSpec=[new y0({ndim:5})]}call(e,t){return G(()=>{if(this.cell.dropoutMask!=null&&(EJ(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(EJ(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new Z(`ConvRNN2D cell does not support constants`);let n=t==null?null:t.mask,r=t==null?null:t.training,i=t==null?null:t.initialState;return super.call(e,{mask:n,training:r,initialState:i})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...[,,].fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return G(()=>{let{stateSize:t}=this.cell,n=e.shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)],a=WX(i);return Array.isArray(t)?Array(t.length).fill(a):[a]})}resetStates(e,t=!1){G(()=>{if(!this.stateful)throw new V$(`Cannot call resetStates() on an RNN Layer that is not stateful.`);let n=this.inputSpec[0].shape,r=this.computeSingleOutputShape(n),i=[r[0],...r.slice(2)];if(n[0]==null)throw new Z("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>WX(i)):this.states_=[WX(i)];else if(e==null)EJ(this.states_),this.keptStates!=null&&(EJ(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>WX(i)):this.states_[0]=WX(i);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new Z(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):EJ(this.states_);for(let t=0;t<this.states_.length;++t){let n=e[t],r=i;if(!jU(n.shape,r))throw new Z(`State ${t} is incompatible with layer ${this.name}: expected shape=${r}, received shape=${n.shape}`);this.states_[t]=n}}this.states_=this.states_.map(e=>DJ(e.clone()))})}computeSingleOutputShape(e){let{dataFormat:t,filters:n,kernelSize:r,padding:i,strides:a,dilationRate:o}=this.cell,s=t===`channelsFirst`,c=e[s?3:2],l=e[s?4:3],u=p4(c,r[0],i,a[0],o[0]),d=p4(l,r[1],i,a[1],o[1]);return[...e.slice(0,2),...s?[n,u,d]:[u,d,n]]}};H4.className=`ConvRNN2D`;var U4=class extends R4{constructor(e){let{filters:t,kernelSize:n,strides:r,padding:i,dataFormat:a,dilationRate:o}=e;super(Object.assign(Object.assign({},e),{units:t})),this.filters=t,o1(this.filters,`filters`),this.kernelSize=f4(n,2,`kernelSize`),this.kernelSize.forEach(e=>o1(e,`kernelSize`)),this.strides=f4(r||1,2,`strides`),this.strides.forEach(e=>o1(e,`strides`)),this.padding=i||`valid`,m1(this.padding),this.dataFormat=a||`channelsLast`,p1(this.dataFormat),this.dilationRate=f4(o||1,2,`dilationRate`),this.dilationRate.forEach(e=>o1(e,`dilationRate`))}build(e){var t;e=m0(e);let n=this.dataFormat===`channelsFirst`?1:e.length-1;if(e[n]==null)throw new Z(`The channel dimension of the input should be defined. Found ${e[n]}`);let r=e[n],i=this.kernelSize.concat([r,this.filters*4]);this.kernel=this.addWeight(`kernel`,i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);let a=this.kernelSize.concat([this.filters,this.filters*4]);if(this.recurrentKernel=this.addWeight(`recurrent_kernel`,a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let e;if(this.unitForgetBias){let n=this.biasInitializer,r=this.filters;e=new(t=class extends G1{apply(e,t){let i=n.apply([r]),a=GX([r]),o=n.apply([r*2]);return P1([i,a,o])}},t.className=`CustomInit`,t)}else e=this.biasInitializer;this.bias=this.addWeight(`bias`,[this.filters*4],null,e,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return G(()=>{if(e.length!==3)throw new Z(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let n=t.training||!1,r=e[0],i=e[1],a=e[2];0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=V4({ones:()=>XX(r),rate:this.dropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let o=this.dropoutMask,s=(e,t,n)=>!t||!t[n]?e:J(t[n],e),c=s(r,o,0),l=s(r,o,1),u=s(r,o,2),d=s(r,o,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=V4({ones:()=>XX(i),rate:this.recurrentDropout,training:n,count:4,dropoutFunc:this.dropoutFunc}));let f=this.recurrentDropoutMask,p=s(i,f,0),m=s(i,f,1),h=s(i,f,2),g=s(i,f,3),[_,v,y,b]=SZ(this.kernel.read(),4,3),[x,S,C,w]=this.useBias?SZ(this.bias.read(),4):[null,null,null,null];c=this.inputConv(c,_,x,this.padding),l=this.inputConv(l,v,S,this.padding),u=this.inputConv(u,y,C,this.padding),d=this.inputConv(d,b,w,this.padding);let[T,E,D,O]=SZ(this.recurrentKernel.read(),4,3);p=this.recurrentConv(p,T),m=this.recurrentConv(m,E),h=this.recurrentConv(h,D),g=this.recurrentConv(g,O);let k=this.recurrentActivation.apply(q(c,p)),ee=this.recurrentActivation.apply(q(l,m)),te=q(J(ee,a),J(k,this.activation.apply(q(u,h)))),ne=J(this.recurrentActivation.apply(q(d,g)),this.activation.apply(te));return[ne,ne,te]})}getConfig(){let e=super.getConfig(),{units:t}=e,n=uAe(e,[`units`]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),r)}inputConv(e,t,n,r){let i=FY(e,t,this.strides,r||`valid`,this.dataFormat===`channelsFirst`?`NCHW`:`NHWC`,this.dilationRate);return n?H1(i,n,this.dataFormat):i}recurrentConv(e,t){return FY(e,t,1,`same`,this.dataFormat===`channelsFirst`?`NCHW`:`NHWC`)}};U4.className=`ConvLSTM2DCell`,X(U4);var W4=class extends H4{constructor(e){let t=new U4(e);super(Object.assign(Object.assign({},e),{cell:t}))}static fromConfig(e,t){return new e(t)}};W4.className=`ConvLSTM2D`,X(W4);var G4=class extends S0{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;let t=e.shape,n=[];for(let e=0;e<this.noiseShape.length;++e)n.push(this.noiseShape[e]==null?t[e]:this.noiseShape[e]);return n}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=p0(e);if(0<this.rate&&this.rate<1){let e=t.training==null?!1:t.training,r=this.getNoiseShape(n);return W1(()=>U1(n,this.rate,r,this.seed),()=>n,e)}return e})}getConfig(){let e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}};G4.className=`Dropout`,X(G4);var K4=class extends G4{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){let t=e.shape;return[t[0],1,t[2]]}};K4.className=`SpatialDropout1D`,X(K4);var q4=class extends S0{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER=`glorotNormal`,this.DEFAULT_BIAS_INITIALIZER=`zeros`,e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,o1(this.units,`units`),this.activation=$2(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=u0(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=u0(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=z0(e.kernelConstraint),this.biasConstraint=z0(e.biasConstraint),this.kernelRegularizer=a4(e.kernelRegularizer),this.biasRegularizer=a4(e.biasRegularizer),this.activityRegularizer=a4(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=m0(e);let t=e[e.length-1];this.kernel??(this.kernel=this.addWeight(`kernel`,[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight(`bias`,[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=m0(e);let t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=p0(e),r=c1(this.activation.getClassName()),i;return r==null?(i=R1(n,this.kernel.read()),this.bias!=null&&(i=H1(i,this.bias.read())),this.activation!=null&&(i=this.activation.apply(i))):i=R1(n,this.kernel.read(),r,this.bias?this.bias.read():null),i})}getConfig(){let e={units:this.units,activation:Z2(this.activation),useBias:this.useBias,kernelInitializer:l0(this.kernelInitializer),biasInitializer:l0(this.biasInitializer),kernelRegularizer:r4(this.kernelRegularizer),biasRegularizer:r4(this.biasRegularizer),activityRegularizer:r4(this.activityRegularizer),kernelConstraint:L0(this.kernelConstraint),biasConstraint:L0(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}};q4.className=`Dense`,X(q4);var J4=class extends S0{constructor(e){e||={},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=m0(e);for(let t of e.slice(1))if(t==null)throw new Z(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],S1(e,1)]}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=p0(e);if(this.dataFormat===`channelsFirst`&&n.rank>1){let e=[0];for(let t=2;t<n.rank;++t)e.push(t);e.push(1),n=PZ(n,e)}return BOe(n)})}getConfig(){let e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);let t=super.getConfig();return Object.assign(e,t),e}};J4.className=`Flatten`,X(J4);var Y4=class extends S0{constructor(e){super(e),this.supportsMasking=!0,this.activation=$2(e.activation)}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=p0(e);return this.activation.apply(n)})}getConfig(){let e={activation:Z2(this.activation)},t=super.getConfig();return Object.assign(e,t),e}};Y4.className=`Activation`,X(Y4);var X4=class extends S0{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return G(()=>(e=p0(e),ROe(e,this.n)))}getConfig(){let e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}};X4.className=`RepeatVector`,X(X4);var Z4=class extends S0{constructor(e){super(e),this.targetShape=e.targetShape;for(let e=0;e<this.targetShape.length;++e)this.isUnknown(this.targetShape[e])&&(this.targetShape[e]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){let n=`Total size of new array must be unchanged.`,r=t.slice(),i=1,a=null;for(let e=0;e<r.length;++e){let t=r[e];if(this.isUnknown(t))if(a===null)a=e;else throw new Z(`Can only specifiy one unknown dimension.`);else i*=t}let o=S1(e);if(a!==null){if(i===0||o%i!==0)throw new Z(n);r[a]=o/i}else if(o!==i)throw new Z(n);return r}computeOutputShape(e){let t=!1;for(let n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=p0(e),r=n.shape,i=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return Y(n,i)})}getConfig(){let e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}};Z4.className=`Reshape`,X(Z4);var Q4=class extends S0{constructor(e){if(super(e),e.dims==null)throw Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);let t=T1(1,e.dims.length+1);if(!jU(e.dims.slice().sort(),t))throw Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new y0({ndim:this.dims.length+1})]}computeOutputShape(e){e=m0(e);let t=e.slice();return this.dims.forEach((n,r)=>{t[r+1]=e[n]}),t}call(e,t){return PZ(p0(e),this.dimsIncludingBatch)}getConfig(){let e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}};Q4.className=`Permute`,X(Q4);var $4=class extends S0{constructor(e){super(e??{}),this.supportsMasking=!0,e==null?this.maskValue=0:this.maskValue=e.maskValue==null?0:e.maskValue}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){let n=p0(e);return sY(JX(n,this.maskValue),-1)}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=p0(e),r=sY(JX(n,this.maskValue),-1,!0);return J(n,K(r,n.dtype))})}};$4.className=`Masking`,X($4);var e3=class extends S0{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER=`randomUniform`,e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(Y$(e.inputLength))}this.inputDim=e.inputDim,o1(this.inputDim,`inputDim`),this.outputDim=e.outputDim,o1(this.outputDim,`outputDim`),this.embeddingsInitializer=u0(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=a4(e.embeddingsRegularizer),this.activityRegularizer=a4(e.activityRegularizer),this.embeddingsConstraint=z0(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight(`embeddings`,[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return G(()=>this.maskZero?(e=p0(e),JX(e,ZY(e))):null)}computeOutputShape(e){if(e=m0(e),this.inputLength==null)return[...e,this.outputDim];let t=Y$(this.inputLength);if(t.length!==e.length-1)throw new Z(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let n=0;for(let r=0;r<t.length;++r){let i=t[r],a=e[r+1];if(i!=null&&a!=null&&i!==a)throw new Z(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);i??(t[n]=a),n++}}return[e[0],...t,this.outputDim]}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=p0(e);n.dtype!==`int32`&&(n=k1(n,`int32`));let r=z1(this.embeddings.read(),Y(n,[n.size]));return Y(r,m0(this.computeOutputShape(n.shape)))})}getConfig(){let e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:l0(this.embeddingsInitializer),embeddingsRegularizer:r4(this.embeddingsRegularizer),activityRegularizer:r4(this.activityRegularizer),embeddingsConstraint:L0(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}};e3.className=`Embedding`,X(e3);var t3=class extends S0{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new U$}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;let n=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){let i=e[e.length-t.length+r],a=t[r];if(i==null||a==null||i<0||a<0)n.push(null);else if(i===1)n.push(a);else if(a===1)n.push(i);else{if(i!==a)throw new Z(`Operands could not be broadcast together with shapes `+JSON.stringify(e)+` `+JSON.stringify(t));n.push(i)}}return n}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[m0(e)]),e=e,e.length<2)throw new Z(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(let n of e)n!=null&&n[0]!==null&&t.push(n[0]);if(t=r1(t),t.length>1)throw new Z(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let n=e[0]==null?null:e[0].slice(1);for(let t=1;t<e.length;++t){let r=e[t]==null?null:e[t].slice(1);n=this.computeElementwiseOpOutputShape(n,r)}let r=e.map(e=>e.length);e.indexOf(null)===-1&&r1(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return G(()=>{if(e=e,this.reshapeRequired){let t=[],n=e.map(e=>e.rank);if(n.indexOf(null)===-1){let r=w1(n);for(let n of e){let e=n.rank;for(let t=0;t<r-e;++t)n=A1(n,1);t.push(n)}return this.mergeFunction(t)}else{let n=!1;for(let r of e){let e=r.rank;if(e==null){let e=r.shape,i=e[0],a=e.slice(1).concat([i]),o=Y(r,[i].concat(S1(e.slice(1))));o=PZ(o,[1,0]),o=Y(o,a),t.push(o),n=!0}else if(e>1){let i=T1(1,e).concat([0]);t.push(PZ(r,i)),n=!0}else t.push(r)}let r=this.mergeFunction(t),i=r.rank;if(n){if(i==null){let e=r.shape,t=e.length,n=e[t-1],i=[n].concat(e.slice(0,e.length-1));r=Y(PZ(Y(r,[-1,n]),[1,0]),i)}else if(i>1){let e=[i-1].concat(T1(0,i-1));r=PZ(r,e)}}return r}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;t=e[0]==null?null:e[0].slice(1);for(let n=1;n<e.length;++n){let r=e[n]==null?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}let n=[];for(let t of e)t!=null&&t[0]!==null&&n.push(t[0]);return n=r1(n),t=n.length===1?n.concat(t):[null].concat(t),t}computeMask(e,t){return G(()=>{if(t==null)return null;if(!Array.isArray(t))throw new Z("`mask` should be an Array");if(!Array.isArray(e))throw new Z("`inputs` should be an Array");if(t.length!==e.length)throw new Z(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(e=>e==null))return null;t=t.map(e=>e==null?e:yX(e,0));let n=t[0];for(let e=1;e<t.length-1;++e)n=RX(n,t[e]);return n})}},n3=class extends t3{constructor(e){super(e)}mergeFunction(e){return G(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=q(t,e[n]);return t})}};n3.className=`Add`,X(n3);var r3=class extends t3{constructor(e){super(e)}mergeFunction(e){return G(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=J(t,e[n]);return t})}};r3.className=`Multiply`,X(r3);var i3=class extends t3{constructor(e){super(e)}mergeFunction(e){return G(()=>{let t=e[0].clone();for(let n=1;n<e.length;++n)t=q(t,e[n]);return J(1/e.length,t)})}};i3.className=`Average`,X(i3);var a3=class extends t3{constructor(e){super(e)}mergeFunction(e){return G(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=HX(t,e[n]);return t})}};a3.className=`Maximum`,X(a3);var o3=class extends t3{constructor(e){super(e)}mergeFunction(e){return G(()=>{let t=e[0];for(let n=1;n<e.length;++n)t=KX(t,e[n]);return t})}};o3.className=`Minimum`,X(o3);var s3=class extends t3{constructor(e){super(e),this.DEFAULT_AXIS=-1,e??={},this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new Z("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(let n of e)if(n!=null){t=!1;break}if(t)return;let n=[];for(let t=0;t<e.length;++t){let r=e[t].slice();r.splice(this.axis,1);let i=!1;for(let e of n)if(jU(e,r)){i=!0;break}i||n.push(r)}if(n.length>1)throw new Z("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return G(()=>P1(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new Z("A `Concatenate` layer should be called on a list of inputs.");let t=e,n=t[0].slice(),r=this.axis<0?n.length+this.axis:this.axis;for(let e of t.slice(1)){if(n[r]==null||e[r]==null){n[r]=null;break}n[r]+=e[r]}return n}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new Z("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new Z("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new Z(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return G(()=>{let n=!0;if(t.forEach(e=>{if(e!=null){n=!1;return}}),n)return null;let r=[];for(let n=0;n<e.length;++n)t[n]==null?r.push(K(XX(e[n]),`bool`)):t[n].rank<e[n].rank?r.push(yX(t[n],-1)):r.push(t[n]);let i=TY(r,this.axis);return oY(i,-1,!1)})}getConfig(){let e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}};s3.className=`Concatenate`,X(s3);function c3(e,t){for(;e<0;)e+=t;return e}function dAe(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new U$(`batchDot is not implemented for tensors of 4D or higher rank yet`);if(R(e.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${e.shape.length}`),R(e.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${t.shape.length}`),typeof n==`number`&&(n=[n,n]),e.dtype===`complex64`||t.dtype===`complex64`)throw new U$(`batchDot is not implemented for complex64-type Tensors yet.`);let r=e.shape.length,i=t.shape.length;n??=[r-1,i-2];let a=n;return G(()=>{let n;if(r>i){n=r-i;let e=[];for(let t=0;t<n;++t)e.push(1);t=Y(t,t.shape.concat(e))}else if(i>r){n=i-r;let t=[];for(let e=0;e<n;++e)t.push(1);e=Y(e,e.shape.concat(t))}else n=0;let o;if(e.shape.length===2&&t.shape.length===2)o=a[0]===a[1]?hX(J(e,t),a[0]):hX(J(PZ(e,[1,0]),t),a[1]);else{let n=a[0]!==e.shape.length-1,r=a[1]===t.shape.length-1;o=EY(e,t,n,r)}if(n>0){let e;e=r>i?r+i-3:r-1;let t=[];for(let r=e;r<e+n;++r)t.push(r);o=CZ(o,t)}return o.shape.length===1&&(o=yX(o,1)),o})}var l3=class extends t3{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){R(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0],n=e[1];if(t.length>3||n.length>3)throw new U$(`Dot layer does not support tensors of 4D or higher rank yet.`);let r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new Z(`Dimension incompatibility: ${t[r[0]]} !== ${n[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new Z(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],n=e[1],r;return r=Array.isArray(this.axes)?this.axes.map((t,n)=>c3(t,e[n].shape.length)):[c3(this.axes,t.shape.length),c3(this.axes,n.shape.length)],this.normalize&&(t=q0(t,r[0]),n=q0(n,r[1])),dAe(t,n,r)}interpretAxes(e,t){let n;return n=Array.isArray(this.axes)?this.axes:[c3(this.axes,e.length),c3(this.axes,t.length)],n}computeOutputShape(e){R(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");let t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new U$(`Dot layer does not support tensors of 4D or higher rank yet.`);let r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);let i=t.concat(n);return i.length===1&&i.push(1),i}computeMask(e,t){return null}getConfig(){let e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}};l3.className=`Dot`,X(l3);var u3=class extends S0{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=p0(e);return W1(()=>q(L1(n.shape,0,this.stddev),n),()=>n,t.training||!1)})}};u3.className=`GaussianNoise`,X(u3);var d3=class extends S0{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return G(()=>{this.invokeCallHook(e,t);let n=p0(e);return this.rate>0&&this.rate<1?W1(()=>{let e=Math.sqrt(this.rate/(1-this.rate));return J(n,L1(n.shape,1,e))},()=>n,t.training||!1):n})}};d3.className=`GaussianDropout`,X(d3);var f3=class extends S0{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||p0(e).shape}computeOutputShape(e){return e}getConfig(){let e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return G(()=>{if(this.rate<1&&this.rate>0){let n=this._getNoiseShape(e);return W1(()=>{let t=p0(e),r=-1.6732632423543772*1.0507009873554805,i=TX(rZ(n),this.rate);i=k1(i,`float32`);let a=((1-this.rate)*(1+this.rate*r**2))**-.5,o=-a*r*this.rate,s=q(J(t,i),J(q(i,-1),r));return q(J(s,a),o)},()=>p0(e),t.training||!1)}return e})}};f3.className=`AlphaDropout`,X(f3);function p3(e,t,n,r,i,a=.001){let o;if(e.rank===2)o=Gxe(e,t,n,r,i,a);else if(e.rank===3)o=qxe(e,t,n,r,i,a);else if(e.rank===4)o=Yxe(e,t,n,r,i,a);else throw new U$(`batchNormalization is not implemented for array of rank ${e.rank} yet`);return o}function fAe(e,t,n,r,i=.001){return G(()=>{let a=qX(e,r),o=a.mean,s=a.variance;return[p3(e,o,s,n,t,i),o,s]})}function pAe(e,t,n,r,i=.001){return G(()=>{let a=qX(e,r),o=a.mean,s=a.variance,c=[];for(let t of T1(0,e.rank))r.indexOf(t)===-1?c.push(e.shape[t]):c.push(1);let l=Y(o,c),u=Y(s,c),d=t==null?null:Y(t,c),f=n==null?null:Y(n,c);return[p3(e,l,u,f,d,i),o,s]})}function mAe(e,t,n,r,i=.001){return jU(r.slice().sort(),T1(0,e.rank-1))?fAe(e,t,n,r,i):pAe(e,t,n,r,i)}var m3=class extends S0{constructor(e){e??={},super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=u0(e.betaInitializer||`zeros`),this.gammaInitializer=u0(e.gammaInitializer||`ones`),this.movingMeanInitializer=u0(e.movingMeanInitializer||`zeros`),this.movingVarianceInitializer=u0(e.movingVarianceInitializer||`ones`),this.betaConstraint=z0(e.betaConstraint),this.gammaConstraint=z0(e.gammaConstraint),this.betaRegularizer=a4(e.betaRegularizer),this.gammaRegularizer=a4(e.gammaRegularizer)}build(e){e=m0(e);let t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(n==null)throw new Z(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new y0({ndim:e.length,axes:{[t]:n}})];let r=[n];this.scale&&(this.gamma=this.addWeight(`gamma`,r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight(`beta`,r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight(`moving_mean`,r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight(`moving_variance`,r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return G(()=>{let n=t.training==null?!1:t.training,r=p0(e),i=r.shape,a=i.length,o=T1(0,a),s=this.axis>=0?this.axis:this.axis+a;o.splice(s,1);let c=G$(1,a);c[s]=i[s];let l=o.slice();l.sort();let u=!jU(l,T1(0,a).slice(0,a-1)),d=()=>{if(u){let e=Y(this.movingMean.read(),c),t=Y(this.movingVariance.read(),c),n=this.center?Y(this.beta.read(),c):null,i=this.scale?Y(this.gamma.read(),c):null;return p3(r,e,t,n,i,this.epsilon)}else return p3(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!n)return d();let[f,p,m]=mAe(r,this.gamma.read(),this.beta.read(),o,this.epsilon),h=(e,t,n)=>{G(()=>{let r=1-n,i=e.read(),a=J(FX(i,t),r);e.write(FX(i,a))})};return h(this.movingMean,p,this.momentum),h(this.movingVariance,m,this.momentum),f})}getConfig(){let e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:l0(this.betaInitializer),gammaInitializer:l0(this.gammaInitializer),movingMeanInitializer:l0(this.movingMeanInitializer),movingVarianceInitializer:l0(this.movingVarianceInitializer),betaRegularizer:r4(this.betaRegularizer),gammaRegularizer:r4(this.gammaRegularizer),betaConstraint:L0(this.betaConstraint),gammaConstraint:L0(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}};m3.className=`BatchNormalization`,X(m3);var h3=class extends S0{constructor(e){if(e??={},super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis==`number`){if(!Number.isInteger(this.axis))throw Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(let e of this.axis)if(!Number.isInteger(e))throw Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=u0(e.betaInitializer||`zeros`),this.gammaInitializer=u0(e.gammaInitializer||`ones`),this.betaRegularizer=a4(e.betaRegularizer),this.gammaRegularizer=a4(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=m0(e);let t=e.length;typeof this.axis==`number`&&(this.axis=[this.axis]);for(let e=0;e<this.axis.length;++e)this.axis[e]<0&&(this.axis[e]+=t);for(let e of this.axis)if(e<0||e>=t)throw Error(`Invalid axis: ${e}`);if(this.axis.length!==r1(this.axis).length)throw Error(`Found duplicate axes in: ${this.axis}`);let n=this.axis.map(t=>e[t]);this.scale?this.gamma=this.addWeight(`gamma`,n,`float32`,this.gammaInitializer,this.gammaRegularizer,!0):this.gamma=null,this.center?this.beta=this.addWeight(`beta`,n,`float32`,this.betaInitializer,this.betaRegularizer,!0):this.beta=null,this.built=!0}call(e,t){let n=p0(e),r=n.shape,i=r.length;return G(()=>{let{mean:e,variance:t}=qX(n,this.axis,!0),a=G$(1,i);for(let e of this.axis)a[e]=r[e];let o=e=>e!=null&&e.shape.length!==i?Y(e,a):e,s=this.scale?o(this.gamma.read()):null,c=this.center?o(this.beta.read()):null,l=[],u=[];for(let e=0;e<i;++e)this.axis.indexOf(e)===-1?(l.push(1),u.push(r[e])):(l.push(r[e]),u.push(1));return e=bX(e,l),t=bX(t,l),s!=null&&(s=bX(s,u)),c!=null&&(c=bX(c,u)),p3(n,e,t,c,s,this.epsilon)})}getConfig(){let e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:l0(this.betaInitializer),gammaInitializer:l0(this.gammaInitializer),betaRegularizer:r4(this.betaRegularizer),gammaRegularizer:r4(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}};h3.className=`LayerNormalization`,X(h3);function hAe(e,t,n){return G(()=>{if(e.rank!==4)throw new Z(`temporalPadding expects input tensor to be 4-D, but received a ${e.rank}-D tensor.`);if(t??=[[1,1],[1,1]],t.length!==2||t[0].length!==2||t[1].length!==2)throw new Z("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n??=O1(),n!==`channelsLast`&&n!==`channelsFirst`)throw new Z(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return r=n===`channelsFirst`?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],ZX(e,r)})}var g3=class extends S0{constructor(e){if(e??={},super(e),this.dataFormat=e.dataFormat==null?O1():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding==`number`)this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new Z(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,n;if(typeof e.padding[0]==`number`)t=[e.padding[0],e.padding[0]],n=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new Z(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new Z(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);n=e.padding[1]}this.padding=[t,n]}this.inputSpec=[new y0({ndim:4})]}computeOutputShape(e){e=m0(e);let t,n;return this.dataFormat===`channelsFirst`?(t=e[2]!=null&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=e[3]!=null&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=e[1]!=null&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=e[2]!=null&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}call(e,t){return G(()=>hAe(p0(e),this.padding,this.dataFormat))}getConfig(){let e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}};g3.className=`ZeroPadding2D`,X(g3);function _3(e,t,n,r,i,a){return G(()=>{p1(i),h1(a),m1(r),n??=[1,1],r??=`valid`,i??=O1(),a??=`max`,e=h4(e,i);let o,s=r===`same`?`same`:`valid`;return o=a===`max`?VX(e,t,n,s):wY(e,t,n,s),i===`channelsFirst`&&(o=PZ(o,[0,3,1,2])),o})}function v3(e,t,n,r,i,a){return G(()=>{p1(i),h1(a),m1(r),n??=[1,1,1],r??=`valid`,i??=O1(),a??=`max`,e=g4(e,i);let o,s=r===`same`?`same`:`valid`;return o=a===`max`?NCe(e,t,n,s):Fxe(e,t,n,s),i===`channelsFirst`&&(o=PZ(o,[0,4,1,2,3])),o})}var y3=class extends S0{constructor(e){if(e.poolSize??=2,super(e),typeof e.poolSize==`number`)this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]==`number`)this.poolSize=e.poolSize;else throw new Z(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(o1(this.poolSize,`poolSize`),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides==`number`)this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]==`number`)this.strides=e.strides;else throw new Z(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);o1(this.strides,`strides`),this.padding=e.padding==null?`valid`:e.padding,m1(this.padding),this.inputSpec=[new y0({ndim:3})]}computeOutputShape(e){e=m0(e);let t=p4(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return G(()=>{this.invokeCallHook(e,t),e=A1(p0(e),2);let n=this.poolingFunction(p0(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,`channelsLast`);return CZ(n,[2])})}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}},b3=class extends y3{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return p1(i),m1(r),_3(e,t,n,r,i,`max`)}};b3.className=`MaxPooling1D`,X(b3);var x3=class extends y3{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return p1(i),m1(r),_3(e,t,n,r,i,`avg`)}};x3.className=`AveragePooling1D`,X(x3);var S3=class extends S0{constructor(e){if(e.poolSize??=[2,2],super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new Z(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];o1(this.poolSize,`poolSize`),o1(this.strides,`strides`),this.padding=e.padding==null?`valid`:e.padding,this.dataFormat=e.dataFormat==null?`channelsLast`:e.dataFormat,p1(this.dataFormat),m1(this.padding),this.inputSpec=[new y0({ndim:4})]}computeOutputShape(e){e=m0(e);let t=this.dataFormat===`channelsFirst`?e[2]:e[1],n=this.dataFormat===`channelsFirst`?e[3]:e[2];return t=p4(t,this.poolSize[0],this.padding,this.strides[0]),n=p4(n,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat===`channelsFirst`?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}call(e,t){return G(()=>(this.invokeCallHook(e,t),this.poolingFunction(p0(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},C3=class extends S3{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return p1(i),m1(r),_3(e,t,n,r,i,`max`)}};C3.className=`MaxPooling2D`,X(C3);var w3=class extends S3{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return p1(i),m1(r),_3(e,t,n,r,i,`avg`)}};w3.className=`AveragePooling2D`,X(w3);var T3=class extends S0{constructor(e){if(e.poolSize??=[2,2,2],super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new Z(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];o1(this.poolSize,`poolSize`),o1(this.strides,`strides`),this.padding=e.padding==null?`valid`:e.padding,this.dataFormat=e.dataFormat==null?`channelsLast`:e.dataFormat,p1(this.dataFormat),m1(this.padding),this.inputSpec=[new y0({ndim:5})]}computeOutputShape(e){e=m0(e);let t=this.dataFormat===`channelsFirst`?e[2]:e[1],n=this.dataFormat===`channelsFirst`?e[3]:e[2],r=this.dataFormat===`channelsFirst`?e[4]:e[3];return t=p4(t,this.poolSize[0],this.padding,this.strides[0]),n=p4(n,this.poolSize[1],this.padding,this.strides[1]),r=p4(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat===`channelsFirst`?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}call(e,t){return G(()=>(this.invokeCallHook(e,t),this.poolingFunction(p0(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){let e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},E3=class extends T3{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return p1(i),m1(r),v3(e,t,n,r,i,`max`)}};E3.className=`MaxPooling3D`,X(E3);var D3=class extends T3{constructor(e){super(e)}poolingFunction(e,t,n,r,i){return p1(i),m1(r),v3(e,t,n,r,i,`avg`)}};D3.className=`AveragePooling3D`,X(D3);var O3=class extends S0{constructor(e){super(e),this.inputSpec=[new y0({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new U$}},k3=class extends O3{constructor(e){super(e||{})}call(e,t){return G(()=>{let t=p0(e);return UX(t,1)})}};k3.className=`GlobalAveragePooling1D`,X(k3);var A3=class extends O3{constructor(e){super(e||{})}call(e,t){return G(()=>{let t=p0(e);return lX(t,1)})}};A3.className=`GlobalMaxPooling1D`,X(A3);var j3=class extends S0{constructor(e){super(e),this.dataFormat=e.dataFormat==null?`channelsLast`:e.dataFormat,p1(this.dataFormat),this.inputSpec=[new y0({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat===`channelsLast`?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new U$}getConfig(){let e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}},M3=class extends j3{call(e,t){return G(()=>{let t=p0(e);return this.dataFormat===`channelsLast`?UX(t,[1,2]):UX(t,[2,3])})}};M3.className=`GlobalAveragePooling2D`,X(M3);var N3=class extends j3{call(e,t){return G(()=>{let t=p0(e);return this.dataFormat===`channelsLast`?lX(t,[1,2]):lX(t,[2,3])})}};N3.className=`GlobalMaxPooling2D`,X(N3);var P3=class extends S0{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer==null?!1:this.layer.trainable}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){let e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,n={}){let r=t.layer,i=K0(r,n);delete t.layer;let a={layer:i};return Object.assign(a,t),new e(a)}},F3=class extends P3{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=m0(e),e.length<3)throw new Z(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];let t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=m0(e);let t=[e[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}call(e,t){return G(()=>(e=p0(e),j4((e,n)=>[p0(this.layer.call(e,t)),[]],e,[],!1,null,null,!1,!0)[1]))}};F3.className=`TimeDistributed`,X(F3);function gAe(e){i1(NOe,`BidirectionalMergeMode`,e)}var _Ae=`concat`,I3=class extends P3{constructor(e){super(e);let t=e.layer.getConfig(),n={};n.className=e.layer.getClassName(),n.config=t,this.forwardLayer=K0(n),t.goBackwards=t.goBackwards!==!0;let r={};if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=K0(r),this.forwardLayer.name=`forward_`+this.forwardLayer.name,this.backwardLayer.name=`backward_`+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?_Ae:e.mergeMode,gAe(this.mergeMode),e.weights)throw new U$(`weights support is not implemented for Bidirectional layer yet.`);this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){let t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let n,r,i;return this.returnState&&(i=t.slice(1)),n=t[0],n=n,this.mergeMode===`concat`?(n[n.length-1]*=2,r=[n]):r=this.mergeMode==null?[n,n.slice()]:[n],this.returnState?this.mergeMode==null?r.concat(i).concat(i.slice()):[n].concat(i,i.slice()):J$(r)}apply(e,t){let n=t==null?null:t.initialState,r=t==null?null:t.constants;t??={};let i=A4(e,n,r,this.numConstants);if(e=i.inputs,n=i.initialState,r=i.constants,Array.isArray(e)&&(n=e.slice(1),e=e[0]),(n==null||n.length===0)&&r==null)return super.apply(e,t);let a=[],o=[];if(n!=null){let e=n.length;if(e%2>0)throw new Z("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=n,a.push(...n);let r=n.map(e=>new y0({shape:e.shape}));this.forwardLayer.stateSpec=r.slice(0,e/2),this.backwardLayer.stateSpec=r.slice(e/2),o.push(...r)}if(r!=null)throw new U$(`Support for constants in Bidirectional layers is not implemented yet.`);let s=a[0]instanceof b0;for(let e of a)if(e instanceof b0!==s)throw new Z(`The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors`);if(s){let n=[e].concat(a),r=this.inputSpec.concat(o),i=this.inputSpec;this.inputSpec=r;let s=super.apply(n,t);return this.inputSpec=i,s}else return super.apply(e,t)}call(e,t){return G(()=>{let n=t.initialState,r,i;if(n==null)r=this.forwardLayer.call(e,t),i=this.backwardLayer.call(e,t);else{let a=n.slice(0,n.length/2),o=n.slice(n.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:a})),i=this.backwardLayer.call(e,Object.assign(t,{initialState:o}))}let a;this.returnState&&(Array.isArray(r)&&(a=r.slice(1).concat(i.slice(1))),r=r[0],i=i[0]),this.returnSequences&&(i=cZ(i,1));let o;return this.mergeMode===`concat`?o=P1([r,i]):this.mergeMode===`sum`?o=q(r,i):this.mergeMode===`ave`?o=J(.5,q(r,i)):this.mergeMode===`mul`?o=J(r,i):this.mergeMode??(o=[r,i]),this.returnState?this.mergeMode==null?o.concat(a):[o].concat(a):o})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){v1(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),v1(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let n;if(n=this.returnSequences?this.mergeMode==null?[t,t]:t:this.mergeMode==null?[null,null]:null,this.returnState){let e=this.forwardLayer.states.map(e=>null);return Array.isArray(n)?n.concat(e).concat(e):[n].concat(e,e)}else return n}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){let e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){let n=K0(t.layer);if(delete t.layer,t.numConstants!=null)throw new U$(`Deserialization of a Bidirectional layer with numConstants present is not supported yet.`);let r=t;return r.layer=n,new e(r)}};I3.className=`Bidirectional`,X(I3);var L3=class extends S0{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){let e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return G(()=>(e=p0(e),e.dtype!==`float32`&&(e=k1(e,`float32`)),q(J(e,this.scale),this.offset)))}};L3.className=`Rescaling`,X(L3);var{resizeBilinear:vAe,cropAndResize:yAe}=XZ,R3=class extends S0{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,t,n,r,i,a,o,s){return G(()=>{let c,l=!1,u=t/a,d=n/o,f=(r+t)/a,p=(i+n)/o,m=[u,d,f,p],h=[];e.rank===3?(l=!0,c=wZ([e])):c=e;for(let e=0;e<c.shape[0];e++)h.push(m);let g=xJ(h,[h.length,4]),_=iZ(0,h.length,1,`int32`),v=yAe(c,g,_,[r,i],`nearest`);return k1(l?p0(MZ(v)):v,s)})}upsize(e,t,n,r){return G(()=>{let i=vAe(e,[t,n]);return k1(i,r)})}call(e,t){return G(()=>{let t=p0(e),n=t.dtype,r=t.shape,i=r[r.length-3],a=r[r.length-2],o=0;i!==this.height&&(o=Math.floor((i-this.height)/2));let s=0;return a!==this.width&&(s=Math.floor((a-this.width)/2),s===0&&(s=1)),o>=0&&s>=0?this.centerCrop(t,o,s,this.height,this.width,i,a,n):this.upsize(e,this.height,this.width,n)})}getConfig(){let e={height:this.height,width:this.width},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=m0(e);let t=e.length-3,n=e.length-2;return e[t]=this.height,e[n]=this.width,e}};R3.className=`CenterCrop`,X(R3);function bAe(e,t,n,r){let i=p0(e);if(i.dtype!==`int32`&&(i=k1(i,`int32`)),t===`int`)return i;let a=i.shape;if(i.rank===0&&(i=yX(i,-1)),t===`oneHot`&&i.shape[i.shape.length-1]!==1&&(i=yX(i,-1)),i.rank>2)throw new Z(`When outputMode is not int, maximum output rank is 2 Received outputMode ${t} and input shape ${a} which would result in output rank ${i.rank}.`);let o=[`multiHot`,`oneHot`].includes(t),s=i,c;if(c=r!==void 0&&t===`count`?WY(s,r,n,o):WY(s,[],n,o),t!==`tfIdf`)return c;if(r)return J(c,r);throw new Z(`When outputMode is 'tfIdf', weights must be provided.`)}var z3=class extends S0{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode=`multiHot`}getConfig(){let e={numTokens:this.numTokens,outputMode:this.outputMode},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){return e=m0(e),e==null?[this.numTokens]:this.outputMode===`oneHot`&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,t){return G(()=>{e=p0(e),e.dtype!==`int32`&&(e=k1(e,`int32`));let n;if(t.countWeights!==void 0){if(this.outputMode!==`count`)throw new Z(`countWeights is not used when outputMode !== count.
              Received countWeights=${t.countWeights}`);n=p0(t.countWeights)}let r=lX(e),i=uX(e),a=wX(this.numTokens,r).bufferSync().get(0),o=TX(i,0).bufferSync().get(0);if(!(a&&o))throw new Z(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return bAe(e,this.outputMode,this.numTokens,n)})}};z3.className=`CategoryEncoding`,X(z3);var B3=new Set([`bilinear`,`nearest`]),V3=class extends S0{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(B3.has(e.interpolation))this.interpolation=e.interpolation;else throw new Z(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation=`bilinear`;this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=m0(e);let t=e[2];return[this.height,this.width,t]}getConfig(){let e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return G(()=>{let t=[this.height,this.width];if(this.interpolation===`bilinear`)return XZ.resizeBilinear(e,t,!this.cropToAspectRatio);if(this.interpolation===`nearest`)return XZ.resizeNearestNeighbor(e,t,!this.cropToAspectRatio);throw Error(`Interpolation is ${this.interpolation} but only ${[...B3]} are supported`)})}};V3.className=`Resizing`,X(V3);
/**
* @license
* Copyright 2023 CodeSmith LLC
*
* Use of this source code is governed by an MIT-style
* license that can be found in the LICENSE file or at
* https://opensource.org/licenses/MIT.
* =============================================================================
*/
var H3=class{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}};H3.className=`RandomSeed`;var U3=class extends S0{constructor(e){super(e),this.randomGenerator=new H3(e.seed)}getConfig(){let e={seed:this.randomGenerator.seed},t=super.getConfig();return Object.assign(e,t),e}};U3.className=`BaseRandomLayer`;const W3=new Set([`bilinear`,`nearest`]);var G3=class extends U3{constructor(e){super(e);let{factor:t,interpolation:n=`bilinear`}=e;if(this.factor=t,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new Z(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new Z(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new Z(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(n)if(W3.has(n))this.interpolation=n;else throw new Z(`Invalid interpolation parameter: ${n} is not implemented`)}getConfig(){let e={factor:this.factor,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}computeOutputShape(e){e=m0(e);let t=e[2];return[this.imgHeight,-1,t]}call(e,t){return G(()=>{let t=p0(e);this.imgHeight=t.shape[t.shape.length-3];let n=t.shape[t.shape.length-2];this.widthFactor=rZ([1],1+this.widthLower,1+this.widthUpper,`float32`,this.randomGenerator.next());let r=this.widthFactor.dataSync()[0]*n;r=Math.round(r);let i=[this.imgHeight,r];switch(this.interpolation){case`bilinear`:return XZ.resizeBilinear(e,i);case`nearest`:return XZ.resizeNearestNeighbor(e,i);default:throw Error(`Interpolation is ${this.interpolation}
          but only ${[...W3]} are supported`)}})}};G3.className=`RandomWidth`,X(G3);function K3(e){return new q4(e)}B().registerFlag(`KEEP_INTERMEDIATE_TENSORS`,()=>!1,e=>{e&&console.warn(`Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.`)});
/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*
* =============================================================================
*/
var xAe;(function(e){e[e.DT_INVALID=0]=`DT_INVALID`,e[e.DT_FLOAT=1]=`DT_FLOAT`,e[e.DT_DOUBLE=2]=`DT_DOUBLE`,e[e.DT_INT32=3]=`DT_INT32`,e[e.DT_UINT8=4]=`DT_UINT8`,e[e.DT_INT16=5]=`DT_INT16`,e[e.DT_INT8=6]=`DT_INT8`,e[e.DT_STRING=7]=`DT_STRING`,e[e.DT_COMPLEX64=8]=`DT_COMPLEX64`,e[e.DT_INT64=9]=`DT_INT64`,e[e.DT_BOOL=10]=`DT_BOOL`,e[e.DT_QINT8=11]=`DT_QINT8`,e[e.DT_QUINT8=12]=`DT_QUINT8`,e[e.DT_QINT32=13]=`DT_QINT32`,e[e.DT_BFLOAT16=14]=`DT_BFLOAT16`,e[e.DT_QINT16=15]=`DT_QINT16`,e[e.DT_QUINT16=16]=`DT_QUINT16`,e[e.DT_UINT16=17]=`DT_UINT16`,e[e.DT_COMPLEX128=18]=`DT_COMPLEX128`,e[e.DT_HALF=19]=`DT_HALF`,e[e.DT_RESOURCE=20]=`DT_RESOURCE`,e[e.DT_VARIANT=21]=`DT_VARIANT`,e[e.DT_UINT32=22]=`DT_UINT32`,e[e.DT_UINT64=23]=`DT_UINT64`,e[e.DT_FLOAT_REF=101]=`DT_FLOAT_REF`,e[e.DT_DOUBLE_REF=102]=`DT_DOUBLE_REF`,e[e.DT_INT32_REF=103]=`DT_INT32_REF`,e[e.DT_UINT8_REF=104]=`DT_UINT8_REF`,e[e.DT_INT16_REF=105]=`DT_INT16_REF`,e[e.DT_INT8_REF=106]=`DT_INT8_REF`,e[e.DT_STRING_REF=107]=`DT_STRING_REF`,e[e.DT_COMPLEX64_REF=108]=`DT_COMPLEX64_REF`,e[e.DT_INT64_REF=109]=`DT_INT64_REF`,e[e.DT_BOOL_REF=110]=`DT_BOOL_REF`,e[e.DT_QINT8_REF=111]=`DT_QINT8_REF`,e[e.DT_QUINT8_REF=112]=`DT_QUINT8_REF`,e[e.DT_QINT32_REF=113]=`DT_QINT32_REF`,e[e.DT_BFLOAT16_REF=114]=`DT_BFLOAT16_REF`,e[e.DT_QINT16_REF=115]=`DT_QINT16_REF`,e[e.DT_QUINT16_REF=116]=`DT_QUINT16_REF`,e[e.DT_UINT16_REF=117]=`DT_UINT16_REF`,e[e.DT_COMPLEX128_REF=118]=`DT_COMPLEX128_REF`,e[e.DT_HALF_REF=119]=`DT_HALF_REF`,e[e.DT_RESOURCE_REF=120]=`DT_RESOURCE_REF`,e[e.DT_VARIANT_REF=121]=`DT_VARIANT_REF`,e[e.DT_UINT32_REF=122]=`DT_UINT32_REF`,e[e.DT_UINT64_REF=123]=`DT_UINT64_REF`})(xAe||={});var SAe;(function(e){(function(e){e[e.LEGACY=0]=`LEGACY`,e[e.V1=1]=`V1`,e[e.V2=2]=`V2`})(e.CheckpointFormatVersion||={})})(SAe||={});function CAe(e,t){return q3(e,t)}function q3(e,t,n=new Map,r=new Set){if(e==null)return null;if(typeof Blob==`function`&&e instanceof Blob)return e.slice();if(r.has(e))throw Error(`Circular references are not supported.`);if(n.has(e))return n.get(e);let i=t(e);if(i.recurse&&i.value!==null)throw Error(`A deep map function may not return both a value and recurse=true.`);if(i.recurse)if(X3(e)){let i=Array.isArray(e)?[]:{};for(let a in r.add(e),e){let o=e[a];i[a]=q3(o,t,n,r)}return r.delete(e),e.__proto__&&(i.__proto__=e.__proto__),i}else throw Error(`Can't recurse into non-iterable type: ${e}`);else return n.set(e,i.value),i.value}function wAe(e,t=Y3){return J3(e,t)}function J3(e,t,n=new Set){let r=e[0];if(n.has(r))throw Error(`Circular references are not supported.`);let i=t(e);if(i.recurse&&i.value!==null)throw Error(`A deep zip function may not return both a value and recurse=true.`);if(i.recurse)if(X3(r)){let i=Array.isArray(r)?[]:{};for(let a in n.add(r),r){let r=e.map(e=>e[a]);i[a]=J3(r,t,n)}return n.delete(r),i}else throw Error(`Can't recurse into non-iterable type: ${r}`);else return i.value}function Y3(e){return e===null?null:X3(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function X3(e){let t=!1;if(B().get(`IS_BROWSER`))t=e instanceof TextDecoder;else{let{StringDecoder:n}=$J();t=e instanceof n}return e!=null&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||typeof e==`object`&&!(e instanceof qq)&&!(e instanceof Promise)&&!t)}function TAe(e){return e==null||EAe(e)||Array.isArray(e)||typeof e==`object`&&e instanceof qq||Fq(e)}function EAe(e){return e===null||typeof e!=`object`&&typeof e!=`function`}function DAe(e){return CAe(e,OAe)}function OAe(e){return e instanceof qq?{value:e.clone(),recurse:!1}:X3(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}
/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*
* =============================================================================
*/
var Z3=class{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,e==null)throw RangeError(`Can't create a ring buffer of unknown capacity.`);if(e<1)throw RangeError(`Can't create ring buffer of capacity < 1.`);this.data=Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw RangeError(`Can't get item at a negative index.`);return this.data[e%this.capacity]}set(e,t){if(e<0)throw RangeError(`Can't set item at a negative index.`);this.data[e%this.capacity]=t}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(e){if(this.isFull())throw RangeError(`Ring buffer is full.`);this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(let t of e)this.push(t)}pop(){if(this.isEmpty())throw RangeError(`Ring buffer is empty.`);this.end=this.wrap(this.end-1);let e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw RangeError(`Ring buffer is full.`);this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw RangeError(`Ring buffer is empty.`);let e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw RangeError(`Ring buffer is empty.`);let t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}},Q3=class e extends Z3{constructor(){super(e.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){let e=this.capacity*2,t=Array(e),n=this.length();for(let e=0;e<n;e++)t[e]=this.get(this.wrap(this.begin+e));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}};Q3.INITIAL_CAPACITY=32;var kAe=l(eZ());function AAe(e){return new NAe(e)}function jAe(e){return new PAe(e)}function MAe(e,t){return new t6(e,t)}var $3=class{async toArray(){let e=[],t=await this.next();for(;!t.done;)e.push(t.value),t=await this.next();return e}async toArrayForTest(){let e=this.prefetch(100),t=[],n=await e.next();for(;!n.done;)t.push(n.value),n=await e.next();return t}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let t=await this.next(),n=e(t.value);for(;!t.done&&n;)t=await this.next(),n=e(t.value)}handleErrors(e){return new VAe(this,e)}filter(e){return new zAe(this,e)}map(e){return new BAe(this,e)}mapAsync(e){return new e6(this,e)}serialMapAsync(e){return new e6(this,e).serial()}flatmap(e){return new UAe(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(e=>e===!0)}rowMajorBatch(e,t=!0){return new RAe(this,e,t)}columnMajorBatch(e,t=!0,n=Y3){return this.rowMajorBatch(e,t).map(e=>wAe(e,n))}concatenate(e,t){return new t6(AAe([this,e]),t)}take(e){return e<0||e==null?this:new LAe(this,e)}skip(e){return e<0||e==null?this:new IAe(this,e)}prefetch(e){return new n6(this,e)}shuffle(e,t){return new GAe(this,e,t)}serial(){return new FAe(this)}},NAe=class extends $3{constructor(e){super(),this.items=e,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};let e=this.items[this.trav];return this.trav++,{value:DAe(e),done:!1}}},PAe=class extends $3{constructor(e){super(),this.nextFn=e}summary(){return`Function call`}async next(){try{return this.nextFn()}catch(e){throw e.message=`Error thrown while iterating through a dataset: ${e.message}`,e}}},FAe=class extends $3{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}},IAe=class extends $3{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){let e=await this.upstream.next();if(e.done)return e;EJ(e.value)}return this.upstream.next()}},LAe=class extends $3{constructor(e,t){super(),this.upstream=e,this.maxCount=t,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}},RAe=class extends $3{constructor(e,t,n=!0){super(),this.upstream=e,this.batchSize=t,this.enableSmallLastBatch=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){let e=[];for(;e.length<this.batchSize;){let t=await this.upstream.next();if(t.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(t.value)}return{value:e,done:!1}}},zAe=class extends $3{constructor(e,t){super(),this.upstream=e,this.predicate=t,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){let e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;EJ(e.value)}}},BAe=class extends $3{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Map`}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=aJ(e.value),n=this.transform(e.value),r=aJ(n);for(let e of t)iJ(e,r)||e.dispose();return{value:n,done:!1}}},VAe=class extends $3{constructor(e,t){super(),this.upstream=e,this.handler=t,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(e){if(!this.handler(e))return{value:null,done:!0}}}},e6=class extends $3{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){let e=await this.upstream.next();if(e.done)return{value:null,done:!0};let t=aJ(e.value),n=await this.transform(e.value),r=aJ(n);for(let e of t)iJ(e,r)||e.dispose();return{value:n,done:!1}}},HAe=class extends $3{constructor(){super(),this.outputQueue=new Q3,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.outputQueue.length()===0;)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}},UAe=class extends HAe{constructor(e,t){super(),this.upstream=e,this.transform=t}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){let e=await this.upstream.next();if(e.done)return!1;let t=aJ(e.value),n=this.transform(e.value),r=aJ(n);this.outputQueue.pushAll(n);for(let e of t)iJ(e,r)||e.dispose();return!0}},t6=class extends $3{constructor(e,t){super(),this.baseErrorHandler=t,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return`TODO: fill in upstream of chained summaries -> Chained`}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,this.iterator==null){let e=await this.moreIterators.next();if(e.done)return{value:null,done:!0};this.iterator=e.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}let t=await this.iterator.next();return t.done?(this.iterator=null,this.readFromChain(e)):t}},WAe;(function(e){e[e.FAIL=0]=`FAIL`,e[e.SHORTEST=1]=`SHORTEST`,e[e.LONGEST=2]=`LONGEST`})(WAe||={});var n6=class extends $3{constructor(e,t){super(),this.upstream=e,this.bufferSize=t,this.buffer=new Z3(t)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){let e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}},GAe=class extends n6{constructor(e,t,n){super(e,t),this.upstream=e,this.windowSize=t,this.upstreamExhausted=!1,this.random=kAe.alea(n||Mq().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){let e=this.chooseIndex(),t=await this.buffer.shuffleExcise(e);if(t.done)this.upstreamExhausted=!0;else return this.refill(),t}return{value:null,done:!0}}},KAe=l(eZ()),r6=class{constructor(){this.size=null}batch(e,t=!0){let n=this;R(e>0,()=>`batchSize needs to be positive, but it is
      ${e}`);let r;return r=this.size===1/0||this.size==null?this.size:t?Math.ceil(this.size/e):Math.floor(this.size/e),i6(async()=>(await n.iterator()).columnMajorBatch(e,t,qAe),r)}concatenate(e){let t=this,n;return n=this.size===1/0||e.size===1/0?1/0:this.size!=null&&e.size!=null?this.size+e.size:null,i6(async()=>(await t.iterator()).concatenate(await e.iterator()),n)}filter(e){let t=this,n;return n=this.size===1/0?1/0:null,i6(async()=>(await t.iterator()).filter(t=>G(()=>e(t))),n)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){let t=this;return i6(async()=>(await t.iterator()).map(t=>G(()=>e(t))),this.size)}mapAsync(e){let t=this;return i6(async()=>(await t.iterator()).mapAsync(e),this.size)}prefetch(e){if(e==null)throw RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");let t=this;return i6(async()=>(await t.iterator()).prefetch(e),this.size)}repeat(e){let t=this,n;return n=this.size!=null&&e>0?this.size*e:e===0?0:this.size!=null&&(e===void 0||e<0)?1/0:null,i6(async()=>{let n=jAe(async()=>({value:await t.iterator(),done:!1}));return MAe(n.take(e))},n)}skip(e){let t=this,n;return n=this.size!=null&&e>=0&&this.size>=e?this.size-e:this.size!=null&&(this.size<e||e===void 0||e<0)?0:null,i6(async()=>(await t.iterator()).skip(e),n)}shuffle(e,t,n=!0){if(e==null||e<0)throw this.size==null?RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);let r=this,i=KAe.alea(t||Mq().toString());return i6(async()=>{let t=i.int32();return n&&(t+=i.int32()),(await r.iterator()).shuffle(e,t.toString())},this.size)}take(e){let t=this,n;return n=this.size!=null&&this.size>e?e:this.size!=null&&this.size<=e?this.size:null,i6(async()=>(await t.iterator()).take(e),n)}async toArray(){if(this.size===1/0)throw Error(`Can not convert infinite data stream to array.`);return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw Error(`Can not convert infinite data stream to array.`);return(await this.iterator()).toArrayForTest()}};r6.MAX_BUFFER_SIZE=1e4;function i6(e,t=null){return new class extends r6{constructor(){super(...arguments),this.size=t}async iterator(){return e()}}}function qAe(e){if(e===null)return null;let t=e[0];return TAe(t)?{value:JAe(e),recurse:!1}:{value:null,recurse:!0}}function JAe(e){if(e.length===0)throw Error(`Can't make a batch of zero elements.`);return e[0]instanceof qq?wZ(e):xJ(e)}function a6(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{e!=null&&R(e.dtype!==`complex64`,()=>`${t} does not support complex64 tensors in the CPU backend.`)})}var YAe=NZ,o6=class e extends SU{nextDataId(){return e.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new xU(this,wJ())}write(e,t,n){this.firstUse&&(this.firstUse=!1,B().get(`IS_NODE`)&&cq(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));let r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}makeTensorInfo(e,t,n){let r;if(t===`string`&&n!=null&&n.length>0&&KU(n[0])){let i=n.map(e=>Nq(e));r=this.write(i,e,t)}else r=this.write(n,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){let t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){let t=this.data.get(e);t.refCount--}}move(e,t,n,r,i){this.data.set(e,{values:t,dtype:r,refCount:i})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){let{dtype:t,complexTensorInfos:n}=this.data.get(e);if(t===`complex64`){let e=this.readSync(n.real.dataId),t=this.readSync(n.imag.dataId);return $Q(e,t)}return tW(this.data.get(e).values,t)}bufferSync(e){let t=this.readSync(e.dataId);if(e.dtype===`string`)try{let n=t.map(e=>Pq(e));return tY(e.shape,e.dtype,n)}catch{throw Error(`Failed to decode encoded string bytes into utf-8`)}return tY(e.shape,e.dtype,t)}makeOutput(e,t,n){return wJ().makeTensorFromTensorInfo(this.makeTensorInfo(t,n,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;let{complexTensorInfos:n}=this.data.get(e);n!=null&&(this.disposeData(n.real.dataId,!0),this.disposeData(n.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){let t=Mq();return e(),{kernelMs:Mq()-t}}memory(){return{unreliable:!0,reasons:[`The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less.`]}}where(e){a6([e],`where`);let t=this.readSync(e.dataId);return YAe(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}};o6.nextDataId=0;function s6(e){let t=new Float32Array(e.length);for(let n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}const XAe={kernelName:`Abs`,backendName:`cpu`,kernelFunc:e=>{let{x:t}=e.inputs,n=e.backend;a6(t,`abs`);let r=new Float32Array(z(t.shape)),i=n.data.get(t.dataId).values;return r=s6(i),n.makeOutput(r,t.shape,t.dtype)}};function c6(e){return(t,n,r,i,a)=>{let o=JY(t,n),s=o.length,c=QU(o),l=z(o),u=zU(a,l),d=t.length,f=n.length,p=QU(t),m=QU(n),h=KY(t,o),g=KY(n,o);if(h.length+g.length===0)for(let t=0;t<u.length;++t)u[t]=e(r[t%r.length],i[t%i.length]);else for(let t=0;t<u.length;++t){let n=sW(t,s,c),a=n.slice(-d);h.forEach(e=>a[e]=0);let o=oW(a,d,p),l=n.slice(-f);g.forEach(e=>l[e]=0);let _=oW(l,f,m);u[t]=e(r[o],i[_])}return[u,o]}}function l6(e){let{inputs:t,backend:n}=e,{real:r,imag:i}=t,a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,s=n.makeTensorInfo(r.shape,`complex64`),c=n.data.get(s.dataId);return c.complexTensorInfos={real:n.makeTensorInfo(r.shape,`float32`,a),imag:n.makeTensorInfo(i.shape,`float32`,o)},s}const ZAe={kernelName:VW,backendName:`cpu`,kernelFunc:l6};function u6(e,t,n=`float32`){if(n===`complex64`){let n=u6(e,t,`float32`),r=u6(e,t,`float32`);return l6({inputs:{real:n,imag:r},backend:e})}let r=rW(z(t),n);return e.makeTensorInfo(t,n,r)}function d6(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const QAe={kernelName:wG,backendName:`cpu`,kernelFunc:d6};function f6(e){let{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.real,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}const $Ae={kernelName:uK,backendName:`cpu`,kernelFunc:f6};function p6(e,t,n,r){if(r===`int32`){let n=Int32Array.from(e);return[t,`int32`,n]}if(r===`bool`){let r=jq([0],n),[i,a]=c6((e,t)=>e===t?0:1)(t,[],e,r,`bool`);return[a,`bool`,i]}throw Error(`Error in Cast: failed to cast ${n} to ${r}`)}function m6(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:a}=r;if(a===`complex64`){if(i.dtype===`complex64`)return d6({inputs:{x:i},backend:n});let e=u6(n,i.shape,i.dtype),t=m6({inputs:{x:i},backend:n,attrs:{dtype:`float32`}}),r=l6({inputs:{real:t,imag:e},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),r}if(i.dtype===`complex64`){let e=f6({inputs:{input:i},backend:n}),t=m6({inputs:{x:e},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(e),t}if(!UU(i.dtype,a)){let e=d6({inputs:{x:i},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:a}}let o=n.data.get(i.dataId).values,[s,c,l]=p6(o,i.shape,i.dtype,a);return n.makeTensorInfo(s,c,l)}const eje={kernelName:RW,backendName:`cpu`,kernelFunc:m6};function h6(e,t,n,r){return n==null?({inputs:n,backend:i})=>{let{a,b:o}=n,s=i;a6([a,o],e);let c=s.data.get(a.dataId).values,l=s.data.get(o.dataId).values,u=a.dtype===`string`?j$(c):c,d=a.dtype===`string`?j$(l):l,f=r||a.dtype,[p,m]=t(a.shape,o.shape,u,d,f);return s.makeTensorInfo(m,f,p)}:({inputs:e,backend:i})=>{let{a,b:o}=e,s=i;if(a.dtype===`complex64`||o.dtype===`complex64`){let e=m6({inputs:{x:a},backend:s,attrs:{dtype:`complex64`}}),t=s.data.get(e.dataId),r=t.complexTensorInfos.real,i=t.complexTensorInfos.imag,c=s.data.get(r.dataId).values,l=s.data.get(i.dataId).values,u=m6({inputs:{x:o},backend:s,attrs:{dtype:`complex64`}}),d=s.data.get(u.dataId),f=d.complexTensorInfos.real,p=d.complexTensorInfos.imag,m=s.data.get(f.dataId).values,h=s.data.get(p.dataId).values,[g,_,v]=n(a.shape,o.shape,c,l,m,h),y=s.makeTensorInfo(v,`float32`,g),b=s.makeTensorInfo(v,`float32`,_),x=l6({inputs:{real:y,imag:b},backend:s});return s.disposeIntermediateTensorInfo(e),s.disposeIntermediateTensorInfo(u),s.disposeIntermediateTensorInfo(y),s.disposeIntermediateTensorInfo(b),x}else{let e=s.data.get(a.dataId).values,n=s.data.get(o.dataId).values,i=r||a.dtype,[c,l]=t(a.shape,o.shape,e,n,i);return s.makeTensorInfo(l,i,c)}}}function g6(e){return(t,n,r,i,a,o)=>{let s=JY(t,n),c=z(s),l=s.length,u=QU(s),d=zU(`float32`,c),f=zU(`float32`,c),p=KY(t,s),m=KY(n,s),h=$Q(r,i),g=$Q(a,o),_=t.length,v=QU(t),y=n.length,b=QU(n);if(p.length+m.length===0)for(let t=0;t<d.length;t++){let n=t%h.length,r=t%g.length,i=e(h[n*2],h[n*2+1],g[r*2],g[r*2+1]);d[t]=i.real,f[t]=i.imag}else for(let t=0;t<d.length;t++){let n=sW(t,l,u),r=n.slice(-_);p.forEach(e=>r[e]=0);let i=oW(r,_,v),a=n.slice(-y);m.forEach(e=>a[e]=0);let o=oW(a,y,b),s=e(h[i*2],h[i*2+1],g[o*2],g[o*2+1]);d[t]=s.real,f[t]=s.imag}return[d,f,s]}}const _6=c6(((e,t)=>e+t)),tje=g6(((e,t,n,r)=>({real:e+n,imag:t+r}))),v6=h6(`Add`,_6,tje),nje={kernelName:`Add`,backendName:`cpu`,kernelFunc:v6};function y6(e,t,n,r,i){let a=z(r),o=rW(i,n);for(let n=0;n<e.length;n++){let r=e[n];if(r<0)throw Error(`Input x must be non-negative!`);r>=i||(a>0?o[r]+=t[n]:o[r]+=1)}return o}function b6(e,t,n,r=!1){let i=e.shape[0],a=e.shape[1],o=tY([i,n],t.dtype);for(let s=0;s<i;s++)for(let i=0;i<a;i++){let a=e.get(s,i);if(a<0)throw Error(`Input x must be non-negative!`);a>=n||(r?o.set(1,s,a):t.size>0?o.set(o.get(s,a)+t.get(s,i),s,a):o.set(o.get(s,a)+1,s,a))}return o}const x6=c6(((e,t)=>e&t)),rje=h6(IW,x6),ije={kernelName:IW,backendName:`cpu`,kernelFunc:rje};function S6(e){return(t,n,r)=>{let i=BU(n,t.length);for(let n=0;n<t.length;++n)i[n]=e(t[n],r);return i}}function C6(e,t,n){let r=S6(t);return w6(e,r,n)}function w6(e,t,n){return({inputs:r,attrs:i,backend:a})=>{let{x:o}=r;a6(o,e);let s=a,c=s.data.get(o.dataId).values,l;if(o.dtype===`string`){if(!Array.isArray(c))throw Error(`String tensor's value was not an instance of Array`);l=j$(c)}else l=c;let u=n||o.dtype,d=t(l,u,i);return s.makeTensorInfo(o.shape,u,d)}}const T6=S6(e=>Math.ceil(e)),aje=w6(zW,T6),oje={kernelName:zW,backendName:`cpu`,kernelFunc:aje};function E6(e,t,n,r){let i=BU(n,z(t));if(r&&n!==`string`){let t=0;e.forEach(e=>{let n=z(e.shape);i.set(e.vals,t),t+=n})}else{let r=0;e.forEach(e=>{let a=n===`string`?j$(e.vals):e.vals,o=0;for(let n=0;n<e.shape[0];++n){let s=n*t[1]+r;for(let t=0;t<e.shape[1];++t)i[s+t]=a[o++]}r+=e.shape[1]})}return i}const D6=c6((e,t)=>e===t?1:0),O6=h6(fG,D6,null,`bool`),sje={kernelName:fG,backendName:`cpu`,kernelFunc:O6},k6=S6(e=>Math.exp(e)),A6=w6(`Exp`,k6,`float32`),cje={kernelName:`Exp`,backendName:`cpu`,kernelFunc:A6},j6=S6(e=>Math.expm1(e)),lje=w6(mG,j6),uje={kernelName:mG,backendName:`cpu`,kernelFunc:lje},M6=S6(e=>Math.floor(e)),dje=w6(_G,M6),fje={kernelName:_G,backendName:`cpu`,kernelFunc:dje},N6=c6((e,t)=>Math.floor(e/t)),pje=h6(vG,N6,null,`int32`),mje={kernelName:vG,backendName:`cpu`,kernelFunc:pje};function P6(e,t,n,r,i,a,o,s,c){let l=tY([r,a],n);for(let n=0;n<r;n++){let r=[],u=0;for(let t=0;t<i;t++){let a=e[n*i+t];u+=a*o[t],r.push(a)}if(u<0||u>=c/a)throw Error(`Invalid indices: ${r} does not index into ${s}`);for(let e=0;e<a;e++)l.values[n*a+e]=t.get(...t.indexToLoc(u*a+e))}return l}function F6(e,t,n){let r=tY(n,e.dtype);for(let n=0;n<r.size;++n){let i=r.indexToLoc(n).slice(),a=i[0],o=i[2],s=t.locToIndex([a,o]);i[2]=t.values[s];let c=e.locToIndex(i);0<=c&&c<e.values.length&&(r.values[n]=e.values[c])}return r}const I6=c6((e,t)=>e>t?1:0),hje=h6(SG,I6,null,`bool`),gje={kernelName:SG,backendName:`cpu`,kernelFunc:hje},L6=c6((e,t)=>e>=t?1:0),_je=h6(CG,L6,null,`bool`),vje={kernelName:CG,backendName:`cpu`,kernelFunc:_je},R6=c6((e,t)=>e<t?1:0),yje=h6(jG,R6,null,`bool`),bje={kernelName:jG,backendName:`cpu`,kernelFunc:yje},z6=c6((e,t)=>e<=t?1:0),xje=h6(MG,z6,null,`bool`),Sje={kernelName:MG,backendName:`cpu`,kernelFunc:xje};function B6(e,t,n){let r=(t-e)/(n-1),i=rW(n,`float32`);i[0]=e;for(let e=1;e<i.length;e++)i[e]=i[e-1]+r;return i}const V6=S6(e=>Math.log(e)),Cje={kernelName:`Log`,backendName:`cpu`,kernelFunc:w6(`Log`,V6)};function H6(e,t,n,r){let i=zU(r,z(n));for(let n=0;n<i.length;++n){let r=n*t,a=e[r];for(let n=0;n<t;++n){let t=e[r+n];(Number.isNaN(t)||t>a)&&(a=t)}i[n]=a}return i}const U6=c6(((e,t)=>Math.max(e,t))),wje=h6(zG,U6),Tje={kernelName:zG,backendName:`cpu`,kernelFunc:wje},W6=c6(((e,t)=>Math.min(e,t))),Eje=h6(KG,W6),Dje={kernelName:KG,backendName:`cpu`,kernelFunc:Eje},G6=c6(((e,t)=>e*t)),Oje=g6(((e,t,n,r)=>({real:e*n-t*r,imag:e*r+t*n}))),K6=h6(YG,G6,Oje),kje={kernelName:YG,backendName:`cpu`,kernelFunc:K6};function q6(e,t,n){let r=Aq(-1,n);return G6([],t,r,e,n)}function Aje(e){let{inputs:t,backend:n}=e,{x:r}=t;a6(r,`neg`);let i=n.data.get(r.dataId).values,[a,o]=q6(i,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,a)}const jje={kernelName:`Neg`,backendName:`cpu`,kernelFunc:Aje},J6=c6(((e,t)=>e===t?0:1)),Mje=h6(XG,J6,null,`bool`),Nje={kernelName:XG,backendName:`cpu`,kernelFunc:Mje};function Y6(e,t,n,r,i){let a=t.length,o=z(t),s=QU(t),c=QU(i),l=zU(n,z(i));for(let t=0;t<o;++t){let n=sW(t,a,s),i=Array(n.length);for(let e=0;e<i.length;e++)i[e]=n[r[e]];let o=oW(i,a,c);l[o]=e[t]}return l}function X6(e){let{inputs:t,attrs:n,backend:r}=e,{x:i}=t,{perm:a}=n;a6(i,`transpose`);let o=i.shape.length,s=Array(o);for(let e=0;e<s.length;e++)s[e]=i.shape[a[e]];let c=r.data.get(i.dataId).values,l=Y6(c,i.shape,i.dtype,a,s);return{dataId:r.write(l,s,i.dtype),shape:s,dtype:i.dtype}}const Pje={kernelName:QK,backendName:`cpu`,kernelFunc:X6};function Z6(e,t,n,r){let[i,a]=rX(e,r),o=$q(t,`int32`),s=rW(z(i),o),c=z(a);for(let e=0;e<s.length;++e){let t=e*c,r=1;for(let e=0;e<c;++e)r*=n[t+e];s[e]=r}return{outVals:s,outShape:i,outDtype:o}}function Fje(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:o}=r;a6(i,`prod`);let s=i.shape.length,c=LU(a,i.shape),l=oX(c,s),u=c,d=i,f=[];l!=null&&(d=X6({inputs:{x:i},backend:n,attrs:{perm:l}}),f.push(d),u=cX(u.length,s));let p=n.data.get(d.dataId).values,{outVals:m,outShape:h,outDtype:g}=Z6(d.shape,d.dtype,p,u),_=h;return o&&(_=iX(h,c)),f.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(_,g,m)}const Ije={kernelName:aK,backendName:`cpu`,kernelFunc:Fje};function Lje(e,t,n){e.forEach((e,r)=>{if(e<0||e>=n){let i=sW(r,t.length,QU(t)).join(`,`);throw Error(`indices[${i}] = ${e} is not in [0, ${n})`)}})}function Rje(e,t){for(let n=0;n<e.length;++n){let r=e[n],i=n===e.length-1?t:e[n+1].length;if(r.length===0)throw Error(`Ragged splits may not be empty`);if(r[0]<0)throw Error(`Ragged splits must be non-negative`);if(r[r.length-1]>i)throw Error(`Ragged splits must not point past values`);for(let e=1;e<r.length;++e)if(r[e-1]>r[e])throw Error(`Ragged splits must be sorted in ascending order`)}}function zje(e,t,n,r){let i=[],a=0,o=t.length-1+n.length,s=Array(o).fill(null).map(()=>[0]);Rje(n,r);let c=1;for(let e=0;e<t.length-1;++e){c*=t[e];let n=t[e+1];for(let t=1;t<c+1;++t)s[e].push(t*n)}for(let r=0;r<e.length;++r){let o=e[r],c=e[r]+1;for(let e=0;e<n.length;++e){let r=n[e],i=e+t.length-1;if(i>=0){let e=s[i],t=e[e.length-1]-r[o];for(let e=o;e<c;++e)s[i].push(r[e+1]+t)}o=r[o],c=r[c]}c!==o&&(i.push([o,c]),a+=c-o)}return{outSplits:s,valueSlices:i,numValues:a}}function Bje(e){let t=[];for(let n=0;n<e.length;++n){let r=e[n].length,i=BU(`int32`,r);t.push(i),e[n].forEach((e,t)=>i[t]=e)}return t}function Q6(e,t){let n=e.slice(0,t);for(;n.length<t;)n.push(1);for(let r=t;r<e.length;r++)n[t-1]*=e[r];return n}function Vje(e,t,n,r,i,a){let o=Q6(t,2)[1],s=Q6(a,2)[1],c=0;for(let t of n)for(let n=t[0];n<t[1];++n){for(let t=0;t<r;++t)i[c*s+t]=e[n*o+t];++c}}function Hje(e,t,n,r,i){let a=t.slice();a[0]=i;let o=BU(n,z(a)),s=e.length,c=s===0?0:s/t[0];return Vje(e,t,r,c,o,a),[o,a]}function $6(e,t,n,r,i,a,o,s){if(e.length===0)throw Error(`paramsNestedSplits must be non empty`);if(t[0].length===0)throw Error(`Split tensors must not be scalars`);let c=t[0][0]-1;if(Lje(a,o,c),r.length===0)throw Error(`params.rank must be nonzero`);let l=r[0],{outSplits:u,valueSlices:d,numValues:f}=zje(a,o,e,l),p=Bje(u),m=Hje(n,r,i,d,f);return[p,m[0],m[1]]}var e8=2147483647;function t8(e,t,n,r,i,a,o){if(t.length>1)throw Error(`starts must be a scalar or vector`);if(i.length>1)throw Error(`limits must be a scalar or vector`);if(o.length>1)throw Error(`deltas must be a scalar or vector`);let s=t.length===0,c=i.length===0,l=o.length===0,u=[];s||u.push(t[0]),c||u.push(i[0]),l||u.push(o[0]);for(let e=1;e<u.length;++e)if(u[e]!==u[e-1])throw Error(`starts, limits, and deltas must have the same shape`);let d=u.length===0?1:u[0],f=BU(`int32`,d+1);f[0]=0;for(let t=0;t<d;++t){let n=s?e[0]:e[t],i=c?r[0]:r[t],o=l?a[0]:a[t];if(o===0)throw Error(`Requires delta != 0`);let u;if(o>0&&i<n||o<0&&i>n)u=0;else if(u=Math.ceil(Math.abs((i-n)/o)),u>e8)throw Error(`Requires ((limit - start) / delta) <= ${e8}`);f[t+1]=f[t]+u}let p=f[d],m=BU(n,p),h=0;for(let t=0;t<d;++t){let n=f[t+1]-f[t],r=s?e[0]:e[t],i=l?a[0]:a[t];for(let e=0;e<n;++e)m[h++]=r,r+=i}return[f,m]}var n8=NQ,Uje=class e{constructor(e,t,n,r,i,a,o,s,c,l){this.shape=e,this.shapeShape=t,this.values=n,this.valuesShape=r,this.valuesDType=i,this.defaultValue=a,this.defaultValueShape=o,this.rowPartitionValues=s,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=FQ(l),this.raggedRank=IQ(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===n8.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===n8.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(t){let n=this.getRowPartitionTensor(t-1);switch(this.getRowPartitionTypeByDimension(t-1)){case n8.VALUE_ROWIDS:return e.getMaxWidthValueRowID(n);case n8.ROW_SPLITS:return e.getMaxWidthRowSplit(n);default:throw Error(`Cannot handle partition type ${n8[this.getRowPartitionTypeByDimension(t-1)]}`)}}static getMaxWidthRowSplit(e){let t=e.length;if(t===0||t===1)return 0;let n=0;for(let r=0;r<t-1;++r){let t=e[r+1]-e[r];t>n&&(n=t)}return n}static getMaxWidthValueRowID(e){let t=e.length;if(t===0)return 0;let n=0,r=e[0],i=0;for(let a=1;a<t;++a){let t=e[a];t!==r&&(r=t,i=Math.max(a-n,i),n=a)}return Math.max(t-n,i)}tensorShapeFromTensor(e,t,n=!0){if(t.length===0){if(e[0]===-1)return[];throw Error(`The only valid scalar shape tensor is the fully unknown shape specified as -1.`)}return i8(e,n)}calculateOutputSize(e){let t=this.valuesShape,n=this.defaultValueShape;LQ(n,t);let r=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=PQ(this.raggedRank,r,t);i[0]<0&&(i[0]=e);for(let e=1;e<=this.raggedRank;++e)i[e]<0&&(i[e]=this.getMaxWidth(e));return i}calculateFirstParentOutputIndex(e,t,n){let r=Math.min(e,n),i=[],a=0;for(let e=0;e<r;++e,a+=t)i.push(a);for(let t=r;t<e;++t)i.push(-1);return R(i.length===e,()=>`Final length of result must be equal to firstDimension.`),i}calculateOutputIndexRowSplit(e,t,n,r){let i=e.length,a=[];for(let o=0;o<i-1;++o){let i=e[o+1]-e[o],s=Math.min(r,i),c=t[o];c===-1&&(s=0);for(let e=0;e<s;++e)a.push(c),c+=n;for(let e=0;e<i-s;++e)a.push(-1)}if(i>0&&a.length!==e[i-1])throw Error(`Invalid row split size.`);return a}calculateOutputIndexValueRowID(e,t,n,r){let i=e.length,a=[];if(i===0)return[];let o=0,s=e[0];if(s>=t.length)throw Error(`Got currentValueRowId=${s}, which is not less than ${t.length}`);let c=t[s];a.push(c);for(let l=1;l<i;++l){let i=e[l];if(i===s)c>=0&&(++o,o<r?c+=n:c=-1);else{if(o=0,s=i,i>=t.length)throw Error(`Got nextValueRowId=${i} which is not less than ${t.length}`);c=t[i]}a.push(c)}if(a.length!==e.length)throw Error(`Invalid row ids.`);return a}calculateOutputIndex(e,t,n,r){let i=this.getRowPartitionTensor(e),a=this.getRowPartitionTypeByDimension(e);switch(a){case n8.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(i,t,n,r);case n8.ROW_SPLITS:if(i.length-1>t.length)throw Error(`Row partition size is greater than output size: ${i.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(i,t,n,r);default:throw Error(`Unsupported partition type: ${n8[a]}`)}}getFirstDimensionSize(){let e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw Error(`No row_partition_types given.`);let t=this.rowPartitionTypes[0];switch(t){case n8.FIRST_DIM_SIZE:return e[0];case n8.VALUE_ROWIDS:throw Error(`Cannot handle VALUE_ROWIDS in first dimension.`);case n8.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw Error(`Cannot handle type ${n8[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw Error(`Invalid first partition input. Tensor requires at least one element.`);let e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),n=Array(this.raggedRank+1);n[n.length-1]=1;for(let e=n.length-2;e>=0;--e)n[e]=n[e+1]*t[e+1];let r=i8(t,!1),i=BU(this.valuesDType,z(r));if(n[0]*t[0]>0){let a=this.calculateFirstParentOutputIndex(e,n[0],t[0]);for(let e=1;e<=this.raggedRank;++e)a=this.calculateOutputIndex(e-1,a,n[e],t[e]);this.setOutput(this.raggedRank,a,i,r)}return[r,i]}setOutput(e,t,n,r){if(n.length===0)return;let i=this.values,a=n,o=r.slice();o=o.slice(e+1);let s=z(o),c=t.length,l=this.defaultValue;if(l.length!==s&&l.length!==1){let e=this.defaultValueShape;G(()=>{let t=Y(l,e);l=MY(t,o).dataSync()})}let u=0,d=0,f=0;for(let e=0;e<=c;++e){let r=e<c?t[e]:-1;if(r===f){++f;continue}if(d<f){let e=i.subarray(u*s),t=a.subarray(d*s),n=(f-d)*s;r8(t,e,n)}if(e>=c){let e=n.length;r=Math.floor(e/s)}if(r>f)if(this.defaultValue.length===1)a.subarray(f*s,r*s).fill(this.defaultValue[0]),f=r;else for(;r>f;){let e=a.slice(f*s);r8(e,l,s),++f}r<0?(u=e+1,d=f):(u=e,d=f,f=d+1)}}};function r8(e,t,n){for(let r=0;r<n;r++)e[r]=t[r]}function i8(e,t){let n=[];for(let r of e){if(r<0){if(!t)throw Error(`Dimension ${r} must be >= 0`);if(r<-1)throw Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function a8(e,t,n,r,i,a,o,s,c,l){return new Uje(e,t,n,r,i,a,o,s,c,l).compute()}function o8(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return rW(0,r);let i=Math.abs(Math.ceil((t-e)/n)),a=rW(i,r);t<e&&n===1&&(n=-1),a[0]=e;for(let e=1;e<a.length;e++)a[e]=a[e-1]+n;return a}const s8=S6(e=>1/Math.sqrt(e)),Wje=w6(xK,s8),Gje={kernelName:xK,backendName:`cpu`,kernelFunc:Wje};function c8(e,t,n,r,i,a,o,s,c,l){let u=[r/i,i],d=e.values,f=t.values;if(r===0)return tY(n,t.dtype);let p=c instanceof Wq?c:tY(u,t.dtype);typeof c==`string`||typeof c==`number`?p.values.fill(c):typeof c==`boolean`&&p.values.fill(+c);for(let e=0;e<a;e++){let a=[],c=0;for(let t=0;t<o;t++){let n=d[e*o+t];a.push(n),c+=n*s[t]}if(c<0||c>=r/i)throw Error(`Invalid indices: ${a} does not index into ${n}`);for(let n=0;n<i;n++)l?p.values[c*i+n]+=f[e*i+n]:p.values[c*i+n]=t.rank===0?f[0]:f[e*i+n]}return p}const Kje=S6(e=>1/(1+Math.exp(-e))),l8=C6(AK,e=>1/(1+Math.exp(-e))),qje={kernelName:AK,backendName:`cpu`,kernelFunc:l8};function u8(e,t,n,r,i){let a=wQ(r,t,n),o=z(n),s=QU(r);if(a){let n=TQ(t,s);return i===`string`?e.slice(n,n+o):e.subarray(n,n+o)}let c=i===`string`?j$(e):e,l=tY(r,i,c),u=tY(n,i);for(let e=0;e<u.size;++e){let n=u.indexToLoc(e),r=n.map((e,n)=>e+t[n]);u.set(l.get(...r),...n)}return i===`string`?M$(u.values):u.values}function d8(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:a,size:o}=r;a6(i,`slice`);let[s,c]=EQ(i,a,o);mQ(i,s,c);let l=n.data.get(i.dataId).values,u=u8(l,s,c,i.shape,i.dtype);return n.makeTensorInfo(c,i.dtype,u)}const Jje={kernelName:DK,backendName:`cpu`,kernelFunc:d8};function f8(e,t,n,r,i,a,o){let s=t[0],c=a[0],l=Array(c),u=Array(s),d=t[1];if(c===0){if(s!==0)throw Error(g$(s));let e=BU(n,0),t=BU(i,0);return[e,[0,d],t,l,u]}let f=!0,p=0,m=Array(c).fill(0);for(let t=0;t<s;++t){let n=e[t*d];if(n<0)throw Error(_$(t,n));if(n>=c)throw Error(v$(t,n,c));++m[n],f&&=n>=p,p=n}let h=!0;for(let e=0;e<c;++e){let t=m[e]===0;l[e]=t,h&&=!t,m[e]=Math.max(m[e],1),e>0&&(m[e]+=m[e-1])}if(h&&f){let t=e,n=r;for(let e=0;e<s;++e)u[e]=e;return[t,[s,d],n,l,u]}else{let t=m[c-1],a=BU(n,t*d),f=BU(i,t),p=Array(c).fill(0);for(let t=0;t<s;++t){let n=e[t*d],i=p[n],o=(n===0?0:m[n-1])+i;p[n]++;for(let n=0;n<d;++n)a[o*d+n]=e[t*d+n];f[o]=r[t],u[t]=o}for(let e=0;e<c;++e)if(p[e]===0){let t=e===0?0:m[e-1];a[t*d+0]=e;for(let e=1;e<d;++e)a[t*d+e]=0;f[t]=o}return[a,[t,d],f,l,u]}}function p8(e,t,n,r,i){let a=z(r),o=t[0],s=i.length,c=[],l=1,u=-1;for(let e=0;e<s;++e){let t=i[e];if(t===-1){if(u!==-1)throw Error(y$(u,e));u=e,c.push(1)}else{if(t<0)throw Error(b$(e,t));l*=t,c.push(t)}}if(u!==-1){if(l<=0)throw Error(x$());let e=Math.trunc(a/l);if(l*e!==a)throw Error(S$(r,c));c[u]=e}if(z(c)!==a)throw Error(C$(r,c));let d=r.length,f=[];if(d>0){f[d-1]=1;for(let e=d-2;e>=0;--e)f[e]=f[e+1]*r[e+1]}let p=[];if(s>0){p[s-1]=1;for(let e=s-2;e>=0;--e)p[e]=p[e+1]*c[e+1]}let m=BU(n,o*s);for(let t=0;t<o;++t){let n=0;for(let r=0;r<d;++r)n+=e[t*d+r]*f[r];for(let e=0;e<s;++e)m[t*s+e]=Math.trunc(n/p[e]),n%=p[e]}return[m,[o,s],c]}function m8(e,t,n,r,i,a=!1,o=0){let s=r.length,c=[t[0],e.length/t[0]],l=c[1],u=s>0?i[s-1]+1:0;if(u<0)throw Error(w$());let d=t.slice();d[0]=u;let f=d.reduce((e,t)=>e*t,1),p=BU(n,f);if(s===0)return u>0&&p.fill(o),[p,d];if(u<=0)throw Error(w$());let m=0,h=1,g=0,_=i[m];for(;;){let t=0;if(h<s){if(t=i[h],_===t){++h;continue}if(_>=t)throw Error(T$())}if(_<0||_>=u)throw Error(E$(_,u));_>g&&p.fill(o,g*l,_*l);for(let t=m;t<h;++t){let n=r[t];if(n<0||n>=c[0])throw Error(D$(t,r[t],c[0]));for(let t=0;t<l;t++)p[_*l+t]+=e[n*l+t]}if(a)for(let e=0;e<l;e++)p[_*l+e]/=h-m;if(m=h,++h,g=_+1,_=t,h>s)break}return g<u&&p.fill(o,g*l,u*l),[p,d]}const Yje=S6(e=>Math.sqrt(e)),Xje=C6(MK,e=>Math.sqrt(e)),Zje={kernelName:MK,backendName:`cpu`,kernelFunc:Xje},h8=c6(((e,t)=>{let n=e-t;return n*n})),Qje=h6(VK,h8),$je={kernelName:VK,backendName:`cpu`,kernelFunc:Qje},g8=S6((e,t)=>{let{pattern:n,replaceGlobal:r,rewrite:i}=t;return e.replace(new RegExp(n,r?`g`:``),i)});var eMe=w6(UK,g8);const tMe={kernelName:UK,backendName:`cpu`,kernelFunc:eMe};function _8(e,t,n,r){let i=tY(e,t.dtype);for(let e=0;e<i.size;e++){let a=i.indexToLoc(e),o=Array(a.length);for(let e=0;e<o.length;e++)o[e]=a[e]*n[e]+r[e];i.set(t.get(...o),...a)}return i}var nMe=class{constructor(e,t,n,r,i,a){this.separator=Nq(e),this.nGramWidths=t,this.leftPad=Nq(n),this.rightPad=Nq(r),this.padWidth=i,this.preserveShort=a}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){let n=this.getPadWidth(t);return Math.max(0,e+2*n-t+1)}createNGrams(e,t,n,r,i,a){for(let o=0;o<i;++o){let s=this.getPadWidth(a),c=Math.max(0,s-o),l=Math.max(0,s-(i-(o+1))),u=a-(c+l),d=t+(c>0?0:o-s),f=0;f+=c*this.leftPad.length;for(let t=0;t<u;++t)f+=e[d+t].length;f+=l*this.rightPad.length;let p=c+l+u-1;f+=p*this.separator.length,n[r+o]=new Uint8Array(f);let m=n[r+o],h=0,g=e=>e.forEach(e=>m[h++]=e);for(let e=0;e<c;++e)g(this.leftPad),g(this.separator);for(let t=0;t<u-1;++t)g(e[d+t]),g(this.separator);if(u>0){g(e[d+u-1]);for(let e=0;e<l;++e)g(this.separator),g(this.rightPad)}else{for(let e=0;e<l-1;++e)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,t){let n=e.length,r=t.length;if(r>0){let e=t[0];if(e!==0)throw Error(`First split value must be 0, got ${e}`);for(let i=1;i<r;++i){let r=t[i]>=e;if(r&&=t[i]<=n,!r)throw Error(`Invalid split value ${t[i]}, must be in [${e}, ${n}]`);e=t[i]}if(e!==n)throw Error(`Last split value must be data size. Expected ${n}, got ${e}`)}let i=r-1,a=BU(`int32`,r);if(n===0||r===0){let e=Array(n);for(let e=0;e<=i;++e)a[e]=0;return[e,a]}a[0]=0;for(let e=1;e<=i;++e){let n=t[e]-t[e-1],r=0;this.nGramWidths.forEach(e=>{r+=this.getNumNGrams(n,e)}),this.preserveShort&&n>0&&r===0&&(r=1),a[e]=a[e-1]+r}let o=Array(a[i]);for(let n=0;n<i;++n){let r=t[n],i=a[n];if(this.nGramWidths.forEach(a=>{let s=t[n+1]-t[n],c=this.getNumNGrams(s,a);this.createNGrams(e,r,o,i,c,a),i+=c}),this.preserveShort&&i===a[n]){let a=t[n+1]-t[n];if(a===0)continue;let s=a+2*this.padWidth;this.createNGrams(e,r,o,i,1,s)}}return[o,a]}};function v8(e,t,n,r,i,a,o,s){return new nMe(n,r,i,a,o,s).compute(e,t)}function rMe(e,t,n,r){if(!e.length)return;if(t.length===0){for(let t=0;t<e.length;++t)r.push(e.subarray(t,t+1));return}if(t.length===1){let i=t[0],a=e.indexOf(i);for(;a!==-1;){let t=e.subarray(0,a);(!n||t.length!==0)&&r.push(t),e=e.subarray(a+1),a=e.indexOf(i)}(!n||e.length!==0)&&r.push(e);return}let i=0;for(let a=0;a<e.length+1;a++)if(a===e.length||t.indexOf(e[a])!==-1){let t=e.subarray(i,a);(!n||t.length!==0)&&r.push(t),i=a+1}}function y8(e,t,n){let r=e.length,i=[],a=0,o=0,s=Array(r);for(let c=0;c<r;++c){let r=i.length;rMe(e[c],t,n,i);let l=i.length-r;s[c]=l,a+=l,o=Math.max(o,l)}let c=BU(`int32`,a*2),l=Array(a),u=[r,o],d=0;for(let e=0;e<r;++e)for(let t=0;t<s[e];++t)c[d*2]=e,c[d*2+1]=t,l[d]=i[d],++d;return[c,l,u]}function b8(e,t){let n=BU(`int32`,e.length);for(let r=0;r<e.length;++r)n[r]=abe(e[r]).modulo(t).getLowBitsUnsigned();return n}const x8=c6(((e,t)=>e-t)),iMe=g6(((e,t,n,r)=>({real:e-n,imag:t-r}))),S8=h6(`Sub`,x8,iMe),aMe={kernelName:`Sub`,backendName:`cpu`,kernelFunc:S8};function C8(e,t){let n=Array(e.rank);for(let r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];let r=tY(n,e.dtype);for(let t=0;t<r.values.length;++t){let n=r.indexToLoc(t),i=Array(e.rank);for(let t=0;t<i.length;t++)i[t]=n[t]%e.shape[t];let a=e.locToIndex(i);r.values[t]=e.values[a]}return r}var w8=(e,t)=>{let n=t.value-e.value;return n===0?e.index-t.index:n};function T8(e,t,n=0,r=e.length-1){for(;r>n;){if(r-n>600){let i=r-n+1,a=t-n+1,o=Math.log(i),s=.5*Math.exp(2*o/3),c=.5*Math.sqrt(o*s*(i-s)/i)*Math.sign(a-i/2),l=Math.max(n,Math.floor(t-a*s/i+c)),u=Math.min(r,Math.floor(t+(i-a)*s/i+c));T8(e,t,l,u)}let i=e[t],a=n,o=r;for(DU(e,n,t),w8(e[r],i)>0&&DU(e,n,r);a<o;){for(DU(e,a,o),a++,o--;w8(e[a],i)<0;)a+=1;for(;w8(e[o],i)>0;)--o}w8(e[n],i)===0?DU(e,n,o):(o+=1,DU(e,o,r)),o<=t&&(n=o+1),t<=o&&(r=o-1)}}function E8(e,t,n,r,i){let a=t[t.length-1],[o,s]=[e.length/a,a],c=zU(n,o*r),l=zU(`int32`,o*r);for(let t=0;t<o;t++){let n=t*s,a=e.subarray(n,n+s),o=Array(a.length);a.forEach((e,t)=>o[t]={value:e,index:t}),r<o.length&&(T8(o,r),o=o.slice(0,r)),i&&o.sort(w8);let u=t*r,d=c.subarray(u,u+r),f=l.subarray(u,u+r);for(let e=0;e<r;e++)d[e]=o[e].value,f[e]=o[e].index}let u=t.slice();return u[u.length-1]=r,[tY(u,n,c),tY(u,`int32`,l)]}function D8(e,t,n,r){let i=LU(t,n)[0],a=[1,n[0],1];for(let e=0;e<i;e++)a[0]*=n[e];a[1]=n[i];for(let e=i+1;e<n.length;e++)a[2]*=n[e];let o=new Map,s=new Int32Array(n[i]),c=new Wq(a,r,e),l=[],u=a[0]===1&&a[2]===1;for(let t=0;t<n[i];t++){let n;if(u)n=e[t].toString();else{let e=[];for(let n=0;n<a[0];n++)for(let r=0;r<a[2];r++)e.push(c.get(n,t,r));n=e.join(`,`)}let r=o.get(n);if(r!=null)s[t]=r;else{let e=o.size;o.set(n,e),s[t]=e,l.push(t)}}let d=a.slice();d[1]=o.size;let f=new Wq(d,r);l.forEach((e,t)=>{for(let n=0;n<a[0];n++)for(let r=0;r<a[2];r++)f.set(c.get(n,e,r),n,t,r)});let p=n.slice();return p[i]=d[1],{outputValues:f.values,outputShape:p,indices:s}}var oMe=s({addImpl:()=>_6,bincountImpl:()=>y6,bincountReduceImpl:()=>b6,bitwiseAndImpl:()=>x6,castImpl:()=>p6,ceilImpl:()=>T6,concatImpl:()=>E6,equalImpl:()=>D6,expImpl:()=>k6,expm1Impl:()=>j6,floorDivImpl:()=>N6,floorImpl:()=>M6,gatherNdImpl:()=>P6,gatherV2Impl:()=>F6,greaterEqualImpl:()=>L6,greaterImpl:()=>I6,lessEqualImpl:()=>z6,lessImpl:()=>R6,linSpaceImpl:()=>B6,logImpl:()=>V6,maxImpl:()=>H6,maximumImpl:()=>U6,minimumImpl:()=>W6,multiplyImpl:()=>G6,negImpl:()=>q6,notEqualImpl:()=>J6,prodImpl:()=>Z6,raggedGatherImpl:()=>$6,raggedRangeImpl:()=>t8,raggedTensorToTensorImpl:()=>a8,rangeImpl:()=>o8,rsqrtImpl:()=>s8,scatterImpl:()=>c8,sigmoidImpl:()=>Kje,simpleAbsImpl:()=>s6,sliceImpl:()=>u8,sparseFillEmptyRowsImpl:()=>f8,sparseReshapeImpl:()=>p8,sparseSegmentReductionImpl:()=>m8,sqrtImpl:()=>Yje,squaredDifferenceImpl:()=>h8,staticRegexReplaceImpl:()=>g8,stridedSliceImpl:()=>_8,stringNGramsImpl:()=>v8,stringSplitImpl:()=>y8,stringToHashBucketFastImpl:()=>b8,subImpl:()=>x8,tileImpl:()=>C8,topKImpl:()=>E8,transposeImpl:()=>Y6,uniqueImpl:()=>D8});OJ(`cpu`,()=>new o6,1);const O8=C6(`Elu`,e=>e>=0?e:Math.exp(e)-1),sMe={kernelName:`Elu`,backendName:`cpu`,kernelFunc:O8};function k8(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:a}=r;a6([i],`leakyRelu`);let o=z(i.shape),s=n.data.get(i.dataId).values,c=zU(`float32`,o);for(let e=0;e<s.length;e++)c[e]=s[e]<0?a*s[e]:s[e];return n.makeTensorInfo(i.shape,`float32`,c)}const cMe={kernelName:AG,backendName:`cpu`,kernelFunc:k8};var lMe=c6((e,t)=>e<0?t*e:e);function A8(e){let{inputs:t,backend:n}=e,{x:r,alpha:i}=t;a6([r,i],`prelu`);let a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,[s,c]=lMe(r.shape,i.shape,a,o,`float32`);return n.makeTensorInfo(c,`float32`,s)}const uMe={kernelName:iK,backendName:`cpu`,kernelFunc:A8},j8=C6(fK,e=>Math.max(0,e)),dMe={kernelName:fK,backendName:`cpu`,kernelFunc:j8},M8=C6(vK,e=>Math.min(Math.max(0,e),6)),fMe={kernelName:vK,backendName:`cpu`,kernelFunc:M8};function N8(e,t,n,r,i){if(n===`linear`)return d6({inputs:{x:t},backend:e});if(n===`relu`)return j8({inputs:{x:t},backend:e});if(n===`elu`)return O8({inputs:{x:t},backend:e});if(n===`relu6`)return M8({inputs:{x:t},backend:e});if(n===`prelu`)return A8({inputs:{x:t,alpha:r},backend:e});if(n===`leakyrelu`)return k8({inputs:{x:t},backend:e,attrs:{alpha:i}});if(n===`sigmoid`)return l8({inputs:{x:t},backend:e});throw Error(`Activation ${n} has not been implemented for the CPU backend.`)}function P8(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:a}=r,o=z(i.shape),s=IU(a,o),c=z(s);R(o===c,()=>`The new shape (${s}) has ${c} elements and the old shape (${i.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`),n.incRef(i.dataId);let l=n.data.get(i.dataId);if(l.complexTensorInfos!=null){let e=l.complexTensorInfos.real,t=l.complexTensorInfos.imag;e.shape=s,t.shape=s}return{dataId:i.dataId,shape:s,dtype:i.dtype}}const pMe={kernelName:pK,backendName:`cpu`,kernelFunc:P8};function F8(e){let{inputs:t,backend:n,attrs:r}=e,{a:i,b:a}=t,{transposeA:o,transposeB:s}=r;a6([i,a],`matMul`);let c=i.shape.length,l=a.shape.length,u=o?i.shape[c-2]:i.shape[c-1],d=s?a.shape[l-1]:a.shape[l-2],f=o?i.shape[c-1]:i.shape[c-2],p=s?a.shape[l-2]:a.shape[l-1],m=i.shape.slice(0,-2),h=a.shape.slice(0,-2),g=z(m),_=z(h),v=JY(i.shape.slice(0,-2),a.shape.slice(0,-2)).concat([f,p]);R(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${i.shape} and ${a.shape} and transposeA=${o} and transposeB=${s} must match.`);let y=o?[g,u,f]:[g,f,u],b=s?[_,p,d]:[_,d,p],x=P8({inputs:{x:i},backend:n,attrs:{shape:y}}),S=P8({inputs:{x:a},backend:n,attrs:{shape:b}}),C=o?x.shape[1]:x.shape[2],w=o?x.shape[2]:x.shape[1],T=s?S.shape[1]:S.shape[2],E=Math.max(g,_),D=n.data.get(x.dataId).values,O=n.data.get(S.dataId).values,k=QU(x.shape),ee=QU(S.shape),[te,ne,A]=o?[k[0],1,k[1]]:[k[0],k[1],1],[j,re,ie]=s?[1,ee[1],ee[0]]:[ee[1],1,ee[0]],ae=w*T,oe=tY([E,w,T],x.dtype),se=oe.values,ce=n.blockSize;for(let e=0;e<E;e++){let t=e%g,n=e%_;for(let r=0;r<w;r+=ce){let i=Math.min(r+ce,w);for(let a=0;a<T;a+=ce){let o=Math.min(a+ce,T);for(let s=0;s<C;s+=ce){let c=Math.min(s+ce,C);for(let l=r;l<i;l++)for(let r=a;r<o;r++){let i=0;for(let e=s;e<c;e++){let a=D[t*te+l*ne+e*A],o=O[e*j+r*re+n*ie];i+=a*o}se[e*ae+(l*T+r)]+=i}}}}}return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(S),n.makeTensorInfo(v,oe.dtype,oe.values)}const mMe={kernelName:NW,backendName:`cpu`,kernelFunc:F8};function hMe(e){let{inputs:t,backend:n,attrs:r}=e,{a:i,b:a,bias:o,preluActivationWeights:s}=t,{transposeA:c,transposeB:l,activation:u,leakyreluAlpha:d}=r,f,p,m,h=[];f=F8({inputs:{a:i,b:a},attrs:{transposeA:c,transposeB:l},backend:n}),o&&(p=v6({inputs:{a:f,b:o},backend:n}),h.push(f),f=p),u&&(m=N8(n,f,u,s,d),h.push(f),f=m);for(let e of h)n.disposeIntermediateTensorInfo(e);return f}const gMe={kernelName:aq,backendName:`cpu`,kernelFunc:hMe},_Me=C6(yW,e=>Math.acos(e)),vMe={kernelName:yW,backendName:`cpu`,kernelFunc:_Me},yMe=C6(bW,e=>Math.acosh(e)),bMe={kernelName:bW,backendName:`cpu`,kernelFunc:yMe};function xMe(e){let{inputs:t,backend:n}=e,r=t;a6(t,`addN`);let i=r.map(e=>n.data.get(e.dataId).values),a=tY(r[0].shape,r[0].dtype),o=a.values;for(let e=0;e<r.length;e++){let t=i[e];for(let e=0;e<o.length;e++)o[e]+=t[e]}return n.makeTensorInfo(a.shape,a.dtype,a.values)}const SMe={kernelName:xW,backendName:`cpu`,kernelFunc:xMe};function CMe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:o}=r;a6(i,`all`);let s=LU(a,i.shape),c=s,l=oX(c,i.shape.length),u=i;l!=null&&(u=X6({inputs:{x:i},backend:n,attrs:{perm:l}}),c=cX(c.length,i.shape.length)),aX(`all`,c,u.shape.length);let[d,f]=rX(u.shape,c),p=z(f),m=rW(z(d),u.dtype),h=n.data.get(u.dataId).values;for(let e=0;e<m.length;++e){let t=e*p,n=h[t];for(let e=0;e<p;++e){let r=h[t+e];n&&=r}m[e]=n}l!=null&&n.disposeIntermediateTensorInfo(u);let g=n.makeTensorInfo(d,u.dtype,m);if(o){let e=iX(d,s),t=P8({inputs:{x:g},backend:n,attrs:{shape:e}});return n.disposeIntermediateTensorInfo(g),t}return g}const wMe={kernelName:`All`,backendName:`cpu`,kernelFunc:CMe};function TMe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:o}=r;a6(i,`any`);let s=LU(a,i.shape),c=s,l=oX(c,i.shape.length),u=i;l!=null&&(u=X6({inputs:{x:i},backend:n,attrs:{perm:l}}),c=cX(c.length,i.shape.length)),aX(`any`,c,u.shape.length);let[d,f]=rX(u.shape,c),p=z(f),m=rW(z(d),u.dtype),h=n.data.get(u.dataId).values;for(let e=0;e<m.length;++e){let t=e*p,n=h[t];for(let e=0;e<p;++e){let r=h[t+e];n||=r}m[e]=n}l!=null&&n.disposeIntermediateTensorInfo(u);let g=n.makeTensorInfo(d,u.dtype,m);if(o){let e=iX(d,s),t=P8({inputs:{x:g},backend:n,attrs:{shape:e}});return n.disposeIntermediateTensorInfo(g),t}return g}const EMe={kernelName:`Any`,backendName:`cpu`,kernelFunc:TMe};function DMe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a}=r;a6(i,`argMax`);let o=LU(a,i.shape),s=oX(o,i.shape.length),c=i,l=[];s!=null&&(c=X6({inputs:{x:i},backend:n,attrs:{perm:s}}),l.push(c),o=cX(o.length,c.shape.length)),o=[o[0]],aX(`argMax`,o,c.shape.length);let[u,d]=rX(c.shape,o),f=z(u),p=rW(f,`int32`),m=z(d),h=n.data.get(c.dataId).values;for(let e=0;e<p.length;++e){let t=e*m,n=h[t],r=0;for(let e=0;e<m;++e){let i=h[t+e];i>n&&(n=i,r=e)}p[e]=r}return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(u,`int32`,p)}const OMe={kernelName:SW,backendName:`cpu`,kernelFunc:DMe};function kMe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a}=r;a6(i,`argMin`);let o=LU(a,i.shape),s=oX(o,i.shape.length),c=i,l=[];s!=null&&(c=X6({inputs:{x:i},backend:n,attrs:{perm:s}}),l.push(c),o=cX(o.length,c.shape.length)),o=[o[0]],aX(`argMin`,o,c.shape.length);let[u,d]=rX(c.shape,o),f=z(u),p=rW(f,`int32`),m=z(d),h=n.data.get(c.dataId).values;for(let e=0;e<p.length;++e){let t=e*m,n=h[t],r=0;for(let e=0;e<m;++e){let i=h[t+e];i<n&&(n=i,r=e)}p[e]=r}return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(u,`int32`,p)}const AMe={kernelName:CW,backendName:`cpu`,kernelFunc:kMe},jMe=C6(wW,e=>Math.asin(e)),MMe={kernelName:wW,backendName:`cpu`,kernelFunc:jMe},NMe=C6(TW,e=>Math.asinh(e)),PMe={kernelName:TW,backendName:`cpu`,kernelFunc:NMe},FMe=C6(EW,e=>Math.atan(e)),IMe={kernelName:EW,backendName:`cpu`,kernelFunc:FMe},LMe=c6((e,t)=>Math.atan2(e,t)),RMe=h6(OW,LMe),zMe={kernelName:OW,backendName:`cpu`,kernelFunc:RMe},BMe=C6(DW,e=>Math.atanh(e)),VMe={kernelName:DW,backendName:`cpu`,kernelFunc:BMe};function I8(e,t,n,r,i,a){let o=i.strideHeight,s=i.strideWidth,c=i.dilationHeight,l=i.dilationWidth,u=i.effectiveFilterHeight,d=i.effectiveFilterWidth,f=i.padInfo.top,p=i.padInfo.left,m=a===`max`?-1/0:1/0,h=tY(i.outShape,n),g=h.values,_=i.outShape[1]*i.outShape[2]*i.outShape[3],v=i.outShape[2]*i.outShape[3],y=i.outShape[3];for(let t=0;t<i.batchSize;++t){let n=t*_,h=t*r[0];for(let t=0;t<i.inChannels;++t)for(let _=0;_<i.outHeight;++_){let b=_*o-f,x=Math.max(0,b),S=Math.min(i.inHeight,u+b),C=n+_*v;for(let n=0;n<i.outWidth;++n){let o=n*s-p,u=Math.max(0,o),f=Math.min(i.inWidth,d+o),_=m,v=0,b=0;for(let n=x;n<S;n+=c){let i=h+n*r[1];for(let n=u;n<f;n+=l){let o=i+n*r[2],s=e[o+t];a===`max`&&s>_?_=s:a===`avg`&&(v+=s,b++)}if(isNaN(_))break}let w=C+n*y+t;g[w]=a===`avg`?v/b:_}}}return h}function L8(e,t,n,r,i=!1,a=!1){let o=tY(r.outShape,`int32`),s=r.strideHeight,c=r.strideWidth,l=r.dilationHeight,u=r.dilationWidth,d=r.effectiveFilterHeight,f=r.effectiveFilterWidth,p=r.padInfo.top,m=r.padInfo.left,h=tY(t,n,e);for(let e=0;e<r.batchSize;++e)for(let t=0;t<r.inChannels;++t)for(let n=0;n<r.outHeight;++n){let g=n*s-p,_=g;for(;_<0;)_+=l;let v=Math.min(r.inHeight,d+g);for(let s=0;s<r.outWidth;++s){let d=s*c-m,p=d;for(;p<0;)p+=u;let y=Math.min(r.inWidth,f+d),b=-1/0,x=-1;for(let n=_;n<v;n+=l){let o=n-g;for(let s=p;s<y;s+=u){let c=s-d,l=h.get(e,n,s,t);l>b&&(b=l,x=i?a?((e*r.inHeight+n)*r.inWidth+s)*r.inChannels+t:(n*r.inWidth+s)*r.inChannels+t:o*f+c)}}o.set(x,e,n,s,t)}}return o}function R8(e,t,n,r,i,a){let o=i.strideDepth,s=i.strideHeight,c=i.strideWidth,l=i.dilationDepth,u=i.dilationHeight,d=i.dilationWidth,f=i.effectiveFilterDepth,p=i.effectiveFilterHeight,m=i.effectiveFilterWidth,h=i.padInfo.front,g=i.padInfo.top,_=i.padInfo.left,v=a===`max`?-1/0:1/0,y=tY(i.outShape,n),b=y.values,x=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],S=i.outShape[2]*i.outShape[3]*i.outShape[4],C=i.outShape[3]*i.outShape[4],w=i.outShape[4];for(let t=0;t<i.batchSize;++t){let n=t*x,y=t*r[0];for(let t=0;t<i.inChannels;++t)for(let x=0;x<i.outDepth;++x){let T=x*o-h,E=T;for(;E<0;)E+=l;let D=Math.min(i.inDepth,f+T),O=n+x*S;for(let n=0;n<i.outHeight;++n){let o=n*s-g,f=o;for(;f<0;)f+=u;let h=Math.min(i.inHeight,p+o),x=O+n*C;for(let n=0;n<i.outWidth;++n){let o=n*c-_,s=o;for(;s<0;)s+=d;let p=Math.min(i.inWidth,m+o),g=x+n*w,S=v,C=0,T=0;for(let n=E;n<D;n+=l){let i=y+n*r[1];for(let n=f;n<h;n+=u){let o=i+n*r[2];for(let n=s;n<p;n+=d){let i=o+n*r[3],s=e[i+t];if(a===`max`&&s>S?S=s:a===`avg`&&(C+=s,T++),isNaN(S))break}if(isNaN(S))break}if(isNaN(S))break}let O=g+t;b[O]=a===`avg`?C/Math.max(T,1):S}}}}return y}function HMe(e,t){let n=tY(t.outShape,`int32`),r=t.strideDepth,i=t.strideHeight,a=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,c=t.dilationWidth,l=t.effectiveFilterDepth,u=t.effectiveFilterHeight,d=t.effectiveFilterWidth,f=t.padInfo.front,p=t.padInfo.top,m=t.padInfo.left;for(let h=0;h<t.batchSize;++h)for(let g=0;g<t.inChannels;++g)for(let _=0;_<t.outDepth;++_){let v=_*r-f,y=v;for(;y<0;)y+=o;let b=Math.min(t.inDepth,l+v);for(let r=0;r<t.outHeight;++r){let l=r*i-p,f=l;for(;f<0;)f+=s;let x=Math.min(t.inHeight,u+l);for(let i=0;i<t.outWidth;++i){let p=i*a-m,S=p;for(;S<0;)S+=c;let C=Math.min(t.inWidth,d+p),w=-1/0,T=-1;for(let t=y;t<b;t+=o){let n=t-v;for(let r=f;r<x;r+=s){let i=r-l;for(let a=S;a<C;a+=c){let o=a-p,s=e.get(h,t,r,a,g);s>=w&&(w=s,T=n*u*d+i*u+o)}}}n.set(T,h,_,r,i,g)}}}return n}function UMe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;a6(i,`avgPool`);let{filterSize:a,strides:o,pad:s,dimRoundingMode:c}=r;R(bY(o,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);let l=uY(i.shape,a,o,1,s,c),u;if(l.filterWidth===1&&l.filterHeight===1&&jU(l.inShape,l.outShape))u=d6({inputs:{x:i},backend:n});else{let e=n.data.get(i.dataId).values,t=QU(i.shape),r=I8(e,i.shape,i.dtype,t,l,`avg`);u=n.makeTensorInfo(l.outShape,i.dtype,r.values)}return u}const WMe={kernelName:kW,backendName:`cpu`,kernelFunc:UMe};function GMe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:o,pad:s,dimRoundingMode:c,dataFormat:l}=r;a6(i,`avgPool3d`);let u=dY(i.shape,a,o,1,s,c,l),d=n.data.get(i.dataId).values,f=R8(d,i.shape,i.dtype,QU(i.shape),u,`avg`);return n.makeTensorInfo(f.shape,`float32`,f.values)}const KMe={kernelName:jW,backendName:`cpu`,kernelFunc:GMe};function qMe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,{filterSize:o,strides:s,pad:c,dimRoundingMode:l}=r;a6([i,a],`avgPool3DGrad`);let u=dY(a.shape,o,s,1,c,l),d=u.strideDepth,f=u.strideHeight,p=u.strideWidth,m=u.filterDepth,h=u.filterHeight,g=u.filterWidth,_=u.dilationDepth,v=u.dilationHeight,y=u.dilationWidth,b=u.effectiveFilterDepth,x=u.effectiveFilterHeight,S=u.effectiveFilterWidth,C=b-1-u.padInfo.front,w=S-1-u.padInfo.left,T=x-1-u.padInfo.top,E=tY(a.shape,`float32`),D=1/(m*h*g),O=n.bufferSync(i);for(let e=0;e<u.batchSize;++e)for(let t=0;t<u.inChannels;++t)for(let n=0;n<u.inDepth;++n)for(let r=0;r<u.inHeight;++r)for(let i=0;i<u.inWidth;++i){let a=n-C,o=r-T,s=i-w,c=0;for(let n=0;n<b;n+=_){let r=(a+n)/d;if(!(r<0||r>=u.outDepth||Math.floor(r)!==r))for(let n=0;n<x;n+=v){let i=(o+n)/f;if(!(i<0||i>=u.outHeight||Math.floor(i)!==i))for(let n=0;n<S;n+=y){let a=(s+n)/p;if(a<0||a>=u.outWidth||Math.floor(a)!==a)continue;let o=O.get(e,r,i,a,t);c+=o}}}E.set(c*D,e,n,r,i,t)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const JMe={kernelName:MW,backendName:`cpu`,kernelFunc:qMe};function YMe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,o=a;a6([i,a],`avgPoolGrad`);let{filterSize:s,strides:c,pad:l}=r,u=uY(o.shape,s,c,1,l),d=u.strideHeight,f=u.strideWidth,p=u.filterHeight,m=u.filterWidth,h=u.dilationHeight,g=u.dilationWidth,_=u.effectiveFilterHeight,v=u.effectiveFilterWidth,y=v-1-u.padInfo.left,b=_-1-u.padInfo.top,x=tY(o.shape,`float32`),S=1/(p*m),C=n.data.get(i.dataId).values,w=tY(i.shape,`float32`,C);for(let e=0;e<u.batchSize;++e)for(let t=0;t<u.inChannels;++t)for(let n=0;n<u.inHeight;++n)for(let r=0;r<u.inWidth;++r){let i=n-b,a=r-y,o=0;for(let n=0;n<_;n+=h){let r=(i+n)/d;if(!(r<0||r>=u.outHeight||Math.floor(r)!==r))for(let n=0;n<v;n+=g){let i=(a+n)/f;if(i<0||i>=u.outWidth||Math.floor(i)!==i)continue;let s=w.get(e,r,i,t);o+=s}}x.set(o*S,e,n,r,t)}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const XMe={kernelName:AW,backendName:`cpu`,kernelFunc:YMe};function ZMe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,scale:a,offset:o,mean:s,variance:c}=t;R(s.shape.length===c.shape.length,()=>`Batch normalization gradient requires mean and variance to have equal ranks.`),R(o==null||s.shape.length===o.shape.length,()=>`Batch normalization gradient requires mean and offset to have equal ranks.`),R(a==null||s.shape.length===a.shape.length,()=>`Batch normalization gradient requires mean and scale to have equal ranks.`),a6([i,s,c,a,o],`batchNorm`);let{varianceEpsilon:l}=r;l??=.001;let u=n.data.get(i.dataId).values,d=n.data.get(s.dataId).values,f=n.data.get(c.dataId).values,p=a?n.data.get(a.dataId).values:new Float32Array([1]),m=o?n.data.get(o.dataId).values:new Float32Array([0]),h=new Float32Array(u.length),g=m.length,_=p.length,v=f.length,y=d.length,b=0,x=0,S=0,C=0;for(let e=0;e<u.length;++e)h[e]=m[b++]+(u[e]-d[x++])*p[S++]/Math.sqrt(f[C++]+l),b>=g&&(b=0),x>=y&&(x=0),S>=_&&(S=0),C>=v&&(C=0);return n.makeTensorInfo(i.shape,i.dtype,h)}const QMe={kernelName:yG,backendName:`cpu`,kernelFunc:ZMe};function $Me(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:a,crops:o}=r;a6([i],`batchToSpaceND`);let s=a.reduce((e,t)=>e*t),c=BQ(i.shape,a,s),l=VQ(c.length,a.length),u=HQ(i.shape,a,s),d=UQ(o,a.length),f=WQ(u,o,a.length),p=P8({inputs:{x:i},backend:n,attrs:{shape:c}}),m=X6({inputs:{x:p},backend:n,attrs:{perm:l}}),h=P8({inputs:{x:m},backend:n,attrs:{shape:u}}),g=d8({inputs:{x:h},backend:n,attrs:{begin:d,size:f}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(h),g}const eNe={kernelName:PW,backendName:`cpu`,kernelFunc:$Me};function tNe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,weights:a}=t,{size:o}=r,s=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,l=y6(s,c,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,l)}const nNe={kernelName:FW,backendName:`cpu`,kernelFunc:tNe};function rNe(e){let{inputs:t,backend:n}=e,{s0:r,s1:i}=t,a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,s=JY(Array.from(a),Array.from(o));return n.makeTensorInfo([s.length],`int32`,Int32Array.from(s))}const iNe={kernelName:LW,backendName:`cpu`,kernelFunc:rNe},aNe=C6(BW,(e,t)=>{let n=t;return e>n.clipValueMax?n.clipValueMax:e<n.clipValueMin?n.clipValueMin:e}),oNe={kernelName:BW,backendName:`cpu`,kernelFunc:aNe},sNe={kernelName:HW,backendName:`cpu`,kernelFunc:e=>{let{x:t}=e.inputs,n=e.backend,r=new Float32Array(z(t.shape)),i=n.data.get(t.dataId),a=i.complexTensorInfos.real,o=i.complexTensorInfos.imag,s=n.data.get(a.dataId).values,c=n.data.get(o.dataId).values;for(let e=0;e<s.length;e++){let t=s[e],n=c[e];r[e]=Math.hypot(t,n)}return n.makeOutput(r,t.shape,`float32`)}};function z8(e){let{inputs:t,backend:n}=e,{input:r}=t,i=n.data.get(r.dataId).complexTensorInfos.imag,a=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,a)}const cNe={kernelName:EG,backendName:`cpu`,kernelFunc:z8};function B8(e){let{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,a=LU(i,t[0].shape)[0],o=t.map(e=>e.shape);jQ(o,a);let s=MQ(t.map(e=>e.shape),a);if(z(s)===0)return n.makeTensorInfo(s,t[0].dtype,[]);let c=t.filter(e=>z(e.shape)>0);if(c.length===1)return d6({inputs:{x:c[0]},backend:n});if(c[0].dtype===`complex64`){let e=c.map(e=>f6({inputs:{input:e},backend:n})),t=c.map(e=>z8({inputs:{input:e},backend:n})),r=B8({inputs:e,backend:n,attrs:{axis:a}}),i=B8({inputs:t,backend:n,attrs:{axis:a}}),o=l6({inputs:{real:r,imag:i},backend:n});return e.forEach(e=>n.disposeIntermediateTensorInfo(e)),t.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),o}let l=c.map(e=>{let t=[-1,z(e.shape.slice(a))];return P8({inputs:{x:e},backend:n,attrs:{shape:t}})}),u=l.map(e=>({vals:n.data.get(e.dataId).values,shape:e.shape}));s=MQ(l.map(e=>e.shape),1);let d=l[0].shape[0]===1,f=E6(u,s,t[0].dtype,d),p=MQ(c.map(e=>e.shape),a),m=n.makeTensorInfo(p,t[0].dtype,f);return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),m}const lNe={kernelName:UW,backendName:`cpu`,kernelFunc:B8};function V8(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:o,pad:s,dataFormat:c,dilations:l,dimRoundingMode:u}=r;a6([i,a],`conv2d`);let d=SY(c),f=fY(i.shape,a.shape,o,l,s,u,!1,d),p=f.filterHeight,m=f.filterWidth,h=f.dilationHeight,g=f.dilationWidth,_=f.padInfo.left,v=f.padInfo.top,y=f.dataFormat===`channelsLast`,b=new Wq(f.outShape,i.dtype),x=QU(i.shape),S=QU(a.shape),C=x[0],w=y?x[1]:x[2],T=y?x[2]:1,E=y?1:x[1],D=b.strides[0],O=y?b.strides[1]:b.strides[2],k=y?b.strides[2]:1,ee=y?1:b.strides[1],te=n.data.get(i.dataId).values,ne=n.data.get(a.dataId).values,A=b.values;for(let e=0;e<f.batchSize;++e){let t=e*C,n=e*D;for(let e=0;e<f.outHeight;++e){let r=n+e*O,i=e*f.strideHeight-v;for(let e=0;e<p;++e){let n=i+e*h;if(n<0||n>=f.inHeight)continue;let a=e*S[0],o=t+n*w;for(let e=0;e<f.outWidth;++e){let t=r+e*k,n=e*f.strideWidth-_;for(let e=0;e<m;++e){let r=n+e*g;if(r<0||r>=f.inWidth)continue;let i=a+e*S[1],s=o+r*T,c=i;for(let e=0;e<f.inChannels;++e){let n=te[s+e*E];for(let e=0;e<f.outChannels;++e)A[t+e*ee]+=n*ne[c+e];c+=f.outChannels}}}}}}return n.makeTensorInfo(b.shape,b.dtype,A)}const uNe={kernelName:WW,backendName:`cpu`,kernelFunc:V8};function dNe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:o,pad:s,dataFormat:c,dimRoundingMode:l,filterShape:u}=r;a6([i,a],`conv2dBackpropFilter`);let d=SY(c),f=fY(i.shape,u,o,1,s,l,!1,d),{strideHeight:p,strideWidth:m,filterHeight:h,filterWidth:g}=f,_=f.dataFormat===`channelsLast`,v=new Wq(f.filterShape,`float32`),y=f.padInfo.left,b=f.padInfo.top,x=n.data.get(i.dataId).values,S=n.data.get(a.dataId).values,C=new Wq(i.shape,i.dtype,x),w=new Wq(a.shape,a.dtype,S);for(let e=0;e<h;++e){let t=Math.max(0,Math.ceil((b-e)/p)),n=Math.min(f.outHeight,(f.inHeight+b-e)/p);for(let r=0;r<g;++r){let i=Math.max(0,Math.ceil((y-r)/m)),a=Math.min(f.outWidth,(f.inWidth+y-r)/m);for(let o=0;o<f.inChannels;++o)for(let s=0;s<f.outChannels;++s){let c=0;for(let l=0;l<f.batchSize;++l)for(let u=t;u<n;++u){let t=e+u*p-b;for(let e=i;e<a;++e){let n=r+e*m-y;_?c+=C.get(l,t,n,o)*w.get(l,u,e,s):c+=C.get(l,o,t,n)*w.get(l,s,u,e)}}v.set(c,e,r,o,s)}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const fNe={kernelName:GW,backendName:`cpu`,kernelFunc:dNe};function pNe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{inputShape:o,strides:s,pad:c,dataFormat:l,dimRoundingMode:u}=r;a6([i,a],`conv2dBackpropInput`);let d=QU(a.shape),f=QU(i.shape),p=SY(l),m=fY(o,a.shape,s,1,c,u,!1,p),h=new Wq(m.inShape,`float32`),g=h.values,_=n.data.get(i.dataId).values,v=n.data.get(a.dataId).values,[y,b,x]=d,{batchSize:S,filterHeight:C,filterWidth:w,inChannels:T,inHeight:E,inWidth:D,outChannels:O,outHeight:k,outWidth:ee,strideHeight:te,strideWidth:ne}=m;p=m.dataFormat;let A=C-1-m.padInfo.top,j=w-1-m.padInfo.left,re=p===`channelsLast`,ie=h.strides[0],ae=re?h.strides[1]:h.strides[2],oe=re?h.strides[2]:1,se=re?1:h.strides[1],ce=f[0],le=re?f[1]:f[2],ue=re?f[2]:1,de=re?1:f[1];for(let e=0;e<S;++e)for(let t=0;t<T;++t)for(let n=0;n<E;++n){let r=n-A,i=Math.max(0,Math.ceil(r/te)),a=Math.min(k,(C+r)/te);for(let o=0;o<D;++o){let s=o-j,c=Math.max(0,Math.ceil(s/ne)),l=Math.min(ee,(w+s)/ne),u=0;for(let n=i;n<a;++n){let i=n*te-r;for(let r=c;r<l;++r){let a=r*ne-s,o=ce*e+le*n+ue*r,c=y*(C-1-i)+b*(w-1-a)+x*t;for(let e=0;e<O;++e){let t=_[o+de*e],n=v[c+e];u+=t*n}}}let d=ie*e+ae*n+oe*o+se*t;g[d]=u}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const mNe={kernelName:KW,backendName:`cpu`,kernelFunc:pNe};function hNe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:o,pad:s,dilations:c}=r;a6([i,a],`conv3d`);let l=pY(i.shape,a.shape,o,c,s),{filterDepth:u,filterHeight:d,filterWidth:f,dilationDepth:p,dilationHeight:m,dilationWidth:h,padInfo:g}=l,_=g.front,v=g.left,y=g.top,b=new Wq(l.outShape,i.dtype),x=n.data.get(i.dataId).values,S=n.data.get(a.dataId).values,C=b.values,w=QU(i.shape),T=QU(a.shape);for(let e=0;e<l.batchSize;++e){let t=e*w[0],n=e*b.strides[0];for(let e=0;e<l.outDepth;++e){let r=n+e*b.strides[1],i=e*l.strideDepth-_;for(let e=0;e<u;++e){let n=i+e*p;if(n<0||n>=l.inDepth)continue;let a=e*T[0],o=t+n*w[1];for(let e=0;e<l.outHeight;++e){let t=r+e*b.strides[2],n=e*l.strideHeight-y;for(let e=0;e<d;++e){let r=n+e*m;if(r<0||r>=l.inHeight)continue;let i=a+e*T[1],s=o+r*w[2];for(let e=0;e<l.outWidth;++e){let n=t+e*l.outChannels,r=e*l.strideWidth-v;for(let e=0;e<f;++e){let t=r+e*h;if(t<0||t>=l.inWidth)continue;let a=i+e*T[2],o=s+t*l.inChannels,c=a;for(let e=0;e<l.inChannels;++e){let t=x[o+e];for(let e=0;e<l.outChannels;++e)C[n+e]+=t*S[c+e];c+=l.outChannels}}}}}}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const gNe={kernelName:qW,backendName:`cpu`,kernelFunc:hNe};function _Ne(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:o,pad:s,filterShape:c}=r;a6([i,a],`conv3dBackpropFilterV2`);let l=QU(i.shape),u=QU(a.shape),d=pY(i.shape,c,o,1,s),f=d.strideDepth,p=d.strideHeight,m=d.strideWidth,h=d.filterDepth,g=d.filterHeight,_=d.filterWidth,v=new Wq(d.filterShape,`float32`),y=v.values,[b,x,S,C]=v.strides,w=n.data.get(a.dataId).values,[T,E,D,O]=u,k=n.data.get(i.dataId).values,[ee,te,ne,A]=l,j=d.padInfo.front,re=d.padInfo.left,ie=d.padInfo.top;for(let e=0;e<h;++e){let t=Math.max(0,Math.ceil((j-e)/f)),n=Math.min(d.outDepth,(d.inDepth+j-e)/f),r=e*b;for(let i=0;i<g;++i){let a=Math.max(0,Math.ceil((ie-i)/p)),o=Math.min(d.outHeight,(d.inHeight+ie-i)/p),s=i*x+r;for(let r=0;r<_;++r){let c=Math.max(0,Math.ceil((re-r)/m)),l=Math.min(d.outWidth,(d.inWidth+re-r)/m),u=r*S+s;for(let s=0;s<d.inChannels;++s){let h=s*C+u;for(let u=0;u<d.outChannels;++u){let g=0;for(let h=0;h<d.batchSize;++h){let d=h*ee,_=h*T;for(let h=t;h<n;++h){let t=(e+h*f-j)*te+d,n=h*E+_;for(let e=a;e<o;++e){let a=(i+e*p-ie)*ne+t,o=e*D+n;for(let e=c;e<l;++e){let t=(r+e*m-re)*A+a,n=e*O+o;g+=k[t+s]*w[n+u]}}}}y[h+u]=g}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const vNe={kernelName:JW,backendName:`cpu`,kernelFunc:_Ne};function yNe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{pad:o,strides:s,inputShape:c}=r;a6([i],`conv3dBackpropInputV2`);let l=QU(i.shape),u=QU(a.shape),d=pY(c,a.shape,s,1,o),f=new Wq(d.inShape,`float32`),p=f.values,[m,h,g,_]=f.strides,v=n.data.get(i.dataId).values,[y,b,x,S]=l,C=n.data.get(a.dataId).values,[w,T,E,D]=u,{batchSize:O,filterDepth:k,filterHeight:ee,filterWidth:te,inChannels:ne,inDepth:A,inHeight:j,inWidth:re,outChannels:ie,outDepth:ae,outHeight:oe,outWidth:se,strideDepth:ce,strideHeight:le,strideWidth:ue}=d,de=k-1-d.padInfo.front,fe=ee-1-d.padInfo.top,pe=te-1-d.padInfo.left;for(let e=0;e<O;++e)for(let t=0;t<ne;++t)for(let n=0;n<A;++n){let r=n-de,i=Math.max(0,Math.ceil(r/ce)),a=Math.min(ae,(k+r)/ce);for(let o=0;o<j;++o){let s=o-fe,c=Math.max(0,Math.ceil(s/le)),l=Math.min(oe,(ee+s)/le);for(let u=0;u<re;++u){let d=u-pe,f=Math.max(0,Math.ceil(d/ue)),O=Math.min(se,(te+d)/ue),ne=0;for(let n=i;n<a;++n){let i=n*ce-r;for(let r=c;r<l;++r){let a=r*le-s;for(let o=f;o<O;++o){let s=o*ue-d,c=y*e+b*n+x*r+S*o,l=w*(k-1-i)+T*(ee-1-a)+E*(te-1-s)+D*t;for(let e=0;e<ie;++e){let t=v[c+e],n=C[l+e];ne+=t*n}}}}p[m*e+h*n+g*o+_*u+t]=ne}}}return n.makeTensorInfo(f.shape,f.dtype,f.values)}const bNe={kernelName:YW,backendName:`cpu`,kernelFunc:yNe},xNe={kernelName:`Cos`,backendName:`cpu`,kernelFunc:C6(`Cos`,e=>Math.cos(e))},SNe=C6(XW,e=>Math.cosh(e)),CNe={kernelName:XW,backendName:`cpu`,kernelFunc:SNe};function wNe(e){let{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:a,boxInd:o}=t,{cropSize:s,method:c,extrapolationValue:l}=r,[u,d,f,p]=i.shape,m=a.shape[0],[h,g]=s,_=tY([m,h,g,p],`float32`),v=n.data.get(a.dataId).values,y=n.data.get(o.dataId).values,b=n.data.get(i.dataId).values,x=QU(i.shape),S=QU(_.shape);for(let e=0;e<m;e++){let t=e*4,n=v[t],r=v[t+1],i=v[t+2],a=v[t+3],o=y[e];if(o>=u)continue;let s=h>1?(i-n)*(d-1)/(h-1):0,m=g>1?(a-r)*(f-1)/(g-1):0;for(let t=0;t<h;t++){let u=h>1?n*(d-1)+t*s:.5*(n+i)*(d-1);if(u<0||u>d-1){for(let n=0;n<g;n++)for(let r=0;r<p;r++){let i=r+n*S[2]+t*S[1]+e*S[0];_.values[i]=l}continue}if(c===`bilinear`){let n=Math.floor(u),i=Math.ceil(u),s=u-n;for(let c=0;c<g;c++){let u=g>1?r*(f-1)+c*m:.5*(r+a)*(f-1);if(u<0||u>f-1){for(let n=0;n<p;n++){let r=n+c*S[2]+t*S[1]+e*S[0];_.values[r]=l}continue}let d=Math.floor(u),h=Math.ceil(u),v=u-d;for(let r=0;r<p;r++){let a=r+d*x[2]+n*x[1]+o*x[0],l=b[a];a=r+h*x[2]+n*x[1]+o*x[0];let u=b[a];a=r+d*x[2]+i*x[1]+o*x[0];let f=b[a];a=r+h*x[2]+i*x[1]+o*x[0];let p=b[a],m=l+(u-l)*v,g=f+(p-f)*v;a=r+c*S[2]+t*S[1]+e*S[0],_.values[a]=m+(g-m)*s}}}else for(let n=0;n<g;++n){let i=g>1?r*(f-1)+n*m:.5*(r+a)*(f-1);if(i<0||i>f-1){for(let r=0;r<p;r++){let i=r+n*S[2]+t*S[1]+e*S[0];_.values[i]=l}continue}let s=Math.round(i),c=Math.round(u);for(let r=0;r<p;r++){let i=r+s*x[2]+c*x[1]+o*x[0],a=r+n*S[2]+t*S[1]+e*S[0];_.values[a]=b[i]}}}}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const TNe={kernelName:$W,backendName:`cpu`,kernelFunc:wNe};function ENe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,exclusive:o,reverse:s}=r;a6(i,`cumprod`);let c=oX([a],i.shape.length),l=i;c!=null&&(l=X6({inputs:{x:i},backend:n,attrs:{perm:c}}));let u=cX(1,i.shape.length)[0];if(u!==l.shape.length-1)throw Error(`backend.cumprod in CPU expects an inner-most axis=${l.shape.length-1} but got axis=${u}`);let d=$q(l.dtype,`int32`),f=nW(z(l.shape),d),p=n.data.get(l.dataId).values,m=l.shape[l.shape.length-1],h=s?(e,t)=>e+m-t-1:(e,t)=>e+t;for(let e=0;e<p.length;e+=m)for(let t=0;t<m;t++){let n=h(e,t);if(t===0)f[n]=o?1:p[n];else{let r=h(e,t-1);f[n]=o?p[r]*f[r]:p[n]*f[r]}}let g=n.makeTensorInfo(l.shape,d,f);if(c!=null){let e=sX(c),t=X6({inputs:{x:g},backend:n,attrs:{perm:e}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(l),t}return g}const DNe={kernelName:ZW,backendName:`cpu`,kernelFunc:ENe};function ONe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,exclusive:o,reverse:s}=r;a6(i,`cumsum`);let c=oX([a],i.shape.length),l=i;c!=null&&(l=X6({inputs:{x:i},backend:n,attrs:{perm:c}}));let u=cX(1,i.shape.length)[0];if(u!==l.shape.length-1)throw Error(`backend.cumsum in CPU expects an inner-most axis=${l.shape.length-1} but got axis=${u}`);let d=$q(l.dtype,`int32`),f=rW(z(l.shape),d),p=n.data.get(l.dataId).values,m=l.shape[l.shape.length-1],h=s?(e,t)=>e+m-t-1:(e,t)=>e+t;for(let e=0;e<p.length;e+=m)for(let t=0;t<m;t++){let n=h(e,t);if(t===0)f[n]=o?0:p[n];else{let r=h(e,t-1);f[n]=o?p[r]+f[r]:p[n]+f[r]}}let g=n.makeTensorInfo(l.shape,d,f);if(c!=null){let e=sX(c),t=X6({inputs:{x:g},backend:n,attrs:{perm:e}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(l),t}return g}const kNe={kernelName:QW,backendName:`cpu`,kernelFunc:ONe};function ANe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,weights:a}=t,{size:o,binaryOutput:s}=r;if(i.shape.length===1){let e=n.data.get(i.dataId).values,t=n.data.get(a.dataId).values,r=y6(e,t,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,r)}else if(i.shape.length===2){let e=n.bufferSync(i),t=n.bufferSync(a),r=b6(e,t,o,s);return n.makeTensorInfo(r.shape,a.dtype,r.values)}throw Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const jNe={kernelName:eG,backendName:`cpu`,kernelFunc:ANe};function MNe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:a,dataFormat:o}=r;R(o===`NHWC`,()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${o}`);let s=i.shape[0],c=i.shape[1],l=i.shape[2],u=i.shape[3],d=c*a,f=l*a,p=u/(a*a),m=n.data.get(i.dataId).values,h=new Float32Array(s*d*f*p),g=0;for(let e=0;e<s;++e)for(let t=0;t<d;++t){let n=Math.floor(t/a),r=t%a;for(let t=0;t<f;++t){let i=Math.floor(t/a),o=t%a,s=(r*a+o)*p;for(let t=0;t<p;++t){let r=t+s+u*(i+l*(n+c*e));h[g++]=m[r]}}}return n.makeTensorInfo([s,d,f,p],i.dtype,h)}const NNe={kernelName:tG,backendName:`cpu`,kernelFunc:MNe};function H8(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:o,pad:s,dilations:c,dimRoundingMode:l}=r;a6([i,a],`depthwiseConv2DNative`);let u=QU(i.shape),d=QU(a.shape),f=c;f??=[1,1],R(bY(o,f),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${f}'`);let p=fY(i.shape,a.shape,o,f,s,l,!0),{filterHeight:m,filterWidth:h,dilationHeight:g,dilationWidth:_,padInfo:v}=p,y=v.left,b=v.top,x=p.outChannels/p.inChannels,S=new Wq(p.outShape,i.dtype),C=n.data.get(i.dataId).values,w=n.data.get(a.dataId).values,T=S.values;for(let e=0;e<p.batchSize;++e){let t=e*u[0],n=e*S.strides[0];for(let e=0;e<p.outHeight;++e){let r=n+e*S.strides[1],i=e*p.strideHeight-b;for(let e=0;e<m;++e){let n=i+e*g;if(n<0||n>=p.inHeight)continue;let a=e*d[0],o=t+n*u[1];for(let e=0;e<p.outWidth;++e){let t=r+e*S.strides[2],n=e*p.strideWidth-y;for(let e=0;e<h;++e){let r=n+e*_;if(r<0||r>=p.inWidth)continue;let i=a+e*d[1],s=o+r*p.inChannels,c=t,l=i;for(let e=0;e<p.inChannels;++e){let t=C[s+e];for(let e=0;e<x;++e)T[c+e]+=t*w[l+e];c+=x,l+=x}}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const PNe={kernelName:nG,backendName:`cpu`,kernelFunc:H8};function FNe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:o,dilations:s,pad:c,dimRoundingMode:l,filterShape:u}=r;a6([i,a],`depthwiseConv2dNativeBackpropFilter`);let d=fY(i.shape,u,o,s,c,l,!0),{strideHeight:f,strideWidth:p,filterHeight:m,filterWidth:h}=d,g=new Wq(d.filterShape,`float32`),_=d.padInfo.left,v=d.padInfo.top,y=d.outChannels/d.inChannels,b=n.data.get(i.dataId).values,x=new Wq(i.shape,i.dtype,b),S=n.data.get(a.dataId).values,C=new Wq(a.shape,a.dtype,S);for(let e=0;e<m;++e){let t=Math.max(0,Math.ceil((v-e)/f)),n=Math.min(d.outHeight,(d.inHeight+v-e)/f);for(let r=0;r<h;++r){let i=Math.max(0,Math.ceil((_-r)/p)),a=Math.min(d.outWidth,(d.inWidth+_-r)/p);for(let o=0;o<d.outChannels;++o){let s=Math.trunc(o/y),c=o%y,l=0;for(let c=0;c<d.batchSize;++c)for(let u=t;u<n;++u){let t=e+u*f-v;for(let e=i;e<a;++e){let n=r+e*p-_;l+=x.get(c,t,n,s)*C.get(c,u,e,o)}}g.set(l,e,r,s,c)}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const INe={kernelName:rG,backendName:`cpu`,kernelFunc:FNe};function LNe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{strides:o,dilations:s,pad:c,dimRoundingMode:l,inputShape:u}=r;a6([i,a],`depthwiseConv2DNativeBackpropInput`);let d=QU(i.shape),f=QU(a.shape),p=fY(u,a.shape,o,s,c,l,!0),m=new Wq(p.inShape,`float32`),h=m.values,[g,_,v]=m.strides,y=n.data.get(i.dataId).values,[b,x,S]=d,C=n.data.get(a.dataId).values,[w,T,E]=f,{batchSize:D,filterHeight:O,filterWidth:k,inChannels:ee,inHeight:te,inWidth:ne,outChannels:A,outHeight:j,outWidth:re,strideHeight:ie,strideWidth:ae}=p,oe=O-1-p.padInfo.top,se=k-1-p.padInfo.left,ce=A/ee;for(let e=0;e<D;++e)for(let t=0;t<ee;++t)for(let n=0;n<te;++n){let r=n-oe,i=Math.max(0,Math.ceil(r/ie)),a=Math.min(j,(O+r)/ie);for(let o=0;o<ne;++o){let s=o-se,c=Math.max(0,Math.ceil(s/ae)),l=Math.min(re,(k+s)/ae),u=0;for(let n=i;n<a;++n){let i=n*ie-r;for(let r=c;r<l;++r){let a=r*ae-s,o=b*e+x*n+S*r,c=w*(O-1-i)+T*(k-1-a)+E*t;for(let e=0;e<ce;++e){let n=t*ce+e,r=y[o+n],i=C[c+e];u+=r*i}}}h[g*e+_*n+v*o+t]=u}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const RNe={kernelName:iG,backendName:`cpu`,kernelFunc:LNe};function zNe(e){let{inputs:t,backend:n}=e,{x:r}=t,i=z(r.shape),a=n.data.get(r.dataId).values,o=tY([i,i],r.dtype),s=o.values;for(let e=0;e<a.length;e++)s[e*i+e]=a[e];let c=[...r.shape,...r.shape];return n.makeTensorInfo(c,o.dtype,o.values)}const BNe={kernelName:aG,backendName:`cpu`,kernelFunc:zNe},VNe={kernelName:oG,backendName:`cpu`,kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:i}=e,{strides:a,pad:o,dilations:s}=n,c=t,l=c.data.get(r.dataId).values,u=r.shape.length,d=c.data.get(i.dataId).values,f=i.shape.length,{batchSize:p,inHeight:m,inWidth:h,inChannels:g,outHeight:_,outWidth:v,padInfo:y,strideHeight:b,strideWidth:x,filterHeight:S,filterWidth:C,dilationHeight:w,dilationWidth:T,outShape:E}=lY(r.shape,i.shape,a,o,`NHWC`,s),D=z(E),O=E.length,k=BU(r.dtype,D);for(let e=0;e<p;++e)for(let t=0;t<_;++t){let n=t*b-y.top;for(let a=0;a<v;++a){let o=a*x-y.left;for(let s=0;s<g;++s){let c=-(2**53-1);for(let t=0;t<S;++t){let a=n+t*w;if(a>=0&&a<m)for(let n=0;n<C;++n){let p=o+n*T;if(p>=0&&p<h){let o=oW([e,a,p,s],u,QU(r.shape)),m=oW([t,n,s],f,QU(i.shape)),h=l[o]+d[m];h>c&&(c=h)}}}let p=oW([e,t,a,s],O,QU(E));k[p]=c}}}return{dataId:c.write(jq(k,r.dtype),E,r.dtype),shape:E,dtype:r.dtype}}},HNe={kernelName:cG,backendName:`cpu`,kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:i,dy:a}=e,{strides:o,pad:s,dilations:c}=n,l=t,u=eW(r.shape,l.data.get(r.dataId).values),d=eW(i.shape,l.data.get(i.dataId).values),{batchSize:f,inHeight:p,inWidth:m,inChannels:h,outHeight:g,outWidth:_,padInfo:v,strideHeight:y,strideWidth:b,filterHeight:x,filterWidth:S,dilationHeight:C,dilationWidth:w,outShape:T}=lY(r.shape,i.shape,o,s,`NHWC`,c);R(a.rank===T.length,()=>`Error in ${cG}, dy must have the same rank as output ${T.length}, but got ${a.rank}`);let E=eW(T,l.data.get(a.dataId).values),D=iW(i.shape,i.dtype);for(let e=0;e<f;++e)for(let t=0;t<g;++t){let n=t*y-v.top;for(let r=0;r<_;++r){let i=r*b-v.left;for(let a=0;a<h;++a){let o=-(2**53-1),s=0,c=0;for(let t=0;t<x;++t){let r=n+t*C;if(r>=0&&r<p)for(let n=0;n<S;++n){let l=i+n*w;if(l>=0&&l<m){let i=u[e][r][l][a]+d[t][n][a];i>o&&(o=i,s=t,c=n)}}}D[s][c][a]+=E[e][t][r][a]}}}return{dataId:l.write(jq(D,r.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}},UNe={kernelName:sG,backendName:`cpu`,kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,filter:i,dy:a}=e,{strides:o,pad:s,dilations:c}=n,l=t,u=eW(r.shape,l.data.get(r.dataId).values),d=eW(i.shape,l.data.get(i.dataId).values),{batchSize:f,inHeight:p,inWidth:m,inChannels:h,outHeight:g,outWidth:_,padInfo:v,strideHeight:y,strideWidth:b,filterHeight:x,filterWidth:S,dilationHeight:C,dilationWidth:w,outShape:T}=lY(r.shape,i.shape,o,s,`NHWC`,c);R(a.rank===T.length,()=>`Error in ${sG}, dy must have the same rank as output ${T.length}, but got ${a.rank}`);let E=eW(T,l.data.get(a.dataId).values),D=iW(r.shape,r.dtype);for(let e=0;e<f;++e)for(let t=0;t<g;++t){let n=t*y-v.top;for(let r=0;r<_;++r){let i=r*b-v.left;for(let a=0;a<h;++a){let o=-(2**53-1),s=n<0?0:n,c=i<0?0:i;for(let t=0;t<x;++t){let r=n+t*C;if(r>=0&&r<p)for(let n=0;n<S;++n){let l=i+n*w;if(l>=0&&l<m){let i=u[e][r][l][a]+d[t][n][a];i>o&&(o=i,s=r,c=l)}}}D[e][s][c][a]+=E[e][t][r][a]}}}return{dataId:l.write(jq(D,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};function WNe(e){let{inputs:t,backend:n,attrs:r}=e,{image:i}=t,{canvas:a,options:o}=r,{contextOptions:s,imageOptions:c}=o||{},l=c?.alpha||1,u=s?.contextType||`2d`;if(u!==`2d`)throw Error(`Context type ${s.contextType} is not supported by the CPU backend.`);let d=a.getContext(u,s?.contextAttributes||{});if(d==null)throw Error(`Could not get the context with ${u} type.`);let[f,p]=i.shape.slice(0,2),m=i.shape.length===2?1:i.shape[2],h=n.data.get(i.dataId).values,g=i.dtype===`float32`?255:1,_=new Uint8ClampedArray(p*f*4);for(let e=0;e<f*p;++e){let t=[0,0,0,255*l];for(let n=0;n<m;n++){let r=h[e*m+n];if(i.dtype===`float32`){if(r<0||r>1)throw Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${r}.`)}else if(i.dtype===`int32`&&(r<0||r>255))throw Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${r}.`);m===1?(t[0]=r*g,t[1]=r*g,t[2]=r*g):t[n]=r*g}let n=e*4;_[n+0]=Math.round(t[0]),_[n+1]=Math.round(t[1]),_[n+2]=Math.round(t[2]),_[n+3]=Math.round(t[3])}a.width=p,a.height=f;let v=new ImageData(_,p,f);return d.putImageData(v,0,0),i}const GNe={kernelName:`Draw`,backendName:`cpu`,kernelFunc:WNe};function U8(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:o}=r;a6(i,`sum`);let s;s=i.dtype===`bool`?m6({inputs:{x:i},backend:n,attrs:{dtype:`int32`}}):d6({inputs:{x:i},backend:n});let c=s.shape.length,l=LU(a,s.shape),u=oX(l,c),d=l,f=s;u!=null&&(f=X6({inputs:{x:s},backend:n,attrs:{perm:u}}),d=cX(d.length,c)),aX(`sum`,d,f.shape.length);let[p,m]=rX(f.shape,d),h=$q(f.dtype,`int32`),g=u6(n,p,h),_=z(m),v=n.data.get(g.dataId).values,y=n.data.get(f.dataId).values;for(let e=0;e<v.length;++e){let t=e*_,n=0;for(let e=0;e<_;++e)n+=y[t+e];v[e]=n}if(o){let e=iX(g.shape,l),t=g;g=P8({inputs:{x:g},backend:n,attrs:{shape:e}}),n.disposeIntermediateTensorInfo(t)}return n.disposeIntermediateTensorInfo(s),u!=null&&n.disposeIntermediateTensorInfo(f),g}const KNe={kernelName:`Sum`,backendName:`cpu`,kernelFunc:U8};function qNe(e){let{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,a=t,{allDims:o,summedDims:s,idDims:c}=u$(i,a.length);f$(o.length,c,a);let{path:l,steps:u}=p$(s,c),d=u.length,f=null,p=o.length,m=[];for(let e=0;e<d;++e){for(let t of u[e]){let{permutationIndices:e,expandDims:r}=d$(p,c[t]),i;m$(e)?i=a[t]:(i=X6({inputs:{x:a[t]},backend:n,attrs:{perm:e}}),m.push(i));let o=i.shape.slice();for(let e=0;e<r.length;++e)o.splice(r[e],0,1);jU(i.shape,o)||(i=P8({inputs:{x:i},backend:n,attrs:{shape:o}}),m.push(i)),f===null?f=i:(f=K6({inputs:{a:i,b:f},backend:n}),m.push(f))}e<d-1&&(l[e]>=0&&(f=U8({inputs:{x:f},backend:n,attrs:{axis:l[e]-(o.length-p),keepDims:!1}}),m.push(f)),p--)}for(let e of m)e!==f&&n.disposeIntermediateTensorInfo(e);return f}const JNe={kernelName:uG,backendName:`cpu`,kernelFunc:qNe};function YNe(e){let{inputs:t,backend:n}=e,{dy:r,y:i}=t;a6([r,i],`eluGrad`);let a=new Float32Array(z(i.shape)),o=n.data.get(i.dataId).values,s=n.data.get(r.dataId).values;for(let e=0;e<o.length;++e){let t=o[e];t>=0?a[e]=s[e]:a[e]=s[e]*(t+1)}return n.makeTensorInfo(i.shape,`float32`,a)}const XNe={kernelName:dG,backendName:`cpu`,kernelFunc:YNe};var ZNe=qQ,QNe=JQ,$Ne=YQ,ePe=XQ,tPe=ZQ,nPe=QQ;const rPe={kernelName:`Erf`,backendName:`cpu`,kernelFunc:C6(`Erf`,e=>{let t=Math.sign(e),n=Math.abs(e),r=1/(1+ZNe*n);return t*(1-((((nPe*r+tPe)*r+ePe)*r+$Ne)*r+QNe)*r*Math.exp(-n*n))})};function W8(e){let{inputs:t,backend:n,attrs:r}=e,{input:i}=t,{dim:a}=r,o=i.shape.length,s=i.shape.slice(),c=a;return a<0&&(R(-(o+1)<=a,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),c=o+a+1),s.splice(c,0,1),P8({inputs:{x:i},backend:n,attrs:{shape:s}})}const iPe={kernelName:pG,backendName:`cpu`,kernelFunc:W8},aPe=c6((e,t)=>e/t),G8=h6(lG,aPe),K8={kernelName:lG,backendName:`cpu`,kernelFunc:G8};function q8(e,t,n){let r=e.shape,i=r[0],a=r[1],o=n.data.get(e.dataId),s=o.complexTensorInfos.real,c=o.complexTensorInfos.imag,l=[i,a],u=z(l),d=zU(`float32`,u),f=zU(`float32`,u);for(let e=0;e<i;e++){let r=d8({inputs:{x:s},backend:n,attrs:{begin:[e,0],size:[1,a]}}),i=d8({inputs:{x:c},backend:n,attrs:{begin:[e,0],size:[1,a]}}),o=l6({inputs:{real:r,imag:i},backend:n}),{real:l,imag:u}=oPe(o,t,n),p=$Q(l,u);for(let t=0;t<a;t++){let n=r$(p,t);d[e*a+t]=n.real,f[e*a+t]=n.imag}n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o)}let p=n.makeTensorInfo(l,`float32`,d),m=n.makeTensorInfo(l,`float32`,f),h=l6({inputs:{real:p,imag:m},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),h}function oPe(e,t,n){let r=z(e.shape),i=n.data.get(e.dataId),a=n.data.get(i.complexTensorInfos.real.dataId).values,o=n.data.get(i.complexTensorInfos.imag.dataId).values;if(sPe(r)){let i=J8(a,o,r,t,n),s=[e.shape[0],e.shape[1]];if(t){let e=n.makeTensorInfo(s,`float32`,i.real),t=n.makeTensorInfo(s,`float32`,i.imag),a=n.makeTensorInfo([],`float32`,Aq(r,`float32`)),o=d6({inputs:{x:a},backend:n}),c=K8.kernelFunc({inputs:{a:e,b:a},backend:n}),l=K8.kernelFunc({inputs:{a:t,b:o},backend:n}),u=n.data.get(c.dataId).values,d=n.data.get(l.dataId).values;return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),{real:u,imag:d}}return i}else{let e=$Q(a,o),n=cPe(e,r,t);return e$(n)}}function sPe(e){return(e&e-1)==0}function J8(e,t,n,r,i){if(n===1)return{real:e,imag:t};let a=$Q(e,t),o=n/2,s=t$(a),c=s.real,l=s.imag,u=[c.length],d=i.makeTensorInfo(u,`float32`,c),f=i.makeTensorInfo(u,`float32`,l),p=l6({inputs:{real:d,imag:f},backend:i}),m=n$(a),h=m.real,g=m.imag,_=[h.length],v=i.makeTensorInfo(_,`float32`,h),y=i.makeTensorInfo(_,`float32`,g),b=l6({inputs:{real:v,imag:y},backend:i}),x=J8(c,l,o,r,i),S=x.real,C=x.imag,w=[S.length],T=i.makeTensorInfo(w,`float32`,S),E=i.makeTensorInfo(w,`float32`,C),D=l6({inputs:{real:T,imag:E},backend:i}),O=J8(h,g,o,r,i),k=O.real,ee=O.imag,te=[k.length],ne=i.makeTensorInfo(te,`float32`,k),A=i.makeTensorInfo(te,`float32`,ee),j=l6({inputs:{real:ne,imag:A},backend:i}),re=a$(n,r),ie=[re.real.length],ae=i.makeTensorInfo(ie,`float32`,re.real),oe=i.makeTensorInfo(ie,`float32`,re.imag),se=l6({inputs:{real:ae,imag:oe},backend:i}),ce=K6({inputs:{a:se,b:j},backend:i}),le=v6({inputs:{a:D,b:ce},backend:i}),ue=S8({inputs:{a:D,b:ce},backend:i}),de=f6({inputs:{input:le},backend:i}),fe=f6({inputs:{input:ue},backend:i}),pe=z8({inputs:{input:le},backend:i}),me=z8({inputs:{input:ue},backend:i}),he=B8({inputs:[de,fe],backend:i,attrs:{axis:0}}),ge=B8({inputs:[pe,me],backend:i,attrs:{axis:0}}),_e=i.data.get(he.dataId).values,ve=i.data.get(ge.dataId).values;return i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(f),i.disposeIntermediateTensorInfo(p),i.disposeIntermediateTensorInfo(v),i.disposeIntermediateTensorInfo(y),i.disposeIntermediateTensorInfo(b),i.disposeIntermediateTensorInfo(T),i.disposeIntermediateTensorInfo(E),i.disposeIntermediateTensorInfo(D),i.disposeIntermediateTensorInfo(ne),i.disposeIntermediateTensorInfo(A),i.disposeIntermediateTensorInfo(j),i.disposeIntermediateTensorInfo(ae),i.disposeIntermediateTensorInfo(oe),i.disposeIntermediateTensorInfo(se),i.disposeIntermediateTensorInfo(ce),i.disposeIntermediateTensorInfo(le),i.disposeIntermediateTensorInfo(ue),i.disposeIntermediateTensorInfo(de),i.disposeIntermediateTensorInfo(pe),i.disposeIntermediateTensorInfo(fe),i.disposeIntermediateTensorInfo(me),i.disposeIntermediateTensorInfo(he),i.disposeIntermediateTensorInfo(ge),{real:_e,imag:ve}}function cPe(e,t,n){let r=new Float32Array(t*2);for(let i=0;i<t;i++){let a=0,o=0;for(let r=0;r<t;r++){let s=o$(i*r,t,n),c=r$(e,r);a+=c.real*s.real-c.imag*s.imag,o+=c.real*s.imag+c.imag*s.real}n&&(a/=t,o/=t),i$(r,a,o,i)}return r}function lPe(e){let{inputs:t,backend:n}=e,{input:r}=t,i=z(r.shape),a=r.shape[r.shape.length-1],o=i/a,s=P8({inputs:{x:r},backend:n,attrs:{shape:[o,a]}}),c=q8(s,!1,n),l=P8({inputs:{x:c},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(c),l}const uPe={kernelName:`FFT`,backendName:`cpu`,kernelFunc:lPe};function Y8(e){let{backend:t,attrs:n}=e,{shape:r,value:i,dtype:a}=n,o=a||YU(i),s=BU(o,z(r));return fPe(s,i,o),t.makeTensorInfo(r,o,s)}const dPe={kernelName:hG,backendName:`cpu`,kernelFunc:Y8};function fPe(e,t,n){e.fill(t)}const pPe={kernelName:gG,backendName:`cpu`,kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,i=n,a=zU(r.dtype,z(r.shape)),[o,s,c,l]=r.shape,u=i.data.get(r.dataId).values;for(let e=0;e<o;e++){let t=e*c*s*l;for(let e=0;e<s;e++){let n=e*(c*l);for(let e=0;e<c;e++){let r=e*l;for(let i=0;i<l;i++){let o=Math.round(c-e-1),s=t+n+r+i,d=u[s];if(o>=0&&o<c){let e=o*l,r=t+n+e+i;d=u[r]}a[s]=d}}}}return{dataId:i.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};function mPe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a,bias:o,preluActivationWeights:s}=t,{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:f,activation:p,leakyreluAlpha:m}=r,h=V8({inputs:{x:i,filter:a},backend:n,attrs:{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:f}});if(o){let e=h;if(u===`NCHW`&&o.shape.length===1&&o.shape[0]!==1){let e=P8({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});h=v6({inputs:{a:h,b:e},backend:n}),n.disposeIntermediateTensorInfo(e)}else h=v6({inputs:{a:h,b:o},backend:n});n.disposeIntermediateTensorInfo(e)}if(p){let e=h;if(u===`NCHW`&&p===`prelu`&&s.shape.length===1&&s.shape[0]!==1){let e=P8({inputs:{x:s},backend:n,attrs:{shape:[s.shape[0],1,1]}});h=N8(n,h,p,e,m),n.disposeIntermediateTensorInfo(e)}else h=N8(n,h,p,s,m);n.disposeIntermediateTensorInfo(e)}return h}const hPe={kernelName:oq,backendName:`cpu`,kernelFunc:mPe};function gPe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a,bias:o,preluActivationWeights:s}=t,{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:f,activation:p,leakyreluAlpha:m}=r,h=H8({inputs:{x:i,filter:a},backend:n,attrs:{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:f}});if(o){let e=h;h=v6({inputs:{a:h,b:o},backend:n}),n.disposeIntermediateTensorInfo(e)}if(p){let e=h;h=N8(n,h,p,s,m),n.disposeIntermediateTensorInfo(e)}return h}const _Pe={kernelName:sq,backendName:`cpu`,kernelFunc:gPe};function vPe(e){let{inputs:t,backend:n}=e,{params:r,indices:i}=t,a=z(r.shape),o=i.shape,s=o[o.length-1],[c,l,u,d]=fQ(r,i);if(l===0)return n.makeTensorInfo(c,r.dtype,[]);let f=n.data.get(i.dataId).values,p=n.bufferSync(r),m=P6(f,p,r.dtype,l,s,u,d,r.shape,a);return n.makeTensorInfo(c,r.dtype,m.values)}const yPe={kernelName:xG,backendName:`cpu`,kernelFunc:vPe};function bPe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,indices:a}=t,{axis:o,batchDims:s}=r;a6([i,a],`gatherV2`);let c=LU(o,i.shape)[0],l=n.data.get(a.dataId).values,u=i.shape[c];for(let e=0;e<l.length;++e){let t=l[e];R(t<=u-1&&t>=0,()=>`GatherV2: the index value ${t} is not in [0, ${u-1}]`)}let d=s;s??(d=0);let f=z(a.shape),p=A$(i,a,c,d),m=P8({inputs:{x:i},backend:n,attrs:{shape:[p.batchSize,p.outerSize,p.dimSize,p.sliceSize]}}),h=P8({inputs:{x:a},backend:n,attrs:{shape:[p.batchSize,f/p.batchSize]}}),g=[p.batchSize,p.outerSize,f/p.batchSize,p.sliceSize],_=n.bufferSync(h),v=n.bufferSync(m),y=F6(v,_,g);return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(h),n.makeTensorInfo(p.outputShape,y.dtype,y.values)}const xPe={kernelName:bG,backendName:`cpu`,kernelFunc:bPe};function SPe(e){let{inputs:t,backend:n}=e,{input:r}=t,i=z(r.shape),a=r.shape[r.shape.length-1],o=i/a,s=P8({inputs:{x:r},backend:n,attrs:{shape:[o,a]}}),c=q8(s,!0,n),l=P8({inputs:{x:c},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(c),l}const CPe={kernelName:TG,backendName:`cpu`,kernelFunc:SPe},wPe=C6(DG,e=>Number.isFinite(e)?1:0,`bool`),TPe={kernelName:DG,backendName:`cpu`,kernelFunc:wPe},EPe=C6(OG,e=>Math.abs(e)===1/0?1:0,`bool`),DPe={kernelName:OG,backendName:`cpu`,kernelFunc:EPe},OPe=C6(kG,e=>Number.isNaN(e)?1:0,`bool`),kPe={kernelName:kG,backendName:`cpu`,kernelFunc:OPe};function APe(e){let{backend:t,attrs:n}=e,{start:r,stop:i,num:a}=n,o=B6(r,i,a);return t.makeTensorInfo([o.length],`float32`,o)}const jPe={kernelName:NG,backendName:`cpu`,kernelFunc:APe},MPe=C6(PG,e=>Math.log1p(e)),NPe={kernelName:PG,backendName:`cpu`,kernelFunc:MPe},PPe=c6((e,t)=>e&&t),FPe=h6(FG,PPe,null,`bool`),IPe={kernelName:FG,backendName:`cpu`,kernelFunc:FPe},LPe=C6(IG,e=>e?0:1,`bool`),RPe={kernelName:IG,backendName:`cpu`,kernelFunc:LPe},zPe=c6((e,t)=>e||t),BPe=h6(LG,zPe,null,`bool`),VPe={kernelName:LG,backendName:`cpu`,kernelFunc:BPe};function HPe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:a,bias:o,alpha:s,beta:c}=r;a6(i,`LRN`);let l=i.shape[3],u=l-1,d=n.data.get(i.dataId).values,f=z(i.shape),p=new Float32Array(f);function m(e){let t=e%l,n=e-t+Math.max(0,t-a),r=e-t+Math.min(t+a,u),i=0;for(;n<=r;n++){let e=d[n];i+=e*e}return i}for(let e=0;e<f;e++){let t=m(e);p[e]=d[e]*(o+s*t)**+-c}return n.makeTensorInfo(i.shape,i.dtype,p)}const UPe={kernelName:`LRN`,backendName:`cpu`,kernelFunc:HPe};function WPe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,y:a,dy:o}=t,{depthRadius:s,bias:c,alpha:l,beta:u}=r;a6(o,`LRNGrad`);let d=z(o.shape),f=o.shape[3],p=n.data.get(o.dataId).values,m=n.data.get(i.dataId).values,h=n.data.get(a.dataId).values,g=new Float32Array(d),_=d;for(let e=0;e<_;e++){let t=e%f,n=e-t+Math.max(0,t-s),r=e-t+Math.min(f,t+s+1),i=0;for(let e=n;e<r;e++)i+=m[e]**2;i=l*i+c;for(let t=n;t<r;t++){let n=-2*l*u*m[t]*h[e]/i;e===t&&(n+=i**+-u),n*=p[e],g[t]+=n}}return n.makeTensorInfo(o.shape,i.dtype,g)}const GPe={kernelName:RG,backendName:`cpu`,kernelFunc:WPe};function X8(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:a,keepDims:o}=r,s=n,c=i.shape,l=c.length,u=LU(a,c),d=u,f=oX(d,l),p=s.data.get(i.dataId).values;if(f!=null){let e=Array(l);for(let t=0;t<e.length;t++)e[t]=c[f[t]];p=Y6(p,c,i.dtype,f,e),d=cX(d.length,l),c=e}a6(i,`max`),aX(`max`,d,l);let[m,h]=rX(c,d),g=z(h),_=H6(p,g,m,i.dtype),v=s.write(_,m,i.dtype),y=m;return o&&(y=iX(m,u)),{dataId:v,shape:y,dtype:i.dtype}}const KPe={kernelName:`Max`,backendName:`cpu`,kernelFunc:X8};function qPe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;a6(i,`maxPool`);let{filterSize:a,strides:o,pad:s,dimRoundingMode:c}=r;R(bY(o,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);let l=uY(i.shape,a,o,1,s,c),u;if(l.filterWidth===1&&l.filterHeight===1&&jU(l.inShape,l.outShape))u=d6({inputs:{x:i},backend:n});else{let e=n.data.get(i.dataId).values,t=QU(i.shape),r=I8(e,i.shape,i.dtype,t,l,`max`);u=n.makeTensorInfo(l.outShape,i.dtype,r.values)}return u}const JPe={kernelName:BG,backendName:`cpu`,kernelFunc:qPe};function YPe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:o,pad:s,dimRoundingMode:c,dataFormat:l}=r;a6(i,`maxPool3d`);let u=dY(i.shape,a,o,1,s,c,l),d=n.data.get(i.dataId).values,f=R8(d,i.shape,i.dtype,QU(i.shape),u,`max`);return n.makeTensorInfo(f.shape,`float32`,f.values)}const XPe={kernelName:HG,backendName:`cpu`,kernelFunc:YPe};function ZPe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,{filterSize:o,strides:s,pad:c,dimRoundingMode:l}=r;a6([i,a],`maxPool3DGrad`);let u=dY(a.shape,o,s,1,c,l),d=n.bufferSync(a),f=HMe(d,u),p=u.strideDepth,m=u.strideHeight,h=u.strideWidth,g=u.dilationDepth,_=u.dilationHeight,v=u.dilationWidth,y=u.effectiveFilterDepth,b=u.effectiveFilterHeight,x=u.effectiveFilterWidth,S=y-1-u.padInfo.front,C=x-1-u.padInfo.left,w=b-1-u.padInfo.top,T=tY(a.shape,`float32`),E=n.bufferSync(i);for(let e=0;e<u.batchSize;++e)for(let t=0;t<u.inChannels;++t)for(let n=0;n<u.inDepth;++n)for(let r=0;r<u.inHeight;++r)for(let i=0;i<u.inWidth;++i){let a=n-S,o=r-w,s=i-C,c=0;for(let n=0;n<y;n+=g){let r=(a+n)/p;if(!(r<0||r>=u.outDepth||Math.floor(r)!==r))for(let i=0;i<b;i+=_){let a=(o+i)/m;if(!(a<0||a>=u.outHeight||Math.floor(a)!==a))for(let o=0;o<x;o+=v){let l=(s+o)/h;if(l<0||l>=u.outWidth||Math.floor(l)!==l)continue;let d=y*b*x-1-f.get(e,r,a,l,t),p=n*b*x+i*x+o,m=d===p?1:0;if(m===0)continue;let g=E.get(e,r,a,l,t);c+=g*m}}}T.set(c,e,n,r,i,t)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}const QPe={kernelName:UG,backendName:`cpu`,kernelFunc:ZPe};function $Pe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a,output:o}=t,s=a;a6([a,o],`maxPoolGrad`);let{filterSize:c,strides:l,pad:u,dimRoundingMode:d}=r,f=uY(s.shape,c,l,1,u,d),p=n.data.get(s.dataId).values,m=tY(f.outShape,s.dtype,L8(p,s.shape,s.dtype,f).values),h=f.strideHeight,g=f.strideWidth,_=f.dilationHeight,v=f.dilationWidth,y=f.effectiveFilterHeight,b=f.effectiveFilterWidth,x=b-1-f.padInfo.left,S=y-1-f.padInfo.top,C=tY(s.shape,`float32`),w=n.data.get(i.dataId).values,T=tY(i.shape,`float32`,w);for(let e=0;e<f.batchSize;++e)for(let t=0;t<f.inChannels;++t)for(let n=0;n<f.inHeight;++n)for(let r=0;r<f.inWidth;++r){let i=n-S,a=r-x,o=0;for(let n=0;n<y;n+=_){let r=(i+n)/h;if(!(r<0||r>=f.outHeight||Math.floor(r)!==r))for(let i=0;i<b;i+=v){let s=(a+i)/g;if(s<0||s>=f.outWidth||Math.floor(s)!==s)continue;let c=y*b-1-m.get(e,r,s,t),l=n*b+i,u=c===l?1:0;if(u===0)continue;let d=T.get(e,r,s,t);o+=d*u}}C.set(o,e,n,r,t)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const eFe={kernelName:VG,backendName:`cpu`,kernelFunc:$Pe};function tFe(e,t,n,r,i){let a=QU(t),o=I8(e,t,n,a,i,`max`),s=L8(e,t,n,i,!0,r);return[o.values,s.values]}const nFe={kernelName:WG,backendName:`cpu`,kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{filterSize:i,strides:a,pad:o,includeBatchInIndex:s}=t,c=n;a6(r,`MaxPoolWithArgmax`);let l=c.data.get(r.dataId).values,u=uY(r.shape,i,a,[1,1],o),[d,f]=tFe(l,r.shape,r.dtype,s,u),p=c.write(d,u.outShape,r.dtype),m=c.write(f,u.outShape,r.dtype);return[{dataId:p,shape:u.outShape,dtype:r.dtype},{dataId:m,shape:u.outShape,dtype:`int32`}]}};function rFe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:o}=r,s=LU(a,i.shape),c=rX(i.shape,s)[1],l=z(c),u=[],d=n.makeTensorInfo([],`float32`,new Float32Array([l]));u.push(d);let f=m6({inputs:{x:i},backend:n,attrs:{dtype:`float32`}});u.push(f);let p=G8({inputs:{a:f,b:d},backend:n});u.push(p);let m=U8({inputs:{x:p},backend:n,attrs:{axis:a,keepDims:o}});return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),m}const iFe={kernelName:GG,backendName:`cpu`,kernelFunc:rFe};function aFe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:o}=r;a6(i,`min`);let s=LU(a,i.shape),c=s,l=oX(c,i.shape.length),u=i;l!=null&&(u=X6({inputs:{x:i},backend:n,attrs:{perm:l}}),c=cX(c.length,i.shape.length)),aX(`min`,c,u.shape.length);let[d,f]=rX(u.shape,c),p=z(f),m=rW(z(d),u.dtype),h=n.data.get(u.dataId).values;for(let e=0;e<m.length;++e){let t=e*p,n=h[t];for(let e=0;e<p;++e){let r=h[t+e];(Number.isNaN(r)||r<n)&&(n=r)}m[e]=n}l!=null&&n.disposeIntermediateTensorInfo(u);let g=n.makeTensorInfo(d,u.dtype,m);if(o){let e=iX(d,s),t=P8({inputs:{x:g},backend:n,attrs:{shape:e}});return n.disposeIntermediateTensorInfo(g),t}return g}const oFe={kernelName:`Min`,backendName:`cpu`,kernelFunc:aFe};function sFe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:a,mode:o}=r;a6(i,`mirrorPad`);let s=a.map((e,t)=>e[0]+i.shape[t]+e[1]),c=a.map(e=>e[0]),l=a.map((e,t)=>e[0]+i.shape[t]),u=o===`reflect`?0:1,d=n.data.get(i.dataId).values,f=i.shape.length,p=QU(i.shape),m=z(s),h=s.length,g=QU(s),_=zU(i.dtype,m);for(let e=0;e<m;e++){let t=sW(e,h,g);for(let e=0;e<h;e++)t[e]<c[e]?t[e]=c[e]*2-t[e]-u:t[e]>=l[e]&&(t[e]=(l[e]-1)*2-t[e]+u);t=t.map((e,t)=>e-c[t]);let n=oW(t,f,p);_[e]=d[n]}return{dataId:n.write(_,s,i.dtype),shape:s,dtype:i.dtype}}const cFe={kernelName:qG,backendName:`cpu`,kernelFunc:sFe},lFe=c6(((e,t)=>{let n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t})),uFe={kernelName:`Mod`,backendName:`cpu`,kernelFunc:h6(`Mod`,lFe)};function Z8(e){let{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:a}=r,o=i.shape.length,s=a;if(s===-1&&(s=o-1),s!==o-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${o} and dim was ${s}`);let c=LU([s],i.shape),l=X8({inputs:{x:i},backend:n,attrs:{reductionIndices:c,keepDims:!1}}),u=iX(l.shape,c),d=P8({inputs:{x:l},backend:n,attrs:{shape:u}}),f=S8({inputs:{a:i,b:d},backend:n}),p=A6({inputs:{x:f},backend:n}),m=U8({inputs:{x:p},backend:n,attrs:{axis:c,keepDims:!1}}),h=P8({inputs:{x:m},backend:n,attrs:{shape:u}}),g=G8({inputs:{a:p,b:h},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(h),g}const dFe={kernelName:FK,backendName:`cpu`,kernelFunc:Z8};var fFe=l(eZ());function pFe(e){let{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:a,seed:o,normalized:s}=r;a6(i,`multinomial`);let c=s?i:Z8({inputs:{logits:i},backend:n,attrs:{dim:-1}}),l=c.shape[0],u=c.shape[1],d=n.data.get(c.dataId).values,f=[l,a],p=rW(z(f),`int32`);for(let e=0;e<l;++e){let t=e*u,n=new Float32Array(u-1);n[0]=d[t];for(let e=1;e<n.length;++e)n[e]=n[e-1]+d[t+e];let r=fFe.alea(o.toString()),i=e*a;for(let e=0;e<a;++e){let t=r();p[i+e]=n.length;for(let r=0;r<n.length;r++)if(t<n[r]){p[i+e]=r;break}}}return s||n.disposeIntermediateTensorInfo(c),n.makeTensorInfo(f,`int32`,p)}const mFe={kernelName:JG,backendName:`cpu`,kernelFunc:pFe};var hFe=HZ;function gFe(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:c}=r;a6(i,`NonMaxSuppression`);let l=n.data.get(i.dataId).values,u=n.data.get(a.dataId).values,{selectedIndices:d}=hFe(l,u,o,s,c);return n.makeTensorInfo([d.length],`int32`,new Int32Array(d))}const _Fe={kernelName:ZG,backendName:`cpu`,kernelFunc:gFe};var vFe=UZ;function yFe(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:c,padToMaxOutputSize:l}=r;a6(i,`NonMaxSuppressionPadded`);let u=n.data.get(i.dataId).values,d=n.data.get(a.dataId).values,{selectedIndices:f,validOutputs:p}=vFe(u,d,o,s,c,l);return[n.makeTensorInfo([f.length],`int32`,new Int32Array(f)),n.makeTensorInfo([],`int32`,new Int32Array([p]))]}const bFe={kernelName:QG,backendName:`cpu`,kernelFunc:yFe};var xFe=WZ;function SFe(e){let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:c,softNmsSigma:l}=r;a6(i,`NonMaxSuppressionWithScore`);let u=n.data.get(i.dataId).values,d=n.data.get(a.dataId).values,{selectedIndices:f,selectedScores:p}=xFe(u,d,o,s,c,l);return[n.makeTensorInfo([f.length],`int32`,new Int32Array(f)),n.makeTensorInfo([p.length],`float32`,new Float32Array(p))]}const CFe={kernelName:$G,backendName:`cpu`,kernelFunc:SFe};function wFe(e){let{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:a,depth:o,onValue:s,offValue:c}=r;a6(i,`oneHot`);let l=z(i.shape),u=new Float32Array(l*o);u.fill(c);let d=n.data.get(i.dataId).values;for(let e=0;e<l;++e)d[e]>=0&&d[e]<o&&(u[e*o+d[e]]=s);return n.makeTensorInfo([...i.shape,o],a,u)}const TFe={kernelName:tK,backendName:`cpu`,kernelFunc:wFe};function Q8(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype===`string`)throw Error(`zerosLike is not supported for string tensors`);if(r.dtype===`complex64`){let e=f6({inputs:{input:r},backend:n}),t=Q8({inputs:{x:e},backend:n}),i=z8({inputs:{input:r},backend:n}),a=Q8({inputs:{x:i},backend:n}),o=l6({inputs:{real:t,imag:a},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),o}else return Y8({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const EFe={kernelName:nq,backendName:`cpu`,kernelFunc:Q8};function $8(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype===`string`)throw Error(`onesLike is not supported for string tensors`);if(r.dtype===`complex64`){let e=f6({inputs:{input:r},backend:n}),t=$8({inputs:{x:e},backend:n}),i=z8({inputs:{input:r},backend:n}),a=Q8({inputs:{x:i},backend:n}),o=l6({inputs:{real:t,imag:a},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),o}else return Y8({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const DFe={kernelName:eK,backendName:`cpu`,kernelFunc:$8};function e5(e){let{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return W8({inputs:{input:t[0]},backend:n,attrs:{dim:i}});let a=t[0].shape,o=t[0].dtype;t.forEach(e=>{kU(a,e.shape,`All tensors passed to stack must have matching shapes`),R(o===e.dtype,()=>`All tensors passed to stack must have matching dtypes`)});let s=[],c=t.map(e=>{let t=W8({inputs:{input:e},backend:n,attrs:{dim:i}});return s.push(t),t}),l=B8({inputs:c,backend:n,attrs:{axis:i}});return s.forEach(e=>n.disposeIntermediateTensorInfo(e)),l}const OFe={kernelName:nK,backendName:`cpu`,kernelFunc:e5};function kFe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:a,constantValue:o}=r;a6(i,`pad`);let s=a.map((e,t)=>e[0]+i.shape[t]+e[1]),c=a.map(e=>e[0]),l=n.data.get(i.dataId).values,u=z(i.shape),d=i.shape.length,f=QU(i.shape),p=z(s),m=s.length,h=QU(s),g=zU(i.dtype,p);o!==0&&g.fill(o);for(let e=0;e<u;e++){let t=sW(e,d,f).map((e,t)=>e+c[t]),n=oW(t,m,h);g[n]=l[e]}return{dataId:n.write(g,s,i.dtype),shape:s,dtype:i.dtype}}const t5={kernelName:rK,backendName:`cpu`,kernelFunc:kFe},AFe=c6((e,t)=>e**+t),jFe={kernelName:`Pow`,backendName:`cpu`,kernelFunc:h6(`Pow`,AFe)};function MFe(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:a,indices:o}=t,{outputRaggedRank:s}=r,c=i.map(e=>n.data.get(e.dataId).values),l=i.map(e=>e.shape),u=n.data.get(a.dataId).values,d=n.data.get(o.dataId).values,[f,p,m]=$6(c,l,u,a.shape,a.dtype,d,o.shape,s),h=f.map(e=>n.makeTensorInfo([e.length],`int32`,e)),g=n.makeTensorInfo(m,a.dtype,p);return h.concat([g])}const NFe={kernelName:oK,backendName:`cpu`,kernelFunc:MFe};function PFe(e){let{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:a}=t,o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,[l,u]=t8(o,r.shape,r.dtype,s,i.shape,c,a.shape),d=n.makeTensorInfo([l.length],`int32`,l),f=n.makeTensorInfo([u.length],r.dtype,u);return[d,f]}const FFe={kernelName:sK,backendName:`cpu`,kernelFunc:PFe};function IFe(e){let{inputs:t,backend:n,attrs:r}=e,{shape:i,values:a,defaultValue:o,rowPartitionTensors:s}=t,{rowPartitionTypes:c}=r,l=n.data.get(i.dataId).values,u=n.data.get(a.dataId).values,d=n.data.get(o.dataId).values,f=s.map(e=>n.data.get(e.dataId).values),p=s.map(e=>e.shape),[m,h]=a8(l,i.shape,u,a.shape,a.dtype,d,o.shape,f,p,c);return n.makeTensorInfo(m,a.dtype,h)}const LFe={kernelName:cK,backendName:`cpu`,kernelFunc:IFe};function RFe(e){let{backend:t,attrs:n}=e,{start:r,stop:i,dtype:a,step:o}=n,s=o8(r,i,o,a);return t.makeTensorInfo([s.length],a,s)}const zFe={kernelName:lK,backendName:`cpu`,kernelFunc:RFe},BFe=C6(dK,e=>1/e),VFe={kernelName:dK,backendName:`cpu`,kernelFunc:BFe};function HFe(e){let{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:a,halfPixelCenters:o,size:s}=r;a6(i,`resizeBilinear`);let c=QU(i.shape),[l,u]=s,[d,f,p,m]=i.shape,h=n.data.get(i.dataId).values,g=new Float32Array(z([d,l,u,m])),_=[a&&l>1?f-1:f,a&&u>1?p-1:p],v=[a&&l>1?l-1:l,a&&u>1?u-1:u],y=0,b=_[0]/v[0],x=_[1]/v[1];for(let e=0;e<d;e++)for(let t=0;t<l;t++){let n;n=o?b*(t+.5)-.5:b*t;let r=Math.max(0,Math.floor(n)),i=n-r,a=Math.min(f-1,Math.ceil(n)),s=e*c[0]+r*c[1],l=e*c[0]+a*c[1];for(let e=0;e<u;e++){let t;t=o?x*(e+.5)-.5:x*e;let n=Math.max(0,Math.floor(t)),r=t-n,a=Math.min(p-1,Math.ceil(t)),u=s+n*c[2],d=l+n*c[2],f=s+a*c[2],_=l+a*c[2];for(let e=0;e<m;e++){let t=h[u+e],n=h[d+e],a=h[f+e],o=h[_+e],s=t+(a-t)*r,c=n+(o-n)*r,l=s+(c-s)*i;g[y++]=l}}}return n.makeTensorInfo([d,l,u,m],`float32`,g)}const UFe={kernelName:gK,backendName:`cpu`,kernelFunc:HFe};function WFe(e){let{inputs:t,backend:n,attrs:r}=e,{images:i,dy:a}=t,{alignCorners:o}=r;a6([a,i],`resizeBilinearGrad`);let s=QU(i.shape),[c,l,u,d]=i.shape,[,f,p]=a.shape,m=new Float32Array(c*l*u*d),h=[o&&f>1?l-1:l,o&&p>1?u-1:u],g=[o&&f>1?f-1:f,o&&p>1?p-1:p],_=h[0]/g[0],v=h[1]/g[1],y=n.data.get(a.dataId).values,b=0;for(let e=0;e<c;e++){let t=e*s[0];for(let e=0;e<f;e++){let n=e*_,r=Math.floor(n),i=Math.min(Math.ceil(n),l-1),a=t+r*s[1],o=t+i*s[1],c=n-r,f=1-c;for(let e=0;e<p;e++){let t=e*v,n=Math.floor(t),r=Math.min(Math.ceil(t),u-1),i=t-n,l=1-i,p=a+n*s[2],h=a+r*s[2],g=o+n*s[2],_=o+r*s[2],x=f*l,S=f*i,C=c*l,w=c*i;for(let e=0;e<d;e++){let t=y[b++];m[p+e]+=t*x,m[h+e]+=t*S,m[g+e]+=t*C,m[_+e]+=t*w}}}}return n.makeTensorInfo([c,u,l,d],`float32`,m)}const GFe={kernelName:_K,backendName:`cpu`,kernelFunc:WFe};function KFe(e){let{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:a,halfPixelCenters:o,size:s}=r;a6(i,`resizeNearestNeighbor`);let c=QU(i.shape),[l,u]=s,[d,f,p,m]=i.shape,h=n.data.get(i.dataId).values,g=new Float32Array(d*l*u*m),_=[a&&l>1?f-1:f,a&&u>1?p-1:p],v=[a&&l>1?l-1:l,a&&u>1?u-1:u],y=_[0]/v[0],b=_[1]/v[1],x=0;for(let e=0;e<d;e++){let t=e*c[0];for(let e=0;e<l;e++){let n=o?y*(e+.5):y*e,r=Math.min(f-1,a?Math.round(n):Math.floor(n));o&&(r=Math.max(0,r));let i=t+r*c[1];for(let e=0;e<u;e++){let t=o?b*(e+.5):b*e,n=Math.min(p-1,a?Math.round(t):Math.floor(t));o&&(n=Math.max(0,n));let r=i+n*c[2];for(let e=0;e<m;e++){let t=h[r+e];g[x++]=t}}}}return n.makeTensorInfo([d,l,u,m],i.dtype,g)}const qFe={kernelName:mK,backendName:`cpu`,kernelFunc:KFe};function JFe(e){let{inputs:t,backend:n,attrs:r}=e,{images:i,dy:a}=t,{alignCorners:o}=r;a6([a,i],`resizeNearestNeighborGrad`);let s=QU(i.shape),c=QU(a.shape),[l,u,d,f]=i.shape,[,p,m]=a.shape,h=new Float32Array(l*u*d*f),g=n.data.get(a.dataId).values,_=[o&&p>1?u-1:u,o&&m>1?d-1:d],v=[o&&p>1?p-1:p,o&&m>1?m-1:m],y=_[0]/v[0],b=_[1]/v[1],x=1/y,S=1/b,C=Math.ceil(x)*2+2,w=Math.ceil(S)*2+2;for(let e=0;e<l;e++){let t=e*s[0];for(let e=0;e<u;e++){let n=t+e*s[1],r=Math.floor(e*x),i=Math.floor(r-C/2);for(let r=0;r<d;r++){let a=n+r*s[2],l=Math.floor(r*S),_=Math.floor(l-w/2);for(let n=0;n<f;n++){let s=0;for(let a=0;a<C;a++){let l=a+i;if(l<0||l>=p)continue;let f=t+l*c[1],h=l*y,v=Math.min(u-1,o?Math.round(h):Math.floor(h));if(e===v)for(let e=0;e<w;e++){let t=e+_;if(t<0||t>=m)continue;let i=f+t*c[2],a=t*b,l=Math.min(d-1,o?Math.round(a):Math.floor(a));r===l&&(s+=g[i+n])}}h[a+n]=s}}}}return n.makeTensorInfo(i.shape,i.dtype,h)}const YFe={kernelName:hK,backendName:`cpu`,kernelFunc:JFe};function XFe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:a}=r;a6(i,`reverse`);let o=i.shape.length,s=LU(a,i.shape);if(o===0)return d6({inputs:{x:i},backend:n});let c=new Wq(i.shape,i.dtype),l=n.bufferSync(i);for(let e=0;e<c.size;e++){let t=c.indexToLoc(e),n=t.slice();s.forEach(e=>n[e]=i.shape[e]-1-n[e]),c.set(l.get(...n),...t)}return n.makeTensorInfo(c.shape,c.dtype,c.values)}const ZFe={kernelName:yK,backendName:`cpu`,kernelFunc:XFe},QFe={kernelName:iq,backendName:`cpu`,kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,{radians:i,fillValue:a,center:o}=t,s=n,c=zU(r.dtype,z(r.shape)),[l,u,d,f]=r.shape,[p,m]=zQ(o,u,d),h=Math.sin(i),g=Math.cos(i),_=s.data.get(r.dataId).values;for(let e=0;e<l;e++){let t=e*d*u*f;for(let e=0;e<u;e++){let n=e*(d*f);for(let r=0;r<d;r++){let i=r*f;for(let o=0;o<f;o++){let s=[l,e,r,o],v=s[2],y=s[1],b=(v-p)*g-(y-m)*h,x=(v-p)*h+(y-m)*g;b=Math.round(b+p),x=Math.round(x+m);let S=a;if(typeof a!=`number`&&(S=o===3?255:a[o]),b>=0&&b<d&&x>=0&&x<u){let e=x*(d*f),n=b*f,r=t+e+n+o;S=_[r]}let C=t+n+i+o;c[C]=S}}}}return{dataId:s.write(c,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},$Fe=C6(bK,e=>{let t=Math.floor(e);return e-t<.5?Math.floor(e):e-t>.5?Math.ceil(e):t%2==0?t:t+1}),eIe={kernelName:bK,backendName:`cpu`,kernelFunc:$Fe};function tIe(e){let{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:a}=t,{shape:o}=r,{sliceRank:s,numUpdates:c,sliceSize:l,strides:u,outputSize:d}=kZ(a,i,o),f=n.bufferSync(i),p=n.bufferSync(a),m=c8(f,p,o,d,l,c,s,u,0,!0);return n.makeTensorInfo(o,m.dtype,m.values)}const nIe={kernelName:SK,backendName:`cpu`,kernelFunc:tIe};function rIe(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<t?n=i+1:r=i;return r}function iIe(e,t){let n=0,r=e.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),e[i]<=t?n=i+1:r=i;return r}function aIe(e,t,n,r,i,a){let o=BU(`int32`,n*i);for(let s=0;s<n;++s){let n=e.slice(s*r,(s+1)*r),c=s*i;for(let e=0;e<i;++e)o[c+e]=a===`left`?rIe(n,t[e+c]):iIe(n,t[e+c])}return o}function oIe(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:a}=t,{side:o}=r,s=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,l=aIe(s,c,i.shape[0],i.shape[1],a.shape[1],o);return n.makeTensorInfo(a.shape,`int32`,l)}const sIe={kernelName:wK,backendName:`cpu`,kernelFunc:oIe};function cIe(e){let{inputs:t,backend:n}=e,{condition:r,t:i,e:a}=t;a6([r,i,a],`select`);let o=r.shape.length,s=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,u=$q(i.dtype,a.dtype),d=rW(z(i.shape),u),f=0,p=o===0||o>1||i.shape.length===1?1:z(i.shape.slice(1));for(let e=0;e<s.length;e++)for(let t=0;t<p;t++)s[e]===1?d[f++]=c[e]:d[f++]=l[e];return n.makeTensorInfo(i.shape,u,d)}const lIe={kernelName:TK,backendName:`cpu`,kernelFunc:cIe};var uIe=GQ,dIe=KQ;const fIe=C6(EK,e=>e>=0?dIe*e:uIe*(Math.exp(e)-1)),pIe={kernelName:EK,backendName:`cpu`,kernelFunc:fIe},mIe=C6(kK,e=>e<0?-1:e>0?1:0),hIe={kernelName:kK,backendName:`cpu`,kernelFunc:mIe},gIe={kernelName:`Sin`,backendName:`cpu`,kernelFunc:C6(`Sin`,e=>Math.sin(e))},_Ie=C6(OK,e=>Math.sinh(e)),vIe={kernelName:OK,backendName:`cpu`,kernelFunc:_Ie};var n5=Math.log(1.1920928955078125e-7)+2;const yIe=C6(jK,e=>{let t=e>-n5,n=e<n5,r=Math.exp(e),i;return i=n?r:t?e:Math.log(1+r),i}),bIe={kernelName:jK,backendName:`cpu`,kernelFunc:yIe};function xIe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:a,paddings:o}=r;a6([i],`spaceToBatchND`);let s=z(a),c=[[0,0]];c.push(...o);for(let e=1+a.length;e<i.shape.length;++e)c.push([0,0]);let l=t5.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:c,constantValue:0}}),u=BQ(l.shape,a,s,!1),d=VQ(u.length,a.length,!1),f=HQ(l.shape,a,s,!1),p=P8({inputs:{x:l},backend:n,attrs:{shape:u}}),m=X6({inputs:{x:p},backend:n,attrs:{perm:d}}),h=P8({inputs:{x:m},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),h}const SIe={kernelName:NK,backendName:`cpu`,kernelFunc:xIe};function CIe(e){let{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:a,defaultValue:o}=t;if(a.shape.length!==1)throw Error(`Dense shape must be a vector, saw:
        ${a.shape}`);if(r.shape.length!==2)throw Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(i.shape.length!==1)throw Error(`Values must be a vector, saw:
        ${i.shape}`);if(o.shape.length!==0)throw Error(`Default value must be a scalar, saw:
        ${o.shape}`);let s=n.data.get(r.dataId).values,c=n.data.get(i.dataId).values,l=n.data.get(a.dataId).values,u=n.data.get(o.dataId).values[0],[d,f,p,m,h]=f8(s,r.shape,r.dtype,c,i.dtype,l,u);return[n.makeTensorInfo(f,r.dtype,d),n.makeTensorInfo([f[0]],i.dtype,p),n.makeTensorInfo([m.length],`bool`,new Uint8Array(m.map(e=>Number(e)))),n.makeTensorInfo([h.length],r.dtype,new Int32Array(h))]}const wIe={kernelName:IK,backendName:`cpu`,kernelFunc:CIe};function TIe(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:a}=t;if(r.shape.length!==2)throw Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(i.shape.length!==1)throw Error(`Input shape should be a vector but received shape
        ${i.shape}`);if(a.shape.length!==1)throw Error(`Target shape should be a vector but received shape ${a.shape}`);let o=Array.from(n.data.get(i.dataId).values),s=n.data.get(r.dataId).values,c=Array.from(n.data.get(a.dataId).values),[l,u,d]=p8(s,r.shape,r.dtype,o,c);return[n.makeTensorInfo(u,r.dtype,l),n.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}const EIe={kernelName:LK,backendName:`cpu`,kernelFunc:TIe};function DIe(e){let{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:a}=t;if(r.shape.length<1)throw Error(`Data should be at least 1 dimensional but received scalar`);if(i.shape.length!==1)throw Error(`Indices should be a vector but received shape
          ${i.shape}`);if(a.shape.length!==1)throw Error(`Segment ids should be a vector but received shape
          ${a.shape}`);if(i.shape[0]!==a.shape[0])throw Error(`segmentIds and indices should have same size.`);let o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,[l,u]=m8(o,r.shape,r.dtype,s,c,!0);return n.makeTensorInfo(u,r.dtype,l)}const OIe={kernelName:RK,backendName:`cpu`,kernelFunc:DIe};function kIe(e){let{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:a}=t;if(r.shape.length<1)throw Error(`Data should be at least 1 dimensional but received scalar`);if(i.shape.length!==1)throw Error(`Indices should be a vector but received shape
         ${i.shape}`);if(a.shape.length!==1)throw Error(`Segment ids should be a vector but received shape
         ${a.shape}`);if(i.shape[0]!==a.shape[0])throw Error(`segmentIds and indices should have same size.`);let o=n.data.get(r.dataId).values,s=n.data.get(i.dataId).values,c=n.data.get(a.dataId).values,[l,u]=m8(o,r.shape,r.dtype,s,c);return n.makeTensorInfo(u,r.dtype,l)}const AIe={kernelName:zK,backendName:`cpu`,kernelFunc:kIe};function jIe(e){let{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:a,defaultValue:o}=t,{outputShape:s}=r,{sliceRank:c,numUpdates:l,sliceSize:u,strides:d,outputSize:f}=kZ(a,i,s),p=n.bufferSync(i),m;switch(a.dtype){case`bool`:{let e=n.bufferSync(a),t=!!n.data.get(o.dataId).values[0];m=c8(p,e,s,f,u,l,c,d,t,!1);break}case`float32`:{let e=n.bufferSync(a),t=n.data.get(o.dataId).values[0];m=c8(p,e,s,f,u,l,c,d,t,!1);break}case`int32`:{let e=n.bufferSync(a),t=n.data.get(o.dataId).values[0];m=c8(p,e,s,f,u,l,c,d,t,!1);break}case`string`:{let e=n.bufferSync(a),t=Pq(n.data.get(o.dataId).values[0]);m=c8(p,e,s,f,u,l,c,d,t,!1);break}default:throw Error(`Unsupported type ${a.dtype}`)}return n.makeTensorInfo(s,m.dtype,m.values)}const MIe={kernelName:BK,backendName:`cpu`,kernelFunc:jIe};function NIe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:a,axis:o}=r,s=LU(o,i.shape)[0],c=h$(i,a,s),l=Array(i.shape.length).fill(0),u=i.shape.slice();return c.map(e=>{let t=[...u];t[s]=e;let r=d8({inputs:{x:i},backend:n,attrs:{begin:l,size:t}});return l[s]+=e,r})}const PIe={kernelName:PK,backendName:`cpu`,kernelFunc:NIe},FIe={kernelName:HK,backendName:`cpu`,kernelFunc:({inputs:e,backend:t})=>{let{x:n}=e,r=t;a6(n,`square`);let i=r.data.get(n.dataId).values,a=new Float32Array(i.length);for(let e=0;e<i.length;++e){let t=i[e];a[e]=t*t}return{dataId:r.write(a,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}},IIe=C6(rq,(e,t)=>{let n=t;return isNaN(e)?NaN:e>0?1:n.alpha}),LIe={kernelName:rq,backendName:`cpu`,kernelFunc:IIe};function RIe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:a,end:o,strides:s,beginMask:c,endMask:l,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:f}=r;a6(i,`stridedSlice`);let{finalShapeSparse:p,finalShape:m,isIdentity:h,sliceDim0:g,isSimpleSlice:_,begin:v,end:y,strides:b}=DQ(i.shape,a,o,s,c,l,u,d,f),x;if(h)x=P8({inputs:{x:i},backend:n,attrs:{shape:m}});else if(g||_){R(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);let e=hQ(v,y,b),t=d8({inputs:{x:i},backend:n,attrs:{begin:v,size:e}});x=P8({inputs:{x:t},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(t)}else{let e=n.bufferSync(i),t=_8(p,e,b,v);x=n.makeTensorInfo(m,t.dtype,t.values)}return x}const zIe={kernelName:WK,backendName:`cpu`,kernelFunc:RIe};function BIe(e){let{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:a,leftPad:o,rightPad:s,padWidth:c,preserveShortSequences:l}=r,{data:u,dataSplits:d}=t,f=n.data.get(u.dataId).values,p=n.data.get(d.dataId).values,[m,h]=v8(f,p,i,a,o,s,c,l);return[n.makeTensorInfo([m.length],`string`,m),n.makeTensorInfo(d.shape,`int32`,h)]}const VIe={kernelName:GK,backendName:`cpu`,kernelFunc:BIe};function HIe(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:a,delimiter:o}=t;if(a.dtype!==`string`)throw Error(`Input must be of datatype string`);if(a.shape.length!==1)throw Error(`Input must be a vector, got shape: ${a.shape}`);if(o.shape.length!==0)throw Error(`Delimiter must be a scalar, got shape: ${o.shape}`);let s=n.data.get(a.dataId).values,c=n.data.get(o.dataId).values[0],[l,u,d]=y8(s,c,i),f=u.length;return[n.makeTensorInfo([f,2],`int32`,l),n.makeTensorInfo([f],`string`,u),n.makeTensorInfo([2],`int32`,new Int32Array(d))]}const UIe={kernelName:KK,backendName:`cpu`,kernelFunc:HIe};function WIe(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:a}=t;if(a.dtype!==`string`)throw Error(`Input must be of datatype string`);if(i<=0)throw Error(`Number of buckets must be at least 1`);let o=n.data.get(a.dataId).values,s=b8(o,i);return n.makeTensorInfo(a.shape,`int32`,s)}const GIe={kernelName:qK,backendName:`cpu`,kernelFunc:WIe},KIe={kernelName:`Tan`,backendName:`cpu`,kernelFunc:C6(`Tan`,e=>Math.tan(e))},qIe=C6(JK,e=>Math.tanh(e)),JIe={kernelName:JK,backendName:`cpu`,kernelFunc:qIe};function YIe(e){let{inputs:t,backend:n}=e,{tensor:r,indices:i,updates:a}=t,{sliceRank:o,numUpdates:s,sliceSize:c,strides:l,outputSize:u}=kZ(a,i,r.shape),d=n.bufferSync(i),f=n.bufferSync(a),p=n.bufferSync(r),m=c8(d,f,r.shape,u,c,s,o,l,p,!1);return n.makeTensorInfo(r.shape,m.dtype,m.values)}const XIe={kernelName:CK,backendName:`cpu`,kernelFunc:YIe};function ZIe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:a}=r;a6(i,`tile`);let o=C8(n.bufferSync(i),a);return n.makeTensorInfo(o.shape,o.dtype,o.values)}const QIe={kernelName:YK,backendName:`cpu`,kernelFunc:ZIe};function $Ie(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:a,sorted:o}=r;a6(i,`topk`);let s=n.data.get(i.dataId).values,[c,l]=E8(s,i.shape,i.dtype,a,o);return[n.makeTensorInfo(c.shape,c.dtype,c.values),n.makeTensorInfo(l.shape,l.dtype,l.values)]}const eLe={kernelName:XK,backendName:`cpu`,kernelFunc:$Ie};function tLe(e){let{inputs:t,attrs:n,backend:r}=e,{image:i,transforms:a}=t,{interpolation:o,fillMode:s,fillValue:c,outputShape:l}=n,[u,d,f,p]=i.shape,[m,h]=l??[d,f],g=[u,m,h,p],_=QU(i.shape),v=_[0],y=_[1],b=_[2],x=QU(g),S=x[0],C=x[1],w=x[2],T=zU(i.dtype,z(g));T.fill(c);let E=r.data.get(i.dataId).values,D=r.data.get(a.dataId).values;for(let e=0;e<u;++e){let t=a.shape[0]===1?D:D.subarray(e*8,e*8+8);for(let n=0;n<m;++n)for(let r=0;r<h;++r)for(let i=0;i<p;++i){let a,l=t[6]*r+t[7]*n+1;if(l===0)continue;let u=(t[0]*r+t[1]*n+t[2])/l,p=(t[3]*r+t[4]*n+t[5])/l,m=r5(u,f,s),h=r5(p,d,s);switch(o){case`nearest`:a=sLe(E,d,f,v,y,b,e,h,m,i,c);break;case`bilinear`:a=cLe(E,d,f,v,y,b,e,h,m,i,c);break;default:throw Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${o}`)}let g=e*S+n*C+r*w+i;T[g]=a}return r.makeTensorInfo(g,i.dtype,T)}return{dataId:r.write(T,g,i.dtype),shape:i.shape,dtype:i.dtype}}const nLe={kernelName:ZK,backendName:`cpu`,kernelFunc:tLe};function r5(e,t,n){switch(n){case`reflect`:return rLe(e,t);case`wrap`:return iLe(e,t);case`nearest`:return oLe(e,t);case`constant`:default:return aLe(e,t)}}function rLe(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let e=2*t;n<e&&(n=e*Math.trunc(-n/e)+n),n=n<-t?n+e:-n-1}else if(n>t-1)if(t<=1)n=0;else{let e=2*t;n-=e*Math.trunc(n/e),n>=t&&(n=e-n-1)}return TU(0,n,t-1)}function iLe(e,t){let n=e;if(n<0)if(t<=1)n=0;else{let e=t-1;n+=t*(Math.trunc(-n/e)+1)}else if(n>t-1)if(t<=1)n=0;else{let e=t-1;n-=t*Math.trunc(n/e)}return TU(0,n,t-1)}function aLe(e,t){return e}function oLe(e,t){return TU(0,e,t-1)}function i5(e,t,n,r,i,a,o,s,c,l,u){let d=o*r+s*i+c*a+l;return 0<=s&&s<t&&0<=c&&c<n?e[d]:u}function sLe(e,t,n,r,i,a,o,s,c,l,u){return i5(e,t,n,r,i,a,o,Math.round(s),Math.round(c),l,u)}function cLe(e,t,n,r,i,a,o,s,c,l,u){let d=Math.floor(s),f=Math.floor(c),p=d+1,m=f+1,h=(m-c)*i5(e,t,n,r,i,a,o,d,f,l,u)+(c-f)*i5(e,t,n,r,i,a,o,d,m,l,u),g=(m-c)*i5(e,t,n,r,i,a,o,p,f,l,u)+(c-f)*i5(e,t,n,r,i,a,o,p,m,l,u);return(p-s)*h+(s-d)*g}function lLe(e){let{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:a}=t;a6(a,`unique`);let o=r.data.get(a.dataId).values,{outputValues:s,outputShape:c,indices:l}=D8(o,i,a.shape,a.dtype);return[r.makeTensorInfo(c,a.dtype,s),r.makeTensorInfo([l.length],`int32`,l)]}const uLe={kernelName:$K,backendName:`cpu`,kernelFunc:lLe};function dLe(e){let{inputs:t,backend:n,attrs:r}=e,{value:i}=t,{axis:a}=r;a<0&&(a+=i.shape.length);let o=i.shape.length,s=i.shape[a],c=Array(o-1),l=0;for(let e=0;e<o;e++)e!==a&&(c[l++]=i.shape[e]);let u=Array(o).fill(0),d=i.shape.slice();d[a]=1;let f=Array(s);for(let e=0;e<f.length;e++){u[a]=e;let t=d8({inputs:{x:i},backend:n,attrs:{begin:u,size:d}});f[e]=P8({inputs:{x:t},backend:n,attrs:{shape:c}}),n.disposeIntermediateTensorInfo(t)}return f}const fLe={kernelName:eq,backendName:`cpu`,kernelFunc:dLe};function pLe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:a}=t,{numSegments:o}=r;a6(i,`unsortedSegmentSum`);let s=i.shape.length,c=a.shape.length,l=[],u=[],d=s-c,f=a;for(let e=0;e<d;++e){let t=W8({inputs:{input:f},backend:n,attrs:{dim:e+1}});f=t,u.push(t)}for(let e=0;e<o;++e){let t=Aq(e,`int32`),r=n.makeTensorInfo([],`int32`,t),a=O6({inputs:{a:r,b:f},backend:n}),o=m6({inputs:{x:a},backend:n,attrs:{dtype:`float32`}}),s=K6({inputs:{a:o,b:i},backend:n}),c=U8({inputs:{x:s},backend:n,attrs:{axis:0,keepDims:!1}});l.push(c),u.push(r),u.push(a),u.push(o),u.push(s),u.push(c)}let p=e5({inputs:l,backend:n,attrs:{axis:0}});return u.forEach(e=>n.disposeIntermediateTensorInfo(e)),p}var mLe=[gMe,XAe,vMe,bMe,nje,SMe,wMe,EMe,OMe,AMe,MMe,PMe,IMe,zMe,VMe,WMe,KMe,JMe,XMe,mMe,QMe,eNe,nNe,ije,iNe,eje,oje,oNe,ZAe,sNe,lNe,uNe,fNe,mNe,gNe,vNe,bNe,xNe,CNe,TNe,DNe,kNe,jNe,NNe,PNe,INe,RNe,BNe,VNe,HNe,UNe,GNe,JNe,sMe,XNe,sje,rPe,cje,iPe,uje,uPe,dPe,pPe,fje,mje,hPe,_Pe,yPe,xPe,gje,vje,QAe,CPe,cNe,TPe,DPe,kPe,cMe,bje,Sje,jPe,Cje,NPe,IPe,RPe,VPe,UPe,GPe,KPe,Tje,JPe,XPe,QPe,eFe,nFe,iFe,oFe,Dje,cFe,uFe,mFe,kje,jje,_Fe,bFe,CFe,Nje,TFe,DFe,OFe,t5,jFe,uMe,Ije,NFe,FFe,LFe,zFe,$Ae,K8,VFe,dMe,fMe,pMe,UFe,GFe,qFe,YFe,ZFe,QFe,eIe,Gje,nIe,sIe,lIe,pIe,qje,hIe,gIe,vIe,Jje,dFe,bIe,SIe,wIe,EIe,OIe,AIe,MIe,PIe,Zje,FIe,$je,tMe,LIe,zIe,VIe,UIe,GIe,aMe,KNe,KIe,JIe,XIe,QIe,eLe,nLe,Pje,uLe,fLe,{kernelName:tq,backendName:`cpu`,kernelFunc:pLe},EFe];for(let e of mLe)mq(e);var a5={},o5={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function hLe(e,t){a5[e]=t}function s5(e,t){if(!(e in a5)||t!=null){let n=_Le(e,t);if(n!==null)a5[e]=n;else return console.log(`Could not get context for WebGL version`,e),null}let n=a5[e];return n==null||n.isContextLost()?(delete a5[e],s5(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),a5[e])}function gLe(e){if(!B().getBool(`IS_SAFARI`)&&typeof OffscreenCanvas<`u`&&e===2)return new OffscreenCanvas(300,150);if(typeof document<`u`)return document.createElement(`canvas`);throw Error(`Cannot create a canvas in this context`)}function _Le(e,t){if(e!==1&&e!==2)throw Error(`Cannot get WebGL rendering context, WebGL is disabled.`);let n=t??gLe(e);return n.addEventListener(`webglcontextlost`,t=>{t.preventDefault(),delete a5[e]},!1),B().getBool(`SOFTWARE_WEBGL_ENABLED`)&&(o5.failIfMajorPerformanceCaveat=!1),e===1?n.getContext(`webgl`,o5)||n.getContext(`experimental-webgl`,o5):n.getContext(`webgl2`,o5)}var c5;(function(e){e[e.DENSE=0]=`DENSE`,e[e.SHARED_BATCH=1]=`SHARED_BATCH`})(c5||={});var l5;(function(e){e[e.RENDER=0]=`RENDER`,e[e.UPLOAD=1]=`UPLOAD`,e[e.PIXELS=2]=`PIXELS`,e[e.DOWNLOAD=3]=`DOWNLOAD`})(l5||={});var u5;(function(e){e[e.UNPACKED_FLOAT16=0]=`UNPACKED_FLOAT16`,e[e.UNPACKED_FLOAT32=1]=`UNPACKED_FLOAT32`,e[e.PACKED_4X1_UNSIGNED_BYTE=2]=`PACKED_4X1_UNSIGNED_BYTE`,e[e.PACKED_2X2_FLOAT32=3]=`PACKED_2X2_FLOAT32`,e[e.PACKED_2X2_FLOAT16=4]=`PACKED_2X2_FLOAT16`})(u5||={});function d5(e,t){return[t,e]}function vLe(e,t){return e*t}function f5(e){let t=z(e),n=Math.ceil(t/4);return NU(n)}function p5(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function yLe(e,t){let[n,r]=p5(e,t);return n*r*4}function m5(e,t){let n=e,r,i,a,o,s,c,l,u,d,f;return B().getNumber(`WEBGL_VERSION`)===2?(r=n.R32F,i=n.R16F,a=n.RGBA16F,o=n.RGBA32F,s=n.RED,l=4,u=1,d=n.HALF_FLOAT,f=n.FLOAT,c=n.RGBA8):(r=e.RGBA,i=e.RGBA,a=e.RGBA,o=n.RGBA,s=e.RGBA,l=4,u=4,d=t==null?null:t.HALF_FLOAT_OES,f=e.FLOAT,c=e.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:o,textureFormatFloat:s,downloadTextureFormat:c,downloadUnpackNumChannels:l,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:f}}function Q(e,t){let n=t();return B().getBool(`DEBUG`)&&bLe(e),n}function bLe(e){let t=e.getError();if(t!==e.NO_ERROR)throw Error(`WebGL Error: `+wLe(e,t))}var xLe=5.96e-8,SLe=65504;function CLe(e){return!!(B().getBool(`WEBGL_RENDER_FLOAT32_ENABLED`)||e===0||xLe<Math.abs(e)&&Math.abs(e)<SLe)}function wLe(e,t){switch(t){case e.NO_ERROR:return`NO_ERROR`;case e.INVALID_ENUM:return`INVALID_ENUM`;case e.INVALID_VALUE:return`INVALID_VALUE`;case e.INVALID_OPERATION:return`INVALID_OPERATION`;case e.INVALID_FRAMEBUFFER_OPERATION:return`INVALID_FRAMEBUFFER_OPERATION`;case e.OUT_OF_MEMORY:return`OUT_OF_MEMORY`;case e.CONTEXT_LOST_WEBGL:return`CONTEXT_LOST_WEBGL`;default:return`Unknown error code ${t}`}}function h5(e,t){return S5(e,()=>e.getExtension(t),`Extension "`+t+`" not supported on this browser.`)}function TLe(e,t){let n=S5(e,()=>e.createShader(e.VERTEX_SHADER),`Unable to create vertex WebGLShader.`);if(Q(e,()=>e.shaderSource(n,t)),Q(e,()=>e.compileShader(n)),e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw console.log(e.getShaderInfoLog(n)),Error(`Failed to compile vertex shader.`);return n}function ELe(e,t){let n=S5(e,()=>e.createShader(e.FRAGMENT_SHADER),`Unable to create fragment WebGLShader.`);if(Q(e,()=>e.shaderSource(n,t)),Q(e,()=>e.compileShader(n)),B().get(`ENGINE_COMPILE_ONLY`))return n;if(e.getShaderParameter(n,e.COMPILE_STATUS)===!1)throw g5(t,e.getShaderInfoLog(n)),Error(`Failed to compile fragment shader.`);return n}var DLe=/ERROR: [0-9]+:([0-9]+):/g;function g5(e,t){let n=DLe.exec(t);if(n==null){console.log(`Couldn't parse line number in error: ${t}`),console.log(e);return}let r=+n[1],i=e.split(`
`),a=i.length.toString().length+2,o=i.map((e,t)=>PU((t+1).toString(),a)+e),s=0;for(let e=0;e<o.length;e++)s=Math.max(o[e].length,s);let c=o.slice(0,r-1),l=o.slice(r-1,r),u=o.slice(r);console.log(c.join(`
`)),console.log(t.split(`
`)[0]),console.log(`%c ${PU(l[0],s)}`,`border:1px solid red; background-color:#e3d2d2; color:#a61717`),console.log(u.join(`
`))}function OLe(e){return S5(e,()=>e.createProgram(),`Unable to create WebGLProgram.`)}function kLe(e,t){if(Q(e,()=>e.linkProgram(t)),!B().get(`ENGINE_COMPILE_ONLY`)&&e.getProgramParameter(t,e.LINK_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),Error(`Failed to link vertex and fragment shaders.`)}function _5(e,t){if(Q(e,()=>e.validateProgram(t)),e.getProgramParameter(t,e.VALIDATE_STATUS)===!1)throw console.log(e.getProgramInfoLog(t)),Error(`Shader program validation failed.`)}function ALe(e,t){let n=S5(e,()=>e.createBuffer(),`Unable to create WebGLBuffer`);return Q(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),Q(e,()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function jLe(e,t){let n=S5(e,()=>e.createBuffer(),`Unable to create WebGLBuffer`);return Q(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)),Q(e,()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)),n}function MLe(e){return S5(e,()=>e.createTexture(),`Unable to create WebGLTexture.`)}function NLe(e,t){let n=B().getNumber(`WEBGL_MAX_TEXTURE_SIZE`);if(e<=0||t<=0){let n=`[${e}x${t}]`;throw Error(`Requested texture size `+n+` is invalid.`)}if(e>n||t>n){let r=`[${e}x${t}]`,i=`[${n}x${n}]`;throw Error(`Requested texture size `+r+` greater than WebGL maximum on this browser / GPU `+i+`.`)}}function PLe(e){return S5(e,()=>e.createFramebuffer(),`Unable to create WebGLFramebuffer.`)}function v5(e,t,n,r,i,a,o){let s=e.getAttribLocation(t,n);return s===-1?!1:(Q(e,()=>e.bindBuffer(e.ARRAY_BUFFER,r)),Q(e,()=>e.vertexAttribPointer(s,i,e.FLOAT,!1,a,o)),Q(e,()=>e.enableVertexAttribArray(s)),!0)}function FLe(e,t,n){BLe(e,n),Q(e,()=>e.activeTexture(e.TEXTURE0+n)),Q(e,()=>e.bindTexture(e.TEXTURE_2D,t))}function ILe(e,t,n){return S5(e,()=>e.getUniformLocation(t,n),`uniform "`+n+`" not present in program.`)}function LLe(e,t,n){return e.getUniformLocation(t,n)}function RLe(e,t,n,r){Q(e,()=>FLe(e,t,r)),Q(e,()=>e.uniform1i(n,r))}function y5(e,t,n){Q(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,n)),Q(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0))}function b5(e,t){Q(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,t)),Q(e,()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0))}function x5(e){let t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw Error(`Error binding framebuffer: `+zLe(e,t))}function zLe(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return`FRAMEBUFFER_INCOMPLETE_ATTACHMENT`;case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return`FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT`;case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return`FRAMEBUFFER_INCOMPLETE_DIMENSIONS`;case e.FRAMEBUFFER_UNSUPPORTED:return`FRAMEBUFFER_UNSUPPORTED`;default:return`unknown error ${t}`}}function S5(e,t,n){let r=Q(e,()=>t());if(r==null)throw Error(n);return r}function BLe(e,t){let n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){let e=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw Error(`textureUnit must be in ${e}.`)}}function C5(e,t=2){return z(e.slice(0,e.length-t))}function w5(e){if(e.length===0)throw Error(`Cannot get rows and columns of an empty shape array.`);return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function T5(e){let t=[1,1,1];return e.length===0||e.length===1&&e[0]===1||(t=[C5(e),...w5(e)]),t}function VLe(e,t=!1){let n=B().getNumber(`WEBGL_MAX_TEXTURE_SIZE`),r=B().getNumber(`WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE`);r===1/0&&B().getBool(`WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE`)&&(r=n/2),t&&(n*=2,r*=2,e=e.map((t,n)=>n>=e.length-2?EU(e[n]):e[n]),e.length===1&&(e=[2,e[0]])),e.length!==2&&(e=RU(e).newShape);let i=z(e),a=null;e.length<=1&&i<=n?a=[1,i]:e.length===2&&e[0]<=n&&e[1]<=n?a=e:e.length===3&&e[0]*e[1]<=n&&e[2]<=n?a=[e[0]*e[1],e[2]]:e.length===3&&e[0]<=n&&e[1]*e[2]<=n?a=[e[0],e[1]*e[2]]:e.length===4&&e[0]*e[1]*e[2]<=n&&e[3]<=n?a=[e[0]*e[1]*e[2],e[3]]:e.length===4&&e[0]<=n&&e[1]*e[2]*e[3]<=n&&(a=[e[0],e[1]*e[2]*e[3]]);let o=a!=null&&Math.max(...a)>r&&Math.min(...a)<=(t?2:1)&&Math.min(...a)>0;if(a==null||o)if(t){let t=C5(e),n=2,r=2;e.length&&([n,r]=w5(e)),i=t*(n/2)*(r/2),a=NU(i).map(e=>e*2)}else a=NU(i);return a}function E5(e){return e%2==0}function D5(e,t){if(e=e.slice(-2),t=t.slice(-2),jU(e,t)||!e.length||!t.length||e[0]===0||e[1]===0||t[0]===0||t[1]===0)return!0;if(e.length!==t.length){let n=e[e.length-1],r=t[t.length-1];if(n===r||E5(n)&&E5(r)&&(e[0]===1||t[0]===1))return!0}return e[1]===t[1]&&E5(e[0])&&E5(t[0])}var O5,k5;function HLe(e){if(O5==null){let t=s5(e);O5=t.getParameter(t.MAX_TEXTURE_SIZE)}return O5}function ULe(e){if(k5==null){let t=s5(e);k5=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,k5)}function WLe(e){if(e===0)return 0;let t,n=s5(e);return t=A5(n,`EXT_disjoint_timer_query_webgl2`)&&e===2?2:A5(n,`EXT_disjoint_timer_query`)?1:0,t}function A5(e,t){return e.getExtension(t)!=null}function j5(e){try{if(s5(e)!=null)return!0}catch(e){return console.log(`Error when getting WebGL context: `,e),!1}return!1}function GLe(e){if(e===0)return!1;let t=s5(e);if(e===1){if(!A5(t,`OES_texture_float`))return!1}else if(!A5(t,`EXT_color_buffer_float`))return!1;return M5(t)}function KLe(e){if(e===0)return!1;let t=s5(e);if(e===1){if(!A5(t,`OES_texture_float`)||!A5(t,`WEBGL_color_buffer_float`))return!1}else{if(A5(t,`EXT_color_buffer_float`))return M5(t);let e=`EXT_color_buffer_half_float`;if(A5(t,e)){let n=t.getExtension(e);return qLe(t,n)}return!1}return M5(t)}function M5(e){let t=m5(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);let r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);let i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),i}function qLe(e,t){let n=m5(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);let i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);let a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(i),a}function JLe(e){return e===2?s5(e).fenceSync!=null:!1}function N5(e,t){Array.isArray(e)||(e=[e]),e.forEach(e=>{e!=null&&R(e.dtype!==`complex64`,()=>`${t} does not support complex64 tensors in the WebGL backend.`)})}var P5=B();P5.registerFlag(`HAS_WEBGL`,()=>P5.getNumber(`WEBGL_VERSION`)>0),P5.registerFlag(`WEBGL_VERSION`,()=>j5(2)?2:j5(1)?1:0),P5.registerFlag(`WEBGL_CHECK_NUMERICAL_PROBLEMS`,()=>!1),P5.registerFlag(`WEBGL_BUFFER_SUPPORTED`,()=>P5.get(`WEBGL_VERSION`)===2),P5.registerFlag(`WEBGL_CPU_FORWARD`,()=>!0),P5.registerFlag(`WEBGL_FORCE_F16_TEXTURES`,()=>!1),P5.registerFlag(`WEBGL_PACK`,()=>P5.getBool(`HAS_WEBGL`)),P5.registerFlag(`WEBGL_PACK_NORMALIZATION`,()=>P5.getBool(`WEBGL_PACK`)),P5.registerFlag(`WEBGL_PACK_CLIP`,()=>P5.getBool(`WEBGL_PACK`)),P5.registerFlag(`WEBGL_PACK_DEPTHWISECONV`,()=>P5.getBool(`WEBGL_PACK`)),P5.registerFlag(`WEBGL_PACK_BINARY_OPERATIONS`,()=>P5.getBool(`WEBGL_PACK`)),P5.registerFlag(`WEBGL_PACK_UNARY_OPERATIONS`,()=>P5.getBool(`WEBGL_PACK`)),P5.registerFlag(`WEBGL_PACK_ARRAY_OPERATIONS`,()=>P5.getBool(`WEBGL_PACK`)),P5.registerFlag(`WEBGL_PACK_IMAGE_OPERATIONS`,()=>P5.getBool(`WEBGL_PACK`)),P5.registerFlag(`WEBGL_PACK_REDUCE`,()=>P5.getBool(`WEBGL_PACK`)),P5.registerFlag(`WEBGL_LAZILY_UNPACK`,()=>P5.getBool(`WEBGL_PACK`)),P5.registerFlag(`WEBGL_CONV_IM2COL`,()=>P5.getBool(`WEBGL_PACK`)),P5.registerFlag(`WEBGL_PACK_CONV2DTRANSPOSE`,()=>P5.getBool(`WEBGL_PACK`)),P5.registerFlag(`WEBGL_MAX_TEXTURE_SIZE`,()=>HLe(P5.getNumber(`WEBGL_VERSION`))),P5.registerFlag(`WEBGL_MAX_TEXTURES_IN_SHADER`,()=>ULe(P5.getNumber(`WEBGL_VERSION`))),P5.registerFlag(`WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION`,()=>{let e=P5.getNumber(`WEBGL_VERSION`);return e===0?0:WLe(e)}),P5.registerFlag(`WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE`,()=>P5.getNumber(`WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION`)>0&&!fJ()),P5.registerFlag(`WEBGL_RENDER_FLOAT32_CAPABLE`,()=>GLe(P5.getNumber(`WEBGL_VERSION`))),P5.registerFlag(`WEBGL_RENDER_FLOAT32_ENABLED`,()=>P5.getBool(`WEBGL_FORCE_F16_TEXTURES`)?!1:P5.getBool(`WEBGL_RENDER_FLOAT32_CAPABLE`)),P5.registerFlag(`WEBGL_DOWNLOAD_FLOAT_ENABLED`,()=>KLe(P5.getNumber(`WEBGL_VERSION`))),P5.registerFlag(`WEBGL_FENCE_API_ENABLED`,()=>JLe(P5.getNumber(`WEBGL_VERSION`))),P5.registerFlag(`WEBGL_SIZE_UPLOAD_UNIFORM`,()=>P5.getBool(`WEBGL_RENDER_FLOAT32_ENABLED`)?4:0),P5.registerFlag(`WEBGL_DELETE_TEXTURE_THRESHOLD`,()=>-1,e=>{if(typeof e!=`number`)throw Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)}),P5.registerFlag(`WEBGL_FLUSH_THRESHOLD`,()=>fJ()?1:-1,e=>{if(typeof e!=`number`)throw Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${e}.`);if(e<0&&e!==-1)throw Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)}),P5.registerFlag(`CPU_HANDOFF_SIZE_THRESHOLD`,()=>128),P5.registerFlag(`WEBGL_USE_SHAPES_UNIFORMS`,()=>!1),P5.registerFlag(`TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD`,()=>1e5),P5.registerFlag(`TOPK_K_CPU_HANDOFF_THRESHOLD`,()=>128),P5.registerFlag(`WEBGL_EXP_CONV`,()=>!1),P5.registerFlag(`SOFTWARE_WEBGL_ENABLED`,()=>P5.getBool(`IS_TEST`)),P5.registerFlag(`WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE`,()=>1/0),P5.registerFlag(`WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE`,()=>!1),P5.registerFlag(`WEBGL2_ISNAN_CUSTOM`,()=>!1),P5.registerFlag(`ENGINE_COMPILE_ONLY`,()=>!1);function F5(){let e,t,n,r,i,a,o,s,c,l;return B().getNumber(`WEBGL_VERSION`)===2?(e=`#version 300 es`,t=`in`,n=`out`,r=`in`,i=`texture`,a=`outputColor`,o=`out vec4 outputColor;`,s=B().getBool(`WEBGL2_ISNAN_CUSTOM`)?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:``,c=``,l=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(e=``,t=`attribute`,n=`varying`,r=`varying`,i=`texture2D`,a=`gl_FragColor`,o=``,s=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,l=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:i,output:a,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:c,defineRound:l}}function I5(e,t,n=`index`){let r=QU(t);return r.map((t,i)=>{let a=`int ${e[i]} = ${n} / ${t}`,o=i===r.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * ${t}`:`index -= ${e[i]} * ${t}`;return`${a}; ${o};`}).join(``)}function L5(e,t,n=`index`){let r=QU(t);return r.map((t,i)=>{let a=`int ${e[i]} = ${n} / outShapeStrides[${i}]`,o=i===r.length-1?`int ${e[i+1]} = ${n} - ${e[i]} * outShapeStrides[${i}]`:`index -= ${e[i]} * outShapeStrides[${i}]`;return`${a}; ${o};`}).join(``)}function YLe(e,t){let n=e.length,r=e.map(e=>`${t}[${e}]`),i=Array(n-1);i[n-2]=r[n-1];for(let e=n-3;e>=0;--e)i[e]=`(${i[e+1]} * ${r[e+1]})`;return i}function XLe(e,t,n=`index`){let r=e.map((e,t)=>t),i=YLe(r,t);return i.map((t,r)=>{let a=`int ${e[r]} = ${n} / ${i[r]}`,o=r===i.length-1?`int ${e[r+1]} = ${n} - ${e[r]} * ${i[r]}`:`index -= ${e[r]} * ${i[r]}`;return`${a}; ${o};`}).join(``)}function R5(e){let t=QU(e).map(e=>e.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;
  }
`}function z5(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const B5=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;var{getBroadcastDims:V5}=bEe;function ZLe(e,t,n){let r=[];if(e.forEach(e=>{let t=z(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?r.push(`uniform float ${e.name}${t>1?`[${t}]`:``};`):(r.push(`uniform sampler2D ${e.name};`),r.push(`uniform int offset${e.name};`)),n.enableShapeUniforms){let{uniformShape:t}=J5(n.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape);switch(t.length){case 1:r.push(`uniform int ${e.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${e.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${e.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${e.name}Shape;`);break;default:break}r.push(`uniform ivec2 ${e.name}TexShape;`)}}),n.enableShapeUniforms){switch(t.logicalShape.length){case 1:r.push(`uniform int outShape;`);break;case 2:r.push(`uniform ivec2 outShape;`),r.push(`uniform int outShapeStrides;`);break;case 3:r.push(`uniform ivec3 outShape;`),r.push(`uniform ivec2 outShapeStrides;`);break;case 4:r.push(`uniform ivec4 outShape;`),r.push(`uniform ivec3 outShapeStrides;`);break;default:break}r.push(`uniform ivec2 outTexShape;`)}n.customUniforms&&n.customUniforms.forEach(e=>{r.push(`uniform ${e.type} ${e.name}${e.arrayIndex?`[${e.arrayIndex}]`:``};`)});let i=r.join(`
`),a=e.map(e=>QLe(e,t,n.packedInputs,n.enableShapeUniforms)).join(`
`),o=t.texShape,s=F5(),c=tRe(s),l,u,d=iRe(s);return t.isPacked?(l=$Le(t.logicalShape,o,n.enableShapeUniforms),u=rRe(s)):(l=eRe(t.logicalShape,o,n.enableShapeUniforms),u=nRe(s)),n.packedInputs&&(d+=cRe),[d,c,u,i,l,a,n.userCode].join(`
`)}function H5(e,t=!1){let n=e.shapeInfo.logicalShape;switch(n.length){case 0:return bRe(e,t);case 1:return SRe(e,t);case 2:return wRe(e,t);case 3:return ERe(e,t);case 4:return ORe(e,t);case 5:return kRe(e);case 6:return ARe(e);default:throw Error(`${n.length}-D input sampling is not yet supported`)}}function U5(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return yRe(e);case 1:return xRe(e,t);case 2:return CRe(e,t);case 3:return TRe(e,t);default:return DRe(e,t)}}function QLe(e,t,n=!1,r){let i=``;n?i+=U5(e,r):i+=H5(e,r);let a=e.shapeInfo.logicalShape,o=t.logicalShape;return a.length<=o.length&&(n?i+=jRe(e,t):i+=MRe(e,t)),i}function $Le(e,t,n){switch(e.length){case 0:return W5();case 1:return lRe(e,t,n);case 2:return _Re(e,t,n);case 3:return dRe(e,t,n);default:return pRe(e,t,n)}}function eRe(e,t,n){switch(e.length){case 0:return W5();case 1:return uRe(e,t,n);case 2:return vRe(e,t,n);case 3:return fRe(e,t,n);case 4:return mRe(e,t,n);case 5:return hRe(e,t);case 6:return gRe(e,t);default:throw Error(`${e.length}-D output sampling is not yet supported`)}}function tRe(e){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${e.texture2D}(textureSampler, uv).r;
    }
  `}function nRe(e){return`
    void setOutput(float val) {
      ${e.output} = vec4(val, 0, 0, 0);
    }
  `}function rRe(e){return`
    void setOutput(vec4 val) {
      ${e.output} = val;
    }
  `}function iRe(e){return`${e.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${e.varyingFs} vec2 resultUV;
    ${e.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${e.defineSpecialNaN}
    ${e.defineSpecialInf}
    ${e.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${aRe}
    ${oRe}
    ${sRe}
  `}var aRe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,oRe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,sRe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,cRe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function W5(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function lRe(e,t,n){let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function uRe(e,t,n){return t[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${t[1]}.0);
      }
    `:t[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${t[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      return resTexRC.x * ${t[1]} + resTexRC.y;
    }
  `}function dRe(e,t,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[2]/2),a=i*Math.ceil(e[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec3(b, r, c);
    }
  `}function fRe(e,t,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${L5([`r`,`c`,`d`],e)}
    return ivec3(r, c, d);
  }
`;let r=I5([`r`,`c`,`d`],e);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function pRe(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],i=Math.ceil(e[e.length-1]/2),a=i*Math.ceil(e[e.length-2]/2),o=a,s=``,c=`b, r, c`;for(let t=2;t<e.length-1;t++)o*=e[e.length-t-1],s=`
      int b${t} = index / ${o};
      index -= b${t} * ${o};
    `+s,c=`b${t}, `+c;return`
    ivec${e.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${s}

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec${e.length}(${c});
    }
  `}function mRe(e,t,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${L5([`r`,`c`,`d`,`d2`],e)}
      return ivec4(r, c, d, d2);
    }
  `;let r=I5([`r`,`c`,`d`,`d2`],e);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function hRe(e,t){let n=I5([`r`,`c`,`d`,`d2`,`d3`],e);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},
                             ${t[1]}));

      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function gRe(e,t){let n=I5([`r`,`c`,`d`,`d2`,`d3`,`d4`],e);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function _Re(e,t,n){let r=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(jU(e,t))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;let i=Math.ceil(e[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec2(r, c);
    }
  `}function vRe(e,t,n){return jU(e,t)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));
      }
    `:e[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:e[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${t[0]}, ${t[1]}));
        int index = resTexRC.x * ${t[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${t[0]}, ${t[1]}));
      int index = resTexRC.x * ${t[1]} + resTexRC.y;
      int r = index / ${e[1]};
      int c = index - r * ${e[1]};
      return ivec2(r, c);
    }
  `}function G5(e){return`offset${e}`}function yRe(e){let t=e.name,n=`get`+t.charAt(0).toUpperCase()+t.slice(1),r=F5();return`
    vec4 ${n}() {
      return ${r.texture2D}(${t}, halfCR);
    }
  `}function bRe(e,t){let n=e.name,r=`get`+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;let[i,a]=e.shapeInfo.texShape;if(i===1&&a===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;let o=G5(n);if(t)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${o});
      return sampleTexture(${n}, uv);
    }
  `;let[s,c]=e.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${s}, ${c}, ${o});
      return sampleTexture(${n}, uv);
    }
  `}function xRe(e,t){let n=e.name,r=`get`+n.charAt(0).toUpperCase()+n.slice(1),i=e.shapeInfo.texShape,a=F5();if(t)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${a.texture2D}(${n}, uv);
    }
  `;let o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${o[0]}, ${o[1]}, index);
      return ${a.texture2D}(${n}, uv);
    }
  `}function SRe(e,t){let n=e.name,r=`get`+n.charAt(0).toUpperCase()+n.slice(1);if(e.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${K5(e)}
      }
    `;let i=e.shapeInfo.texShape,a=i[0],o=i[1];if(o===1&&a===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;let s=G5(n);return o===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${s}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${s}) + 0.5) / ${a}.0);
        return sampleTexture(${n}, uv);
      }
    `:a===1?t?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${s}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${s}) + 0.5) / ${o}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:t?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${s});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${a}, ${o}, index + ${s});
      return sampleTexture(${n}, uv);
    }
  `}function CRe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,i=`get`+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape,o=a[0],s=a[1],c=F5();if(a!=null&&jU(n,a))return t?`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${c.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}.0, ${o}.0);

        return ${c.texture2D}(${r}, uv);
      }
    `;if(t)return`
    vec4 ${i}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${c.texture2D}(${r}, uv);
    }
  `;let l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${i}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${l[0]}, ${l[1]}, row, col);
      return ${c.texture2D}(${r}, uv);
    }
  `}function wRe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,i=`get`+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape;if(a!=null&&jU(n,a)){if(t)return`
      float ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;let e=a[0],n=a[1];return`
    float ${i}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${n}.0, ${e}.0);
      return sampleTexture(${r}, uv);
    }
  `}let{newShape:o,keptDims:s}=RU(n),c=o;if(c.length<n.length){let n=Y5(e,c);return`
      ${H5(n,t)}
      float ${i}(int row, int col) {
        return ${i}(${X5([`row`,`col`],s)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${K5(e)}
      }
    `;let l=a[0],u=a[1],d=G5(r);return u===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${l}.0);
      return sampleTexture(${r}, uv);
    }
  `:l===1?t?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:t?`
      float ${i}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${i}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${l}, ${u}, index);
    return sampleTexture(${r}, uv);
  }
`}function TRe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,i=`get`+r.charAt(0).toUpperCase()+r.slice(1),a=e.shapeInfo.texShape,o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(n[0]===1){let r=n.slice(1),a=[1,2],o=Y5(e,r);return`
        ${U5(o,t)}
        vec4 ${i}(int b, int row, int col) {
          return ${i}(${X5([`b`,`row`,`col`],a)});
        }
      `}let s=F5();if(t)return`
    vec4 ${i}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${s.texture2D}(${r}, uv);
    }
  `;let c=o[0],l=o[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return`
    vec4 ${i}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${c}, ${l}, ${d}, ${u}, b, row, col);
      return ${s.texture2D}(${r}, uv);
    }
  `}function ERe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,i=`get`+r.charAt(0).toUpperCase()+r.slice(1),a=n[1]*n[2],o=n[2],{newShape:s,keptDims:c}=RU(n),l=s;if(l.length<n.length){let n=Y5(e,l);return`
        ${H5(n,t)}
        float ${i}(int row, int col, int depth) {
          return ${i}(${X5([`row`,`col`,`depth`],c)});
        }
      `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${a}, ${o}, 1)));
        ${K5(e)}
      }
    `;let u=e.shapeInfo.texShape,d=u[0],f=u[1],p=e.shapeInfo.flatOffset;if(f===a&&p==null)return t?`
      float ${i}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${i}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${o}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${f}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(f===o&&p==null)return t?`
      float ${i}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;let m=G5(r);return t?`
    float ${i}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${m};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${i}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${a} + col * ${o} + depth + ${m};
        vec2 uv = uvFromFlat(${d}, ${f}, index);
        return sampleTexture(${r}, uv);
      }
  `}function DRe(e,t){let n=e.name,r=`get`+n.charAt(0).toUpperCase()+n.slice(1),i=F5();if(t)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${n}, uv);
    }
  `;let a=e.shapeInfo.logicalShape,o=a.length,s=e.shapeInfo.texShape,c=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],l=c[0],u=c[1],d=Math.ceil(a[o-1]/2),f=d*Math.ceil(a[o-2]/2),p=`int b, int row, int col`,m=`b * ${f} + (row / 2) * ${d} + (col / 2)`;for(let e=2;e<o-1;e++)p=`int b${e}, `+p,f*=a[o-e-1],m=`b${e} * ${f} + `+m;return`
    vec4 ${r}(${p}) {
      int index = ${m};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${l});
      return ${i.texture2D}(${n}, uv);
    }
  `}function ORe(e,t){let n=e.shapeInfo.logicalShape,r=e.name,i=`get`+r.charAt(0).toUpperCase()+r.slice(1),a=n[3],o=n[2]*a,s=n[1]*o,{newShape:c,keptDims:l}=RU(n);if(c.length<n.length){let n=Y5(e,c);return`
      ${H5(n,t)}
      float ${i}(int row, int col, int depth, int depth2) {
        return ${i}(${X5([`row`,`col`,`depth`,`depth2`],l)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${s}, ${o}, ${a}, 1)));
        ${K5(e)}
      }
    `;let u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,f=d[0],p=d[1],m=`int stride2 = ${r}Shape[3];`,h=`int stride1 = ${r}Shape[2] * stride2;`,g=`int stride0 = ${r}Shape[1] * stride1;`;if(p===s&&u==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        ${m}
        ${h}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${o}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(p===a&&u==null)return t?`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${r}, uv);
      }
    `;let _=G5(r);return t?`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${m}
      ${h}
      ${g}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${_});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${s} + col * ${o} +
          depth * ${a} + depth2;
      vec2 uv = uvFromFlat(${f}, ${p}, index + ${_});
      return sampleTexture(${r}, uv);
    }
  `}function kRe(e){let t=e.shapeInfo.logicalShape,n=e.name,r=`get`+n.charAt(0).toUpperCase()+n.slice(1),i=t[4],a=t[3]*i,o=t[2]*a,s=t[1]*o,{newShape:c,keptDims:l}=RU(t);if(c.length<t.length){let t=Y5(e,c);return`
      ${H5(t)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${X5([`row`,`col`,`depth`,`depth2`,`depth3`],l)});
      }
    `}if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${s}, ${o}, ${a}, ${i})) +
          depth3;
        ${K5(e)}
      }
    `;let u=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,f=d[0],p=d[1];if(p===s&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${o}, ${a}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===i&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]},
               ${t[2]*t[3]}, ${t[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;let m=G5(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${s} + col * ${o} + depth * ${a} +
          depth2 * ${i} + depth3 + ${m};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function ARe(e){let t=e.shapeInfo.logicalShape,n=e.name,r=`get`+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:a}=RU(t);if(i.length<t.length){let t=Y5(e,i);return`
      ${H5(t)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${X5([`row`,`col`,`depth`,`depth2`,`depth3`,`depth4`],a)});
      }
    `}let o=t[5],s=t[4]*o,c=t[3]*s,l=t[2]*c,u=t[1]*l;if(e.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${l}, ${c}, ${s})) +
          dot(
            vec2(depth3, depth4),
            vec2(${o}, 1)));
        ${K5(e)}
      }
    `;let d=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,p=f[0],m=f[1];if(m===u&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${l}, ${c}, ${s}, ${o})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(m===o&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${t[1]*t[2]*t[3]*t[4]},
               ${t[2]*t[3]*t[4]},
               ${t[3]*t[4]},
               ${t[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;let h=G5(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${l} + depth * ${c} +
          depth2 * ${s} + depth3 * ${o} + depth4 + ${h};
      vec2 uv = uvFromFlat(${p}, ${m}, index);
      return sampleTexture(${n}, uv);
    }
  `}function K5(e){let t=e.name,n=z(e.shapeInfo.logicalShape);return n<2?`return ${t};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${t}[i];
      }
    }
  `}function jRe(e,t){let n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i=`get`+r+`AtOutCoords`,a=e.shapeInfo.logicalShape.length,o=t.logicalShape.length,s=V5(e.shapeInfo.logicalShape,t.logicalShape),c=q5(o),l=o-a,u,d=[`x`,`y`,`z`,`w`,`u`,`v`];u=a===0?``:o<2&&s.length>=1?`coords = 0;`:s.map(e=>`coords.${d[e+l]} = 0;`).join(`
`);let f=``;f=o<2&&a>0?`coords`:e.shapeInfo.logicalShape.map((e,t)=>`coords.${d[t+l]}`).join(`, `);let p=`return outputValue;`,m=z(e.shapeInfo.logicalShape)===1,h=z(t.logicalShape)===1;if(a===1&&!m&&!h)p=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!h)p=o===1?`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:`
        return vec4(outputValue.x);
      `;else if(s.length){let e=a-2,t=a-1;s.indexOf(e)>-1&&s.indexOf(t)>-1?p=`return vec4(outputValue.x);`:s.indexOf(e)>-1?p=`return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);`:s.indexOf(t)>-1&&(p=`return vec4(outputValue.xx, outputValue.zz);`)}return`
    vec4 ${i}() {
      ${c} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${r}(${f});
      ${p}
    }
  `}function MRe(e,t){let n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),i=`get`+r+`AtOutCoords`,a=t.texShape,o=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,c=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===c&&e.shapeInfo.flatOffset==null&&jU(o,a))return`
      float ${i}() {
        return sampleTexture(${n}, resultUV);
      }
    `;let l=q5(c),u=V5(e.shapeInfo.logicalShape,t.logicalShape),d=c-s,f,p=[`x`,`y`,`z`,`w`,`u`,`v`];f=s===0?``:c<2&&u.length>=1?`coords = 0;`:u.map(e=>`coords.${p[e+d]} = 0;`).join(`
`);let m=``;return m=c<2&&s>0?`coords`:e.shapeInfo.logicalShape.map((e,t)=>`coords.${p[t+d]}`).join(`, `),`
    float ${i}() {
      ${l} coords = getOutputCoords();
      ${f}
      return get${r}(${m});
    }
  `}function q5(e){if(e<=1)return`int`;if(e===2)return`ivec2`;if(e===3)return`ivec3`;if(e===4)return`ivec4`;if(e===5)return`ivec5`;if(e===6)return`ivec6`;throw Error(`GPU for rank ${e} is not yet supported`)}function J5(e,t,n){let{newShape:r,keptDims:i}=RU(t),a=t.length,o=e&&a===3&&t[0]===1,s=o?t.slice(1):r,c=!e&&a>1&&!jU(t,n)&&r.length<a||o;return{useSqueezeShape:c,uniformShape:c?s:t,keptDims:i}}function Y5(e,t){let n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function X5(e,t){return t.map(t=>e[t]).join(`, `)}function NRe(e,t,n,r){let i=n.map((e,n)=>{let r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:e.isUniform?!1:e.texData.isPacked,flatOffset:null};return e.texData!=null&&e.texData.slice!=null&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}}),a=i.map(e=>e.shapeInfo),o={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=ZLe(i,o,t),c=ELe(e.gl,s),l=e.createProgram(c);return B().get(`ENGINE_COMPILE_ONLY`)?{program:t,fragmentShader:c,source:s,webGLProgram:l,inShapeInfos:a,outShapeInfo:o,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(e.buildVao(l),Object.assign({program:t,fragmentShader:c,source:s,webGLProgram:l,inShapeInfos:a,outShapeInfo:o},Z5(e,t,l)))}function Z5(e,t,n){let r=[],i=[],a,o,s,c=null,l=null;l=e.getUniformLocation(n,`NAN`,!1),B().getNumber(`WEBGL_VERSION`)===1&&(c=e.getUniformLocation(n,`INFINITY`,!1));for(let i of t.variableNames){let a={name:i,uniform:e.getUniformLocation(n,i,!1),offset:e.getUniformLocation(n,`offset${i}`,!1)};t.enableShapeUniforms&&(a.shape=e.getUniformLocation(n,`${i}Shape`,!1),a.texShape=e.getUniformLocation(n,`${i}TexShape`,!1)),r.push(a)}if(t.enableShapeUniforms&&(a=e.getUniformLocation(n,`outShape`,!1),s=e.getUniformLocation(n,`outShapeStrides`,!1),o=e.getUniformLocation(n,`outTexShape`,!1)),t.customUniforms)for(let r of t.customUniforms)i.push(e.getUniformLocation(n,r.name,!1));return{variablesLocations:r,customUniformLocations:i,infLoc:c,nanLoc:l,outShapeLocation:a,outShapeStridesLocation:s,outTexShapeLocation:o}}function Q5(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach((e,n)=>{let r=e.logicalShape,i=t[n],a=i.shape;if(!jU(r,a))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${a} must match`);if(e.isUniform&&i.isUniform)return;let o=e.texShape,s=i.isUniform?null:i.texData.texShape;if(!jU(o,s))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${s} must match`)})}function PRe(e,t,n,r,i){t.program.enableShapeUniforms||(Q5(t.inShapeInfos,n),Q5([t.outShapeInfo],[r]));let a=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(a.texture,o[0],o[1]):e.setOutputMatrixTexture(a.texture,o[0],o[1]),e.setProgram(t.webGLProgram),e.bindVertexArray(t.webGLProgram.vao),B().getNumber(`WEBGL_VERSION`)===1&&t.infLoc!==null&&e.gl.uniform1f(t.infLoc,1/0),t.nanLoc!==null&&e.gl.uniform1f(t.nanLoc,NaN);for(let r=0;r<n.length;++r){let i=n[r],{uniform:a,offset:o,shape:s,texShape:c}=t.variablesLocations[r];if(s){let{uniformShape:n}=J5(t.program.packedInputs,i.shape,i.texData.texShape);switch(n.length){case 1:e.gl.uniform1iv(s,new Int32Array(n));break;case 2:e.gl.uniform2iv(s,new Int32Array(n));break;case 3:e.gl.uniform3iv(s,new Int32Array(n));break;case 4:e.gl.uniform4iv(s,new Int32Array(n));break;default:break}}if(c&&e.gl.uniform2i(c,i.texData.texShape[0],i.texData.texShape[1]),a!=null){if(i.isUniform){if(z(i.shape)<2)e.gl.uniform1f(a,i.uniformValues[0]);else{let t=i.uniformValues;t instanceof Float32Array||(t=new Float32Array(t)),e.gl.uniform1fv(a,t)}continue}i.texData.slice!=null&&o!=null&&e.gl.uniform1i(o,i.texData.slice.flatOffset),e.setInputMatrixTexture(i.texData.texture.texture,a,r)}}let s=t.outShapeLocation;if(s)switch(r.shape.length){case 1:e.gl.uniform1iv(s,new Int32Array(r.shape));break;case 2:e.gl.uniform2iv(s,new Int32Array(r.shape));break;case 3:e.gl.uniform3iv(s,new Int32Array(r.shape));break;case 4:e.gl.uniform4iv(s,new Int32Array(r.shape));break;default:break}if(t.outShapeStridesLocation){let n=QU(r.shape);switch(r.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(n));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(n));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(n));break;default:break}}if(t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),t.program.customUniforms&&i)for(let n=0;n<t.program.customUniforms.length;++n){let r=t.program.customUniforms[n],a=t.customUniformLocations[n],o=i[n];if(r.type===`float`)e.gl.uniform1fv(a,o);else if(r.type===`vec2`)e.gl.uniform2fv(a,o);else if(r.type===`vec3`)e.gl.uniform3fv(a,o);else if(r.type===`vec4`)e.gl.uniform4fv(a,o);else if(r.type===`int`)e.gl.uniform1iv(a,o);else if(r.type===`ivec2`)e.gl.uniform2iv(a,o);else if(r.type===`ivec3`)e.gl.uniform3iv(a,o);else if(r.type===`ivec4`)e.gl.uniform4iv(a,o);else throw Error(`uniform type ${r.type} is not supported yet.`)}e.executeProgram()}function FRe(e,t,n){let r=``;t.concat(n).forEach(t=>{let i=t.texData!=null&&t.texData.slice!=null&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){let a=t.texData.texShape,{useSqueezeShape:o,uniformShape:s,keptDims:c}=J5(e.packedInputs,t.shape,a),l=``,u=``,d=``;if(s.length===1&&e.packedInputs){let e=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];l=`${e[0]>1}_${e[1]>1}`}else if(s.length===2&&!e.packedInputs)u=`${s[0]>1}_${s[1]>1}`;else if(s.length>2&&!e.packedInputs){let e=QU(s);d=`${e[0]===a[1]}_${e[e.length-1]===a[1]}`}let f=t.shape.length,p=s.length===2&&jU(t.shape,a),m=z(t.shape)===1,h=KY(t.shape,n.shape),g=!e.packedInputs&&f===n.shape.length&&jU(a,n.texData.texShape),_=e.packedInputs||s.length>2?``:`${a[0]>1}_${a[1]>1}`;r+=`${f}_${g}_${o?c:``}_${s.length}_${m}_${h}_${p}_${l}_${u}_${d}_${_}_${i}`}else{let e=t.isUniform?`uniform`:t.texData.texShape;r+=`${t.shape}_${e}_${i}`}});let i=e.userCode,a=e.constructor.name;return a+=`_`+r+`_`+i+`${B().getNumber(`WEBGL_VERSION`)}`,a}function $5(e){return B().getBool(`WEBGL_USE_SHAPES_UNIFORMS`)&&e<=4}var IRe=class{constructor(e){this.variableNames=[`A`],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=c5.DENSE,this.customUniforms=[{name:`texShape`,type:`ivec2`}];let t=F5();this.outputShape=e,this.enableShapeUniforms=$5(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?L5([`r`,`c`,`d`],e):I5([`r`,`c`,`d`],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}},LRe=class{constructor(e){this.variableNames=[`A`],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=c5.DENSE,this.customUniforms=[{name:`texShape`,type:`ivec2`}];let t=F5();this.outputShape=e,this.enableShapeUniforms=$5(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?L5([`r`,`c`,`d`],e):I5([`r`,`c`,`d`],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}},RRe=class{constructor(e){this.variableNames=[`A`],this.outTexUsage=l5.DOWNLOAD;let t=F5();this.outputShape=e,this.userCode=`
      ${B5}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}},zRe=class{constructor(e){this.variableNames=[`A`],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=l5.DOWNLOAD;let t=F5();this.outputShape=e,this.userCode=`
      ${B5}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}},BRe={R:0,G:1,B:2,A:3},e7=class{constructor(e,t=!1,n=`RGBA`){this.variableNames=[`A`],this.customUniforms=[{name:`texShape`,type:`ivec2`}];let r=F5();this.outputShape=e,this.enableShapeUniforms=$5(this.outputShape.length);let i=`result`;t&&(i=`floor(result * 255. + 0.5)`);let a=``;for(let e=0;e<n.length;e++){let t=n[e];a+=`
          if(offset == ${e}) {
            result = values[${BRe[t]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?z5():R5(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${n.length});

        flatIndex = idiv(flatIndex, ${n.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${a}
        }
        ${r.output} = vec4(${i}, 0., 0., 0.);
      }
    `}},VRe=class{constructor(e,t=!1){this.variableNames=[`A`],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:`texShape`,type:`ivec2`}];let n=F5();this.outputShape=e,this.enableShapeUniforms=$5(this.outputShape.length);let r=``,i=`result`;t&&(i=`floor(result * 255. + 0.5)`);for(let t=0;t<=1;t++)for(let i=0;i<=1;i++){let a=t*2+i;r+=`
          localCoords = coords;
          if(localCoords[2] + ${i} < ${this.enableShapeUniforms?`outShape[2]`:`${e[2]}`}) {
          localCoords[2] += ${i};
          if (localCoords[1] + ${t} < ${this.enableShapeUniforms?`outShape[1]`:`${e[1]}`}) {
            localCoords[1] += ${t};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${n.texture2D}(A, uv);

            if (offset == 0) {
              result[${a}] = values[0];
            } else if (offset == 1) {
              result[${a}] = values[1];
            } else if (offset == 2) {
              result[${a}] = values[2];
            } else {
              result[${a}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?z5():R5(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${n.output} = ${i};
        }
    `}};function HRe(e){let t=F5(),n=`${t.version}
    precision highp float;
    ${t.attribute} vec3 clipSpacePos;
    ${t.attribute} vec2 uv;
    ${t.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return TLe(e,n)}function URe(e){let t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return ALe(e,t)}function WRe(e){let t=new Uint16Array([0,1,2,2,1,3]);return jLe(e,t)}function t7(e,t,n,r,i,a){NLe(t,n);let o=MLe(e),s=e.TEXTURE_2D;return Q(e,()=>e.bindTexture(s,o)),Q(e,()=>e.texParameteri(s,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)),Q(e,()=>e.texParameteri(s,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),Q(e,()=>e.texParameteri(s,e.TEXTURE_MIN_FILTER,e.NEAREST)),Q(e,()=>e.texParameteri(s,e.TEXTURE_MAG_FILTER,e.NEAREST)),B().getNumber(`WEBGL_VERSION`)===1?Q(e,()=>e.texImage2D(s,0,r,t,n,0,i,a,null)):Q(e,()=>e.texStorage2D(s,1,r,t,n)),Q(e,()=>e.bindTexture(e.TEXTURE_2D,null)),{texture:o,texShape:[n,t]}}function n7(e){return e.internalFormatFloat}function GRe(e,t,n,r){let[i,a]=d5(t,n);return t7(e,i,a,n7(r),r.textureFormatFloat,e.FLOAT)}function r7(e){return e.internalFormatHalfFloat}function KRe(e,t,n,r){let[i,a]=d5(t,n);return t7(e,i,a,r7(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function i7(e){return e.downloadTextureFormat}function qRe(e,t,n,r){let[i,a]=d5(t,n);return t7(e,i,a,i7(r),e.RGBA,e.UNSIGNED_BYTE)}function a7(e){return e.internalFormatPackedFloat}function JRe(e,t,n,r){let[i,a]=p5(t,n);return t7(e,i,a,a7(r),e.RGBA,e.FLOAT)}function o7(e){return e.internalFormatPackedHalfFloat}function YRe(e,t,n,r){let[i,a]=p5(t,n);return t7(e,i,a,o7(r),e.RGBA,r.textureTypeHalfFloat)}function XRe(e,t,n){return Q(e,()=>e.bindBuffer(e.ARRAY_BUFFER,n)),v5(e,t,`clipSpacePos`,n,3,20,0)&&v5(e,t,`uv`,n,2,20,12)}function ZRe(e,t,n,r,i,a){Q(e,()=>e.bindTexture(e.TEXTURE_2D,t));let o,s,c;i instanceof Uint8Array?(o=new Uint8Array(n*r*4),s=e.UNSIGNED_BYTE,c=e.RGBA):(o=new Float32Array(n*r*4),s=e.FLOAT,c=a.internalFormatPackedFloat),o.set(i),B().getNumber(`WEBGL_VERSION`)===2?Q(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,e.RGBA,s,o)):Q(e,()=>e.texImage2D(e.TEXTURE_2D,0,c,n,r,0,e.RGBA,s,o)),Q(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function QRe(e,t,n){Q(e,()=>e.bindTexture(e.TEXTURE_2D,t)),n.data instanceof Uint8Array?B().getNumber(`WEBGL_VERSION`)===2?Q(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,n.width,n.height,e.RGBA,e.UNSIGNED_BYTE,n.data)):Q(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)):B().getNumber(`WEBGL_VERSION`)===2?Q(e,()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,n)):Q(e,()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)),Q(e,()=>e.bindTexture(e.TEXTURE_2D,null))}function $Re(e,t,n,r){let i=e.createBuffer();Q(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,i));let a=16*t*n;return Q(e,()=>e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)),Q(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)),Q(e,()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null)),i}function eze(e,t,n){let r=e,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function tze(e,t,n,r){let[i,a]=d5(t,n),o=new Uint8Array(vLe(t*n,4));return Q(e,()=>e.readPixels(0,0,i,a,r.downloadTextureFormat,e.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function nze(e,t,n,r,i,a,o,s){let c=e,l=new Float32Array(yLe(a,o));return c.bindBuffer(c.PIXEL_PACK_BUFFER,t),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,l),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),l}function rze(e,t,n){let r=new Float32Array(t*n*4);return Q(e,()=>e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)),r}var s7=class{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];let t=B().getNumber(`WEBGL_VERSION`);if(e==null?this.gl=s5(t):(this.gl=e,hLe(t,e)),e=this.gl,B().getNumber(`WEBGL_VERSION`)===2){let t=e;this.createVertexArray=()=>Q(t,()=>t.createVertexArray()),this.bindVertexArray=e=>Q(t,()=>t.bindVertexArray(e)),this.deleteVertexArray=e=>Q(t,()=>t.deleteVertexArray(e)),this.getVertexArray=()=>Q(t,()=>t.getParameter(t.VERTEX_ARRAY_BINDING))}else if(e!=null){let t=e.getExtension(`OES_vertex_array_object`);if(t==null)throw Error(`All WebGL1 implementations are expected to offer OES_vertex_array_object.`);this.createVertexArray=()=>Q(e,()=>t.createVertexArrayOES()),this.bindVertexArray=n=>Q(e,()=>t.bindVertexArrayOES(n)),this.deleteVertexArray=n=>Q(e,()=>t.deleteVertexArrayOES(n)),this.getVertexArray=()=>Q(e,()=>e.getParameter(t.VERTEX_ARRAY_BINDING_OES))}let n=`WEBGL_color_buffer_float`,r=`EXT_color_buffer_half_float`;if(this.parallelCompilationExtension=this.gl.getExtension(`KHR_parallel_shader_compile`),B().getNumber(`WEBGL_VERSION`)===1){let e=`OES_texture_half_float`;if(this.textureFloatExtension=h5(this.gl,`OES_texture_float`),A5(this.gl,e))this.textureHalfFloatExtension=h5(this.gl,e);else if(B().get(`WEBGL_FORCE_F16_TEXTURES`))throw Error(`GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.`);if(this.colorBufferFloatExtension=this.gl.getExtension(n),A5(this.gl,r))this.colorBufferHalfFloatExtension=h5(this.gl,r);else if(B().get(`WEBGL_FORCE_F16_TEXTURES`))throw Error(`GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.`)}else if(n=`EXT_color_buffer_float`,A5(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else if(A5(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw Error(`GL context does not support color renderable floats`);this.vertexBuffer=URe(this.gl),this.indexBuffer=WRe(this.gl),this.framebuffer=PLe(this.gl),this.textureConfig=m5(this.gl,this.textureHalfFloatExtension)}get debug(){return B().getBool(`DEBUG`)}dispose(){if(this.disposed)return;this.program!=null&&console.warn(`Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing.`),this.outputTexture!=null&&console.warn(`Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.`);let e=this.gl;Q(e,()=>e.finish()),Q(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),Q(e,()=>e.deleteFramebuffer(this.framebuffer)),Q(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),Q(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),Q(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),GRe(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),KRe(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),qRe(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),QRe(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,n,r){this.throwIfDisposed(),ZRe(this.gl,e,t,n,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),YRe(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),JRe(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(b5(this.gl,this.framebuffer),this.outputTexture=null),Q(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,n){return this.downloadMatrixDriver(e,()=>tze(this.gl,t,n,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,n,r,i,a){return nze(this.gl,e,t,n,r,i,a,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return eze(this.gl,e,t)}createBufferFromTexture(e,t,n){this.bindTextureToFrameBuffer(e);let r=$Re(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){let e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,n;if(B().getBool(`WEBGL_FENCE_API_ENABLED`)){let r=e,i=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=()=>{let e=r.clientWaitSync(i,0,0);return e===r.ALREADY_SIGNALED||e===r.CONDITION_SATISFIED},t=i}else B().getNumber(`WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION`)>0?(t=this.beginQuery(),this.endQuery(),n=()=>this.isQueryAvailable(t,B().getNumber(`WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION`))):n=()=>!0;return{query:t,isFencePassed:n}}downloadMatrixFromPackedTexture(e,t,n){return this.downloadMatrixDriver(e,()=>rze(this.gl,t,n))}createProgram(e){this.throwIfDisposed();let t=this.gl;this.vertexShader??=HRe(t);let n=OLe(t);Q(t,()=>t.attachShader(n,this.vertexShader)),Q(t,()=>t.attachShader(n,e)),kLe(t,n);let r=Object.assign(n,{vao:this.createVertexArray()});return this.debug&&_5(t,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);let t=this.gl;Q(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),XRe(t,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(Q(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&_5(this.gl,this.program),Q(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,n=!0){return this.throwIfDisposed(),n?ILe(this.gl,e,t):LLe(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),Q(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),RLe(this.gl,e,t,n)}setOutputMatrixTexture(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}setOutputPackedMatrixTexture(e,t,n){this.throwIfDisposed();let[r,i]=p5(t,n);this.setOutputMatrixTextureDriver(e,r,i)}setOutputMatrixWriteRegion(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,n,r){throw Error(`setOutputPackedMatrixWriteRegion not implemented.`)}debugValidate(){this.program!=null&&_5(this.gl,this.program),x5(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();let e=this.gl;if(this.debug){let e=this.getVertexArray();console.assert(e===this.program.vao,`VAO changed between setProgram and executeProgram!`),this.debugValidate()}Q(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),Q(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension??=h5(this.gl,B().getNumber(`WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION`)===2?`EXT_disjoint_timer_query_webgl2`:`EXT_disjoint_timer_query`),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(B().getNumber(`WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION`)===2){let e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}let e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(B().getNumber(`WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION`)===2){let e=this.gl,t=this.getQueryTimerExtensionWebGL2();e.endQuery(t.TIME_ELAPSED_EXT);return}let e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await FU(()=>this.disposed||this.isQueryAvailable(e,B().getNumber(`WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION`))),this.getQueryTime(e,B().getNumber(`WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION`))}getQueryTime(e,t){if(t===0)return null;if(t===2){let t=this.gl;return t.getQueryParameter(e,t.QUERY_RESULT)/1e6}else{let t=this.getQueryTimerExtensionWebGL1();return t.getQueryObjectEXT(e,t.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){let t=this.gl,n=this.getQueryTimerExtensionWebGL2(),r=t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE);return this.disjoint??=this.gl.getParameter(n.GPU_DISJOINT_EXT),r&&!this.disjoint}else{let t=this.getQueryTimerExtensionWebGL1(),n=t.getQueryObjectEXT(e,t.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint??=this.gl.getParameter(t.GPU_DISJOINT_EXT),n&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){let e=ize(this.itemsToPoll.map(e=>e.isDoneFn));for(let t=0;t<=e;++t){let{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let n;`setTimeoutCustom`in B().platform&&(n=B().platform.setTimeoutCustom.bind(B().platform)),FU(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,n)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),y5(this.gl,e,this.framebuffer),this.debug&&x5(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture==null?b5(this.gl,this.framebuffer):(y5(this.gl,this.outputTexture,this.framebuffer),this.debug&&x5(this.gl))}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);let n=t();return this.unbindTextureToFrameBuffer(),n}setOutputMatrixTextureDriver(e,t,n){this.throwIfDisposed();let r=this.gl;y5(r,e,this.framebuffer),this.debug&&x5(r),this.outputTexture=e,Q(r,()=>r.viewport(0,0,t,n)),Q(r,()=>r.scissor(0,0,t,n))}setOutputMatrixWriteRegionDriver(e,t,n,r){this.throwIfDisposed(),Q(this.gl,()=>this.gl.scissor(e,t,n,r))}throwIfDisposed(){if(this.disposed)throw Error(`Attempted to use disposed GPGPUContext.`)}throwIfNoProgram(){if(this.program==null)throw Error(`No GPU program is currently set.`)}};function ize(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}var{addImpl:aze,bincountImpl:c7,bincountReduceImpl:oze,bitwiseAndImpl:sze,castImpl:cze,ceilImpl:lze,concatImpl:uze,equalImpl:dze,expImpl:fze,expm1Impl:pze,floorImpl:mze,gatherNdImpl:hze,gatherV2Impl:gze,greaterImpl:_ze,greaterEqualImpl:vze,lessImpl:yze,lessEqualImpl:bze,linSpaceImpl:xze,logImpl:Sze,maxImpl:Cze,maximumImpl:wze,minimumImpl:Tze,multiplyImpl:Eze,negImpl:Dze,notEqualImpl:Oze,prodImpl:kze,raggedGatherImpl:Aze,raggedRangeImpl:jze,raggedTensorToTensorImpl:Mze,rangeImpl:Nze,rsqrtImpl:Pze,scatterImpl:Fze,sigmoidImpl:Ize,simpleAbsImpl:l7,sliceImpl:Lze,sparseFillEmptyRowsImpl:Rze,sparseReshapeImpl:zze,sparseSegmentReductionImpl:u7,sqrtImpl:Bze,staticRegexReplaceImpl:Vze,stridedSliceImpl:Hze,stringNGramsImpl:Uze,stringSplitImpl:Wze,stringToHashBucketFastImpl:Gze,subImpl:Kze,tileImpl:qze,topKImpl:Jze,transposeImpl:d7,uniqueImpl:Yze}=oMe;
/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
function f7(e,t){return[`x`,`y`,`z`,`w`,`u`,`v`].slice(0,t).map(t=>`${e}.${t}`)}function p7(e,t){return t===1?[e]:f7(e,t)}function Xze(e,t){if(e===1)return`rc`;let n=``;for(let r=0;r<e;r++)n+=t[r],r<e-1&&(n+=`,`);return n}var Zze=class{constructor(e){if(this.variableNames=[`A`],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=$5(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{let e=p7(`rc`,this.rank),t=q5(this.rank),n=this.getOutOfBoundsCondition(e),r=this.getSetup(e),i=this.getOutput(e);this.userCode=`
        void main() {
          ${t} rc = getOutputCoords();

          if(${n}) {
            setOutput(vec4(0));
          } else {
            ${r}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){let t=[];for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){let i=`${n===0?`r`:`rp1`}, ${r===0?`c`:`cp1`}`;for(let t=2;t<this.rank;t++)i=`${e[e.length-1-t]},`+i;t.push(i)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?`outShape`:this.outputShape[0]}`;let t=``;for(let n=this.rank-2;n<this.rank;n++)t+=`${e[n]} >= ${this.enableShapeUniforms?`outShape[${n}]`:this.outputShape[n]}`,n<this.rank-1&&(t+=`||`);return t}getSetup(e){if(this.rank===1)return``;let t=e.slice(-2),n=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${n};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){let t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?`outShape`:this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}},m7=class{constructor(e,t){this.variableNames=[`A`],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:`inputShape`,type:`ivec3`}],this.outputShape=e,this.enableShapeUniforms=$5(this.outputShape.length);let n=``;for(let e=0;e<4;e++){let t=`thisRC = rc;`;e%2==1&&(t+=`thisRC.z += 1;`),e>1&&(t+=`thisRC.y += 1;`),n+=`
        ${t}
        ${e>0?`if(thisRC.y < rows && thisRC.z < cols){`:``}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${e}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${e>0?`}`:``}
      `}this.userCode=`
      ${Qze(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?z5():R5(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?`outShape[1]`:e[1]};
        int cols = ${this.enableShapeUniforms?`outShape[2]`:e[2]};

        ${n}

        setOutput(result);
      }
    `}};function Qze(e,t){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${t?XLe([`r`,`c`,`d`],`inputShape`):I5([`r`,`c`,`d`],e)}
      return ivec3(r, c, d);
    }
  `}var $ze=class{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,t,n){let r=g7(t,n),i=_7(e,r,n);i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]);let a=h7(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=a,this.log();let e=this.freeTextures[i].pop();return this.usedTextures[i].push(e),e}let o;return r===u5.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===u5.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===u5.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===u5.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===u5.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(o),this.numUsedTextures++,this._numBytesAllocated+=a,this.log(),o}releaseTexture(e,t,n,r){if(this.freeTextures==null)return;let i=g7(n,r),a=_7(t,i,r);a in this.freeTextures||(this.freeTextures[a]=[]);let o=h7(t,i,this.gpgpu.gl,this.gpgpu.textureConfig,r),s=B().getNumber(`WEBGL_DELETE_TEXTURE_THRESHOLD`);s!==-1&&this._numBytesAllocated>s?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[a].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;let c=this.usedTextures[a],l=c&&c.indexOf(e);if(l==null||l<0)throw Error(`Cannot release a texture that was never provided by this texture manager`);c[l]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;let e=this.numFreeTextures+this.numUsedTextures;console.log(`Free/Used`,`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);let t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(let e in this.freeTextures)this.freeTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});for(let e in this.usedTextures)this.usedTextures[e].forEach(e=>{this.gpgpu.deleteMatrixTexture(e.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}};function eBe(e,t){let n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F||t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;if(t===n.RGBA8)return 4;throw Error(`Unknown internal format ${t}`)}function h7(e,t,n,r,i){let a=tBe(t,r),o;if(i){let[t,n]=p5(e[0],e[1]);o=t*n}else{let[t,n]=d5(e[0],e[1]);o=t*n}let s=eBe(n,a);return o*s}function tBe(e,t){switch(e){case u5.PACKED_2X2_FLOAT32:return a7(t);case u5.PACKED_2X2_FLOAT16:return o7(t);case u5.UNPACKED_FLOAT32:return n7(t);case u5.UNPACKED_FLOAT16:return r7(t);case u5.PACKED_4X1_UNSIGNED_BYTE:return i7(t);default:throw Error(`Unknown physical texture type ${e}`)}}function nBe(e){return B().getBool(`WEBGL_RENDER_FLOAT32_ENABLED`)?e?u5.PACKED_2X2_FLOAT32:u5.UNPACKED_FLOAT32:e?u5.PACKED_2X2_FLOAT16:u5.UNPACKED_FLOAT16}function g7(e,t){if(e===l5.UPLOAD)return u5.PACKED_2X2_FLOAT32;if(e===l5.RENDER||e==null)return nBe(t);if(e===l5.DOWNLOAD||e===l5.PIXELS)return u5.PACKED_4X1_UNSIGNED_BYTE;throw Error(`Unknown logical texture type ${e}`)}function _7(e,t,n){return`${e[0]}_${e[1]}_${t}_${n}`}var v7=class{constructor(e,t){this.variableNames=[`A`],this.outputShape=e,this.enableShapeUniforms=$5(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}};const y7=`if (isnan(x)) return x;`,b7=`return abs(x);`;y7+``,y7+``;const x7=`return x;`;var S7=class{constructor(e,t){this.variableNames=[`A`],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=$5(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}},rBe=class{constructor(e){this.variableNames=[`A`],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=$5(this.outputShape.length);let t=e.length,n=p7(`rc`,t),r=q5(t),i=Xze(t,n),a=n.slice(-2),o=t<=1?`rc`:`vec2(${a.join(`,`)})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${i});

        setOutput(getChannel(packedInput, ${o}));
      }
    `}},iBe=NZ,C7={};function aBe(e){return e in C7||(C7[e]={}),C7[e]}var oBe=B().getNumber(`CPU_HANDOFF_SIZE_THRESHOLD`),sBe=600;function cBe(){return B().global.screen==null?1024:B().global.screen.height*B().global.screen.width*window.devicePixelRatio*sBe/1024/1024}var w7=class e extends SU{nextDataId(){return e.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!B().getBool(`HAS_WEBGL`))throw Error(`WebGL is not supported on this device`);let t;if(e!=null){if(e instanceof s7)t=e;else{let n=s5(B().getNumber(`WEBGL_VERSION`),e);t=new s7(n)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{let e=s5(B().getNumber(`WEBGL_VERSION`));t=new s7(e),this.binaryCache=aBe(B().getNumber(`WEBGL_VERSION`)),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new $ze(this.gpgpu),this.numMBBeforeWarning=cBe(),this.texData=new xU(this,wJ())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,t,n,r,i,a){let o=this.makeTensorInfo(t,n),s=this.texData.get(o.dataId);s.isPacked=!1,s.texture={texture:e,texShape:[r,i]},s.texShape=[r,i];let c=T5(t),l=new e7(c,!1,a),u=this.runWebGLProgram(l,[o],n,[[r,i]]);return u.shape=t,s.texture=null,this.disposeIntermediateTensorInfo(o),u.dataId}write(e,t,n){if((B().getBool(`WEBGL_CHECK_NUMERICAL_PROBLEMS`)||B().getBool(`DEBUG`))&&this.checkNumericalProblems(e),n===`complex64`&&e!=null)throw Error(`Cannot write to a complex64 dtype. Please use tf.complex(real, imag).`);let r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:l5.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){let t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){let t=this.texData.get(e);t.refCount--}}move(e,t,n,r,i){if(B().getBool(`DEBUG`)&&this.checkNumericalProblems(t),r===`complex64`)throw Error(`Cannot write to a complex64 dtype. Please use tf.complex(real, imag).`);this.texData.set(e,{shape:n,dtype:r,values:t,usage:l5.UPLOAD,refCount:i})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){let{values:t,dtype:n,complexTensorInfos:r,slice:i,shape:a,isPacked:o}=this.texData.get(e);if(i!=null){let t;t=o?new S7(a,x7):new v7(a,x7);let r=this.runWebGLProgram(t,[{dataId:e,shape:a,dtype:n}],n),i=this.readSync(r.dataId);return this.disposeIntermediateTensorInfo(r),i}if(t!=null)return this.convertAndCacheOnCPU(e);if(n===`string`)return t;let s=this.activeTimers!=null,c;s&&(c=Mq());let l;if(n===`complex64`){let e=this.readSync(r.real.dataId),t=this.readSync(r.imag.dataId);l=$Q(e,t)}else l=this.getValuesFromTexture(e);return s&&(this.downloadWaitMs+=Mq()-c),this.convertAndCacheOnCPU(e,l)}async read(e){if(this.pendingRead.has(e)){let t=this.pendingRead.get(e);return new Promise(e=>t.push(e))}let{values:t,shape:n,slice:r,dtype:i,complexTensorInfos:a,isPacked:o}=this.texData.get(e);if(r!=null){let t;t=o?new S7(n,x7):new v7(n,x7);let r=this.runWebGLProgram(t,[{dataId:e,shape:n,dtype:i}],i),a=this.read(r.dataId);return this.disposeIntermediateTensorInfo(r),a}if(t!=null)return this.convertAndCacheOnCPU(e);if(B().getBool(`DEBUG`)&&!B().getBool(`WEBGL_DOWNLOAD_FLOAT_ENABLED`)&&B().getNumber(`WEBGL_VERSION`)===2)throw Error(`tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.`);let s=null,c;if(i!==`complex64`&&B().get(`WEBGL_BUFFER_SUPPORTED`)){c=this.decode(e);let t=this.texData.get(c.dataId);s=this.gpgpu.createBufferFromTexture(t.texture.texture,...f5(n))}this.pendingRead.set(e,[]),i!==`complex64`&&await this.gpgpu.createAndWaitForFence();let l;if(i===`complex64`){let e=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),t=e[0],n=e[1];l=$Q(t,n)}else if(s==null)l=this.getValuesFromTexture(e);else{let e=z(n);l=this.gpgpu.downloadFloat32MatrixFromBuffer(s,e)}if(c!=null&&this.disposeIntermediateTensorInfo(c),s!=null){let e=this.gpgpu.gl;Q(e,()=>e.deleteBuffer(s))}let u=this.convertAndCacheOnCPU(e,l),d=this.pendingRead.get(e);return this.pendingRead.delete(e),d.forEach(e=>e(u)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&wJ().removeDataId(e,this),this.pendingDeletes--),u}readToGPU(e,t={}){let{values:n,shape:r,slice:i,dtype:a,isPacked:o,texture:s}=this.texData.get(e);if(a===`complex64`)throw Error(`Does not support reading texture for complex64 dtype.`);if(i!=null){let n;n=o?new S7(r,x7):new v7(r,x7);let i=this.runWebGLProgram(n,[{dataId:e,shape:r,dtype:a}],a),s=this.readToGPU(i,t);return this.disposeIntermediateTensorInfo(i),s}if(s==null)throw n==null?Error(`There is no data on GPU or CPU.`):Error(`Data is not on GPU but on CPU.`);let c=this.decode(e,t.customTexShape),l=wJ().makeTensorFromTensorInfo(c),u=this.texData.get(c.dataId);return Object.assign({tensorRef:l},u.texture)}bufferSync(e){let t=this.readSync(e.dataId);if(e.dtype===`string`)try{let n=t.map(e=>Pq(e));return tY(e.shape,e.dtype,n)}catch{throw Error(`Failed to decode encoded string bytes into utf-8`)}return tY(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){let n=e[t];if(!CLe(n))throw B().getBool(`WEBGL_RENDER_FLOAT32_CAPABLE`)?Error(`The value ${n} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${n} cannot be represented on this device.`)}}getValuesFromTexture(e){let{shape:t,dtype:n,isPacked:r}=this.texData.get(e),i=z(t);if(B().getBool(`WEBGL_DOWNLOAD_FLOAT_ENABLED`)){let n=this.decode(e),r=this.texData.get(n.dataId),a=this.gpgpu.downloadMatrixFromPackedTexture(r.texture.texture,...f5(t)).subarray(0,i);return this.disposeIntermediateTensorInfo(n),a}let a=B().getBool(`WEBGL_PACK`)&&r===!0,o=a?T5(t):t,s=a?new zRe(o):new RRe(o),c=this.runWebGLProgram(s,[{shape:o,dtype:n,dataId:e}],`float32`),l=this.texData.get(c.dataId),u=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(l.texture.texture,l.texShape[0],l.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(c),u}timerAvailable(){return B().getNumber(`WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE`)>0}time(e){let t=this.activeTimers,n=[],r=!1;this.programTimersStack==null?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e();let i=Iq(this.activeTimers.map(e=>e.query)).filter(e=>e!=null),a=Iq(this.activeTimers.map(e=>e.name)).filter(e=>e!=null);this.activeTimers=t,r&&(this.programTimersStack=null);let o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(B().getNumber(`WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE`)>0){let e=await Promise.all(i);o.kernelMs=OU(e),o.getExtraProfileInfo=()=>e.map((e,t)=>({name:a[t],ms:e})).map(e=>`${e.name}: ${e.ms}`).join(`, `)}else o.kernelMs={error:`WebGL query timers are not supported in this environment.`};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return B().getNumber(`WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE`)>0?this.gpgpu.beginQuery():{startMs:Mq(),endMs:null}}endTimer(e){return B().getNumber(`WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE`)>0?(this.gpgpu.endQuery(),e):(e.endMs=Mq(),e)}async getQueryTime(e){if(B().getNumber(`WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE`)>0)return this.gpgpu.waitForQueryAndGetTime(e);let t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);let{complexTensorInfos:n}=this.texData.get(e);return n!=null&&(this.disposeData(n.real.dataId,t),this.disposeData(n.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){let{texture:t,dtype:n,texShape:r,usage:i,isPacked:a,slice:o}=this.texData.get(e),s=o&&o.origDataId||e,c=this.dataRefCount.get(s);c>1?this.dataRefCount.set(s,c-1):(this.dataRefCount.delete(s),t!=null&&(this.numBytesInGPU-=this.computeBytes(r,n),this.textureManager.releaseTexture(t,r,i,a)));let l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=oBe){return B().getBool(`WEBGL_CPU_FORWARD`)&&e.every(e=>this.texData.get(e.dataId).texture==null&&z(e.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){cq(`tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead`);let t=e.dataSync();return iBe(e.shape,t)}packedUnaryOp(e,t,n){let r=new S7(e.shape,t),i=this.compileAndRun(r,[e],n);return wJ().makeTensorFromTensorInfo(i)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!==`complex64`){let t=l7(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(B().getBool(`WEBGL_PACK_UNARY_OPERATIONS`))return this.packedUnaryOp(e,b7,e.dtype);let t=new v7(e.shape,b7),n=this.compileAndRun(t,[e]);return wJ().makeTensorFromTensorInfo(n)}makeTensorInfo(e,t,n){let r;if(t===`string`&&n!=null&&n.length>0&&KU(n[0])){let i=n.map(e=>Nq(e));r=this.write(i,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,n){return wJ().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,n),this)}unpackTensor(e){let t=new rBe(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){let t=new Zze(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){let n=[C5(e.shape),...w5(e.shape)],r={dtype:e.dtype,shape:n,dataId:e.dataId},i=[C5(t),...w5(t)],a=new m7(i,n),o=[n],s=this.runWebGLProgram(a,[r],e.dtype,o,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}decode(e,t){let{isPacked:n,shape:r,dtype:i}=this.texData.get(e);if(t!=null){let e=z(r),n=t[0]*t[1]*4;R(e<=n,()=>`customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.`)}let a=T5(r),o;o=n?new LRe(a):new IRe(a);let s=[t??f5(a)],c=this.runWebGLProgram(o,[{shape:a,dtype:i,dataId:e}],i,s,!0,t);return{dtype:i,shape:r,dataId:c.dataId}}runWebGLProgram(e,t,n,r,i=!1,a){let o=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(o.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===c5.DENSE&&(s.texShape=(a??f5(e.outputShape)).map(e=>e*2)),e.outTexUsage!=null&&(s.usage=e.outTexUsage),z(o.shape)===0)return s.values=zU(o.dtype,0),o;let c=[],l=t.map(t=>{if(t.dtype===`complex64`)throw Error(`GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.`);let n=this.texData.get(t.dataId);if(n.texture==null){if(!e.packedInputs&&z(t.shape)<=B().getNumber(`WEBGL_SIZE_UPLOAD_UNIFORM`))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}if(this.uploadToGPU(t.dataId),!!n.isPacked!=!!e.packedInputs)t=n.isPacked?this.unpackTensor(t):this.packTensor(t),c.push(t),n=this.texData.get(t.dataId);else if(n.isPacked&&!D5(n.shape,t.shape)){let e=t,r=t.shape;t.shape=n.shape,t=this.packedReshape(t,r),c.push(t),n=this.texData.get(t.dataId),e.shape=r}return{shape:t.shape,texData:n,isUniform:!1}});this.uploadToGPU(o.dataId);let u={shape:o.shape,texData:s,isUniform:!1},d=FRe(e,l,u),f=this.getAndSaveBinary(d,()=>NRe(this.gpgpu,e,l,u)),p=this.activeTimers!=null,m;p&&(m=this.startTimer()),B().get(`ENGINE_COMPILE_ONLY`)||PRe(this.gpgpu,f,l,u,r),c.forEach(e=>this.disposeIntermediateTensorInfo(e)),p&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));let h=B().getNumber(`WEBGL_FLUSH_THRESHOLD`);if(h>0){let e=Mq();e-this.lastGlFlushTime>h&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=e)}if(!B().getBool(`WEBGL_LAZILY_UNPACK`)&&s.isPacked&&i===!1){let e=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),e}return o}compileAndRun(e,t,n,r,i=!1){return n||=t[0].dtype,this.runWebGLProgram(e,t,n,r,i)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||=(B().getBool(`IS_TEST`)||Object.keys(this.binaryCache).forEach(e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<`u`&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),!0)}floatPrecision(){return this.floatPrecisionValue??=G(()=>{if(!B().get(`WEBGL_RENDER_FLOAT32_ENABLED`)){let e=B().getBool(`DEBUG`);B().set(`DEBUG`,!1);let t=this.abs(fX(1e-8)).dataSync()[0];if(B().set(`DEBUG`,e),t>0)return 32}return 16}),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?1e-7:1e-4}uploadToGPU(e){let t=this.texData.get(e),{shape:n,dtype:r,values:i,texture:a,usage:o,isPacked:s}=t;if(a!=null)return;let c=this.activeTimers!=null,l;c&&(l=Mq());let u=t.texShape;if(u??(u=VLe(n,s),t.texShape=u),i!=null){let e=T5(n),a,o=u[1],d=u[0],f=i instanceof Uint8Array||i instanceof Uint8ClampedArray;(s||!f)&&([o,d]=p5(u[0],u[1])),a=s?new VRe(e,f):new e7(e,f);let p=f?[d,o]:u,m=this.makeTensorInfo(p,r),h=this.texData.get(m.dataId);f?h.usage=l5.PIXELS:h.usage=l5.UPLOAD,h.texShape=p,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(m.dataId),o,d,i);let g=[[d,o]],_=this.runWebGLProgram(a,[m],r,g,!0),v=this.texData.get(_.dataId);t.texShape=v.texShape,t.isPacked=v.isPacked,t.usage=v.usage,B().get(`ENGINE_COMPILE_ONLY`)?this.disposeData(_.dataId):(t.texture=v.texture,t.values=null,this.texData.delete(_.dataId)),this.disposeIntermediateTensorInfo(m),c&&(this.uploadWaitMs+=Mq()-l)}else t.texture=this.acquireTexture(u,o,r,s)}convertAndCacheOnCPU(e,t){let n=this.texData.get(e),{dtype:r}=n;return t!=null&&(n.values=lBe(t,r)),n.values}acquireTexture(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){let e=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${e} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*WU(t)}checkCompileCompletion(){for(let[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){let e=[];if(this.gpgpu.parallelCompilationExtension){for(let[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(let[,t]of Object.entries(this.binaryCache)){let n=new Promise(e=>{try{this.checkCompletion_(t),e(!0)}catch(e){throw e}});e.push(n)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await AQ(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(g5(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),Error(`Failed to compile fragment shader.`)):Error(`Failed to link vertex and fragment shaders.`);return!0}getUniformLocations(){for(let e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);let{variablesLocations:t,customUniformLocations:n,infLoc:r,nanLoc:i,outShapeLocation:a,outShapeStridesLocation:o,outTexShapeLocation:s}=Z5(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=t,e.customUniformLocations=n,e.infLoc=r,e.nanLoc=i,e.outShapeLocation=a,e.outShapeStridesLocation=o,e.outTexShapeLocation=s}}createTensorFromGPUData(e,t,n){e.channels=e.channels||`RGBA`;let{texture:r,height:i,width:a,channels:o}=e,s=wJ().backend;if(!s.gpgpu.gl.isTexture(r))throw Error(`The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.`);let c=s.writeTexture(r,t,n,i,a,o);return wJ().makeTensorFromDataId(c,t,n,s)}};w7.nextDataId=0;function lBe(e,t){if(t===`float32`||t===`complex64`)return e;if(t===`int32`||t===`bool`){let n=t===`int32`?new Int32Array(e.length):new Uint8Array(e.length);for(let t=0;t<n.length;++t)n[t]=Math.round(e[t]);return n}else throw Error(`Unknown dtype ${t}`)}pJ()&&OJ(`webgl`,()=>new w7,2);const T7=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;var E7=class{constructor(e,t,n){this.variableNames=[`A`,`B`],this.outputShape=JY(t,n),this.enableShapeUniforms=$5(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}};const D7=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;var O7=class{constructor(e,t,n,r=!1){this.variableNames=[`A`,`B`],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=JY(t,n);let i=this.outputShape.length;this.enableShapeUniforms=$5(i);let a=``;if(r)if(i===0||z(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          ${q5(i)} coords = getOutputCoords();
        `,i===1)this.enableShapeUniforms?a+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:a+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{let e=p7(`coords`,i);this.enableShapeUniforms?a+=`
            bool nextRowOutOfBounds =
              (${e[i-2]} + 1) >= outShape[${i} - 2];
            bool nextColOutOfBounds =
              (${e[i-1]} + 1) >= outShape[${i} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:a+=`
            bool nextRowOutOfBounds =
              (${e[i-2]} + 1) >= ${this.outputShape[i-2]};
            bool nextColOutOfBounds =
              (${e[i-1]} + 1) >= ${this.outputShape[i-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${a}

        setOutput(result);
      }
    `}};function k7(e){let{inputs:t,backend:n}=e,{x:r}=t;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const uBe={kernelName:wG,backendName:`webgl`,kernelFunc:k7};function A7(e){let{inputs:t,backend:n}=e,{real:r,imag:i}=t,a=n.makeTensorInfo(r.shape,`complex64`),o=n.texData.get(a.dataId),s=k7({inputs:{x:r},backend:n}),c=k7({inputs:{x:i},backend:n});return o.complexTensorInfos={real:s,imag:c},a}const dBe={kernelName:VW,backendName:`webgl`,kernelFunc:A7},j7=`return (a < 0.) ? b * a : a;`,M7=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function fBe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{alpha:a}=r,o=n.makeTensorInfo([],`float32`,Aq(a,`float32`)),s=B().getBool(`WEBGL_PACK_BINARY_OPERATIONS`)?new O7(M7,i.shape,o.shape):new E7(j7,i.shape,o.shape),c=n.runWebGLProgram(s,[i,o],`float32`);return n.disposeIntermediateTensorInfo(o),c}const pBe={kernelName:AG,backendName:`webgl`,kernelFunc:fBe},N7=`return (a < 0.) ? b * a : a;`,P7=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function mBe(e){let{inputs:t,backend:n}=e,{x:r,alpha:i}=t,a=B().getBool(`WEBGL_PACK_BINARY_OPERATIONS`)?new O7(P7,r.shape,i.shape):new E7(N7,r.shape,i.shape);return n.runWebGLProgram(a,[r,i],`float32`)}const hBe={kernelName:iK,backendName:`webgl`,kernelFunc:mBe},F7=`if (isnan(x)) return x;`;function I7({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:n,dtype:r}){return({inputs:i,backend:a})=>{let{x:o}=i,s=a,c=r||o.dtype;if(s.shouldExecuteOnCPU([o])&&n!=null){let e=s.texData.get(o.dataId),t=n(e.values,c);return s.makeTensorInfo(o.shape,c,t)}let l=B().getBool(`WEBGL_PACK_UNARY_OPERATIONS`)&&t!=null,u;return u=l?new S7(o.shape,t):new v7(o.shape,e),s.runWebGLProgram(u,[o],c)}}function L7({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:a}){return({inputs:o,backend:s})=>{let{a:c,b:l}=o,u=s;if(r&&c.dtype===`complex64`){let t=u.texData.get(c.dataId),n=u.texData.get(l.dataId),[r,i]=[[t.complexTensorInfos.real,n.complexTensorInfos.real],[t.complexTensorInfos.imag,n.complexTensorInfos.imag]].map(t=>{let[n,r]=t,i={dataId:n.dataId,dtype:n.dtype,shape:c.shape},a={dataId:r.dataId,dtype:r.dtype,shape:l.shape},o=new E7(e,c.shape,l.shape);return u.runWebGLProgram(o,[i,a],$q(n.dtype,r.dtype))}),a=A7({inputs:{real:r,imag:i},backend:u});return u.disposeIntermediateTensorInfo(r),u.disposeIntermediateTensorInfo(i),a}let d=a||$q(c.dtype,l.dtype);if((c.dtype===`string`||l.dtype===`string`||u.shouldExecuteOnCPU([c,l]))&&i!=null){let e=u.texData.get(c.dataId).values,t=u.texData.get(l.dataId).values,n=c.dtype===`string`?j$(e):e,r=c.dtype===`string`?j$(t):t,[a,o]=i(c.shape,l.shape,n,r,d),s=u.makeTensorInfo(o,d),f=u.texData.get(s.dataId);return f.values=a,s}let f=B().getBool(`WEBGL_PACK_BINARY_OPERATIONS`)&&t!=null,p;return p=f?new O7(t,c.shape,l.shape,n):new E7(e,c.shape,l.shape),u.runWebGLProgram(p,[c,l],d)}}function R7(e,t=!1){if(e===`linear`)return`return x;`;if(e===`relu`)return t?`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`:`if (isnan(x)) return x;
  return (x < 0.0) ? 0.0 : x;
`;if(e===`elu`)return t?`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`:`return (x >= 0.0) ? x : (exp(x) - 1.0);`;if(e===`relu6`)return t?`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`:`if (isnan(x)) return x;
  return (x < 0.0) ? 0.0 : min(6.0, x);
`;if(e===`prelu`)return t?P7:N7;if(e===`leakyrelu`)return t?M7:j7;if(e===`sigmoid`)return`return 1.0 / (1.0 + exp(-1.0 * x));`;throw Error(`Activation ${e} has not been implemented for the WebGL backend.`)}var z7=class{constructor(e,t,n,r=!1,i=!1,a=!1,o=null,s=!1,c=!1){this.variableNames=[`matrixA`,`matrixB`],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n,this.enableShapeUniforms=$5(this.outputShape.length);let l=r?e[1]:e[2],u=Math.ceil(l/2),d=r?`i * 2, rc.y`:`rc.y, i * 2`,f=i?`rc.z, i * 2`:`i * 2, rc.z`,p=r?[`a.xxyy`,`a.zzww`]:[`a.xxzz`,`a.yyww`],m=i?[`b.xzxz`,`b.ywyw`]:[`b.xyxy`,`b.zwzw`],h=``,g=``;o&&(h=s?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:c?`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:`vec4 activation(vec4 x) {
          ${o}
        }`,g=`result = activation(result);`);let _=a?`result += getBiasAtOutCoords();`:``;a&&this.variableNames.push(`bias`),s&&this.variableNames.push(`preluActivationWeights`),c&&this.variableNames.push(`leakyreluAlpha`);let v=`rc.x`,y=`rc.x`;e[0]<t[0]?v=`imod(rc.x, ${e[0]})`:t[0]<e[0]&&(y=`imod(rc.x, ${t[0]})`),this.userCode=`
      ${h}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${u}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${v};
        int batchB = ${y};
        for (int i = 0; i < ${u}; i++) {
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${_}

        ${g}

        setOutput(result);
      }
    `}};const B7={REAL:`return areal * breal - aimag * bimag;`,IMAG:`return areal * bimag + aimag * breal;`};var V7=class{constructor(e,t,n){this.variableNames=[`AReal`,`AImag`,`BReal`,`BImag`],this.outputShape=JY(t,n),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}},H7=`return a * b;`;function U7(e){let{inputs:t,backend:n}=e,{a:r,b:i}=t,a=$q(r.dtype,i.dtype);if(r.dtype===`complex64`){let e=n.texData.get(r.dataId),t=n.texData.get(i.dataId),a=new V7(B7.REAL,r.shape,i.shape),o=new V7(B7.IMAG,r.shape,i.shape),s=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:r.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:i.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:i.shape}],c=n.runWebGLProgram(a,s,`float32`),l=n.runWebGLProgram(o,s,`float32`),u=A7({inputs:{real:c,imag:l},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),u}if(n.shouldExecuteOnCPU([r,i])){let e=n.texData.get(r.dataId),t=n.texData.get(i.dataId),[o,s]=Eze(r.shape,i.shape,e.values,t.values,a),c=n.makeTensorInfo(s,a),l=n.texData.get(c.dataId);return l.values=o,c}let o;return o=B().getBool(`WEBGL_PACK_BINARY_OPERATIONS`)?new O7(H7,r.shape,i.shape):new E7(H7,r.shape,i.shape),n.runWebGLProgram(o,[r,i],a)}const gBe={kernelName:YG,backendName:`webgl`,kernelFunc:U7};function _Be(e,t,n){let r=[C5(e.shape),...w5(e.shape)],i={dtype:e.dtype,shape:r,dataId:e.dataId},a=[C5(t),...w5(t)],o=new m7(a,r),s=[r],c=n.runWebGLProgram(o,[i],e.dtype,s,!0);return{dataId:c.dataId,shape:t,dtype:c.dtype}}function $(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{shape:a}=r,o=n,s=z(i.shape),c=IU(a,s),l=z(c);R(s===l,()=>`The new shape (${c}) has ${l} elements and the old shape (${i.shape}) has ${s} elements. The new shape and old shape must have the same number of elements.`);let u=o.texData.get(i.dataId);return u.isPacked&&!D5(i.shape,c)&&!(u.texture!==null&&D5(u.shape,c))?_Be(i,c,o):(o.incRef(i.dataId),{dataId:i.dataId,shape:c,dtype:i.dtype})}const vBe={kernelName:pK,backendName:`webgl`,kernelFunc:$};var W7=class{constructor(e,t){this.variableNames=[`x`];let{windowSize:n,batchSize:r,inSize:i,outSize:a}=e;this.outputShape=[r,a];let o=Math.floor(n/4)*4,s=n%4,c=`sumValue += dot(values, ones);`;if(t!=null){let e=1/t;c=`sumValue += dot(values * ${MU(e)?e.toPrecision(2):e}, ones);`}let l=``;i%n>0&&(l=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${l}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        float sumValue = 0.0;

        for (int i = 0; i < ${o}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${o};
        if (${s===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${s===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${s===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}},yBe=class{constructor(e,t){this.variableNames=[`x`];let{windowSize:n,batchSize:r,inSize:i,outSize:a}=e;this.outputShape=[r,a];let o=`0.0`,s=``;t===`prod`?o=`1.0`:t===`min`?(o=`1.0 / 1e-20`,s=`min`):t===`max`&&(o=`-1.0 / 1e-20`,s=`max`);let c=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t===`sum`?c=`sumValue`:t===`prod`?c=`prodValue`:t===`all`?c=`allValue`:t===`any`&&(c=`anyValue`);let l=Math.floor(n/4)*4,u=n%4,d=`
      if (${t===`sum`}) {
        sumValue += dot(values, ones);
      } else if (${t===`prod`}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${s}(values, minMaxValue);
        if (${t===`min`} || ${t===`max`}) {
          minMaxValue = ${s}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f=`vec4`;t===`all`?(o=`1.0`,d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f=`bvec4`):t===`any`&&(o=`0.0`,d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f=`bvec4`);let p=``;i%n>0&&(p=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${o};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${n};

        vec4 minMaxValue = vec4(${o});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${l}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${l};
        if (${u===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${u===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${u===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${c});
      }
    `}};function bBe(e){let t=[];for(;t.length===0||t[t.length-1].outSize!==1;){let n=t.length?t[t.length-1].outSize:e[1],r=RQ(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}function G7(e,t,n,r){let i=bBe(e.shape),a=e;for(let o=0;o<i.length;o++){let{inSize:s,windowSize:c,outSize:l}=i[o],u,d;u=n===`mean`?o===0?new W7({windowSize:c,inSize:s,batchSize:e.shape[0],outSize:l},s):new W7({windowSize:c,inSize:s,batchSize:e.shape[0],outSize:l}):new yBe({windowSize:c,inSize:s,batchSize:e.shape[0],outSize:l},n),d=a,a=r.runWebGLProgram(u,[a],t),d.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(d)}return a}var xBe=class{constructor(e,t){this.variableNames=[`A`];let n=Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;let r=q5(this.rank),i=SBe(t);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${i}));
    }
    `}};function SBe(e){let t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);let n=[`resRC.x`,`resRC.y`,`resRC.z`,`resRC.w`,`resRC.u`,`resRC.v`],r=Array(t);for(let t=0;t<e.length;t++)r[e[t]]=n[t];return r.join()}var CBe=class{constructor(e,t){this.variableNames=[`A`],this.packedInputs=!0,this.packedOutput=!0;let n=Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);let r=q5(this.rank),i=f7(`rc`,this.rank),a=Array(this.rank);for(let e=0;e<t.length;e++)a[t[e]]=i[e];let o=`vec2(${a.slice(-2).join()})`,s=`++${i[this.rank-1]} < ${n[this.rank-1]}`,c=`getChannel(getA(${a.join()}), ${o})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${s}) {
        result[1] = ${c};
      }
      --${i[this.rank-1]};
      if(++${i[this.rank-2]} < ${n[this.rank-2]}) {
        result[2] = ${c};
        if(${s}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}};function K7(e,t,n){let r=B().getBool(`WEBGL_PACK_ARRAY_OPERATIONS`)?new CBe(e.shape,t):new xBe(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function wBe(e,t,n,r){let i=t,a=e.shape.length,o=LU(i,e.shape),s=o,c=oX(s,a),l=c!=null,u=e;l&&(u=K7(e,c,r),s=cX(s.length,a)),aX(`sum`,s,a);let[d,f]=rX(u.shape,s),p=d;n&&(p=iX(d,o));let m=z(f),h=z(e.shape)/m,g=$({inputs:{x:u},attrs:{shape:[h,m]},backend:r}),_=eJ(e.dtype),v=G7(g,_,`sum`,r),y=$({inputs:{x:v},attrs:{shape:p},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(v),l&&r.disposeIntermediateTensorInfo(u),y}function q7(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:o}=r;return wBe(i,a,o,n)}const TBe={kernelName:`Sum`,backendName:`webgl`,kernelFunc:q7};function J7(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{perm:a}=r,o=n,s=i.shape.length,c=Array(s);for(let e=0;e<c.length;e++)c[e]=i.shape[a[e]];let l;if(o.shouldExecuteOnCPU([i])){let e=o.texData.get(i.dataId).values,t=d7(e,i.shape,i.dtype,a,c);l=o.makeTensorInfo(c,i.dtype);let n=o.texData.get(l.dataId);n.values=t}else l=K7(i,a,o);return l}const EBe={kernelName:QK,backendName:`webgl`,kernelFunc:J7};function Y7({a:e,b:t,transposeA:n,transposeB:r,backend:i,bias:a=null,preluActivationWeights:o=null,leakyreluAlpha:s=0,activation:c=null}){let l=e.shape.length,u=t.shape.length,d=n?e.shape[l-2]:e.shape[l-1],f=r?t.shape[u-1]:t.shape[u-2],p=n?e.shape[l-1]:e.shape[l-2],m=r?t.shape[u-2]:t.shape[u-1],h=e.shape.slice(0,-2),g=t.shape.slice(0,-2),_=z(h),v=z(g),y=JY(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([p,m]);R(d===f,()=>`Error in matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${n} and transposeB=${r} must match.`);let b=n?[_,d,p]:[_,p,d],x=r?[v,m,f]:[v,f,m],S=$({inputs:{x:e},backend:i,attrs:{shape:b}}),C=$({inputs:{x:t},backend:i,attrs:{shape:x}}),w=[S,C],T=Math.max(_,v),E=n?S.shape[1]:S.shape[2],D=a!=null,O=o!=null,k=c===`leakyrelu`,ee=c==null?null:R7(c,!0),te=D||O||k||ee!=null,ne;if((p===1||m===1)&&E>1e3&&te===!1){let e=S,t=C;n&&(e=J7({inputs:{x:S},backend:i,attrs:{perm:[0,2,1]}}),w.push(e)),r&&(t=J7({inputs:{x:C},backend:i,attrs:{perm:[0,2,1]}}),w.push(t));let a=m!==1,o=m===1,s=e;a&&(s=$({inputs:{x:e},backend:i,attrs:{shape:[T,E,1]}}),w.push(s));let c=m===1?2:1,l=t;o&&(l=$({inputs:{x:t},backend:i,attrs:{shape:[T,1,E]}}),w.push(l));let u=U7({inputs:{a:s,b:l},backend:i});ne=q7({inputs:{x:u},backend:i,attrs:{axis:c,keepDims:!0}}),w.push(u)}else{let c=$q(e.dtype,t.dtype),l=new z7(b,x,[T,p,m],n,r,D,ee,O,k),u=[S,C];if(a!=null&&u.push(a),O&&u.push(o),k){let e=i.makeTensorInfo([],`float32`,Aq(s,`float32`));u.push(e),w.push(e)}ne=i.runWebGLProgram(l,u,c)}let A=$({inputs:{x:ne},backend:i,attrs:{shape:y}});w.push(ne);for(let e of w)i.disposeIntermediateTensorInfo(e);return A}function DBe(e){let{inputs:t,backend:n,attrs:r}=e,{a:i,b:a,bias:o,preluActivationWeights:s}=t,{transposeA:c,transposeB:l,activation:u,leakyreluAlpha:d}=r;return Y7({a:i,b:a,transposeA:c,transposeB:l,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:d,activation:u})}const OBe={kernelName:aq,backendName:`webgl`,kernelFunc:DBe};var X7=`return abs(x);`;function kBe(e){let{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])&&r.dtype!==`complex64`){let e=n.texData.get(r.dataId),t=l7(e.values);return n.makeTensorInfo(r.shape,r.dtype,t)}let i;return i=B().getBool(`WEBGL_PACK_UNARY_OPERATIONS`)?new S7(r.shape,X7):new v7(r.shape,X7),n.runWebGLProgram(i,[r],r.dtype)}const ABe={kernelName:`Abs`,backendName:`webgl`,kernelFunc:kBe};var jBe=y7+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`;const MBe=I7({opSnippet:jBe}),NBe={kernelName:yW,backendName:`webgl`,kernelFunc:MBe};var PBe=y7+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`;const FBe=I7({opSnippet:PBe}),IBe={kernelName:bW,backendName:`webgl`,kernelFunc:FBe};var Z7=`return a + b;`;const LBe={kernelName:`Add`,backendName:`webgl`,kernelFunc:L7({opSnippet:Z7,packedOpSnippet:Z7,supportsComplex:!0,cpuKernelImpl:aze})};
/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var RBe=class{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((e,t)=>`T${t}`);let n=[];this.variableNames.forEach(e=>{n.push(`float v${e} = get${e}AtOutCoords();`)});let r=this.variableNames.map(e=>`v${e}`).join(` + `);this.userCode=`
      void main() {
        ${n.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}},zBe=class{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((e,t)=>`T${t}`);let n=[];this.variableNames.forEach(e=>{n.push(`vec4 v${e} = get${e}AtOutCoords();`)});let r=this.variableNames.map(e=>`v${e}`).join(` + `);this.userCode=`
      void main() {
        ${n.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}};function Q7(e){let{inputs:t,backend:n}=e,r=t;if(r.length===1)return k7({inputs:{x:r[0]},backend:n});if(r.length>B().getNumber(`WEBGL_MAX_TEXTURES_IN_SHADER`)){let e=Math.floor(r.length/2),t=Q7({inputs:r.slice(0,e),backend:n}),i=Q7({inputs:r.slice(e),backend:n});return Q7({inputs:[t,i],backend:n})}let i=r.map(e=>e.dtype).reduce((e,t)=>$q(e,t)),a=r.map(e=>e.shape),o=B().getBool(`WEBGL_PACK`)?new zBe(r[0].shape,a):new RBe(r[0].shape,a);return n.runWebGLProgram(o,r,i)}const BBe={kernelName:xW,backendName:`webgl`,kernelFunc:Q7};function VBe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:o}=r,s=i.shape.length,c=LU(a,i.shape),l=c,u=oX(l,s),d=i;u!=null&&(d=J7({inputs:{x:i},backend:n,attrs:{perm:u}}),l=cX(l.length,s)),aX(`all`,l,s);let[f,p]=rX(d.shape,l),m=z(p),h=$({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),g=G7(h,h.dtype,`all`,n),_;if(o){let e=iX(f,c);_=$({inputs:{x:g},backend:n,attrs:{shape:e}})}else _=$({inputs:{x:g},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),_}const HBe={kernelName:`All`,backendName:`webgl`,kernelFunc:VBe};function UBe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:o}=r,s=i.shape.length,c=LU(a,i.shape),l=c,u=oX(l,s),d=i;u!=null&&(d=J7({inputs:{x:i},backend:n,attrs:{perm:u}}),l=cX(l.length,s)),aX(`any`,l,s);let[f,p]=rX(d.shape,l),m=z(p),h=$({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),g=G7(h,h.dtype,`any`,n),_;if(o){let e=iX(f,c);_=$({inputs:{x:g},backend:n,attrs:{shape:e}})}else _=$({inputs:{x:g},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),_}const WBe={kernelName:`Any`,backendName:`webgl`,kernelFunc:UBe};
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var GBe=class{constructor(e,t,n){this.variableNames=[`A`];let{windowSize:r,batchSize:i,outSize:a}=e;n||this.variableNames.push(`bestIndicesA`),this.outputShape=[i,a],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${n?`inOffset + i;`:`round(getBestIndicesA(batch, inOffset + i));`};
          float candidate = getA(batch, inIdx);
          if (candidate ${t===`max`?`>`:`<`} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}},KBe=class{constructor(e,t,n,r){this.variableNames=[`A`],this.packedInputs=!0,this.packedOutput=!0,R(e.length>2,()=>`Packed arg${n.charAt(0).toUpperCase()+n.slice(1)} supports only inputs with rank above 2.`);let i=e[e.length-1],a=Math.ceil(i/t);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),r||this.variableNames.push(`bestIndicesA`);let o=this.outputShape,s=o.length,c=q5(s),l=p7(`coords`,s),u,d;if(a===1){d=s+1;let e=q5(d);u=`
        ${e} sourceLocR = ${e}(${l.join()}, 0);
        ++${l[s-1]};
        ${e} sourceLocG = ${e}(${l.join()}, 0);
        ++${l[s-2]};
        ${e} sourceLocA = ${e}(${l.join()}, 0);
        --${l[s-1]};
        ${e} sourceLocB = ${e}(${l.join()}, 0);
        --${l[s-2]};`}else d=s,u=`
        ${c} sourceLocR = coords;
        ++${l[s-1]};
        ${c} sourceLocG = coords;
        ++${l[s-2]};
        ${c} sourceLocA = coords;
        --${l[s-1]};
        ${c} sourceLocB = coords;
        --${l[s-2]};`;let f=[`x`,`y`,`z`,`w`,`u`,`v`].slice(0,d),p=`.`+f[d-1],m=f.map(e=>`int `+e),h=p7(`sourceLocR`,d-1).concat(`inIdx.r`),g=p7(`sourceLocG`,d-1).concat(`inIdx.g`),_=p7(`sourceLocB`,d-1).concat(`inIdx.b`),v=p7(`sourceLocA`,d-1).concat(`inIdx.a`),y=n===`max`?`greaterThan`:`lessThan`,b=r?``:`
          inIdx = round(vec4(getBestIndicesAChannel(${h.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${_.join()}),
                             getBestIndicesAChannel(${v.join()})));`,x=`vec4(
            getAChannel(${h.join()}),
            hasNextCol ? getAChannel(${g.join()}) : 0.,
            hasNextRow ? getAChannel(${_.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,S=r?``:`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${S}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${l[s-1]} < ${o[s-1]-1};
        bool hasNextRow = ${l[s-2]} < ${o[s-2]-1};
        ${u}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${x};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${b}
          vec4 candidate = ${x};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${y}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}};function $7(e,t,n,r=null){let i=t.shape[0],a=t.shape[1];r!=null&&(i=r.shape[0],a=r.shape[1]);let o=RQ(a),s={windowSize:o,inSize:a,batchSize:i,outSize:Math.ceil(a/o)},c=new GBe(s,n,r==null),l=[t];r!=null&&l.push(r);let u=e.runWebGLProgram(c,l,`int32`);if(u.shape[1]===1)return u;let d=$7(e,t,n,u);return e.disposeIntermediateTensorInfo(u),d}function e9(e,t,n,r=null){let i=r==null?t.shape:r.shape,a=i[i.length-1],o=RQ(a),s=new KBe(i,o,n,r==null),c=r==null?[t]:[t,r],l=e.runWebGLProgram(s,c,`int32`);if(l.shape.length===t.shape.length){let r=e9(e,t,n,l);return e.disposeIntermediateTensorInfo(l),r}return l}function t9(e,t,n,r){let i=[n];if(aX(`arg`+r.charAt(0).toUpperCase()+r.slice(1),i,t.shape.length),!B().getBool(`WEBGL_PACK_REDUCE`)||t.shape.length<=2){let n=[],a=e.texData.get(t.dataId),o=a!==null&&a.isPacked,s=t;o&&(s=e.unpackTensor(t),n.push(s));let[c,l]=rX(s.shape,i),u=z(l),d=$({inputs:{x:s},backend:e,attrs:{shape:[-1,u]}});n.push(d);let f=$7(e,d,r);n.push(f);let p=$({inputs:{x:f},backend:e,attrs:{shape:c}});return n.forEach(t=>e.disposeIntermediateTensorInfo(t)),p}return e9(e,t,r)}function qBe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a}=r,o=LU(a,i.shape),s=oX(o,i.shape.length),c=i,l=[];s!=null&&(c=J7({inputs:{x:i},backend:n,attrs:{perm:s}}),l.push(c),o=cX(o.length,c.shape.length)),aX(`argMax`,[o[0]],c.shape.length);let u=t9(n,c,o[0],`max`);return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}const JBe={kernelName:SW,backendName:`webgl`,kernelFunc:qBe};function YBe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a}=r,o=LU(a,i.shape),s=oX(o,i.shape.length),c=i,l=[];s!=null&&(c=J7({inputs:{x:i},backend:n,attrs:{perm:s}}),l.push(c),o=cX(o.length,c.shape.length)),aX(`argMin`,[o[0]],c.shape.length);let u=t9(n,c,o[0],`min`);return l.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}const XBe={kernelName:CW,backendName:`webgl`,kernelFunc:YBe};var ZBe=y7+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`;const QBe=I7({opSnippet:ZBe}),$Be={kernelName:wW,backendName:`webgl`,kernelFunc:QBe};var eVe=y7+`return log(x + sqrt(x * x + 1.0));`;const tVe=I7({opSnippet:eVe}),nVe={kernelName:TW,backendName:`webgl`,kernelFunc:tVe};var rVe=y7+`
  return atan(x);
`;const iVe=I7({opSnippet:rVe}),aVe={kernelName:EW,backendName:`webgl`,kernelFunc:iVe};var oVe=T7+`
  return atan(a, b);
`,sVe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+D7+`
  return result;
`;const cVe=L7({opSnippet:oVe,packedOpSnippet:sVe}),lVe={kernelName:OW,backendName:`webgl`,kernelFunc:cVe};var uVe=y7+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`;const dVe=I7({opSnippet:uVe}),fVe={kernelName:DW,backendName:`webgl`,kernelFunc:dVe};
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var n9=class{constructor(e,t,n,r=!1,i=!1){if(this.variableNames=[`x`],t===`avg`&&n)throw Error(`Cannot compute positions for average pool.`);let a=e.filterWidth,o=e.strideHeight,s=e.strideWidth,c=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;let m=t===`avg`,h=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`,_=`0.0`;if(m||(_=`-1.0 / 1e-20`),n){this.userCode=`
        const ivec2 strides = ivec2(${o}, ${s});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${u};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${l}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?i?h:g:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let v=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t===`avg`&&(v=`avgValue / max(count, 1.0)`);let y=Math.floor(a/4)*4,b=a%4,x=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${s});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${_};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${_});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${u};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${y}; wC += 4) {
            int xC = xCCorner + wC * ${l};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${l}, d),
              getValue(batch, xR, xC + 2 * ${l}, d),
              getValue(batch, xR, xC + 3 * ${l}, d)
            );

            ${x}
          }

          int xC = xCCorner + ${y};
          if (${b===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${x}
          } else if (${b===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${l}, d),
              initializationValue,
              initializationValue
            );

            ${x}
          } else if (${b===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${l}, d),
              getValue(batch, xR, xC + 2 * ${l}, d),
              initializationValue
            );

            ${x}
          }
        }
        setOutput(${v});
      }
    `}},r9=class{constructor(e,t,n,r=!1,i=!1){if(this.variableNames=[`x`],t===`avg`&&n)throw Error(`Cannot compute positions for average pool.`);let a=e.filterWidth,o=e.strideDepth,s=e.strideHeight,c=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,d=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,h=e.padInfo.front,g=e.padInfo.top,_=e.padInfo.left;this.outputShape=e.outShape;let v=t===`avg`,y=`0.0`;if(v||(y=`-1.0 / 1e-20`),n){this.userCode=`
        const ivec3 strides =
            ivec3(${o}, ${s}, ${c});
        const ivec3 pads = ivec3(${h}, ${g}, ${_});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${l}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${u}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?i?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}let b=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t===`avg`&&(b=`avgValue / max(count, 1.0)`);let x=Math.floor(a/4)*4,S=a%4,C=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = max(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${o}, ${s}, ${c});
      const ivec3 pads = ivec3(${h}, ${g}, ${_});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${l}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${x}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${C}
            }

            int xC = xCCorner + ${x};
            if (${S===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${C}
            } else if (${S===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${C}
            } else if (${S===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${C}
            }
          }
        }
        setOutput(${b});
      }
    `}};function pVe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;N5(i,`avgPool`);let{filterSize:a,strides:o,pad:s,dimRoundingMode:c}=r;R(bY(o,1),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);let l=uY(i.shape,a,o,1,s,c);if(l.filterWidth===1&&l.filterHeight===1&&jU(l.inShape,l.outShape))return k7({inputs:{x:i},backend:n});let u=new n9(l,`avg`,!1);return n.runWebGLProgram(u,[i],`float32`)}const mVe={kernelName:kW,backendName:`webgl`,kernelFunc:pVe};function hVe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:o,pad:s,dimRoundingMode:c,dataFormat:l}=r,u=dY(i.shape,a,o,[1,1,1],s,c,l),d=new r9(u,`avg`,!1);return n.runWebGLProgram(d,[i],`float32`)}const gVe={kernelName:jW,backendName:`webgl`,kernelFunc:hVe};
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var _Ve=class{constructor(e){this.variableNames=[`dy`],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=s-1-e.padInfo.top,u=c-1-e.padInfo.left,d=1/(t*n);this.userCode=`
      const ivec2 pads = ivec2(${l}, ${u});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${s};
            wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${o}) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}},vVe=class{constructor(e){this.variableNames=[`dy`],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,c=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=u-1-e.padInfo.front,m=d-1-e.padInfo.top,h=f-1-e.padInfo.left,g=1/(t*n*r);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${h});
      const float avgMultiplier = float(${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${u};
            wD += ${s}) {
          float dyD = float(dyDCorner + wD) / ${i}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${l}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function yVe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,o=a,{filterSize:s,strides:c,pad:l,dimRoundingMode:u}=r,d=dY(o.shape,s,c,[1,1,1],l,u),f=new vVe(d);return n.runWebGLProgram(f,[i],o.dtype)}const bVe={kernelName:MW,backendName:`webgl`,kernelFunc:yVe};function xVe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,o=a;N5([i,a],`avgPoolGrad`);let{filterSize:s,strides:c,pad:l}=r,u=uY(o.shape,s,c,1,l),d=new _Ve(u);return n.runWebGLProgram(d,[i],o.dtype)}const SVe={kernelName:AW,backendName:`webgl`,kernelFunc:xVe};function CVe(e){let{inputs:t,backend:n,attrs:r}=e,{a:i,b:a}=t,{transposeA:o,transposeB:s}=r;return Y7({a:i,b:a,transposeA:o,transposeB:s,backend:n})}const wVe={kernelName:NW,backendName:`webgl`,kernelFunc:CVe};var TVe=class{constructor(e,t,n,r,i,a){this.outputShape=[],this.variableNames=[`x`,`mean`,`variance`],JY(e,t),JY(e,n);let o=`0.0`;r!=null&&(JY(e,r),this.variableNames.push(`offset`),o=`getOffsetAtOutCoords()`);let s=`1.0`;i!=null&&(JY(e,i),this.variableNames.push(`scale`),s=`getScaleAtOutCoords()`),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${o};
        float scale = ${s};
        float inv = scale * inversesqrt(variance + float(${a}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}},EVe=class{constructor(e,t,n,r,i,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=[`x`,`mean`,`variance`],JY(e,t),JY(e,n);let o=`vec4(0.0)`;r!=null&&(JY(e,r),this.variableNames.push(`offset`),o=`getOffsetAtOutCoords()`);let s=`vec4(1.0)`;i!=null&&(JY(e,i),this.variableNames.push(`scale`),s=`getScaleAtOutCoords()`),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${o};
        vec4 scale = ${s};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${a}));

        setOutput((x - mean) * inv + offset);
      }
    `}};const DVe={kernelName:yG,backendName:`webgl`,kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r,mean:i,variance:a,offset:o,scale:s}=e;R(i.shape.length===a.shape.length,()=>`Batch normalization gradient requires mean and variance to have equal ranks.`),R(o==null||i.shape.length===o.shape.length,()=>`Batch normalization gradient requires mean and offset to have equal ranks.`),R(s==null||i.shape.length===s.shape.length,()=>`Batch normalization gradient requires mean and scale to have equal ranks.`);let{varianceEpsilon:c}=n;c??=.001;let l=[r,i,a],u=null;o!=null&&(u=o.shape,l.push(o));let d=null;s!=null&&(d=s.shape,l.push(s));let f=B().getBool(`WEBGL_PACK_NORMALIZATION`)?new EVe(r.shape,i.shape,a.shape,u,d,c):new TVe(r.shape,i.shape,a.shape,u,d,c);return t.runWebGLProgram(f,l,l[0].dtype)}};var OVe=class{constructor(e){this.variableNames=[`source`],this.outputShape=e,this.rank=e.length;let t=q5(this.rank);this.customUniforms=[{name:`start`,arrayIndex:this.rank,type:`int`}];let n=kVe(this.rank),r,i=e.map((e,t)=>`sourceLoc.${i9[t]} = start[${t}] + coords.${i9[t]};`);r=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${i.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${n}));
      }
    `}},i9=[`x`,`y`,`z`,`w`,`u`,`v`];function kVe(e){if(e===1)return`sourceLoc`;if(e<=6)return i9.slice(0,e).map(e=>`sourceLoc.`+e).join(`,`);throw Error(`Slicing for rank ${e} is not yet supported`)}var AVe=class{constructor(e){this.variableNames=[`source`],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:`start`,arrayIndex:this.rank,type:`int`}];let t=q5(this.rank),n=p7(`coords`,this.rank),r=p7(`sourceLoc`,this.rank),i=this.rank===1?`sourceLoc`:`vec2(${r.slice(-2).join()})`,a=`getChannel(getSource(${r.join()}), ${i})`,o=`
      result.x = ${a};
      if (++${n[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${a};
        --${r[this.rank-1]};
      }
    `,s=this.rank===1?``:`
      --${n[this.rank-1]};
      if (++${n[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${a};
        if (++${n[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${a};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((e,t)=>`start[${t}]`).join()});`:e.map((e,t)=>`${r[t]} = ${n[t]} + start[${t}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${o}
        ${s}
        setOutput(result);
      }
    `}};function jVe(e,t,n,r){let i=r.texData.get(e.dataId),a=r.makeTensorInfo(n,e.dtype),o=r.texData.get(a.dataId);Object.assign(o,i),o.refCount=1,o.shape=n,o.dtype=e.dtype;let s=TQ(t,QU(e.shape));i.slice&&(s+=i.slice.flatOffset),o.slice={flatOffset:s,origDataId:i.slice&&i.slice.origDataId||e.dataId};let c=r.dataRefCount.get(o.slice.origDataId)||1;return r.dataRefCount.set(o.slice.origDataId,c+1),a}function a9(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:a,size:o}=r,[s,c]=EQ(i,a,o);if(mQ(i,s,c),z(c)===0)return n.makeTensorInfo(c,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||i.dtype===`string`){let e=n.texData.get(i.dataId),t=Lze(e.values,s,c,i.shape,i.dtype);return n.makeTensorInfo(c,i.dtype,t)}let{isPacked:l}=n.texData.get(i.dataId),u=wQ(i.shape,s,c);if(l||!u){let e=B().getBool(`WEBGL_PACK_ARRAY_OPERATIONS`)?new AVe(c):new OVe(c),t=[s];return n.runWebGLProgram(e,[i],i.dtype,t)}return n.uploadToGPU(i.dataId),jVe(i,s,c,n)}const MVe={kernelName:DK,backendName:`webgl`,kernelFunc:a9},NVe={kernelName:PW,backendName:`webgl`,kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:a,crops:o}=r;R(i.shape.length<=4,()=>`batchToSpaceND for rank > 4 with a WebGL backend not implemented yet`);let s=a.reduce((e,t)=>e*t),c=BQ(i.shape,a,s),l=VQ(c.length,a.length),u=HQ(i.shape,a,s),d=UQ(o,a.length),f=WQ(u,o,a.length),p=[],m=$({inputs:{x:i},backend:n,attrs:{shape:c}}),h=J7({inputs:{x:m},backend:n,attrs:{perm:l}}),g=$({inputs:{x:h},backend:n,attrs:{shape:u}}),_=a9({inputs:{x:g},backend:n,attrs:{begin:d,size:f}});return p.push(m),p.push(h),p.push(g),p.forEach(e=>n.disposeIntermediateTensorInfo(e)),_}};function PVe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,weights:a}=t,{size:o}=r,s=n.readSync(i.dataId),c=n.readSync(a.dataId),l=c7(s,c,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,l)}const FVe={kernelName:FW,backendName:`webgl`,kernelFunc:PVe};function IVe(e){let{inputs:t,backend:n}=e,{a:r,b:i}=t,a=B().getBool(`WEBGL_PACK_BINARY_OPERATIONS`),o=B().getNumber(`WEBGL_VERSION`);if(n.shouldExecuteOnCPU([r,i])||o===1){let e=n.texData.get(r.dataId).values,t=n.texData.get(i.dataId).values,[a,o]=sze(r.shape,i.shape,e,t,r.dtype),s=n.makeTensorInfo(o,r.dtype),c=n.texData.get(s.dataId);return c.values=a,s}let s;return s=a?new O7(`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,r.shape,i.shape,!1):new E7(`
  return float(int(a.r) & int(b.r));
`,r.shape,i.shape),n.runWebGLProgram(s,[r,i],r.dtype)}const LVe={kernelName:IW,backendName:`webgl`,kernelFunc:IVe};function RVe(e){let{inputs:t,backend:n}=e,{s0:r,s1:i}=t,a=n.readSync(r.dataId),o=n.readSync(i.dataId),s=JY(Array.from(a),Array.from(o));return n.makeTensorInfo([s.length],`int32`,Int32Array.from(s))}const zVe={kernelName:LW,backendName:`webgl`,kernelFunc:RVe},o9=L7({opSnippet:`return float(a != b);`,cpuKernelImpl:Oze,dtype:`bool`}),BVe={kernelName:XG,backendName:`webgl`,kernelFunc:o9};function s9(e){let{inputs:t,backend:n}=e,{input:r}=t,i=n.texData.get(r.dataId);return k7({inputs:{x:i.complexTensorInfos.real},backend:n})}const VVe={kernelName:uK,backendName:`webgl`,kernelFunc:s9};var HVe=`return float(int(x));`;function UVe(e,t){let n=new v7(e.shape,HVe),r=t.runWebGLProgram(n,[e],`int32`);return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}function c9(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dtype:a}=r;if(a===`complex64`){if(i.dtype===`complex64`)return k7({inputs:{x:i},backend:n});let e=WX(i.shape),t=c9({inputs:{x:i},backend:n,attrs:{dtype:`float32`}}),r=A7({inputs:{real:t,imag:e},backend:n});return e.dispose(),n.disposeIntermediateTensorInfo(t),r}if(i.dtype===`complex64`){let e=s9({inputs:{input:i},backend:n}),t=c9({inputs:{x:e},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(e),t}if(!UU(i.dtype,a)){let e=k7({inputs:{x:i},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:a}}if(n.shouldExecuteOnCPU([i])){let e=n.texData.get(i.dataId).values,[t,r,o]=cze(e,i.shape,i.dtype,a);return n.makeTensorInfo(t,r,o)}if(a===`int32`)return UVe(i,n);if(a===`bool`){let e=n.makeTensorInfo([],`bool`,zU(`bool`,1)),t=o9({inputs:{a:i,b:e},backend:n});return n.disposeIntermediateTensorInfo(e),t}throw Error(`Error in Cast: failed to cast ${i.dtype} to ${a}`)}const WVe={kernelName:RW,backendName:`webgl`,kernelFunc:c9};var l9=`return ceil(x);`;const GVe=I7({opSnippet:l9,packedOpSnippet:l9,cpuKernelImpl:lze}),KVe={kernelName:zW,backendName:`webgl`,kernelFunc:GVe};
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var qVe=class{constructor(e){this.variableNames=[`A`],this.customUniforms=[{name:`minVal`,type:`float`},{name:`maxVal`,type:`float`}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}},JVe=class{constructor(e){this.variableNames=[`A`],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:`minVal`,type:`float`},{name:`maxVal`,type:`float`}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}};function YVe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{clipValueMin:a,clipValueMax:o}=r,s;s=B().getBool(`WEBGL_PACK_CLIP`)?new JVe(i.shape):new qVe(i.shape);let c=[[a],[o]];return n.runWebGLProgram(s,[i],i.dtype,c)}const XVe={kernelName:BW,backendName:`webgl`,kernelFunc:YVe};
/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var ZVe=class{constructor(e){this.variableNames=[`real`,`imag`],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}};function u9(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}function QVe(e){let{inputs:t,backend:n}=e,{x:r}=t,i=n.texData.get(r.dataId),a=new ZVe(r.shape),o=[u9(r,i.complexTensorInfos.real),u9(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(a,o,o[0].dtype)}const $Ve={kernelName:HW,backendName:`webgl`,kernelFunc:QVe};var eHe=class{constructor(e){this.outputShape=[],this.outputShape=MQ(e,1),this.variableNames=e.map((e,t)=>`T${t}`);let t=Array(e.length-1);t[0]=e[0][1];for(let n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];let n=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let e=1;e<t.length;e++){let r=t[e-1];n.push(`else if (yC < ${t[e]}) setOutput(getT${e}(yR, yC-${r}));`)}let r=t.length,i=t[t.length-1];n.push(`else setOutput(getT${r}(yR, yC-${i}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${n.join(`
        `)}
      }
    `}},tHe=class{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=MQ(e,t);let n=this.outputShape,r=n.length,i=q5(r),a=p7(`coords`,r),o=[`x`,`y`,`z`,`w`,`u`,`v`].slice(0,r);this.variableNames=e.map((e,t)=>`T${t}`);let s=Array(e.length-1);s[0]=e[0][t];for(let n=1;n<s.length;n++)s[n]=s[n-1]+e[n][t];let c=o[t],l=o.slice(-2),u=o.join(),d=`if (${c} < ${s[0]}) {
        return getChannel(
            getT0(${u}), vec2(${l.join()}));
        }`;for(let e=1;e<s.length;e++){let t=s[e-1];d+=`
        if (${c} < ${s[e]}  && ${c} >= ${s[e-1]}) {
          return getChannel(
            getT${e}(${d9(o,c,t)}),
            vec2(${d9(l,c,t)}));
        }`}let f=s.length,p=s[s.length-1];d+=`
        return getChannel(
          getT${f}(${d9(o,c,p)}),
          vec2(${d9(l,c,p)}));`,this.userCode=`
      float getValue(${o.map(e=>`int `+e)}) {
        ${d}
      }

      void main() {
        ${i} coords = getOutputCoords();
        vec4 result = vec4(getValue(${a}), 0., 0., 0.);

        ${a[r-1]} = ${a[r-1]} + 1;
        if (${a[r-1]} < ${n[r-1]}) {
          result.g = getValue(${a});
        }

        ${a[r-2]} = ${a[r-2]} + 1;
        if (${a[r-2]} < ${n[r-2]}) {
          result.a = getValue(${a});
        }

        ${a[r-1]} = ${a[r-1]} - 1;
        if (${a[r-2]} < ${n[r-2]} &&
            ${a[r-1]} < ${n[r-1]}) {
          result.b = getValue(${a});
        }
        setOutput(result);
      }
    `}};function d9(e,t,n){let r=e.indexOf(t);return e.map((e,t)=>t===r?`${e} - ${n}`:e).join()}function f9(e){let{inputs:t,backend:n}=e,{input:r}=t,i=n.texData.get(r.dataId);return k7({inputs:{x:i.complexTensorInfos.imag},backend:n})}const nHe={kernelName:EG,backendName:`webgl`,kernelFunc:f9};function p9(e,t,n){let r=e[0].dtype;if(r===`complex64`){let r=e.map(e=>s9({inputs:{input:e},backend:n})),i=e.map(e=>f9({inputs:{input:e},backend:n})),a=p9(r,t,n),o=p9(i,t,n),s=A7({inputs:{real:a,imag:o},backend:n});return r.forEach(e=>n.disposeIntermediateTensorInfo(e)),i.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),s}let i=n.shouldExecuteOnCPU(e);if(r===`string`&&(i=!0),i){let i=e.map(e=>{let r=[-1,z(e.shape.slice(t))];return $({inputs:{x:e},backend:n,attrs:{shape:r}})}),a=i.map(e=>({vals:n.readSync(e.dataId),shape:e.shape})),o=MQ(i.map(e=>e.shape),1),s=i[0].shape[0]===1,c=uze(a,o,r,s),l=MQ(e.map(e=>e.shape),t),u=n.makeTensorInfo(l,r,c);return i.forEach(e=>n.disposeIntermediateTensorInfo(e)),u}let a=e.filter(e=>z(e.shape)>0),o=B().getBool(`WEBGL_PACK_ARRAY_OPERATIONS`)&&a[0].shape.length>1;if(a.length===1){let t=o?new v7(e[0].shape,x7):new S7(e[0].shape,x7);return n.runWebGLProgram(t,e,r)}let s=B().getNumber(`WEBGL_MAX_TEXTURES_IN_SHADER`);if(a.length>s){let e=[];for(let r=0;r<a.length;r+=s){let i=a.slice(r,r+s);e.push(p9(i,t,n))}let r=p9(e,t,n);for(let t of e)n.disposeIntermediateTensorInfo(t);return r}if(o){let e=new tHe(a.map(e=>e.shape),t);return n.runWebGLProgram(e,a,r)}let{tensors2D:c,outShape:l}=rHe(a,t,n),u=new eHe(c.map(e=>e.shape)),d=n.runWebGLProgram(u,c,r);c.forEach(e=>n.disposeIntermediateTensorInfo(e));let f=$({inputs:{x:d},attrs:{shape:l},backend:n});return n.disposeIntermediateTensorInfo(d),f}function rHe(e,t,n){let r=MQ(e.map(e=>e.shape),t);return{tensors2D:e.map(e=>$({inputs:{x:e},attrs:{shape:[-1,z(e.shape.slice(t))]},backend:n})),outShape:r}}function m9(e){let{inputs:t,backend:n,attrs:r}=e,{axis:i}=r,a=LU(i,t[0].shape)[0],o=t.map(e=>e.shape);jQ(o,a);let s=MQ(t.map(e=>e.shape),a);if(z(s)===0)return n.makeTensorInfo(s,t[0].dtype,[]);let c=t.filter(e=>z(e.shape)>0);return c.length===1?k7({inputs:{x:c[0]},backend:n}):p9(c,a,n)}const iHe={kernelName:UW,backendName:`webgl`,kernelFunc:m9};
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var h9=class{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=[`x`,`W`],this.outputShape=e.outShape;let a=e.padInfo.top,o=e.padInfo.left,s=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,u=e.dilationWidth,d=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,h=e.dataFormat===`channelsLast`,g=h?1:2,_=h?2:3,v=h?3:1,y=``,b=``;n&&(y=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:i?`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:`
          float activation(float x) {
            ${n}
          }
        `,b=`result = activation(result);`);let x=t?`result += getBiasAtOutCoords();`:``;t&&this.variableNames.push(`bias`),r&&this.variableNames.push(`preluActivationWeights`),i&&this.variableNames.push(`leakyreluAlpha`),this.userCode=`
      ${y}

      const ivec2 strides = ivec2(${s}, ${c});
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${v}];

        ivec2 xRCCorner =
            ivec2(coords[${g}], coords[${_}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${l};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${u};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${h}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${h}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${h}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${h}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${x}
        ${b}
        setOutput(result);
      }
    `}},aHe=class{constructor(e){this.variableNames=[`x`,`W`],this.outputShape=e.outShape;let t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,c=e.dilationHeight,l=e.dilationWidth,u=e.filterDepth,d=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${i}, ${a}, ${o});
      const ivec3 pads = ivec3(${t}, ${n}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${u}; wF++) {
          int xF = xFCorner + wF * ${s};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${l};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}},g9=class{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=[`x`,`W`],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:`pads`,type:`ivec2`},{name:`strides`,type:`ivec2`},{name:`dilations`,type:`ivec2`},{name:`inDims`,type:`ivec2`}],this.outputShape=e.outShape,this.enableShapeUniforms=$5(this.outputShape.length);let a=e.padInfo.left,o=e.strideWidth,s=e.dilationWidth,c=e.filterHeight,l=e.filterWidth,u=l,d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let e=0;e<l;e++)d+=`
           vec4 xTexelC${e*2};
           int xTexelC${e*2}Ready;
           vec4 xTexelC${e*2+1};
           int xTexelC${e*2+1}Ready;
           vec4 xC${e};`;d+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let e=0;e<l;e++)d+=`
           xTexelC${e*2} = vec4(0.0);
           xTexelC${e*2}Ready = 0;
           xTexelC${e*2+1} = vec4(0.0);
           xTexelC${e*2+1}Ready = 0;
           xC${e} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let t=0;t<(u+1)/2;t++){let n=t*2;if(d+=`
           xC = xCCorner + ${n*s};
           `,o===1){if(n<l&&(a%2==1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${n}Ready == 0) {
                   xTexelC${n} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${n}.zw = vec2(0.0);
                   }
                   xTexelC${n}Ready = 1;
                 }
               `,s===1&&n>0?d+=`
                 xC${n} = vec4(xTexelC${n-2}.zw, xTexelC${n}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${n} = vec4(previous.zw, xTexelC${n}.xy);
                   } else {
                     xC${n} = vec4(0.0, 0.0, xTexelC${n}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${n}Ready == 0) {
                   xTexelC${n} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${n}.zw = vec2(0.0);
                   }
                   xTexelC${n}Ready = 1;
                 }

                 xC${n} = xTexelC${n};
                 `,n+1<l)){let e=a%2==0?EU(s):s;s%2==0&&a%2==1||s%2!=0&&a%2!=1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${e};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${n+1}Ready == 0) {
                     xTexelC${n+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${n+1}.zw = vec2(0.0);
                     }
                     xTexelC${n+1}Ready = 1;
                   }
                   `,s>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${n+1} = vec4(previous.zw, xTexelC${n+1}.xy);
                     } else {
                      xC${n+1} = vec4(0.0, 0.0, xTexelC${n+1}.xy);
                     }
                     `:d+=`
                     xC${n+1} = vec4(xTexelC${n}.zw, xTexelC${n+1}.xy);
                     `):e===1?d+=`
                     xC${n+1} = xTexelC${n};
                     `:d+=`
                     xCOffset = xC + ${e};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${n+1}Ready == 0) {
                       xTexelC${n+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${n+1}.zw = vec2(0.0);
                       }
                       xTexelC${n+1}Ready = 1;
                     }

                     xC${n+1} = xTexelC${n+1};
                     `}}else n<l&&(a%2==1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${n}Ready == 0) {
                   xTexelC${n} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${n}.zw = vec2(0.0);
                   }
                   xTexelC${n}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${n+1}Ready == 0) {
                   xTexelC${n+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${n+1}.zw = vec2(0.0);
                   }
                   xTexelC${n+1}Ready = 1;
                 }

                 xC${n} = vec4(xTexelC${n}.zw, xTexelC${n+1}.zw);
               `,n+1<l&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${n+1} = vec4(xTexelC${n+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${n}Ready == 0) {
                   xTexelC${n} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${n}.zw = vec2(0.0);
                   }
                   xTexelC${n}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${n+1}Ready == 0) {
                   xTexelC${n+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${n+1}.zw = vec2(0.);
                   }
                   xTexelC${n+1}Ready = 1;
                 }

                 xC${n} = vec4(
                   xTexelC${n}.xy, xTexelC${n+1}.xy);
               `,n+1<l&&(d+=`
                   xC${n+1} = vec4(xTexelC${n}.zw, xTexelC${n+1}.zw);
                 `)));n<l&&(d+=`
             wTexel = getW(r, ${n}, d1, d2);
             dotProd += xC${n}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${n}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,n+1<l&&(d+=`
               wTexel = getW(r, ${n+1}, d1, d2);
               dotProd += xC${n+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${n+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let f=``,p=``;n&&(f=r?`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${n}
         }`:i?`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${n}
         }`:`vec4 activation(vec4 x) {
           ${n}
         }`,p=`result = activation(result);`);let m=t?`result += getBiasAtOutCoords();`:``;t&&this.variableNames.push(`bias`),r&&this.variableNames.push(`preluActivationWeights`),i&&this.variableNames.push(`leakyreluAlpha`),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}},oHe=class{constructor(e,t){this.variableNames=[`A`],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:`inputShape`,type:`ivec4`},{name:`pad`,type:`ivec2`},{name:`stride`,type:`ivec2`},{name:`dilation`,type:`ivec2`},{name:`inChannels`,type:`int`},{name:`itemsPerBlockRow`,type:`int`},{name:`outWidth`,type:`int`}],this.outputShape=e,this.enableShapeUniforms=$5(this.outputShape.length);let{dataFormat:n}=t,r=F5(),i=n===`channelsLast`,a=i?1:2,o=i?2:3,s=this.enableShapeUniforms?`if(blockIndex < outShape[2] && pos < outShape[1]) {`:`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`,c=``;for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)c+=`
          blockIndex = rc.z + ${t};
          pos = rc.y + ${e};

          ${s}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${a}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${o}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${i}) {
                  innerDims = vec2(d1, ch);
                  result[${e*2+t}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${e*2+t}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}};function _9(e,t){let n=e.length;return n>=3?t?[...e.slice(0,-3),e[n-3]*e[n-2],e[n-1]]:[...e.slice(0,-3),e[n-3],e[n-2]*e[n-1]]:!t&&n===1&&e[0]>1?[e[0],1]:null}function v9({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:s=null}){let c=e.shape,l=r.texData.get(e.dataId),u=n.inChannels,d=c[0]*c[1]*c[2],f=n.outChannels,p=n.dataFormat===`channelsLast`,m,h=[];if(a!=null){let e=_9(a.shape,p);e!=null&&(a=$({inputs:{x:a},backend:r,attrs:{shape:e}}),h.push(a))}if(i!=null){let e=_9(i.shape,p);e!=null&&(i=$({inputs:{x:i},backend:r,attrs:{shape:e}}),h.push(i))}if(!((d===1||f===1)&&u>1e3)&&l.isPacked&&p&&l.texture!=null&&c[2]%2!=0&&jU(l.shape.slice(-3),c.slice(-3))){let u=c[0]*c[1]*(c[2]+1),d={dataId:e.dataId,shape:[1,u,n.inChannels],dtype:e.dtype},f=l.shape;l.shape=l.shape.slice(),l.shape[l.shape.length-2]++,R(D5(l.shape,d.shape),()=>`packed reshape ${l.shape} to ${d.shape} isn't free`);let p=$({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});h.push(p);let g=Y7({a:d,b:p,backend:r,transposeA:!1,transposeB:!1,bias:i,activation:s,preluActivationWeights:a,leakyreluAlpha:o}),_=r.texData.get(g.dataId);R(_.isPacked,()=>`batchMatMul result is expected to be packed`),l.shape=f,_.shape=n.outShape,m=k7({inputs:{x:g},backend:r}),m.shape=n.outShape,h.push(g)}else{let c=n.outHeight*n.outWidth,l=$({inputs:{x:e},backend:r,attrs:{shape:p?[n.batchSize,c,n.inChannels]:[n.batchSize,n.inChannels,c]}}),u=$({inputs:{x:t},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),d=Y7({a:p?l:u,b:p?u:l,transposeA:!p,transposeB:!1,backend:r,bias:i,activation:s,preluActivationWeights:a,leakyreluAlpha:o});m=$({inputs:{x:d},backend:r,attrs:{shape:n.outShape}}),h.push(l),h.push(u),h.push(d)}for(let e of h)r.disposeIntermediateTensorInfo(e);return m}function y9({x:e,filter:t,convInfo:n,backend:r,bias:i=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:s=null}){let{filterWidth:c,filterHeight:l,inChannels:u,outWidth:d,outHeight:f,dataFormat:p}=n,m=p===`channelsLast`,h=c*l*u,g=f*d,_=[n.batchSize,h,g],v=[];if(a!=null){let e=_9(a.shape,m);e!=null&&(a=$({inputs:{x:a},backend:r,attrs:{shape:e}}),v.push(a))}if(i!=null){let e=_9(i.shape,m);e!=null&&(i=$({inputs:{x:i},backend:r,attrs:{shape:e}}),v.push(i))}let y=$({inputs:{x:t},backend:r,attrs:{shape:[1,h,z(t.shape)/h]}});v.push(y);let b=new oHe(_,n),x=[e.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],S=r.runWebGLProgram(b,[e],`float32`,x),C=$({inputs:{x:S},backend:r,attrs:{shape:_}});v.push(S),v.push(C);let w=i!=null,T=a!=null,E=s===`leakyrelu`,D=s?R7(s,!0):null,O=new z7(m?C.shape:y.shape,m?y.shape:C.shape,m?[n.batchSize,g,n.outChannels]:[n.batchSize,n.outChannels,g],!0,!1,w,D,T,E),k=m?[C,y]:[y,C];if(i&&k.push(i),T&&k.push(a),E){let e=r.makeTensorInfo([],`float32`,Aq(o,`float32`));k.push(e),v.push(e)}let ee=r.runWebGLProgram(O,k,`float32`),te=$({inputs:{x:ee},backend:r,attrs:{shape:n.outShape}});v.push(ee);for(let e of v)r.disposeIntermediateTensorInfo(e);return te}function sHe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:o,pad:s,dataFormat:c,dilations:l,dimRoundingMode:u}=r,d=SY(c),f=fY(i.shape,a.shape,o,l,s,u,!1,d),p;if(f.filterHeight===1&&f.filterWidth===1&&f.dilationHeight===1&&f.dilationWidth===1&&f.strideHeight===1&&f.strideWidth===1&&(f.padInfo.type===`SAME`||f.padInfo.type===`VALID`))p=v9({x:i,filter:a,convInfo:f,backend:n});else if(f.strideWidth<=2&&d===`channelsLast`&&B().getBool(`WEBGL_EXP_CONV`)){let e=new g9(f),t=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];p=n.runWebGLProgram(e,[i,a],`float32`,t)}else if(B().getBool(`WEBGL_CONV_IM2COL`))p=y9({x:i,filter:a,convInfo:f,backend:n});else{let e=new h9(f);p=n.runWebGLProgram(e,[i,a],`float32`)}let m=$({inputs:{x:p},backend:n,attrs:{shape:f.outShape}});return n.disposeIntermediateTensorInfo(p),m}const cHe={kernelName:WW,backendName:`webgl`,kernelFunc:sHe};
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var lHe=class{constructor(e){this.variableNames=[`x`,`dy`],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left,a=e.dataFormat===`channelsLast`;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${a?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}},uHe=class{constructor(e){this.variableNames=[`dy`,`W`],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=e.dataFormat===`channelsLast`,o=t-1-e.padInfo.top,s=n-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${a?3:1}];

        ivec2 dyCorner = ivec2(coords[${a?1:2}], coords[${a?2:3}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${a}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}},dHe=class{constructor(e){this.variableNames=[`x`,`dy`],this.outputShape=e.filterShape;let t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.padInfo.front,a=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${i};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${n} - ${a};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${o};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}},fHe=class{constructor(e){this.variableNames=[`dy`,`W`],this.outputShape=e.inShape;let t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,i=e.strideDepth,a=e.strideHeight,o=e.strideWidth,s=t-1-e.padInfo.front,c=n-1-e.padInfo.top,l=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${s}, ${c}, ${l});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${i}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${n}; wR++) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${n} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function b9(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:o,pad:s,dataFormat:c,dimRoundingMode:l,filterShape:u}=r,d=SY(c),f=fY(i.shape,u,o,1,s,l,!1,d),p=new lHe(f);return n.runWebGLProgram(p,[i,a],`float32`)}const pHe={kernelName:GW,backendName:`webgl`,kernelFunc:b9};var mHe=class{constructor(e){this.variableNames=[`dy`,`W`],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:`strides`,type:`vec2`}],this.outputShape=e.inShape,this.enableShapeUniforms=$5(this.outputShape.length);let t=e.filterHeight,n=e.filterWidth,r=t-1-e.padInfo.top,i=n-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${i});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            int wCPerm = ${n} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}};function hHe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{inputShape:o,strides:s,pad:c,dataFormat:l,dimRoundingMode:u}=r,d=SY(l),f=fY(o,a.shape,s,1,c,u,!1,d);if(B().getBool(`WEBGL_PACK_CONV2DTRANSPOSE`)&&d===`channelsLast`){let e=[[f.strideHeight,f.strideWidth]],t=new mHe(f);return n.runWebGLProgram(t,[i,a],`float32`,e)}else{let e=new uHe(f);return n.runWebGLProgram(e,[i,a],`float32`)}}const gHe={kernelName:KW,backendName:`webgl`,kernelFunc:hHe};function _He(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:o,pad:s,dilations:c}=r,l=pY(i.shape,a.shape,o,c,s),u=new aHe(l);return n.runWebGLProgram(u,[i,a],`float32`)}const vHe={kernelName:qW,backendName:`webgl`,kernelFunc:_He};function yHe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:o,pad:s,filterShape:c}=r,l=pY(i.shape,c,o,1,s),u=new dHe(l);return n.runWebGLProgram(u,[i,a],`float32`)}const bHe={kernelName:JW,backendName:`webgl`,kernelFunc:yHe};function xHe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{pad:o,strides:s,inputShape:c}=r,l=pY(c,a.shape,s,1,o),u=new fHe(l);return n.runWebGLProgram(u,[i,a],`float32`)}const SHe={kernelName:YW,backendName:`webgl`,kernelFunc:xHe};var CHe=F7+`
  return cos(x);
`,wHe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${D7}
  return result;
`;const THe={kernelName:`Cos`,backendName:`webgl`,kernelFunc:I7({opSnippet:CHe,packedOpSnippet:wHe})},EHe=I7({opSnippet:`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`}),DHe={kernelName:XW,backendName:`webgl`,kernelFunc:EHe};
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var OHe=class{constructor(e,t,n,r,i){this.variableNames=[`Image`,`Boxes`,`BoxInd`],this.outputShape=[];let[a,o,s,c]=e,[l]=t,[u,d]=n;this.outputShape=[l,u,d,c];let f=r===`bilinear`?1:0,[p,m]=[`${o-1}.0`,`${s-1}.0`],[h,g,_]=u>1?[`${(o-1)/(u-1)}`,`(y2-y1) * height_ratio`,`y1*${p} + float(y)*(height_scale)`]:[`0.0`,`0.0`,`0.5 * (y1+y2) * ${p}`],[v,y,b]=d>1?[`${(s-1)/(d-1)}`,`(x2-x1) * width_ratio`,`x1*${m} + float(x)*(width_scale)`]:[`0.0`,`0.0`,`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${h});
      const float width_ratio = float(${v});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${a}) {
          return;
        }

        float height_scale = ${g};
        float width_scale = ${y};

        float in_y = ${_};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${i}));
          return;
        }
        float in_x = ${b};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${i}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}};const kHe={kernelName:$W,backendName:`webgl`,kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{image:i,boxes:a,boxInd:o}=t,{cropSize:s,method:c,extrapolationValue:l}=r,u=new OHe(i.shape,a.shape,s,c,l);return n.runWebGLProgram(u,[i,a,o],`float32`)}};var x9;(function(e){e.Prod=`*`,e.Sum=`+`})(x9||={});var S9=class{constructor(e,t,n,r){this.op=e,this.outputShape=t,this.variableNames=[`x`],this.customUniforms=[{name:`index`,type:`float`}];let i=this.outputShape.length,a=this.op===x9.Prod?`1.0`:`0.0`,o=n?a:`getX(${C9(i,`coords`,this.op)})`,s=this.outputShape[this.outputShape.length-1],c=``,l=``;n?(c=r?`end != ${s-1}`:`end != 0`,l=r?`end + 1`:`end - 1`):(c=r?`end + pow2 < ${s}`:`end >= pow2`,l=r?`end + pow2`:`end - pow2`),this.userCode=`
      void main() {
        ${q5(i)} coords = getOutputCoords();
        int end = ${w9(i,`coords`,this.op)};
        float val = ${o};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${l};
          ${w9(i,`coords`,this.op)} = idx;
          val ${this.op}= getX(${C9(i,`coords`,this.op)});
        }
        setOutput(val);
      }
    `}};function C9(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.x, ${t}.y`;if(e===3)return`${t}.x, ${t}.y, ${t}.z`;if(e===4)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function w9(e,t,n){if(e===1)return`${t}`;if(e===2)return`${t}.y`;if(e===3)return`${t}.z`;if(e===4)return`${t}.w`;throw Error(`Cumulative ${n} for rank ${e} is not yet supported`)}function T9(e,t,n,r,i,a){let o=t.shape.length,s=oX([r],o),c=t;s!=null&&(c=J7({inputs:{x:t},backend:n,attrs:{perm:s}}));let l=cX(1,o)[0];if(l!==o-1)throw Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${r}`);let u=c.shape[l],d=k7({inputs:{x:c},backend:n});for(let t=0;t<=Math.ceil(Math.log2(u))-1;t++){let r=new S9(e,c.shape,!1,a),i=[[t]],o=d;d=n.runWebGLProgram(r,[d],d.dtype,i),n.disposeIntermediateTensorInfo(o)}if(i){let t=new S9(e,c.shape,i,a),r=d;d=n.runWebGLProgram(t,[d],d.dtype),n.disposeIntermediateTensorInfo(r)}if(s!=null){let e=sX(s),t=J7({inputs:{x:d},backend:n,attrs:{perm:e}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(c),t}return d}function AHe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,exclusive:o,reverse:s}=r;return T9(x9.Prod,i,n,a,o,s)}const jHe={kernelName:ZW,backendName:`webgl`,kernelFunc:AHe};function MHe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,exclusive:o,reverse:s}=r;return T9(x9.Sum,i,n,a,o,s)}const NHe={kernelName:QW,backendName:`webgl`,kernelFunc:MHe};function PHe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,weights:a}=t,{size:o,binaryOutput:s}=r;if(i.shape.length===1){let e=n.readSync(i.dataId),t=n.readSync(a.dataId),r=c7(e,t,a.dtype,a.shape,o);return n.makeTensorInfo([o],a.dtype,r)}else if(i.shape.length===2){let e=n.bufferSync(i),t=n.bufferSync(a),r=oze(e,t,o,s);return n.makeTensorInfo(r.shape,a.dtype,r.values)}throw Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const FHe={kernelName:eG,backendName:`webgl`,kernelFunc:PHe};
/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var IHe=class{constructor(e,t,n){this.variableNames=[`x`],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat===`NHWC`?`coords[1]`:`coords[2]`}getWidthCoordString(){return this.dataFormat===`NHWC`?`coords[2]`:`coords[3]`}getDepthCoordString(){return this.dataFormat===`NHWC`?`coords[3]`:`coords[1]`}getOutputDepthSize(){return this.dataFormat===`NHWC`?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat===`NHWC`?`getX(b, in_h, in_w, in_d)`:`getX(b, in_d, in_h, in_w)`}};function LHe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockSize:a,dataFormat:o}=r,s=i.shape[0],c=o===`NHWC`?i.shape[1]:i.shape[2],l=o===`NHWC`?i.shape[2]:i.shape[3],u=o===`NHWC`?i.shape[3]:i.shape[1],d=c*a,f=l*a,p=u/(a*a),m=new IHe(o===`NHWC`?[s,d,f,p]:[s,p,d,f],a,o);return n.runWebGLProgram(m,[i],i.dtype)}const RHe={kernelName:tG,backendName:`webgl`,kernelFunc:LHe};var E9=class{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=[`x`,`W`],this.customUniforms=[{name:`pads`,type:`ivec2`},{name:`strides`,type:`ivec2`},{name:`dilations`,type:`ivec2`},{name:`inDims`,type:`ivec2`}],this.outputShape=e.outShape,this.enableShapeUniforms=$5(this.outputShape.length);let a=e.filterHeight,o=e.filterWidth,s=e.outChannels/e.inChannels,c=``,l=``;n&&(c=r?`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:i?`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:`
          float activation(float x) {
            ${n}
          }
        `,l=`result = activation(result);`);let u=t?`result += getBiasAtOutCoords();`:``;t&&this.variableNames.push(`bias`),r&&this.variableNames.push(`preluActivationWeights`),i&&this.variableNames.push(`leakyreluAlpha`),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${s};
        int q = d2 - d1 * ${s};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${a}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${o}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${u}
        ${l}
        setOutput(result);
      }
    `}},D9=class{constructor(e,t=!1,n=null,r=!1,i=!1){this.variableNames=[`x`,`W`],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:`pads`,type:`ivec2`},{name:`strides`,type:`ivec2`},{name:`dilations`,type:`ivec2`},{name:`inDims`,type:`ivec2`}],this.outputShape=e.outShape,this.enableShapeUniforms=$5(this.outputShape.length);let a=e.outChannels/e.inChannels,o=e.padInfo.left,s=e.strideWidth,c=e.dilationWidth,l=e.filterHeight,u=e.filterWidth,d=u,f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let e=0;e<u;e++)f+=`
          vec4 xTexelC${e*2};
          int xTexelC${e*2}Ready;
          vec4 xTexelC${e*2+1};
          int xTexelC${e*2+1}Ready;
          vec4 xC${e};`;f+=`
    for (int r = 0; r < ${l}; r++) {
      `;for(let e=0;e<u;e++)f+=`
          xTexelC${e*2} = vec4(0.0);
          xTexelC${e*2}Ready = 0;
          xTexelC${e*2+1} = vec4(0.0);
          xTexelC${e*2+1}Ready = 0;
          xC${e} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let e=0;e<(d+1)/2;e++){let t=e*2;if(f+=`
          xC = xCCorner + ${t*c};
          `,s===1){if(t<u&&(o%2==1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {
                  xTexelC${t} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${t}.zw = vec2(0.0);
                  }
                  xTexelC${t}Ready = 1;
                }
              `,c===1&&t>0?f+=`
                xC${t} = vec4(xTexelC${t-2}.zw, xTexelC${t}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${t} = vec4(previous.zw, xTexelC${t}.xy);
                  } else {
                    xC${t} = vec4(0.0, 0.0, xTexelC${t}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {
                  xTexelC${t} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${t}.zw = vec2(0.0);
                  }
                  xTexelC${t}Ready = 1;
                }

                xC${t} = xTexelC${t};
                `,t+1<u)){let e=o%2==0?EU(c):c;c%2==0&&o%2==1||c%2!=0&&o%2!=1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${e};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {
                    xTexelC${t+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${t+1}.zw = vec2(0.0);
                    }
                    xTexelC${t+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${t+1} = vec4(previous.zw, xTexelC${t+1}.xy);
                    } else {
                     xC${t+1} = vec4(0.0, 0.0, xTexelC${t+1}.xy);
                    }
                    `:f+=`
                    xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.xy);
                    `):e===1?f+=`
                    xC${t+1} = xTexelC${t};
                    `:f+=`
                    xCOffset = xC + ${e};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {
                      xTexelC${t+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${t+1}.zw = vec2(0.0);
                      }
                      xTexelC${t+1}Ready = 1;
                    }

                    xC${t+1} = xTexelC${t+1};
                    `}}else t<u&&(o%2==1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {
                  xTexelC${t} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${t}.zw = vec2(0.0);
                  }
                  xTexelC${t}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${t+1}Ready == 0) {
                  xTexelC${t+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${t+1}.zw = vec2(0.0);
                  }
                  xTexelC${t+1}Ready = 1;
                }

                xC${t} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);
              `,t+1<u&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${t+1} = vec4(xTexelC${t+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {
                  xTexelC${t} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${t}.zw = vec2(0.0);
                  }
                  xTexelC${t}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {
                  xTexelC${t+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${t+1}.zw = vec2(0.);
                  }
                  xTexelC${t+1}Ready = 1;
                }

                xC${t} = vec4(
                  xTexelC${t}.xy, xTexelC${t+1}.xy);
              `,t+1<u&&(f+=`
                  xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);
                `)));t<u&&(f+=`
            wTexel = getW(r, ${t}, d1, q);
            dotProd += xC${t} * vec4(wTexel.xz, wTexel.xz);
          `,t+1<u&&(f+=`
              wTexel = getW(r, ${t+1}, d1, q);
              dotProd += xC${t+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p=``,m=``;n&&(p=r?`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${n}
        }`:i?`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${n}
        }`:`vec4 activation(vec4 x) {
          ${n}
        }`,m=`result = activation(result);`);let h=t?`result += getBiasAtOutCoords();`:``;t&&this.variableNames.push(`bias`),r&&this.variableNames.push(`preluActivationWeights`),i&&this.variableNames.push(`leakyreluAlpha`),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${a};
        int q = d2 - d1 * ${a};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${h}
        ${m}
        setOutput(result);
      }
    `}};function zHe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:o,pad:s,dilations:c,dimRoundingMode:l}=r,u=c;u??=[1,1],R(bY(o,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);let d=fY(i.shape,a.shape,o,u,s,l,!0),f;f=B().getBool(`WEBGL_PACK_DEPTHWISECONV`)&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?new D9(d):new E9(d);let p=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(f,[i,a],`float32`,p)}const BHe={kernelName:nG,backendName:`webgl`,kernelFunc:zHe};
/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var VHe=class{constructor(e){this.variableNames=[`x`,`dy`],this.outputShape=e.filterShape;let t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,i=e.padInfo.left;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${e.outChannels/e.inChannels} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${n} - ${i};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}},HHe=class{constructor(e){this.variableNames=[`dy`,`W`],this.outputShape=e.inShape;let t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,i=e.strideWidth,a=t-1-e.padInfo.top,o=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${n}; wC++) {
            float dyC = float(dyCCorner + wC) / ${i}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${n} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${s}; dm++) {
              int d2 = d1 * ${s} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function UHe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,dy:a}=t,{strides:o,dilations:s,pad:c,dimRoundingMode:l,filterShape:u}=r,d=fY(i.shape,u,o,s,c,l,!0),f=new VHe(d);return n.runWebGLProgram(f,[i,a],`float32`)}const WHe={kernelName:rG,backendName:`webgl`,kernelFunc:UHe};function GHe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,filter:a}=t,{strides:o,dilations:s,pad:c,dimRoundingMode:l,inputShape:u}=r,d=fY(u,a.shape,o,s,c,l,!0),f=new HHe(d);return n.runWebGLProgram(f,[i,a],`float32`)}const KHe={kernelName:iG,backendName:`webgl`,kernelFunc:GHe};
/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var qHe=class{constructor(e){this.variableNames=[`X`],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}};function JHe(e){let{inputs:t,backend:n}=e,{x:r}=t,i=[...r.shape,...r.shape],a=z(r.shape),o=$({inputs:{x:r},backend:n,attrs:{shape:[a]}}),s=new qHe(a),c=n.runWebGLProgram(s,[o],o.dtype),l=$({inputs:{x:c},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),l}const YHe={kernelName:aG,backendName:`webgl`,kernelFunc:JHe};
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var XHe=class{constructor(e){this.variableNames=[`x`,`W`],this.outputShape=e.outShape;let{inHeight:t,inWidth:n,padInfo:r,strideHeight:i,strideWidth:a,filterHeight:o,filterWidth:s,dilationHeight:c,dilationWidth:l}=e,{top:u,left:d}=r;this.userCode=`
      const ivec2 strides = ivec2(${i}, ${a});
      const ivec2 pads = ivec2(${u}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${o}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${s}; w++) {
              int wIn = wBeg + w * ${l};

              if (wIn >= 0 && wIn < ${n}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}};function ZHe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a}=t,{strides:o,pad:s,dilations:c}=r,l=lY(i.shape,a.shape,o,s,`NHWC`,c),u,d=new XHe(l);u=n.runWebGLProgram(d,[i,a],`float32`);let f=$({inputs:{x:u},backend:n,attrs:{shape:l.outShape}});return n.disposeIntermediateTensorInfo(u),f}const QHe={kernelName:oG,backendName:`webgl`,kernelFunc:ZHe};function $He(e){let{inputs:t,backend:n,attrs:r}=e,{equation:i}=r,a=t,{allDims:o,summedDims:s,idDims:c}=u$(i,a.length);f$(o.length,c,a);let{path:l,steps:u}=p$(s,c),d=u.length,f=null,p=o.length,m=[];for(let e=0;e<d;++e){for(let t of u[e]){let{permutationIndices:e,expandDims:r}=d$(p,c[t]),i;m$(e)?i=a[t]:(i=J7({inputs:{x:a[t]},backend:n,attrs:{perm:e}}),m.push(i));let o=i.shape.slice();for(let e=0;e<r.length;++e)o.splice(r[e],0,1);jU(i.shape,o)||(i=$({inputs:{x:i},backend:n,attrs:{shape:o}}),m.push(i)),f===null?f=i:(f=U7({inputs:{a:i,b:f},backend:n}),m.push(f))}e<d-1&&(l[e]>=0&&(f=q7({inputs:{x:f},backend:n,attrs:{axis:l[e]-(o.length-p),keepDims:!1}}),m.push(f)),p--)}for(let e of m)e!==f&&n.disposeIntermediateTensorInfo(e);return f}const eUe={kernelName:uG,backendName:`webgl`,kernelFunc:$He},tUe={kernelName:`Elu`,backendName:`webgl`,kernelFunc:I7({opSnippet:`return (x >= 0.0) ? x : (exp(x) - 1.0);`,packedOpSnippet:`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`})};var nUe=`return (b >= 0.0) ? a : a * (b + 1.0);`,rUe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`;const iUe={kernelName:dG,backendName:`webgl`,kernelFunc:e=>{let{inputs:t,backend:n}=e,{dy:r,y:i}=t,a=B().getBool(`WEBGL_PACK_BINARY_OPERATIONS`)?new O7(rUe,r.shape,i.shape):new E7(nUe,r.shape,i.shape);return n.runWebGLProgram(a,[r,i],r.dtype)}},aUe=L7({opSnippet:`return float(a == b);`,packedOpSnippet:`
  return vec4(equal(a, b));
`,dtype:`bool`,cpuKernelImpl:dze}),oUe={kernelName:fG,backendName:`webgl`,kernelFunc:aUe};var sUe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${qQ};
  float a1 = ${JQ};
  float a2 = ${YQ};
  float a3 = ${XQ};
  float a4 = ${ZQ};
  float a5 = ${QQ};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`;const cUe={kernelName:`Erf`,backendName:`webgl`,kernelFunc:I7({opSnippet:sUe})};F7+``;const O9=I7({opSnippet:`if (isnan(x)) return x;
  return exp(x);
`,packedOpSnippet:`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,cpuKernelImpl:fze,dtype:`float32`}),lUe={kernelName:`Exp`,backendName:`webgl`,kernelFunc:O9};function k9(e){let{inputs:t,attrs:n,backend:r}=e,{dim:i}=n,{input:a}=t,o=a.shape.length,s=a.shape.slice(),c=i;return i<0&&(R(-(o+1)<=i,()=>`Axis must be in the interval [${-(o+1)}, ${o}]`),c=o+i+1),s.splice(c,0,1),$({inputs:{x:a},backend:r,attrs:{shape:s}})}const uUe={kernelName:pG,backendName:`webgl`,kernelFunc:k9};var A9=`return exp(x) - 1.0;`;const dUe=I7({opSnippet:A9,packedOpSnippet:A9,cpuKernelImpl:pze}),fUe={kernelName:mG,backendName:`webgl`,kernelFunc:dUe};
/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var j9=class{constructor(e,t,n){this.variableNames=[`real`,`imag`];let r=t[1];this.outputShape=t;let i=n?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,a=n?`${r}.0`:`1.0`,o;if(e===`real`)o=`return real * expR - imag * expI;`;else if(e===`imag`)o=`return real * expI + imag * expR;`;else throw Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${i};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${o}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${a};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}};function M9(e,t,n){let r=n.texData.get(e.dataId),i=z(e.shape),a=e.shape[e.shape.length-1],o=i/a,s=$({inputs:{x:e},backend:n,attrs:{shape:[o,a]}}),c=s.shape,l=new j9(`real`,c,t),u=new j9(`imag`,c,t),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:c},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:c}],f=n.runWebGLProgram(l,d,`float32`),p=n.runWebGLProgram(u,d,`float32`),m=A7({inputs:{real:f,imag:p},backend:n});n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p);let h=$({inputs:{x:m},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(m),h}function pUe(e){let{inputs:t,backend:n}=e,{input:r}=t;return M9(r,!1,n)}const mUe={kernelName:`FFT`,backendName:`webgl`,kernelFunc:pUe};
/**
* @license
* Copyright 2019 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var hUe=class{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:`value`,type:`float`}],this.variableNames=[`x`],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}};function N9(e){let{backend:t,attrs:n}=e,{shape:r,value:i}=n,{dtype:a}=n;if(a||=YU(i),a===`string`){let e=BU(a,z(r));return e.fill(i),t.makeTensorInfo(r,a,e)}else{let e=new hUe(r,i),n=[[i]];return t.runWebGLProgram(e,[],a,n)}}const gUe={kernelName:hG,backendName:`webgl`,kernelFunc:N9};
/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var _Ue=class{constructor(e){this.variableNames=[`Image`],this.outputShape=[];let t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}};const vUe={kernelName:gG,backendName:`webgl`,kernelFunc:({inputs:e,backend:t})=>{let{image:n}=e,r=t,i=new _Ue(n.shape);return r.runWebGLProgram(i,[n],n.dtype)}};var P9=`return floor(x);`;const yUe=I7({opSnippet:P9,packedOpSnippet:P9,cpuKernelImpl:mze}),bUe={kernelName:_G,backendName:`webgl`,kernelFunc:yUe},xUe=L7({opSnippet:`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,packedOpSnippet:`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,dtype:`int32`}),SUe={kernelName:vG,backendName:`webgl`,kernelFunc:xUe};var CUe=class{constructor(e){this.variableNames=[`A`];let t=F5(),[n,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${n}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}},wUe=class{constructor(e){this.variableNames=[`A`],this.packedInputs=!1,this.packedOutput=!0;let t=F5(),[n,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${n}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}};const TUe={kernelName:`FromPixels`,backendName:`webgl`,kernelFunc:EUe};var F9,I9=B().getBool(`CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU`);function EUe(e){let{inputs:t,backend:n,attrs:r}=e,{pixels:i}=t,{numChannels:a}=r,o=typeof HTMLVideoElement<`u`&&i instanceof HTMLVideoElement,s=typeof HTMLImageElement<`u`&&i instanceof HTMLImageElement,[c,l]=o?[i.videoWidth,i.videoHeight]:[i.width,i.height],u=[l,c],d=[l,c,a];if(s||o){let e=B().getBool(`CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU`);(F9==null||e!==I9)&&(I9=e,F9=document.createElement(`canvas`).getContext(`2d`,{willReadFrequently:I9})),F9.canvas.width=c,F9.canvas.height=l,F9.drawImage(i,0,0,c,l),i=F9.canvas}let f=n.makeTensorInfo(u,`int32`);n.texData.get(f.dataId).usage=l5.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),i);let p=B().getBool(`WEBGL_PACK`)?new wUe(d):new CUe(d),m=n.runWebGLProgram(p,[f],`int32`);return n.disposeData(f.dataId),m}function DUe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a,bias:o,preluActivationWeights:s}=t,{strides:c,pad:l,dataFormat:u,dilations:d,dimRoundingMode:f,activation:p,leakyreluAlpha:m}=r,h=SY(u),g=fY(i.shape,a.shape,c,d,l,f,!1,h),_,v=[],y=o!=null,b=s!=null,x=p===`leakyrelu`,S=()=>{let e=[i,a],t=(e,t)=>{if(t===`NCHW`&&e.shape.length===1&&e.shape[0]!==1){let t=$({inputs:{x:e},backend:n,attrs:{shape:[e.shape[0],1,1]}});return v.push(t),t}return e};if(y&&e.push(t(o,u)),b&&e.push(t(s,u)),x){let t=n.makeTensorInfo([],`float32`,Aq(m,`float32`));e.push(t),v.push(t)}return e};if(g.filterHeight===1&&g.filterWidth===1&&g.dilationHeight===1&&g.dilationWidth===1&&g.strideHeight===1&&g.strideWidth===1&&(g.padInfo.type===`SAME`||g.padInfo.type===`VALID`))_=v9({x:i,filter:a,convInfo:g,backend:n,bias:o,activation:p,preluActivationWeights:s,leakyreluAlpha:m});else if(g.strideWidth<=2&&h===`channelsLast`&&B().getBool(`WEBGL_EXP_CONV`)){let e=p?R7(p,!0):null,t=new g9(g,y,e,b,x),r=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],i=S();_=n.runWebGLProgram(t,i,`float32`,r)}else if(B().getBool(`WEBGL_CONV_IM2COL`))_=y9({x:i,filter:a,convInfo:g,backend:n,bias:o,activation:p,preluActivationWeights:s,leakyreluAlpha:m});else{let e=p?R7(p,!1):null,t=new h9(g,y,e,b,x),r=S();_=n.runWebGLProgram(t,r,`float32`)}let C=$({inputs:{x:_},backend:n,attrs:{shape:g.outShape}});return v.push(_),v.forEach(e=>n.disposeIntermediateTensorInfo(e)),C}const OUe={kernelName:oq,backendName:`webgl`,kernelFunc:DUe};function kUe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,filter:a,bias:o,preluActivationWeights:s}=t,{strides:c,pad:l,dilations:u,dimRoundingMode:d,activation:f,leakyreluAlpha:p}=r,m=[],h=u;h??=[1,1],R(bY(c,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${c} and dilations '${h}'`);let g=fY(i.shape,a.shape,c,h,l,d,!0),_=B().getBool(`WEBGL_PACK_DEPTHWISECONV`)&&g.strideWidth<=2&&g.outChannels/g.inChannels===1,v=f?R7(f,_):null,y=[i,a],b=o!=null,x=s!=null,S=f===`leakyrelu`;if(b&&y.push(o),x&&y.push(s),S){let e=n.makeTensorInfo([],`float32`,Aq(p,`float32`));y.push(e),m.push(e)}let C;C=_?new D9(g,b,v,x,S):new E9(g,b,v,x,S);let w=[[g.padInfo.top,g.padInfo.left],[g.strideHeight,g.strideWidth],[g.dilationHeight,g.dilationWidth],[g.inHeight,g.inWidth]],T=n.runWebGLProgram(C,y,`float32`,w);return m.forEach(e=>n.disposeIntermediateTensorInfo(e)),T}const AUe={kernelName:sq,backendName:`webgl`,kernelFunc:kUe};var jUe=class{constructor(e,t,n,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=[`x`,`indices`],this.outputShape=n;let i=q5(n.length),a=`
    int index;`;for(let e=0;e<this.sliceDim;e++)a+=`
          index = round(getIndices(coords[0], ${e}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[e]};
          flattenIndex += index * ${this.strides[e]};`;this.userCode=`
         void main() {
          ${i} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${a}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}};function MUe(e){let{inputs:t,backend:n}=e,{params:r,indices:i}=t,a=i.shape,o=a[a.length-1],s=z(r.shape),[c,l,u,d]=fQ(r,i),f=$({inputs:{x:i},backend:n,attrs:{shape:[l,o]}}),p=$({inputs:{x:r},backend:n,attrs:{shape:[z(r.shape)/u,u]}});if(n.shouldExecuteOnCPU([r,i])||r.dtype===`string`){let e=n.readSync(i.dataId),t=n.bufferSync(r),a=hze(e,t,r.dtype,l,o,u,d,r.shape,s);return n.makeTensorInfo(c,r.dtype,a.values)}let m=new jUe(o,d,[l,u],r.shape),h=n.runWebGLProgram(m,[p,f],p.dtype),g=$({inputs:{x:h},backend:n,attrs:{shape:c}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(h),g}const NUe={kernelName:xG,backendName:`webgl`,kernelFunc:MUe};var PUe=class{constructor(e,t){this.variableNames=[`A`,`indices`],this.outputShape=t,this.rank=t.length;let n=q5(this.rank),r=FUe(e,2);this.userCode=`
      void main() {
        ${n} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}};function FUe(e,t){let n=[`resRC.x`,`resRC.y`,`resRC.z`,`resRC.w`],r=[];for(let t=0;t<e.length;t++)t===2?r.push(`index`):r.push(`${n[t]}`);return r.join()}function L9(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,indices:a}=t,{axis:o,batchDims:s}=r,c=LU(o,i.shape)[0];if(B().get(`DEBUG`)){let e=n.readSync(a.dataId),t=i.shape[c];for(let n=0;n<e.length;++n){let r=e[n];R(r<=t-1&&r>=0,()=>`GatherV2: the index value ${r} is not in [0, ${t-1}]`)}}let l=A$(i,a,c,s),u=z(a.shape),d=[],f=$({inputs:{x:i},backend:n,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),p=$({inputs:{x:a},backend:n,attrs:{shape:[l.batchSize,u/l.batchSize]}});d.push(f),d.push(p);let m=[l.batchSize,l.outerSize,u/l.batchSize,l.sliceSize];if(n.shouldExecuteOnCPU([i,a])||i.dtype===`string`){let e=n.bufferSync(p),t=n.bufferSync(f),r=gze(t,e,m);return d.forEach(e=>n.disposeIntermediateTensorInfo(e)),n.makeTensorInfo(l.outputShape,r.dtype,r.values)}let h=new PUe(f.shape,m),g=n.runWebGLProgram(h,[f,p],f.dtype);d.push(g);let _=$({inputs:{x:g},backend:n,attrs:{shape:l.outputShape}});return d.forEach(e=>n.disposeIntermediateTensorInfo(e)),_}const IUe={kernelName:bG,backendName:`webgl`,kernelFunc:L9},LUe=L7({opSnippet:`return float(a > b);`,packedOpSnippet:`
  return vec4(greaterThan(a, b));
`,cpuKernelImpl:_ze,dtype:`bool`}),RUe={kernelName:SG,backendName:`webgl`,kernelFunc:LUe},zUe=L7({opSnippet:`return float(a >= b);`,packedOpSnippet:`
  return vec4(greaterThanEqual(a, b));
`,dtype:`bool`,cpuKernelImpl:vze}),BUe={kernelName:CG,backendName:`webgl`,kernelFunc:zUe};function VUe(e){let{inputs:t,backend:n}=e,{input:r}=t;return M9(r,!0,n)}const HUe={kernelName:TG,backendName:`webgl`,kernelFunc:VUe},UUe=I7({opSnippet:`return float(!isnan(x) && !isinf(x));`,dtype:`bool`}),WUe={kernelName:DG,backendName:`webgl`,kernelFunc:UUe},GUe=I7({opSnippet:`return float(isinf(x));`,dtype:`bool`}),KUe={kernelName:OG,backendName:`webgl`,kernelFunc:GUe},qUe=I7({opSnippet:`return float(isnan(x));`,dtype:`bool`}),JUe={kernelName:kG,backendName:`webgl`,kernelFunc:qUe},YUe=L7({opSnippet:`return float(a < b);`,packedOpSnippet:`
  return vec4(lessThan(a, b));
`,cpuKernelImpl:yze,dtype:`bool`}),XUe={kernelName:jG,backendName:`webgl`,kernelFunc:YUe},ZUe=L7({opSnippet:`return float(a <= b);`,packedOpSnippet:`
  return vec4(lessThanEqual(a, b));
`,cpuKernelImpl:bze,dtype:`bool`}),QUe={kernelName:MG,backendName:`webgl`,kernelFunc:ZUe};function $Ue(e){let{backend:t,attrs:n}=e,{start:r,stop:i,num:a}=n,o=xze(r,i,a);return t.makeTensorInfo([o.length],`float32`,o)}const eWe={kernelName:NG,backendName:`webgl`,kernelFunc:$Ue};var tWe=F7+`
  return x < 0.0 ? 0./0. : log(x);
`;const nWe={kernelName:`Log`,backendName:`webgl`,kernelFunc:I7({opSnippet:tWe,packedOpSnippet:`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,cpuKernelImpl:Sze})};var rWe=F7+`
  return log(1.0 + x);
`;const iWe=I7({opSnippet:rWe}),aWe={kernelName:PG,backendName:`webgl`,kernelFunc:iWe},oWe=L7({opSnippet:`return float(a >= 1.0 && b >= 1.0);`,packedOpSnippet:`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,dtype:`bool`}),sWe={kernelName:FG,backendName:`webgl`,kernelFunc:oWe},cWe=I7({opSnippet:`return float(!(x >= 1.0));`}),lWe={kernelName:IG,backendName:`webgl`,kernelFunc:cWe},uWe=L7({opSnippet:`return float(a >= 1.0 || b >= 1.0);`,packedOpSnippet:`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,dtype:`bool`}),dWe={kernelName:LG,backendName:`webgl`,kernelFunc:uWe};
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var fWe=class{constructor(e,t,n,r,i){this.variableNames=[`x`],this.outputShape=[];let a=t,o=e[3]-1;this.outputShape=e;let s,c=`float(${n}) + float(${r}) * sum`;s=i===.5?`inversesqrt(${c})`:i===1?`1.0/(${c})`:`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${a}; j <= ${a}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${o}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${s};
        setOutput(val);
      }
    `}},pWe=class{constructor(e,t,n,r,i){this.variableNames=[`x`],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;let a=t,o=e[3]-1;this.outputShape=e;let s,c=`float(${n}) + float(${r}) * sum`;s=i===.5?`inversesqrt(${c})`:i===1?`1.0/(${c})`:`exp(log(${c}) * float(-${i}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${a};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${a}; j <= ${a}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${s};
        setOutput(result);
      }
    `}};const mWe={kernelName:`LRN`,backendName:`webgl`,kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{depthRadius:a,bias:o,alpha:s,beta:c}=r,l=B().getBool(`WEBGL_PACK_NORMALIZATION`)?new pWe(i.shape,a,o,s,c):new fWe(i.shape,a,o,s,c);return n.runWebGLProgram(l,[i],i.dtype)}};
/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var hWe=class{constructor(e,t,n,r,i){this.variableNames=[`inputImage`,`outputImage`,`dy`],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=i,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${n});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${i})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${i});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}};const gWe={kernelName:RG,backendName:`webgl`,kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i,y:a,dy:o}=t,{depthRadius:s,bias:c,alpha:l,beta:u}=r,d=new hWe(i.shape,s,c,l,u);return n.runWebGLProgram(d,[i,a,o],i.dtype)}};function _We(e,t,n,r){let i=z(t),a=z(e.shape)/i,o=$({inputs:{x:e},attrs:{shape:[a,i]},backend:r}),s=G7(o,e.dtype,`max`,r),c=$({inputs:{x:s},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),c}function R9(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reductionIndices:a,keepDims:o}=r,s=i.shape.length,c=LU(a,i.shape),l=c,u=oX(l,s),d=u!=null,f=n.shouldExecuteOnCPU([i]),p=i;if(d){if(f){let e=n.texData.get(p.dataId).values,t=Array(s);for(let e=0;e<t.length;e++)t[e]=i.shape[u[e]];let r=d7(e,i.shape,i.dtype,u,t);p=n.makeTensorInfo(t,i.dtype);let a=n.texData.get(p.dataId);a.values=r}else p=K7(i,u,n);l=cX(l.length,s)}aX(`max`,l,s);let[m,h]=rX(p.shape,l),g=m;o&&(g=iX(m,c));let _;if(f){let e=n.texData.get(p.dataId).values,t=Cze(e,z(h),g,i.dtype);_=n.makeTensorInfo(g,i.dtype);let r=n.texData.get(_.dataId);r.values=t}else _=_We(p,h,g,n);return d&&n.disposeIntermediateTensorInfo(p),_}const vWe={kernelName:`Max`,backendName:`webgl`,kernelFunc:R9};var yWe=T7+`
  return max(a, b);
`,bWe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+D7+`
  return result;
`;const xWe=L7({opSnippet:yWe,packedOpSnippet:bWe,cpuKernelImpl:wze}),SWe={kernelName:zG,backendName:`webgl`,kernelFunc:xWe};function CWe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;N5(i,`maxPool`);let{filterSize:a,strides:o,pad:s,dimRoundingMode:c}=r;R(bY(o,1),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '1'`);let l=uY(i.shape,a,o,1,s,c);if(l.filterWidth===1&&l.filterHeight===1&&jU(l.inShape,l.outShape))return k7({inputs:{x:i},backend:n});let u=new n9(l,`max`,!1);return n.runWebGLProgram(u,[i],i.dtype)}const wWe={kernelName:BG,backendName:`webgl`,kernelFunc:CWe};function TWe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{filterSize:a,strides:o,pad:s,dataFormat:c,dimRoundingMode:l}=r,u=dY(i.shape,a,o,[1,1,1],s,l,c),d=new r9(u,`max`,!1);return n.runWebGLProgram(d,[i],i.dtype)}const EWe={kernelName:HG,backendName:`webgl`,kernelFunc:TWe};
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var DWe=class{constructor(e){this.variableNames=[`dy`,`maxPos`],this.outputShape=e.inShape;let t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,i=e.effectiveFilterHeight,a=e.effectiveFilterWidth,o=i-1-e.padInfo.top,s=a-1-e.padInfo.left,c=i*a-1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${i};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${a}; wC++) {
            float dyC = float(dyCCorner + wC) / ${n}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${a} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}},OWe=class{constructor(e){this.variableNames=[`dy`,`maxPos`],this.outputShape=e.inShape;let t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterDepth,c=e.effectiveFilterHeight,l=e.effectiveFilterWidth,u=s-1-e.padInfo.front,d=c-1-e.padInfo.top,f=l-1-e.padInfo.left,p=s*c*l-1;this.userCode=`
      const ivec3 pads = ivec3(${u}, ${d}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${s};
           wD += ${i}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${a}) {
            float dyR = float(dyRCorner + wR) / ${n}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${l};
                wC += ${o}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${l} +
                  wR * ${l} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}};function kWe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a}=t,o=a,{filterSize:s,strides:c,pad:l,dimRoundingMode:u}=r,d=dY(o.shape,s,c,[1,1,1],l,u),f=new r9(d,`max`,!0),p=n.runWebGLProgram(f,[o],o.dtype),m=new OWe(d),h=n.runWebGLProgram(m,[i,p],o.dtype);return n.disposeIntermediateTensorInfo(p),h}const AWe={kernelName:UG,backendName:`webgl`,kernelFunc:kWe};function jWe(e){let{inputs:t,backend:n,attrs:r}=e,{dy:i,input:a,output:o}=t,s=a;N5([a,o],`maxPoolGrad`);let{filterSize:c,strides:l,pad:u,dimRoundingMode:d}=r,f=uY(s.shape,c,l,1,u,d),p=new n9(f,`max`,!0),m=n.runWebGLProgram(p,[s],s.dtype),h=new DWe(f),g=n.runWebGLProgram(h,[i,m],s.dtype);return n.disposeIntermediateTensorInfo(m),g}const MWe={kernelName:VG,backendName:`webgl`,kernelFunc:jWe};function NWe(e,t,n,r){let i=new n9(n,`max`,!1),a=r.runWebGLProgram(i,[e],`float32`);i=new n9(n,`max`,!0,!0,t);let o=r.runWebGLProgram(i,[e],`float32`);return[a,o]}const PWe={kernelName:WG,backendName:`webgl`,kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{filterSize:i,strides:a,pad:o,includeBatchInIndex:s}=t,c=n;R(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);let l=[1,1];R(bY(a,l),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${l}'`);let u=uY(r.shape,i,a,l,o),[d,f]=NWe(r,s,u,c);return[d,f]}};function FWe(e,t,n,r){let i=z(t),a=z(e.shape)/i,o=$({inputs:{x:e},attrs:{shape:[a,i]},backend:r}),s=G7(o,`float32`,`mean`,r),c=$({inputs:{x:s},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),c}const IWe={kernelName:GG,backendName:`webgl`,kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{x:r}=e,{keepDims:i,axis:a}=t,o=n,s=r.shape.length,c=LU(a,r.shape),l=c,u=oX(l,s),d=u!=null,f=o.shouldExecuteOnCPU([r]),p=[],m=r;if(d){if(f){let e=o.texData.get(m.dataId).values,t=Array(s);for(let e=0;e<t.length;e++)t[e]=r.shape[u[e]];let n=d7(e,r.shape,r.dtype,u,t);m=o.makeTensorInfo(t,r.dtype);let i=o.texData.get(m.dataId);i.values=n}else m=K7(r,u,o);p.push(m),l=cX(l.length,s)}aX(`sum`,l,s);let[h,g]=rX(m.shape,l),_=h;i&&(_=iX(h,c));let v=FWe(m,g,_,o);for(let e of p)o.disposeIntermediateTensorInfo(e);return v}};function LWe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:o}=r,s=i.shape.length,c=LU(a,i.shape),l=c,u=oX(l,s),d=i;u!=null&&(d=J7({inputs:{x:i},backend:n,attrs:{perm:u}}),l=cX(l.length,i.shape.length)),aX(`min`,l,s);let[f,p]=rX(d.shape,l),m=z(p),h=$({inputs:{x:d},backend:n,attrs:{shape:[-1,m]}}),g=G7(h,h.dtype,`min`,n),_;if(o){let e=iX(f,c);_=$({inputs:{x:g},backend:n,attrs:{shape:e}})}else _=$({inputs:{x:g},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(g),u!=null&&n.disposeIntermediateTensorInfo(d),_}const RWe={kernelName:`Min`,backendName:`webgl`,kernelFunc:LWe};var zWe=T7+`
  return min(a, b);
`,BWe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+D7+`
  return result;
`;const VWe=L7({opSnippet:zWe,packedOpSnippet:BWe,cpuKernelImpl:Tze}),HWe={kernelName:KG,backendName:`webgl`,kernelFunc:VWe};var UWe=class{constructor(e,t,n){this.variableNames=[`x`],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let r=e.length,i=q5(r),a=t.map(e=>e[0]).join(`,`),o=t.map((t,n)=>t[0]+e[n]).join(`,`),s=[`coords[0]`,`coords[1]`,`coords[2]`,`coords[3]`].slice(0,r),c=n===`reflect`?0:1;if(r===1){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${a});
      ${i} end = ${i}(${o});

      void main() {
        ${i} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${i} coords = outC - start;
        setOutput(getX(${s}));
      }
    `}},WWe=class{constructor(e,t,n){this.variableNames=[`x`],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let r=e.length,i=q5(r),a=t.map(e=>e[0]).join(`,`),o=t.map((t,n)=>t[0]+e[n]).join(`,`),s=p7(`rc`,r),c=p7(`source`,r),l=`${s[r-1]} < ${this.outputShape[r-1]}`,u=r===1?`source`:`vec2(${c.slice(-2).join()})`,d=n===`reflect`?0:1,f=``;if(r===1){let e=`
        ${i} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${e}
        result[0] = getChannel(getX(${c.join()}), ${u});
        ${s[r-1]} += 1;
        if(${l}) {
          ${e}
          result[1] = getChannel(getX(${c.join()}), ${u});
        }
      `}else{let e=`
        ${i} source = rc;
        ${i} lt = ${i}(lessThan(source, start));
        ${i} gte = ${i}(greaterThanEqual(source, end));
        ${i} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;f=`
        ${i} rc = outputLoc;
        ${e}
        result[0] = getChannel(getX(${c.join()}), ${u});
        ${s[r-1]} += 1;
        if(${l}) {
          ${e}
          result[1] = getChannel(getX(${c.join()}), ${u});
        }
        rc = outputLoc;
        ${s[r-2]} += 1;
        if(${s[r-2]} < ${this.outputShape[r-2]}) {
          ${e}
          result[2] = getChannel(getX(${c.join()}), ${u});
          ${s[r-1]} += 1;
          if(${l}) {
            ${e}
            result[3] = getChannel(getX(${c.join()}), ${u});
          }
        }
      `}this.userCode=`
      const ${i} start = ${i}(${a});
      const ${i} end = ${i}(${o});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}};const GWe={kernelName:qG,backendName:`webgl`,kernelFunc:({inputs:e,backend:t,attrs:n})=>{let{x:r}=e,{paddings:i,mode:a}=n,o=B().getBool(`WEBGL_PACK_ARRAY_OPERATIONS`)?new WWe(r.shape,i,a):new UWe(r.shape,i,a);return t.runWebGLProgram(o,[r],r.dtype)}};var KWe=`if (b == 0.0) return NAN;
  return mod(a, b);`,qWe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+D7+`
  return result;
`;const JWe={kernelName:`Mod`,backendName:`webgl`,kernelFunc:L7({opSnippet:KWe,packedOpSnippet:qWe})};
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var YWe=class{constructor(e,t,n){this.variableNames=[`probs`],this.customUniforms=[{name:`seed`,type:`float`}],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}};const z9=L7({opSnippet:`
if (a == b) {
  return 1.0;
};
return a / b;`,packedOpSnippet:`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,checkOutOfBounds:!0}),XWe={kernelName:lG,backendName:`webgl`,kernelFunc:z9};var B9=`return a - b;`;const V9=L7({opSnippet:B9,packedOpSnippet:B9,supportsComplex:!0,cpuKernelImpl:Kze}),ZWe={kernelName:`Sub`,backendName:`webgl`,kernelFunc:V9};function H9(e){let{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{dim:a}=r,o=LU([a],i.shape),s=R9({inputs:{x:i},backend:n,attrs:{reductionIndices:o,keepDims:!1}}),c=iX(s.shape,o),l=$({inputs:{x:s},backend:n,attrs:{shape:c}}),u=V9({inputs:{a:i,b:l},backend:n}),d=O9({inputs:{x:u},backend:n}),f=q7({inputs:{x:d},backend:n,attrs:{axis:o,keepDims:!1}}),p=$({inputs:{x:f},backend:n,attrs:{shape:c}}),m=z9({inputs:{a:d,b:p},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}const QWe={kernelName:FK,backendName:`webgl`,kernelFunc:H9};function $We(e){let{inputs:t,backend:n,attrs:r}=e,{logits:i}=t,{numSamples:a,seed:o,normalized:s}=r,c=s?i:H9({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),l=c.shape[0],u=c.shape[1],d=new YWe(l,u,a),f=[[o]],p=n.runWebGLProgram(d,[c],`int32`,f);return s||n.disposeIntermediateTensorInfo(c),p}const eGe={kernelName:JG,backendName:`webgl`,kernelFunc:$We};var tGe=y7+`
  return -x;
`,nGe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function rGe(e){let{inputs:t,backend:n}=e,{x:r}=t;if(n.shouldExecuteOnCPU([r])){let e=n.texData.get(r.dataId),[t,i]=Dze(e.values,r.shape,r.dtype);return n.makeTensorInfo(i,r.dtype,t)}let i;return i=B().getBool(`WEBGL_PACK_UNARY_OPERATIONS`)?new S7(r.shape,nGe):new v7(r.shape,tGe),n.runWebGLProgram(i,[r],r.dtype)}const iGe={kernelName:`Neg`,backendName:`webgl`,kernelFunc:rGe};var aGe=HZ;function oGe(e){cq(`tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead`);let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:c}=r,l=n.readSync(i.dataId),u=n.readSync(a.dataId),{selectedIndices:d}=aGe(l,u,o,s,c);return n.makeTensorInfo([d.length],`int32`,new Int32Array(d))}const sGe={kernelName:ZG,backendName:`webgl`,kernelFunc:oGe};var cGe=UZ;function lGe(e){cq(`tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead`);let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:c,padToMaxOutputSize:l}=r,u=n.readSync(i.dataId),d=n.readSync(a.dataId),{selectedIndices:f,validOutputs:p}=cGe(u,d,o,s,c,l);return[n.makeTensorInfo([f.length],`int32`,new Int32Array(f)),n.makeTensorInfo([],`int32`,new Int32Array([p]))]}const uGe={kernelName:QG,backendName:`webgl`,kernelFunc:lGe};var dGe=WZ;function fGe(e){cq(`tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead`);let{inputs:t,backend:n,attrs:r}=e,{boxes:i,scores:a}=t,{maxOutputSize:o,iouThreshold:s,scoreThreshold:c,softNmsSigma:l}=r,u=n.readSync(i.dataId),d=n.readSync(a.dataId),{selectedIndices:f,selectedScores:p}=dGe(u,d,o,s,c,l);return[n.makeTensorInfo([f.length],`int32`,new Int32Array(f)),n.makeTensorInfo([p.length],`float32`,new Float32Array(p))]}const pGe={kernelName:$G,backendName:`webgl`,kernelFunc:fGe};
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var mGe=class{constructor(e,t,n,r){this.variableNames=[`indices`],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${n}),
                      float(index == coords.y)));
      }
    `}};const hGe={kernelName:tK,backendName:`webgl`,kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{indices:i}=t,{dtype:a,depth:o,onValue:s,offValue:c}=r,l=z(i.shape),u=new mGe(l,o,s,c),d=$({inputs:{x:i},backend:n,attrs:{shape:[l]}}),f=n.runWebGLProgram(u,[d],a);n.disposeIntermediateTensorInfo(d);let p=[...i.shape,o],m=$({inputs:{x:f},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(f),m}};function U9(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype===`complex64`){let e=s9({inputs:{input:r},backend:n}),t=U9({inputs:{x:e},backend:n}),i=f9({inputs:{input:r},backend:n}),a=U9({inputs:{x:i},backend:n}),o=A7({inputs:{real:t,imag:a},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),o}else return N9({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype===`string`?``:0},backend:n})}const gGe={kernelName:nq,backendName:`webgl`,kernelFunc:U9};function W9(e){let{inputs:t,backend:n}=e,{x:r}=t;if(r.dtype===`string`)throw Error(`onesLike is not supported under string dtype`);if(r.dtype===`complex64`){let e=s9({inputs:{input:r},backend:n}),t=W9({inputs:{x:e},backend:n}),i=f9({inputs:{input:r},backend:n}),a=U9({inputs:{x:i},backend:n}),o=A7({inputs:{real:t,imag:a},backend:n});return n.disposeIntermediateTensorInfo(e),n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),o}else return N9({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const _Ge={kernelName:eK,backendName:`webgl`,kernelFunc:W9};function vGe(e){let{inputs:t,backend:n,attrs:r}=e,{axis:i}=r;if(t.length===1)return k9({inputs:{input:t[0]},backend:n,attrs:{dim:i}});let a=t[0].shape,o=t[0].dtype;t.forEach(e=>{kU(a,e.shape,`All tensors passed to stack must have matching shapes`),R(o===e.dtype,()=>`All tensors passed to stack must have matching dtypes`)});let s=[],c=t.map(e=>{let t=k9({inputs:{input:e},backend:n,attrs:{dim:i}});return s.push(t),t}),l=m9({inputs:c,backend:n,attrs:{axis:i}});return s.forEach(e=>n.disposeIntermediateTensorInfo(e)),l}const yGe={kernelName:nK,backendName:`webgl`,kernelFunc:vGe};var bGe=class{constructor(e,t,n){this.variableNames=[`x`],this.customUniforms=[{name:`value`,type:`float`}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let r=e.length,i=q5(r),a=t.map(e=>e[0]).join(`,`),o=t.map((t,n)=>t[0]+e[n]).join(`,`),s=[`coords[0]`,`coords[1]`,`coords[2]`,`coords[3]`].slice(0,r);if(r===1){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${i} start = ${i}(${a});
      ${i} end = ${i}(${o});

      void main() {
        ${i} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${i} coords = outC - start;
          setOutput(getX(${s}));
        }
      }
    `}},xGe=class{constructor(e,t,n){this.variableNames=[`x`],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:`value`,type:`float`}],this.outputShape=t.map((t,n)=>t[0]+e[n]+t[1]);let r=e.length,i=q5(r),a=t.map(e=>e[0]).join(`,`),o=t.map((t,n)=>t[0]+e[n]).join(`,`),s=p7(`rc`,r),c=p7(`source`,r),l=`${s[r-1]} < ${this.outputShape[r-1]}`,u=r===1?`source`:`vec2(${c.slice(-2).join()})`,d=[`${i} rc = outputLoc;`,`${s[r-1]} += 1;
       if(${l}) {
      `,r===1?``:`}
       rc = outputLoc;
       ${s[r-2]} += 1;
       if(${s[r-2]} < ${this.outputShape[r-2]}) {`,r===1?``:`  ${s[r-1]} += 1;
         if(${l}) {`],f=r===1?`rc < start || rc >= end`:`any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))`,p=``;for(let e=0,t=r===1?2:4;e<t;e++)p+=`
        ${d[e]}
        if (${f}) {
          result[${e}] = float(value);
        } else {
          ${i} source = rc - start;
          result[${e}] = getChannel(getX(${c.join()}), ${u});
        }
      `;p+=r===1?`} `:`}}`,this.userCode=`
      const ${i} start = ${i}(${a});
      const ${i} end = ${i}(${o});

      void main() {
        ${i} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}};const G9=e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{paddings:a,constantValue:o}=r;if(z(i.shape)===0){let e=a.map((e,t)=>e[0]+i.shape[t]+e[1]);return N9({backend:n,attrs:{shape:e,value:o,dtype:i.dtype}})}let s=B().getBool(`WEBGL_PACK_ARRAY_OPERATIONS`)?new xGe(i.shape,a,o):new bGe(i.shape,a,o),c=[[o]];return n.runWebGLProgram(s,[i],i.dtype,c)},SGe={kernelName:rK,backendName:`webgl`,kernelFunc:G9};var CGe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,wGe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+D7+`
  return result;
`;const TGe={kernelName:`Pow`,backendName:`webgl`,kernelFunc:L7({opSnippet:CGe,packedOpSnippet:wGe})};function EGe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{axis:a,keepDims:o}=r,s=i.shape.length,c=[],l=LU(a,i.shape),u=l,d=oX(u,s),f=i;d!=null&&(f=J7({inputs:{x:i},backend:n,attrs:{perm:d}}),u=cX(u.length,s),c.push(f)),aX(`prod`,u,s);let p;if(n.shouldExecuteOnCPU([f])){let e=n.texData.get(f.dataId).values,{outVals:t,outShape:r,outDtype:i}=kze(f.shape,f.dtype,e,u);p=n.makeTensorInfo(r,i,t)}else{let[e,t]=rX(f.shape,u),r=z(t),a=$({inputs:{x:f},backend:n,attrs:{shape:[-1,r]}}),o=eJ(i.dtype),s=G7(a,o,`prod`,n);p=$({inputs:{x:s},backend:n,attrs:{shape:e}}),c.push(a),c.push(s)}if(o){c.push(p);let e=iX(p.shape,l);p=$({inputs:{x:p},backend:n,attrs:{shape:e}})}return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),p}const DGe={kernelName:aK,backendName:`webgl`,kernelFunc:EGe};function OGe(e){let{inputs:t,backend:n,attrs:r}=e,{paramsNestedSplits:i,paramsDenseValues:a,indices:o}=t,{outputRaggedRank:s}=r,c=i.map(e=>n.readSync(e.dataId)),l=i.map(e=>e.shape),u=n.readSync(a.dataId),d=n.readSync(o.dataId),[f,p,m]=Aze(c,l,u,a.shape,a.dtype,d,o.shape,s),h=f.map(e=>n.makeTensorInfo([e.length],`int32`,e)),g=n.makeTensorInfo(m,a.dtype,p);return h.concat([g])}const kGe={kernelName:oK,backendName:`webgl`,kernelFunc:OGe};function AGe(e){let{inputs:t,backend:n}=e,{starts:r,limits:i,deltas:a}=t,o=n.readSync(r.dataId),s=n.readSync(i.dataId),c=n.readSync(a.dataId),[l,u]=jze(o,r.shape,r.dtype,s,i.shape,c,a.shape),d=n.makeTensorInfo([l.length],`int32`,l),f=n.makeTensorInfo([u.length],r.dtype,u);return[d,f]}const jGe={kernelName:sK,backendName:`webgl`,kernelFunc:AGe};function MGe(e){let{inputs:t,backend:n,attrs:r}=e,{shape:i,values:a,defaultValue:o,rowPartitionTensors:s}=t,{rowPartitionTypes:c}=r,l=n.readSync(i.dataId),u=n.readSync(a.dataId),d=n.readSync(o.dataId),f=s.map(e=>n.readSync(e.dataId)),p=s.map(e=>e.shape),[m,h]=Mze(l,i.shape,u,a.shape,a.dtype,d,o.shape,f,p,c);return n.makeTensorInfo(m,a.dtype,h)}const NGe={kernelName:cK,backendName:`webgl`,kernelFunc:MGe},K9=e=>{let{backend:t,attrs:n}=e,{start:r,stop:i,step:a,dtype:o}=n,s=Nze(r,i,a,o);return t.makeTensorInfo([s.length],o,s)},PGe={kernelName:lK,backendName:`webgl`,kernelFunc:K9},FGe=I7({opSnippet:`return 1.0 / x;`}),IGe={kernelName:dK,backendName:`webgl`,kernelFunc:FGe};var LGe=y7+`
  return (x < 0.0) ? 0.0 : x;
`;const RGe=I7({opSnippet:LGe,packedOpSnippet:`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`}),zGe={kernelName:fK,backendName:`webgl`,kernelFunc:RGe};var BGe=y7+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`;const VGe=I7({opSnippet:BGe,packedOpSnippet:`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`}),HGe={kernelName:vK,backendName:`webgl`,kernelFunc:VGe};
/**
* @license
* Copyright 2017 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var UGe=class{constructor(e,t,n,r,i){this.variableNames=[`A`],this.outputShape=[];let[a,o,s,c]=e;this.outputShape=[a,t,n,c];let l=[r&&t>1?o-1:o,r&&n>1?s-1:s],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d;d=i?`(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)`:`vec2(yRC) * effectiveInputOverOutputRatioRC`,this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${l[0]/u[0]},
          ${l[1]/u[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${s}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}},WGe=class{constructor(e,t,n,r,i){this.variableNames=[`A`],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[a,o,s,c]=e;this.outputShape=[a,t,n,c];let l=[r&&t>1?o-1:o,r&&n>1?s-1:s],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d;d=i?`(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)`:`vec3(yRC) * effectiveInputOverOutputRatioRC`,this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${l[0]/u[0]},
          ${l[1]/u[1]},
          ${l[1]/u[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${s}.0,
                                     ${s}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${n-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}};function GGe(e){let{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:a,halfPixelCenters:o,size:s}=r,[c,l]=s,u=B().getBool(`WEBGL_PACK_IMAGE_OPERATIONS`)?new WGe(i.shape,c,l,a,o):new UGe(i.shape,c,l,a,o);return n.runWebGLProgram(u,[i],`float32`)}const KGe={kernelName:gK,backendName:`webgl`,kernelFunc:GGe};
/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var qGe=class{constructor(e,t,n){this.variableNames=[`dy`],this.outputShape=[],this.outputShape=t;let[,r,i]=t,[,a,o]=e,s=[n&&a>1?r-1:r,n&&o>1?i-1:i],c=[n&&a>1?a-1:a,n&&o>1?o-1:o],l=s[0]/c[0],u=s[1]/c[1],d=1/l,f=1/u,p=Math.ceil(d)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${l});
        const float widthScale = float(${u});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${i-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function JGe(e){let{inputs:t,backend:n,attrs:r}=e,{images:i,dy:a}=t,{alignCorners:o}=r,s=new qGe(a.shape,i.shape,o);return n.runWebGLProgram(s,[a],a.dtype)}const YGe={kernelName:_K,backendName:`webgl`,kernelFunc:JGe};
/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var XGe=class{constructor(e,t,n,r,i){this.variableNames=[`A`],this.outputShape=[];let[a,o,s,c]=e;this.outputShape=[a,t,n,c];let l=[r&&t>1?o-1:o,r&&n>1?s-1:s],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=r?`0.5`:`0.0`,f;f=i?`max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))`:`vec2(yRC) * effectiveInputOverOutputRatioRC`,this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${l[0]/u[0]},
          ${l[1]/u[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${s}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}},ZGe=class{constructor(e,t,n,r,i){this.variableNames=[`A`],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];let[a,o,s,c]=e;this.outputShape=[a,t,n,c];let l=[r&&t>1?o-1:o,r&&n>1?s-1:s],u=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=r?`0.5`:`0.0`,f;f=i?`max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))`:`vec3(yRC) * effectiveInputOverOutputRatioRC`,this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${l[0]/u[0]},
          ${l[1]/u[1]},
          ${l[1]/u[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${s}.0,
                                     ${s}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${n-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}};function QGe(e){let{inputs:t,backend:n,attrs:r}=e,{images:i}=t,{alignCorners:a,halfPixelCenters:o,size:s}=r,[c,l]=s,u=B().getBool(`WEBGL_PACK_IMAGE_OPERATIONS`)?new ZGe(i.shape,c,l,a,o):new XGe(i.shape,c,l,a,o);return n.runWebGLProgram(u,[i],i.dtype)}const $Ge={kernelName:mK,backendName:`webgl`,kernelFunc:QGe};
/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var eKe=class{constructor(e,t,n){this.variableNames=[`dy`],this.outputShape=[],this.outputShape=t;let[,r,i]=t,[,a,o]=e,s=[n&&a>1?r-1:r,n&&o>1?i-1:i],c=[n&&a>1?a-1:a,n&&o>1?o-1:o],l=s[0]/c[0],u=s[1]/c[1],d=1/l,f=1/u,p=Math.ceil(d)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${l});
        const float widthScale = float(${u});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float sourceFracRow =
              float(${s[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${s[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${n} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${i}) - 1),
                ${n} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}};function tKe(e){let{inputs:t,backend:n,attrs:r}=e,{images:i,dy:a}=t,{alignCorners:o}=r,s=new eKe(a.shape,i.shape,o);return n.runWebGLProgram(s,[a],a.dtype)}const nKe={kernelName:hK,backendName:`webgl`,kernelFunc:tKe};var rKe=class{constructor(e,t){this.variableNames=[`x`];let n=e.length;if(n>4)throw Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);if(this.outputShape=e,n===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}let r=n=>t.indexOf(n)!==-1&&e[n]!==1?`${e[n]} - coords[${n}] - 1`:`coords[${n}]`,i=e.map((e,t)=>r(t)).join(`,`);this.userCode=`
      void main() {
        ${q5(n)} coords = getOutputCoords();
        setOutput(getX(${i}));
      }
    `}},iKe=class{constructor(e,t){this.variableNames=[`x`],this.packedInputs=!0,this.packedOutput=!0;let n=e.length;if(n>4)throw Error(`WebGL backend: Reverse of rank-${n} tensor is not yet supported`);this.outputShape=e;let r=p7(`rc`,n),i=`${r[n-1]} + 1 < ${this.outputShape[n-1]}`,a=`${r[n-2]} + 1 < ${this.outputShape[n-2]}`,o=q5(n);n===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${i}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${s(r.slice())};
          if(${i}){
            result.g = ${c(r.slice())};
          }
          if(${a}) {
            result.b = ${l(r.slice())};
            if(${i}) {
              result.a = ${u(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function s(e){return d(e)}function c(e){return e[n-1]=`(`+e[n-1]+` + 1)`,d(e)}function l(e){return e[n-2]=`(`+e[n-2]+` + 1)`,d(e)}function u(e){return e[n-1]=`(`+e[n-1]+` + 1)`,e[n-2]=`(`+e[n-2]+` + 1)`,d(e)}function d(t){let n=e.map((e,n)=>f(n,t)),r=n.join(`,`),i=n.slice(-2).join(`,`);return`getChannel(getX(${r}), vec2(${i}))`}function f(n,r){return t.indexOf(n)!==-1&&e[n]!==1?`${e[n]} - ${r[n]} - 1`:`${r[n]}`}}};function aKe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{dims:a}=r,o=i.shape.length,s=LU(a,i.shape);if(o===0)return k7({inputs:{x:i},backend:n});let c=B().getBool(`WEBGL_PACK_ARRAY_OPERATIONS`)?new iKe(i.shape,s):new rKe(i.shape,s);return n.runWebGLProgram(c,[i],i.dtype)}const oKe={kernelName:yK,backendName:`webgl`,kernelFunc:aKe};
/**
* @license
* Copyright 2020 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var sKe=class{constructor(e,t){this.variableNames=[`Image`],this.outputShape=[],this.customUniforms=[{name:`params`,type:`vec4`}];let n=e[1],r=e[2];this.outputShape=e;let i=``;i=typeof t==`number`?`float outputValue = ${t.toFixed(2)};`:`
        vec3 fill = vec3(${t.join(`,`)});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${i}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${n}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}};const cKe={kernelName:iq,backendName:`webgl`,kernelFunc:({inputs:e,attrs:t,backend:n})=>{let{image:r}=e,{radians:i,fillValue:a,center:o}=t,s=n,c=new sKe(r.shape,a),[l,u]=zQ(o,r.shape[1],r.shape[2]),d=[[l,u,Math.sin(i),Math.cos(i)]];return s.runWebGLProgram(c,[r],r.dtype,d)}},lKe=I7({opSnippet:`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`}),uKe={kernelName:bK,backendName:`webgl`,kernelFunc:lKe},dKe=I7({opSnippet:`return inversesqrt(x);`,cpuKernelImpl:Pze}),fKe={kernelName:xK,backendName:`webgl`,kernelFunc:dKe};var q9=class{constructor(e,t,n,r,i,a,o=!0,s=!1){this.variableNames=[`updates`,`indices`,`defaultValue`],this.outputShape=a;let c=q5(i.length),l=q5(a.length),u=``;n===1?u=`i`:n===2&&(u=`i, j`);let d=`getIndices(${u})`,f=``;r===1?f=`i`:r===2&&(f=`i, coords[1]`);let p=`getUpdates(${f})`,m=``;s&&(m=`coords[0], coords[1]`);let h=`getDefaultValue(${m})`;this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${l} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${d});
              flattenedIndex += index * ${t>1?`strides[j]`:`strides`};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${h}, sum, float(found)));
        }
      `}},pKe=class{constructor(e,t,n,r,i,a,o=!0,s=!1){this.variableNames=[`updates`,`indices`,`defaultValue`],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=a;let c=q5(i.length),l=q5(a.length),u=``;n===1?u=`i`:n===2&&(u=`i, j`);let d=`getIndices(${u})`,f=``;r===1?f=`i`:r===2&&(f=`i, coords[1]`);let p=`getUpdates(${f})`,m=``;s&&(m=`coords[0], coords[1]`);let h=`getDefaultValue(${m})`;this.userCode=`
        ${c} strides = ${c}(${i});

        void main() {
          ${l} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${t}; j+=2) {
              ivec4 index = round(${d});
              flattenedIndex += index.xz * ${t>1?`strides[j]`:`strides`};
              if (j + 1 < ${t}) {
                flattenedIndex += index.yw * ${t>1?`strides[j + 1]`:`strides`};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${h}, sum, found));
        }
      `}};function mKe(e){let{inputs:t,backend:n,attrs:r}=e,{indices:i,updates:a}=t,{shape:o}=r,{sliceRank:s,numUpdates:c,sliceSize:l,strides:u,outputSize:d}=kZ(a,i,o),f=[d/l,l];if(d===0)return n.makeTensorInfo(o,i.dtype);let p=$({inputs:{x:i},backend:n,attrs:{shape:[c,s]}}),m=$({inputs:{x:a},backend:n,attrs:{shape:[c,l]}}),h=n.makeTensorInfo([],`float32`,new Float32Array([0])),g;g=B().getBool(`WEBGL_PACK`)?new pKe(c,s,p.shape.length,m.shape.length,u,f):new q9(c,s,p.shape.length,m.shape.length,u,f);let _=n.runWebGLProgram(g,[m,p,h],m.dtype),v=$({inputs:{x:_},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(_),n.disposeIntermediateTensorInfo(h),v}const hKe={kernelName:SK,backendName:`webgl`,kernelFunc:mKe};var gKe=class{constructor(e,t,n,r){this.variableNames=[`sortedSequence`,`values`],this.customUniforms=[{name:`numInputs`,type:`int`}],this.outputShape=[e,n];let i=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`;this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${B().getNumber(`WEBGL_VERSION`)===2?`while (left < right) {`:i}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${r===`left`?`<`:`<=`} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}};function _Ke(e){let{inputs:t,backend:n,attrs:r}=e,{sortedSequence:i,values:a}=t,{side:o}=r,s=new gKe(i.shape[0],i.shape[1],a.shape[1],o),c=[[i.shape[1]]];return n.runWebGLProgram(s,[i,a],`int32`,c)}const vKe={kernelName:wK,backendName:`webgl`,kernelFunc:_Ke};var yKe=class{constructor(e,t,n){this.variableNames=[`c`,`a`,`b`],this.outputShape=t;let r,i;if(n>4)throw Error(`Where for rank ${n} is not yet supported`);if(n===1)i=`resRC`,r=`resRC`;else{let n=[`resRC.x`,`resRC.y`,`resRC.z`,`resRC.w`],a=[],o=[];for(let r=0;r<t.length;r++)o.push(`${n[r]}`),r<e&&a.push(`${n[r]}`);r=a.join(),i=o.join()}this.userCode=`
      void main() {
        ${q5(n)} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${i}));
        } else {
          setOutput(getB(${i}));
        }
      }
    `}};function bKe(e){let{inputs:t,backend:n}=e,{condition:r,t:i,e:a}=t,o=new yKe(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(o,[r,i,a],$q(i.dtype,a.dtype))}const xKe={kernelName:TK,backendName:`webgl`,kernelFunc:bKe};var SKe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${GQ};
  float scale = ${KQ};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`;const CKe=I7({opSnippet:SKe}),wKe={kernelName:EK,backendName:`webgl`,kernelFunc:CKe};var TKe=F7+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`;const EKe=I7({opSnippet:TKe,packedOpSnippet:`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,cpuKernelImpl:Ize}),DKe={kernelName:AK,backendName:`webgl`,kernelFunc:EKe},OKe=I7({opSnippet:`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`}),kKe={kernelName:kK,backendName:`webgl`,kernelFunc:OKe};var AKe=F7+`
  return sin(x);
`,jKe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${D7}
  return result;
`;const MKe={kernelName:`Sin`,backendName:`webgl`,kernelFunc:I7({opSnippet:AKe,packedOpSnippet:jKe})},NKe=I7({opSnippet:`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`}),PKe={kernelName:OK,backendName:`webgl`,kernelFunc:NKe},FKe=I7({opSnippet:`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`}),IKe={kernelName:jK,backendName:`webgl`,kernelFunc:FKe},LKe={kernelName:NK,backendName:`webgl`,kernelFunc:e=>{let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{blockShape:a,paddings:o}=r;R(i.shape.length<=4,()=>`spaceToBatchND for rank > 4 with a WebGL backend not implemented yet`);let s=a.reduce((e,t)=>e*t),c=[[0,0]];c.push(...o);for(let e=1+a.length;e<i.shape.length;++e)c.push([0,0]);let l=[],u=G9({inputs:{x:i},backend:n,attrs:{paddings:c,constantValue:0}}),d=BQ(u.shape,a,s,!1),f=VQ(d.length,a.length,!1),p=HQ(u.shape,a,s,!1),m=$({inputs:{x:u},backend:n,attrs:{shape:d}}),h=J7({inputs:{x:m},backend:n,attrs:{perm:f}}),g=$({inputs:{x:h},backend:n,attrs:{shape:p}});return l.push(u),l.push(m),l.push(h),l.forEach(e=>n.disposeIntermediateTensorInfo(e)),g}};function RKe(e){let{inputs:t,backend:n}=e,{indices:r,values:i,denseShape:a,defaultValue:o}=t;if(a.shape.length!==1)throw Error(`Dense shape must be a vector, saw:
         ${a.shape}`);if(r.shape.length!==2)throw Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(i.shape.length!==1)throw Error(`Values must be a vector, saw:
         ${i.shape}`);if(o.shape.length!==0)throw Error(`Default value must be a scalar, saw:
        ${o.shape}`);let s=n.readSync(r.dataId),c=n.readSync(i.dataId),l=n.readSync(a.dataId),u=n.readSync(o.dataId)[0],[d,f,p,m,h]=Rze(s,r.shape,r.dtype,c,i.dtype,l,u);return[n.makeTensorInfo(f,r.dtype,d),n.makeTensorInfo([f[0]],i.dtype,p),n.makeTensorInfo([m.length],`bool`,new Uint8Array(m.map(e=>Number(e)))),n.makeTensorInfo([h.length],r.dtype,new Int32Array(h))]}const zKe={kernelName:IK,backendName:`webgl`,kernelFunc:RKe};function BKe(e){let{inputs:t,backend:n}=e,{inputIndices:r,inputShape:i,newShape:a}=t;if(r.shape.length!==2)throw Error(`Input indices should be a matrix but received shape ${r.shape}`);if(i.shape.length!==1)throw Error(`Input shape should be a vector but received shape ${i.shape}`);if(a.shape.length!==1)throw Error(`Target shape should be a vector but received shape ${a.shape}`);let o=Array.from(n.readSync(i.dataId)),s=n.readSync(r.dataId),c=Array.from(n.readSync(a.dataId)),[l,u,d]=zze(s,r.shape,r.dtype,o,c);return[n.makeTensorInfo(u,r.dtype,l),n.makeTensorInfo([d.length],a.dtype,new Int32Array(d))]}const VKe={kernelName:LK,backendName:`webgl`,kernelFunc:BKe};function HKe(e){let{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:a}=t;if(r.shape.length<1)throw Error(`Data should be at least 1 dimensional but received scalar`);if(i.shape.length!==1)throw Error(`Indices should be a vector but received shape
              ${i.shape}`);if(a.shape.length!==1)throw Error(`Segment ids should be a vector but received shape
              ${a.shape}`);let o=n.readSync(r.dataId),s=n.readSync(i.dataId),c=n.readSync(a.dataId),[l,u]=u7(o,r.shape,r.dtype,s,c,!0);return n.makeTensorInfo(u,r.dtype,l)}const UKe={kernelName:RK,backendName:`webgl`,kernelFunc:HKe};function WKe(e){let{inputs:t,backend:n}=e,{data:r,indices:i,segmentIds:a}=t;if(r.shape.length<1)throw Error(`Data should be at least 1 dimensional but received scalar`);if(i.shape.length!==1)throw Error(`Indices should be a vector but received shape
             ${i.shape}`);if(a.shape.length!==1)throw Error(`Segment ids should be a vector but received shape
             ${a.shape}`);let o=n.readSync(r.dataId),s=n.readSync(i.dataId),c=n.readSync(a.dataId),[l,u]=u7(o,r.shape,r.dtype,s,c);return n.makeTensorInfo(u,r.dtype,l)}const GKe={kernelName:zK,backendName:`webgl`,kernelFunc:WKe};function KKe(e){let{inputs:t,backend:n,attrs:r}=e,{sparseIndices:i,sparseValues:a,defaultValue:o}=t,{outputShape:s}=r,{sliceRank:c,numUpdates:l,sliceSize:u,strides:d,outputSize:f}=kZ(a,i,s);if(a.dtype===`string`){let e=n.bufferSync(i),t=n.bufferSync(a),r=Pq(n.readSync(o.dataId)[0]),p=Fze(e,t,s,f,u,l,c,d,r,!1);return n.makeTensorInfo(s,p.dtype,p.values)}let p=new q9(l,c,i.shape.length,a.shape.length,d,[f,1],!1),m=n.runWebGLProgram(p,[a,i,o],a.dtype),h=$({inputs:{x:m},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(m),h}const qKe={kernelName:BK,backendName:`webgl`,kernelFunc:KKe};function JKe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{numOrSizeSplits:a,axis:o}=r,s=LU(o,i.shape)[0],c=h$(i,a,s),l=i.shape.length,u=Array(l).fill(0),d=i.shape.slice();return c.map(e=>{let t=[...d];t[s]=e;let r=a9({inputs:{x:i},backend:n,attrs:{begin:u,size:t}});return u[s]+=e,r})}const YKe={kernelName:PK,backendName:`webgl`,kernelFunc:JKe};var J9=`return sqrt(x);`;const XKe=I7({opSnippet:J9,packedOpSnippet:J9,cpuKernelImpl:Bze}),ZKe={kernelName:MK,backendName:`webgl`,kernelFunc:XKe},QKe=I7({opSnippet:`return x * x;`}),$Ke={kernelName:HK,backendName:`webgl`,kernelFunc:QKe};var Y9=`return (a - b) * (a - b);`;const eqe=L7({opSnippet:Y9,packedOpSnippet:Y9}),tqe={kernelName:VK,backendName:`webgl`,kernelFunc:eqe};function nqe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t;if(i.dtype!==`string`)throw Error(`Input must be of datatype string`);let a=n.readSync(i.dataId),o=j$(a),s=Vze(o,`string`,r);return n.makeTensorInfo(i.shape,`string`,s)}const rqe={kernelName:UK,backendName:`webgl`,kernelFunc:nqe};function iqe({inputs:e,attrs:t,backend:n}){let{x:r}=e,i=`if (isnan(x)) return x;
    return x > 0.0 ? 1.0 : float(${t.alpha});
  `,a=new v7(r.shape,i);return n.runWebGLProgram(a,[r],r.dtype)}const aqe={kernelName:rq,backendName:`webgl`,kernelFunc:iqe};var oqe=class{constructor(e,t,n){this.variableNames=[`x`],this.outputShape=n;let r=n.length,i=q5(n.length),a=q5(n.length),o=``;if(r===1)o=`coords * strides + begin`;else{let e=0;o=n.map((t,r)=>(e++,n.length===1?`coords * strides[${r}] + begin[${r}]`:`coords[${e-1}] * strides[${r}] + begin[${r}]`)).join(`,`)}this.userCode=`
      ${i} begin = ${i}(${e});
      ${i} strides = ${i}(${t});

      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}};function sqe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{begin:a,end:o,strides:s,beginMask:c,endMask:l,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:f}=r,{finalShapeSparse:p,finalShape:m,isIdentity:h,sliceDim0:g,isSimpleSlice:_,begin:v,end:y,strides:b}=DQ(i.shape,a,o,s,c,l,u,d,f),x;if(h)x=$({inputs:{x:i},backend:n,attrs:{shape:m}});else if(g||_){R(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);let e=hQ(v,y,b),t=a9({inputs:{x:i},backend:n,attrs:{begin:v,size:e}});x=$({inputs:{x:t},backend:n,attrs:{shape:m}}),n.disposeIntermediateTensorInfo(t)}else if(n.shouldExecuteOnCPU([i])){let e=n.readSync(i.dataId),t=tY(i.shape,i.dtype,e),r=Hze(p,t,b,v);x=n.makeTensorInfo(m,i.dtype,r.values)}else{let e=new oqe(v,b,p);x=n.runWebGLProgram(e,[i],i.dtype)}let S=$({inputs:{x},backend:n,attrs:{shape:m}});return n.disposeIntermediateTensorInfo(x),S}const cqe={kernelName:WK,backendName:`webgl`,kernelFunc:sqe};function lqe(e){let{inputs:t,backend:n,attrs:r}=e,{separator:i,nGramWidths:a,leftPad:o,rightPad:s,padWidth:c,preserveShortSequences:l}=r,{data:u,dataSplits:d}=t,f=n.readSync(u.dataId),p=n.readSync(d.dataId),[m,h]=Uze(f,p,i,a,o,s,c,l);return[n.makeTensorInfo([m.length],`string`,m),n.makeTensorInfo(d.shape,`int32`,h)]}const uqe={kernelName:GK,backendName:`webgl`,kernelFunc:lqe};function dqe(e){let{inputs:t,backend:n,attrs:r}=e,{skipEmpty:i}=r,{input:a,delimiter:o}=t;if(a.dtype!==`string`)throw Error(`Input must be of datatype string`);if(a.shape.length!==1)throw Error(`Input must be a vector, got shape: ${a.shape}`);if(o.shape.length!==0)throw Error(`Delimiter must be a scalar, got shape: ${o.shape}`);let s=n.readSync(a.dataId),c=n.readSync(o.dataId)[0],[l,u,d]=Wze(s,c,i),f=u.length;return[n.makeTensorInfo([f,2],`int32`,l),n.makeTensorInfo([f],`string`,u),n.makeTensorInfo([2],`int32`,new Int32Array(d))]}const fqe={kernelName:KK,backendName:`webgl`,kernelFunc:dqe};function pqe(e){let{inputs:t,backend:n,attrs:r}=e,{numBuckets:i}=r,{input:a}=t;if(a.dtype!==`string`)throw Error(`Input must be of datatype string`);if(i<=0)throw Error(`Number of buckets must be at least 1`);let o=n.readSync(a.dataId),s=Gze(o,i);return n.makeTensorInfo(a.shape,`int32`,s)}const mqe={kernelName:qK,backendName:`webgl`,kernelFunc:pqe},hqe={kernelName:`Tan`,backendName:`webgl`,kernelFunc:I7({opSnippet:`return tan(x);`})},gqe=I7({opSnippet:`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`}),_qe={kernelName:JK,backendName:`webgl`,kernelFunc:gqe};function vqe(e){let{inputs:t,backend:n,attrs:r}=e,{tensor:i,indices:a,updates:o}=t,{}=r,{sliceRank:s,numUpdates:c,sliceSize:l,strides:u,outputSize:d}=kZ(o,a,i.shape),f=[d/l,l];if(d===0)return n.makeTensorInfo(i.shape,a.dtype);let p=$({inputs:{x:a},backend:n,attrs:{shape:[c,s]}}),m=$({inputs:{x:o},backend:n,attrs:{shape:[c,l]}}),h=$({inputs:{x:i},backend:n,attrs:{shape:f}}),g=new q9(c,s,p.shape.length,m.shape.length,u,f,!1,!0),_=n.runWebGLProgram(g,[m,p,h],h.dtype),v=$({inputs:{x:_},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(_),v}const yqe={kernelName:CK,backendName:`webgl`,kernelFunc:vqe};var bqe=class{constructor(e,t){this.variableNames=[`A`];let n=Array(e.length);for(let r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;let r=q5(this.rank),i=xqe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${i}));
      }
    `}};function xqe(e){let t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(t===1)return`imod(resRC, ${e[0]})`;let n=[`resRC.x`,`resRC.y`,`resRC.z`,`resRC.w`,`resRC.u`],r=[];for(let t=0;t<e.length;t++)r.push(`imod(${n[t]}, ${e[t]})`);return r.join()}function X9(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{reps:a}=r;if(i.dtype===`string`||i.shape.length>5){let e=n.readSync(i.dataId),t=i.dtype===`string`?e.map(e=>Pq(e)):e,r=tY(i.shape,i.dtype,t),o=qze(r,a);return n.makeTensorInfo(o.shape,o.dtype,o.values)}let o=new bqe(i.shape,a);return n.runWebGLProgram(o,[i],i.dtype)}const Sqe={kernelName:YK,backendName:`webgl`,kernelFunc:X9};var Cqe=class{constructor(e){this.variableNames=[`x`,`indices`],this.customUniforms=[{name:`n`,type:`int`},{name:`firstPass`,type:`int`},{name:`negativeInf`,type:`float`},{name:`dir`,type:`int`},{name:`inc`,type:`int`}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}},wqe=class{constructor(e){this.variableNames=[`x`,`indices`],this.customUniforms=[{name:`n`,type:`int`},{name:`firstPass`,type:`int`},{name:`k`,type:`int`}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}};function Z9(e,t){t!==null&&e.disposeIntermediateTensorInfo(t)}function Q9(e){let t=1;for(;t<e;)t*=2;return t}function Tqe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i}=t,{k:a,sorted:o}=r,s=B().getNumber(`TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD`),c=B().getNumber(`TOPK_K_CPU_HANDOFF_THRESHOLD`),l=i.shape,u=l[l.length-1];if(n.shouldExecuteOnCPU([i])||u<s||a>c){let e=n.readSync(i.dataId),[t,r]=Jze(e,l,i.dtype,a,o);return[n.makeTensorInfo(t.shape,t.dtype,t.values),n.makeTensorInfo(r.shape,r.dtype,r.values)]}if(a===0)return l[l.length-1]=0,[n.makeTensorInfo(l,i.dtype,[]),n.makeTensorInfo(l,`int32`,[])];if(u===1)return[i,N9({attrs:{shape:l,dtype:`int32`,value:0},backend:n})];let d=n.texData.get(i.dataId),f=d!==null&&d.isPacked,p=f?n.unpackTensor(i):i,m=z(l)/u,h=$({inputs:{x:p},attrs:{shape:[m,u]},backend:n});f&&Z9(n,p);let g=Q9(a),_=Q9(u),v=null,y=()=>v===null?[h,h]:[h,v],b=(e,t,r)=>{let i=y(),a=new Cqe(r),o=[[u],[v===null?1:0],[-1/0],[e],[t]],s=v;v=n.runWebGLProgram(a,i,`int32`,o),Z9(n,s)};for(let e=1;e<g;e*=2){let t=e*2;for(let n=e;n>=1;n/=2)b(t,n,[m,_])}for(let e=_;e>g;e/=2){let t=y(),r=new wqe([m,e/2]),i=[[u],[v===null?1:0],[g]],a=v;v=n.runWebGLProgram(r,t,`int32`,i),Z9(n,a);let o=g/2,s=o*2;for(let e=o;e>=1;e/=2)b(s,e,v.shape)}let x=v;v=a9({inputs:{x:v},backend:n,attrs:{begin:0,size:[m,a]}}),Z9(n,x);let S=L9({inputs:{x:h,indices:v},backend:n,attrs:{axis:1,batchDims:1}});Z9(n,h);let C=l.slice(0,-1);C.push(a),x=v,v=$({inputs:{x:v},attrs:{shape:C},backend:n}),Z9(n,x);let w=S;return S=$({inputs:{x:S},attrs:{shape:C},backend:n}),Z9(n,w),[S,v]}const Eqe={kernelName:XK,backendName:`webgl`,kernelFunc:Tqe};
/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var Dqe=class{constructor(e,t,n,r,i,a){this.variableNames=[`Image`,`Transforms`],this.outputShape=a;let o=n===`nearest`?1:2,s;switch(r){case`constant`:s=1;break;case`reflect`:s=2;break;case`wrap`:s=3;break;case`nearest`:s=4;break;default:s=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${s} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${s} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${s} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${i});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${i});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${o} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}};function Oqe(e){let{inputs:t,backend:n,attrs:r}=e,{image:i,transforms:a}=t,{interpolation:o,fillMode:s,fillValue:c,outputShape:l}=r,[u,d,f,p]=i.shape,[m,h]=l??[d,f],g=new Dqe(d,f,o,s,c,[u,m,h,p]);return n.runWebGLProgram(g,[i,a],`float32`)}const kqe={kernelName:ZK,backendName:`webgl`,kernelFunc:Oqe};function Aqe(e){let{inputs:t,attrs:n,backend:r}=e,{axis:i}=n,{x:a}=t;N5(a,`unique`),console.warn(`WARNING: `,`UI might be locked temporarily as data is being downloaded`);let o=r.readSync(a.dataId),{outputValues:s,outputShape:c,indices:l}=Yze(o,i,a.shape,a.dtype);return[r.makeTensorInfo(c,a.dtype,s),r.makeTensorInfo([l.length],`int32`,l)]}const jqe={kernelName:$K,backendName:`webgl`,kernelFunc:Aqe};function Mqe(e){let{inputs:t,backend:n,attrs:r}=e,{value:i}=t,{axis:a}=r;a<0&&(a+=i.shape.length);let o=i,s=o.shape.length,c=i.shape[a],l=Array(s-1),u=0;for(let e=0;e<s;e++)e!==a&&(l[u++]=o.shape[e]);let d=[],f=Array(s).fill(0),p=o.shape.slice();p[a]=1;let m=Array(c);for(let e=0;e<m.length;e++){f[a]=e;let t=a9({inputs:{x:o},backend:n,attrs:{begin:f,size:p}});m[e]=$({inputs:{x:t},backend:n,attrs:{shape:l}}),d.push(t)}return d.forEach(e=>n.disposeIntermediateTensorInfo(e)),m}const Nqe={kernelName:eq,backendName:`webgl`,kernelFunc:Mqe};
/**
* @license
* Copyright 2018 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*/
var Pqe=class{constructor(e,t){this.variableNames=[`x`,`segmentIds`];let n=e.windowSize,r=e.batchSize,i=e.inSize,a=e.numSegments,o=a*Math.ceil(i/n);this.outputShape=[r,o];let s=Math.floor(n/4)*4,c=n%4,l=`
        sumValue += dot(values, segFilter);
    `,u=``;i%n>0&&(u=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return initializationValue;
        }
      `);let d=``;i%n>0&&(d=`
        if (inIdx < 0 || inIdx >= ${i}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = 0.0;

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${d}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${a})) * float(${n}));
        int currentSeg = int(mod(float(outIdx), float(${a})));

        float sumValue = 0.0;

        for (int i = 0; i < ${s}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${l}
        }

        int inIdx = inOffset + ${s};
        if (${c===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${l}
        } else if (${c===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${l}
        } else if (${c===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${l}
        }
        setOutput(sumValue);
      }
    `}};function Fqe(e){let{inputs:t,backend:n,attrs:r}=e,{x:i,segmentIds:a}=t,{numSegments:o}=r,s=i.shape.length,c=[],l=0,u=oX([l],s),d=i;u!=null&&(d=J7({inputs:{x:i},backend:n,attrs:{perm:u}}),c.push(d),l=cX(1,s)[0]);let f=k$(d.shape,l,o),p=z([d.shape[l]]),m=$({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}});c.push(m);let h=eJ(i.dtype),g=(e,t,r,i,a)=>{let o=e.shape[0],s=e.shape[1],l=O$(s,a),u=new Pqe({windowSize:l,inSize:s,batchSize:o,numSegments:a},t),d=n.compileAndRun(u,[e,r],i);if(c.push(d),d.shape[1]===a)return d;let f=K9({backend:n,attrs:{start:0,stop:a,step:1,dtype:`float32`}}),p=X9({inputs:{x:f},backend:n,attrs:{reps:[s/l]}});return c.push(f),c.push(p),g(d,t,p,i,a)},_=g(m,`unsortedSegmentSum`,a,h,o),v=$({inputs:{x:_},backend:n,attrs:{shape:f}}),y=v;if(u!=null){c.push(v);let e=sX(u);y=J7({inputs:{x:y},backend:n,attrs:{perm:e}})}return c.forEach(e=>n.disposeIntermediateTensorInfo(e)),y}var Iqe=[OBe,ABe,NBe,IBe,LBe,BBe,HBe,WBe,JBe,XBe,$Be,nVe,aVe,lVe,fVe,mVe,gVe,bVe,SVe,wVe,DVe,NVe,FVe,LVe,zVe,WVe,KVe,XVe,dBe,$Ve,iHe,cHe,pHe,gHe,vHe,bHe,SHe,THe,DHe,kHe,jHe,NHe,FHe,RHe,BHe,WHe,KHe,YHe,QHe,eUe,tUe,iUe,oUe,cUe,lUe,uUe,fUe,mUe,gUe,vUe,bUe,SUe,TUe,OUe,AUe,NUe,IUe,RUe,BUe,uBe,HUe,nHe,WUe,KUe,JUe,pBe,XUe,QUe,eWe,nWe,aWe,sWe,lWe,dWe,mWe,gWe,vWe,SWe,wWe,EWe,AWe,MWe,PWe,IWe,RWe,HWe,GWe,JWe,eGe,gBe,iGe,sGe,uGe,pGe,BVe,hGe,_Ge,yGe,SGe,TGe,hBe,DGe,kGe,jGe,NGe,PGe,VVe,XWe,IGe,zGe,HGe,vBe,KGe,YGe,$Ge,nKe,oKe,cKe,uKe,fKe,hKe,vKe,xKe,wKe,DKe,kKe,MKe,PKe,MVe,QWe,IKe,LKe,zKe,VKe,UKe,GKe,qKe,YKe,ZKe,$Ke,tqe,rqe,aqe,cqe,uqe,fqe,mqe,ZWe,TBe,hqe,_qe,yqe,Sqe,Eqe,kqe,EBe,jqe,Nqe,{kernelName:tq,backendName:`webgl`,kernelFunc:Fqe},gGe];for(let e of Iqe)mq(e);var $9=null;async function Lqe(){if($9)return $9;try{$9=await nAe(`/model/model.json`)}catch{let e=aAe();e.add(K3({inputShape:[7],units:8,activation:`relu`})),e.add(K3({units:1,activation:`sigmoid`})),e.compile({optimizer:`adam`,loss:`binaryCrossentropy`}),$9=e}return $9}async function Rqe(e){return(await(await Lqe()).predict(DZ([e])).data())[0]}function zqe(e,t={low:.33,high:.66}){return e<t.low?`low`:e<t.high?`med`:`high`}function Bqe(){let{instrumentId:e}=$ae(),t=AC(),{user:n}=QS(),r=e===`dass21`?hU:vU,i=r.id===`dass21`?7:5,a=(0,N.useMemo)(()=>{let e=[];for(let t=0;t<r.items.length;t+=i)e.push(r.items.slice(t,t+i));return e},[r,i]),o=r.items.length,s=(0,N.useMemo)(()=>`mtc:${n?.uid||`anon`}:${r.id}:answers`,[n?.uid,r.id]),[c,l]=(0,N.useState)(()=>{try{let e=localStorage.getItem(s);return e?JSON.parse(e):{}}catch{return{}}}),[u,d]=(0,N.useState)(0),[f,p]=(0,N.useState)(!1),[m,h]=(0,N.useState)(null),[g,_]=(0,N.useState)(null);(0,N.useEffect)(()=>{localStorage.setItem(s,JSON.stringify(c))},[c,s]);let v=r.items.filter(e=>c[e]!==void 0).length,y=Math.round(v/o*100);function b(e,t){l(n=>({...n,[e]:t}))}function x(e){return a[e].every(e=>c[e]!==void 0)}function S(){if(!x(u)){h(`Responde todas las preguntas de esta pgina para continuar.`);return}h(null),u<a.length-1&&d(e=>e+1)}function C(){h(null),u>0&&d(e=>e-1)}async function w(e){if(e.preventDefault(),h(null),r.items.find(e=>c[e]===void 0)){h(`Hay preguntas sin responder. Revisa las pginas anteriores.`);return}if(!n?.uid){h(`Sesin no disponible. Vuelve a iniciar sesin.`);return}p(!0);try{let e,t=[0,0,0,0,.5,.1,.5];if(r.id===`dass21`){e=_U(c);let n=e.sub;t=[n.stress/42,n.anxiety/42,n.depression/42,0,.5,.1,.5]}else e=bU(c),t=[0,0,0,e.raw/40,.5,.1,.5];let i=await Rqe(t),a=zqe(i);_({scores:e,risk:i,category:a}),await Cie(Pb(XS,`assessments`,n.uid,`submissions`),{instrumentId:r.id,version:r.version,createdAt:Eie(),answers:c,scores:e,model:{risk:i,category:a},flags:{needsFollowUp:a===`high`}}),localStorage.removeItem(s)}catch(e){console.error(`Save error:`,e?.code,e?.message),h(e?.message??`No se pudo guardar la evaluacin.`)}finally{p(!1)}}let T=(0,N.useMemo)(()=>r.scale.labels.map((e,t)=>({value:t,label:e})),[r.scale.labels]);return(0,I.jsxs)(`div`,{className:`container py-4`,children:[(0,I.jsxs)(`div`,{className:`d-flex justify-content-between align-items-center mb-3`,children:[(0,I.jsxs)(`div`,{className:`d-flex align-items-center gap-2`,children:[(0,I.jsx)(`button`,{className:`btn btn-link text-decoration-none`,onClick:()=>t(`/`),children:` Volver al dashboard`}),(0,I.jsx)(`h2`,{className:`mb-0 text-capitalize`,children:r.id}),(0,I.jsxs)(`span`,{className:`badge text-bg-light`,children:[`v`,r.version]})]}),(0,I.jsxs)(`div`,{className:`text-secondary`,children:[v,`/`,o,`  `,y,`%`]})]}),(0,I.jsx)(`div`,{className:`progress mb-3`,role:`progressbar`,"aria-valuenow":y,"aria-valuemin":0,"aria-valuemax":100,children:(0,I.jsx)(`div`,{className:`progress-bar`,style:{width:`${y}%`}})}),m&&(0,I.jsx)(`div`,{className:`alert alert-warning`,children:m}),(0,I.jsxs)(`form`,{onSubmit:w,children:[(0,I.jsx)(`div`,{className:`card mb-3`,children:(0,I.jsx)(`div`,{className:`card-body`,children:a[u].map(e=>(0,I.jsx)(mU,{name:e,text:r.text[e],value:c[e],onChange:t=>b(e,t),options:T,required:!0},e))})}),(0,I.jsxs)(`div`,{className:`d-flex justify-content-between`,children:[(0,I.jsx)(`button`,{type:`button`,className:`btn btn-outline-secondary`,onClick:C,disabled:u===0,children:` Anterior`}),u<a.length-1?(0,I.jsx)(`button`,{type:`button`,className:`btn btn-primary`,onClick:S,children:`Siguiente `}):(0,I.jsx)(`button`,{className:`btn btn-success`,disabled:f,children:f?`Guardando`:`Finalizar y guardar`})]})]}),g&&(0,I.jsxs)(`div`,{className:`alert alert-info mt-4`,children:[(0,I.jsxs)(`div`,{children:[(0,I.jsx)(`strong`,{children:`Riesgo estimado:`}),` `,(g.risk*100).toFixed(0),`%  `,(0,I.jsx)(`em`,{children:g.category})]}),r.id===`dass21`?(0,I.jsxs)(`div`,{className:`small text-secondary mt-1`,children:[`DASS-21  Estrs: `,g.scores.sub.stress,`, Ansiedad: `,g.scores.sub.anxiety,`, Depresin: `,g.scores.sub.depression]}):(0,I.jsxs)(`div`,{className:`small text-secondary mt-1`,children:[`PSS-10  Total: `,g.scores.raw]}),(0,I.jsx)(`div`,{className:`small mt-2`,children:`* Herramienta orientativa (no diagnstica). Si necesitas ayuda urgente, busca apoyo profesional.`})]})]})}function Vqe(){return(0,I.jsx)(Roe,{children:(0,I.jsxs)(moe,{children:[(0,I.jsx)(zC,{path:`/login`,element:(0,I.jsx)(Qoe,{})}),(0,I.jsx)(zC,{path:`/`,element:(0,I.jsx)($S,{children:(0,I.jsx)(uU,{})})}),(0,I.jsx)(zC,{path:`/evaluate/:instrumentId`,element:(0,I.jsx)($S,{children:(0,I.jsx)(Bqe,{})})}),(0,I.jsx)(zC,{path:`*`,element:(0,I.jsx)(poe,{to:`/`,replace:!0})})]})})}(0,bae.createRoot)(document.getElementById(`root`)).render((0,I.jsx)(hae,{children:(0,I.jsx)(Vqe,{})}));